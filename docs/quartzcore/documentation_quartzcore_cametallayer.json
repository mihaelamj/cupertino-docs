{
  "abstract" : "A Core Animation layer that Metal can render into, typically displayed onscreen.",
  "codeExamples" : [
    {
      "code" : "+ (Class) layerClass\n{\n    return [CAMetalLayer class];\n}",
      "language" : "objc"
    },
    {
      "code" : "myView.wantsLayer = YES;\nmyView.layer = [CAMetalLayer layer];",
      "language" : "objc"
    },
    {
      "code" : "CAMetalLayer *metalLayer = (CAMetalLayer*)self.layer;\nid<CAMetalDrawable> *drawable = [metalLayer nextDrawable];\n\nMTLRenderPassDescriptor *renderPassDescriptor\n                               = [MTLRenderPassDescriptor renderPassDescriptor];\n\nrenderPassDescriptor.colorAttachments[0].texture = drawable.texture;\nrenderPassDescriptor.colorAttachments[0].loadAction = MTLLoadActionClear;\nrenderPassDescriptor.colorAttachments[0].clearColor = MTLClearColorMake(0.0,0.0,0.0,1.0);\n...",
      "language" : "objc"
    },
    {
      "code" : "[commandBuffer presentDrawable:drawable];",
      "language" : "objc"
    }
  ],
  "conformsTo" : [
    "CAMediaTiming",
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSCoding",
    "NSObjectProtocol",
    "NSSecureCoding",
    "Sendable",
    "SendableMetatype"
  ],
  "contentHash" : "2a4a7cacc0913d7b41e7562f3dff2e93fb98863e35a1b05cecb1494151bbe985",
  "crawledAt" : "2025-12-07T16:22:43Z",
  "declaration" : {
    "code" : "class CAMetalLayer",
    "language" : "swift"
  },
  "id" : "805773B1-BA34-4B0B-A468-90491F97BEA0",
  "kind" : "class",
  "language" : "swift",
  "module" : "Core Animation",
  "overview" : "## Overview\n\nUse a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] when you want to use Metal to render a layer’s contents; for example, to render into a view. Consider using [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView] instead, because this class automatically wraps a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] object and provides a higher-level abstraction.\n\nIf you’re using UIKit, to create a view that uses a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer], create a subclass of [https:\/\/developer.apple.com\/library\/archive\/releasenotes\/iPhone\/RN-iPhoneSDK\/index.html#\/\/apple_ref\/doc\/uid\/TP40007428-CH1-SW18] and override its [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView\/layerClass] class method to return a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer]:\n\nIf you’re using AppKit, configure an [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSView] object to use a backing layer and assign a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] object to the view:\n\nAdjust the layer’s properties to configure its underlying pixel format and other display behaviors.\n\n### Rendering the Layer’s Contents\n\nA [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] creates a pool of Metal drawable objects ([doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalDrawable]). At any given time, one of these drawable objects contains the contents of the layer. To change the layer’s contents, ask the layer for a drawable object, render into it, and then update the layer’s contents to point to the new drawable.\n\nCall the layer’s [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()] method to obtain a drawable object. Get the drawable object’s texture and create a render pass that renders to that texture, as shown in the code below:\n\nTo change the layer’s contents to the new drawable, call the [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCommandBuffer\/present(_:)] method (or one of its variants) on the command buffer containing the encoded render pass, passing in the drawable object to present.\n\n### Keeping References to Drawables\n\nThe layer reuses a drawable only if it isn’t onscreen and there are no strong references to it. Further, if a drawable isn’t available when you call [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()], the system waits for one to become available. To avoid stalls in your app, request a new drawable only when you need it, and release any references to it as quickly as possible after you’re done with it.\n\nFor example, before retrieving a new drawable, you might perform other work on the CPU or submit commands to the GPU that don’t require the drawable. Then, obtain the drawable and encode a command buffer to render into it, as described above. After you commit this command buffer, release all strong references to the drawable. If you don’t release drawables correctly, the layer runs out of drawables, and future calls to [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()] return `nil`.\n\n### Releasing the Drawable\n\nDon’t release the drawable explicitly; instead, embed your render loop within an autorelease pool block:\n\nThis block releases drawables promptly and avoids possible deadlock situations with multiple drawables. Release drawables as soon as possible after committing your onscreen render pass.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer\ncrawled: 2025-12-07T16:22:43Z\n---\n\n# CAMetalLayer\n\n**Class**\n\nA Core Animation layer that Metal can render into, typically displayed onscreen.\n\n## Declaration\n\n```swift\nclass CAMetalLayer\n```\n\n## Overview\n\nUse a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] when you want to use Metal to render a layer’s contents; for example, to render into a view. Consider using [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView] instead, because this class automatically wraps a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] object and provides a higher-level abstraction.\n\nIf you’re using UIKit, to create a view that uses a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer], create a subclass of [https:\/\/developer.apple.com\/library\/archive\/releasenotes\/iPhone\/RN-iPhoneSDK\/index.html#\/\/apple_ref\/doc\/uid\/TP40007428-CH1-SW18] and override its [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView\/layerClass] class method to return a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer]:\n\n```objc\n+ (Class) layerClass\n{\n    return [CAMetalLayer class];\n}\n```\n\nIf you’re using AppKit, configure an [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSView] object to use a backing layer and assign a [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] object to the view:\n\n```objc\nmyView.wantsLayer = YES;\nmyView.layer = [CAMetalLayer layer];\n```\n\nAdjust the layer’s properties to configure its underlying pixel format and other display behaviors.\n\n### Rendering the Layer’s Contents\n\nA [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer] creates a pool of Metal drawable objects ([doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalDrawable]). At any given time, one of these drawable objects contains the contents of the layer. To change the layer’s contents, ask the layer for a drawable object, render into it, and then update the layer’s contents to point to the new drawable.\n\nCall the layer’s [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()] method to obtain a drawable object. Get the drawable object’s texture and create a render pass that renders to that texture, as shown in the code below:\n\n```objc\nCAMetalLayer *metalLayer = (CAMetalLayer*)self.layer;\nid<CAMetalDrawable> *drawable = [metalLayer nextDrawable];\n\nMTLRenderPassDescriptor *renderPassDescriptor\n                               = [MTLRenderPassDescriptor renderPassDescriptor];\n\nrenderPassDescriptor.colorAttachments[0].texture = drawable.texture;\nrenderPassDescriptor.colorAttachments[0].loadAction = MTLLoadActionClear;\nrenderPassDescriptor.colorAttachments[0].clearColor = MTLClearColorMake(0.0,0.0,0.0,1.0);\n...\n```\n\nTo change the layer’s contents to the new drawable, call the [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCommandBuffer\/present(_:)] method (or one of its variants) on the command buffer containing the encoded render pass, passing in the drawable object to present.\n\n```objc\n[commandBuffer presentDrawable:drawable];\n```\n\n### Keeping References to Drawables\n\nThe layer reuses a drawable only if it isn’t onscreen and there are no strong references to it. Further, if a drawable isn’t available when you call [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()], the system waits for one to become available. To avoid stalls in your app, request a new drawable only when you need it, and release any references to it as quickly as possible after you’re done with it.\n\nFor example, before retrieving a new drawable, you might perform other work on the CPU or submit commands to the GPU that don’t require the drawable. Then, obtain the drawable and encode a command buffer to render into it, as described above. After you commit this command buffer, release all strong references to the drawable. If you don’t release drawables correctly, the layer runs out of drawables, and future calls to [doc:\/\/com.apple.quartzcore\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()] return `nil`.\n\n### Releasing the Drawable\n\nDon’t release the drawable explicitly; instead, embed your render loop within an autorelease pool block:\n\n\n\nThis block releases drawables promptly and avoids possible deadlock situations with multiple drawables. Release drawables as soon as possible after committing your onscreen render pass.\n\n\n\n## Configuring the Metal Device\n\n- **device**: The Metal device responsible for the layer’s drawable resources.\n- **preferredDevice**: The device object that the system recommends using for this layer.\n\n## Configuring the Layer’s Drawable Objects\n\n- **pixelFormat**: The pixel format of the layer’s textures.\n- **colorspace**: The color space of the rendered content.\n- **framebufferOnly**: A Boolean value that determines whether the layer’s textures are used only for rendering.\n- **drawableSize**: The size, in pixels, of textures for rendering layer content.\n\n## Configuring Presentation Behavior\n\n- **presentsWithTransaction**: A Boolean value that determines whether the layer presents its content using a Core Animation transaction.\n- **displaySyncEnabled**: A Boolean value that determines whether the layer synchronizes its updates to the display’s refresh rate.\n\n## Configuring Extended Dynamic Range Behavior\n\n- **wantsExtendedDynamicRangeContent**: Enables extended dynamic range values onscreen.\n- **edrMetadata**: Metadata describing the tone mapping to apply to the extended dynamic range (EDR) values in the layer.\n\n## Obtaining a Metal Drawable\n\n- **nextDrawable()**: Waits until a Metal drawable is available, and then returns it.\n- **maximumDrawableCount**: The number of Metal drawables in the resource pool managed by Core Animation.\n- **allowsNextDrawableTimeout**: A Boolean value that determines whether requests for a new buffer expire if the system can’t satisfy them.\n\n## Configuring the Metal Performance HUD\n\n- **developerHUDProperties**: The properties of the Metal performance heads-up display.\n\n## Instance Properties\n\n- **residencySet**\n\n## Metal and OpenGL\n\n- **CAMetalDrawable**: A Metal drawable associated with a Core Animation layer.\n- **CAEAGLLayer**: A layer that supports drawing OpenGL content in iOS and tvOS applications.\n- **CAEDRMetadata**: Metadata describing how extended dynamic range (EDR) values should be tone mapped.\n- **CAOpenGLLayer**: A layer that provides a layer suitable for rendering OpenGL content.\n- **CARenderer**: A layer that allows an application to render a layer tree into a Core OpenGL context.\n\n## Inherits From\n\n- CALayer\n\n## Conforms To\n\n- CAMediaTiming\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSCoding\n- NSObjectProtocol\n- NSSecureCoding\n- Sendable\n- SendableMetatype\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The Metal device responsible for the layer’s drawable resources.",
          "name" : "device",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/device"
        },
        {
          "description" : "The device object that the system recommends using for this layer.",
          "name" : "preferredDevice",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/preferredDevice"
        }
      ],
      "title" : "Configuring the Metal Device"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The pixel format of the layer’s textures.",
          "name" : "pixelFormat",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/pixelFormat"
        },
        {
          "description" : "The color space of the rendered content.",
          "name" : "colorspace",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/colorspace"
        },
        {
          "description" : "A Boolean value that determines whether the layer’s textures are used only for rendering.",
          "name" : "framebufferOnly",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/framebufferOnly"
        },
        {
          "description" : "The size, in pixels, of textures for rendering layer content.",
          "name" : "drawableSize",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/drawableSize"
        }
      ],
      "title" : "Configuring the Layer’s Drawable Objects"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that determines whether the layer presents its content using a Core Animation transaction.",
          "name" : "presentsWithTransaction",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/presentsWithTransaction"
        },
        {
          "description" : "A Boolean value that determines whether the layer synchronizes its updates to the display’s refresh rate.",
          "name" : "displaySyncEnabled",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/displaySyncEnabled"
        }
      ],
      "title" : "Configuring Presentation Behavior"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Enables extended dynamic range values onscreen.",
          "name" : "wantsExtendedDynamicRangeContent",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/wantsExtendedDynamicRangeContent"
        },
        {
          "description" : "Metadata describing the tone mapping to apply to the extended dynamic range (EDR) values in the layer.",
          "name" : "edrMetadata",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/edrMetadata"
        }
      ],
      "title" : "Configuring Extended Dynamic Range Behavior"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Waits until a Metal drawable is available, and then returns it.",
          "name" : "nextDrawable()",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/nextDrawable()"
        },
        {
          "description" : "The number of Metal drawables in the resource pool managed by Core Animation.",
          "name" : "maximumDrawableCount",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/maximumDrawableCount"
        },
        {
          "description" : "A Boolean value that determines whether requests for a new buffer expire if the system can’t satisfy them.",
          "name" : "allowsNextDrawableTimeout",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/allowsNextDrawableTimeout"
        }
      ],
      "title" : "Obtaining a Metal Drawable"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The properties of the Metal performance heads-up display.",
          "name" : "developerHUDProperties",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/developerHUDProperties"
        }
      ],
      "title" : "Configuring the Metal Performance HUD"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "residencySet",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalLayer\/residencySet"
        }
      ],
      "title" : "Instance Properties"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Metal drawable associated with a Core Animation layer.",
          "name" : "CAMetalDrawable",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAMetalDrawable"
        },
        {
          "description" : "A layer that supports drawing OpenGL content in iOS and tvOS applications.",
          "name" : "CAEAGLLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAEAGLLayer"
        },
        {
          "description" : "Metadata describing how extended dynamic range (EDR) values should be tone mapped.",
          "name" : "CAEDRMetadata",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAEDRMetadata"
        },
        {
          "description" : "A layer that provides a layer suitable for rendering OpenGL content.",
          "name" : "CAOpenGLLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CAOpenGLLayer"
        },
        {
          "description" : "A layer that allows an application to render a layer tree into a Core OpenGL context.",
          "name" : "CARenderer",
          "url" : "https:\/\/developer.apple.com\/documentation\/QuartzCore\/CARenderer"
        }
      ],
      "title" : "Metal and OpenGL"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "CALayer"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "CAMetalLayer",
  "url" : "https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer"
}