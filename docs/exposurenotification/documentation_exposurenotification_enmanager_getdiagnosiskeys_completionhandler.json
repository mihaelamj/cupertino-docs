{
  "abstract" : "Requests the temporary exposure keys from the user’s device to share with a server.",
  "codeExamples" : [

  ],
  "contentHash" : "78ce3fed606f5c454a2f6a8dea3b85c5e6745acc9e4e532bc14d784dfe4bb4f1",
  "crawledAt" : "2025-11-30T23:32:04Z",
  "declaration" : {
    "code" : "func getDiagnosisKeys(completionHandler: @escaping ([ENTemporaryExposureKey]?, (any Error)?) -> Void)",
    "language" : "swift"
  },
  "id" : "3002F9F0-172D-407F-BF4C-18189459889C",
  "kind" : "method",
  "module" : "Exposure Notification",
  "overview" : "## Discussion\n\nThe app must be in the foreground when it calls this method. Each time the app calls this method, the system presents an interface that requests authorization.\n\nWhen [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/ENAPIVersion] is set to `1` in the app’s Info.plist file, you must wait approximately 24 hours after the first call of [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/getDiagnosisKeys(completionHandler:)] before this call returns a valid key. To test your app without waiting 24 hours, use [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/getTestDiagnosisKeys(completionHandler:)].\n\nWhen [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/ENAPIVersion] is set to `2`, this call returns a diagnosis key with a shortened rolling period.",
  "platforms" : [
    "iOS",
    "iPadOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/getDiagnosisKeys(completionHandler:)\ncrawled: 2025-11-30T23:32:04Z\n---\n\n# getDiagnosisKeys(completionHandler:)\n\n**Instance Method**\n\nRequests the temporary exposure keys from the user’s device to share with a server.\n\n## Declaration\n\n```swift\nfunc getDiagnosisKeys(completionHandler: @escaping ([ENTemporaryExposureKey]?, (any Error)?) -> Void)\n```\n\n```swift\nfunc diagnosisKeys() async throws -> [ENTemporaryExposureKey]\n```\n\n## Parameters\n\n- **completionHandler**: The completion handler that the framework calls when [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/getDiagnosisKeys(completionHandler:)] completes. If the method completes successfully, `keys` will contain the diagnosis keys for this device and `error` will be `nil`. If it fails, `keys` will be `nil` and `error` indicates the reason it failed.\n\n## Discussion\n\n\n\n\n\nThe app must be in the foreground when it calls this method. Each time the app calls this method, the system presents an interface that requests authorization.\n\nWhen [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/ENAPIVersion] is set to `1` in the app’s Info.plist file, you must wait approximately 24 hours after the first call of [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/getDiagnosisKeys(completionHandler:)] before this call returns a valid key. To test your app without waiting 24 hours, use [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/getTestDiagnosisKeys(completionHandler:)].\n\nWhen [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/ENAPIVersion] is set to `2`, this call returns a diagnosis key with a shortened rolling period.\n\n## Completion Handlers\n\n- **ENGetDiagnosisKeysHandler**: The definition of a handler that returns diagnosis keys.\n\n## Obtaining Exposure Keys\n\n- **getTestDiagnosisKeys(completionHandler:)**: Requests the temporary exposure keys, including the current key, used by this device for testing.\n- **ENTemporaryExposureKey**: The key used to generate rolling proximity identifiers.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The definition of a handler that returns diagnosis keys.",
          "name" : "ENGetDiagnosisKeysHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENGetDiagnosisKeysHandler"
        }
      ],
      "title" : "Completion Handlers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Requests the temporary exposure keys, including the current key, used by this device for testing.",
          "name" : "getTestDiagnosisKeys(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/getTestDiagnosisKeys(completionHandler:)"
        },
        {
          "description" : "The key used to generate rolling proximity identifiers.",
          "name" : "ENTemporaryExposureKey",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENTemporaryExposureKey"
        }
      ],
      "title" : "Obtaining Exposure Keys"
    }
  ],
  "source" : "appleJSON",
  "title" : "getDiagnosisKeys(completionHandler:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/getDiagnosisKeys(completionHandler:)"
}