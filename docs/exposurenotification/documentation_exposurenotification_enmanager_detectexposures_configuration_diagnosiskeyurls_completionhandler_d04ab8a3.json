{
  "abstract" : "Detects exposures using the configuration that you specify for controlling the scoring algorithm.",
  "codeExamples" : [
    {
      "code" : "{\n  \"ExposureChecks\" : [\n    {\n      \"Timestamp\" : \"2020-08-24 05:06:28 -0700\",\n      \"Files\" : [\n        {\n          \"Hash\" : \"C0758C66350BB2875E438B52F73544AF3B91351365447E805B3548813E8086BD\",\n          \"KeyCount\" : 1082,\n          \"RegionCode\" : \"DR\",\n          \"Timestamp\" : \"2020-08-24 05:09:21 -0700\"\n        },\n      ],\n      \"RegionCode\" : \"DR\"\n    }\n  ]\n}",
      "language" : "json"
    }
  ],
  "contentHash" : "b532e6b80f1610d2e50210580bc3278af73d6afa4fafff96d99d52bb4979e354",
  "crawledAt" : "2025-12-02T19:47:32Z",
  "declaration" : {
    "code" : "func detectExposures(configuration: ENExposureConfiguration, diagnosisKeyURLs: [URL], completionHandler: @escaping ENDetectExposuresHandler) -> Progress",
    "language" : "swift"
  },
  "id" : "A83FAF4D-7BCF-41CC-B597-440D71121412",
  "kind" : "method",
  "language" : "swift",
  "module" : "Exposure Notification",
  "overview" : "## Return Value\n\nThe progress of the method.\n\n## Discussion\n\nThe `diagnosisKeyURLs` parameter requires an array of file URLs that point to exposure key data files downloaded from an exposure notification (EN) server. For more information about the data format used to transmit diagnosis key data, see [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/setting-up-a-key-server].\n\nWhen you retrieve diagnosis key data from an EN server, you receive it as a zip archive that you must decompress before use. Every archive you download from an EN server includes two files with the same base name, but with different file extensions: a key file with a `.bin` extension, and a signature file with a `.sig` extension. Decompress both files in the same directory, create a URL that points to each of the extracted files, and then pass both URLs as an array to `diagnosisKeyURLs` argument in an array.\n\nIf a diagnosis key has a rolling period greater than 144, the framework ignores it and will not consider it for key matching.\n\nYou may submit multiple file pairs in a single call to this method; however, each pair must use a unique base name. The order of the URLs passed in the `diagnosisKeyURLs` array doesn’t matter. The file pairs will be matched up using the base name.\n\nOn iOS 13.7 and later, exposure keys that you submit to this method are automatically cached and used by the EN framework in calculations for up to 14 days. If you want to recalculate an ERV using different configuration values, use [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/detectExposures(configuration:completionHandler:)] to recalculate a new ERV using only cached exposure keys.\n\n### Log Exposures\n\nExposureNotification provides transparency for users at several points. For example, a user can choose Settings > Exposure Notifications to show the status of COVID-19 Exposure Logging, along with the currently active app, and its activity. This activity view shows the number of diagnostic key checks in the past 14 days, and the hash of the checked sets of keys.\n\nTo export the exposure checks, tap Export Exposure Checks. The resulting JSON file contains a `Files` array.\n\nWithin the array are several properties, including the timestamp of the check (`Timestamp`), and how many positive keys the device downloaded and checked on the device (`KeyCount`) at that time.\n\niOS also provides a monthly notification to the user that reads, “Your iPhone continues to look for possible exposures on your behalf.” The notification occurs if the user has installed an EN app and enabled Exposure Logging, and the app has run a check for matched keys. The notification ensures that the app doesn’t continue to share proximity events without notifying the user. Users who tap the notification arrive at the transparency details in the Settings app, as described earlier.",
  "platforms" : [
    "iOS",
    "iPadOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/detectExposures(configuration:diagnosisKeyURLs:completionHandler:)\ncrawled: 2025-12-02T19:47:32Z\n---\n\n# detectExposures(configuration:diagnosisKeyURLs:completionHandler:)\n\n**Instance Method**\n\nDetects exposures using the configuration that you specify for controlling the scoring algorithm.\n\n## Declaration\n\n```swift\nfunc detectExposures(configuration: ENExposureConfiguration, diagnosisKeyURLs: [URL], completionHandler: @escaping ENDetectExposuresHandler) -> Progress\n```\n\n## Parameters\n\n- **configuration**: The configuration to use for scoring.\n- **diagnosisKeyURLs**: An array of file URLs that contain downloaded diagnosis keys.\n- **completionHandler**: The completion handler that the framework calls when the method completes.\n\n## Return Value\n\nThe progress of the method.\n\n## Discussion\n\n\n\nThe `diagnosisKeyURLs` parameter requires an array of file URLs that point to exposure key data files downloaded from an exposure notification (EN) server. For more information about the data format used to transmit diagnosis key data, see [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/setting-up-a-key-server].\n\nWhen you retrieve diagnosis key data from an EN server, you receive it as a zip archive that you must decompress before use. Every archive you download from an EN server includes two files with the same base name, but with different file extensions: a key file with a `.bin` extension, and a signature file with a `.sig` extension. Decompress both files in the same directory, create a URL that points to each of the extracted files, and then pass both URLs as an array to `diagnosisKeyURLs` argument in an array.\n\nIf a diagnosis key has a rolling period greater than 144, the framework ignores it and will not consider it for key matching.\n\nYou may submit multiple file pairs in a single call to this method; however, each pair must use a unique base name. The order of the URLs passed in the `diagnosisKeyURLs` array doesn’t matter. The file pairs will be matched up using the base name.\n\nOn iOS 13.7 and later, exposure keys that you submit to this method are automatically cached and used by the EN framework in calculations for up to 14 days. If you want to recalculate an ERV using different configuration values, use [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/ENManager\/detectExposures(configuration:completionHandler:)] to recalculate a new ERV using only cached exposure keys.\n\n\n\n### Log Exposures\n\nExposureNotification provides transparency for users at several points. For example, a user can choose Settings > Exposure Notifications to show the status of COVID-19 Exposure Logging, along with the currently active app, and its activity. This activity view shows the number of diagnostic key checks in the past 14 days, and the hash of the checked sets of keys.\n\nTo export the exposure checks, tap Export Exposure Checks. The resulting JSON file contains a `Files` array.\n\n```json\n{\n  \"ExposureChecks\" : [\n    {\n      \"Timestamp\" : \"2020-08-24 05:06:28 -0700\",\n      \"Files\" : [\n        {\n          \"Hash\" : \"C0758C66350BB2875E438B52F73544AF3B91351365447E805B3548813E8086BD\",\n          \"KeyCount\" : 1082,\n          \"RegionCode\" : \"DR\",\n          \"Timestamp\" : \"2020-08-24 05:09:21 -0700\"\n        },\n      ],\n      \"RegionCode\" : \"DR\"\n    }\n  ]\n}\n```\n\nWithin the array are several properties, including the timestamp of the check (`Timestamp`), and how many positive keys the device downloaded and checked on the device (`KeyCount`) at that time.\n\niOS also provides a monthly notification to the user that reads, “Your iPhone continues to look for possible exposures on your behalf.” The notification occurs if the user has installed an EN app and enabled Exposure Logging, and the app has run a check for matched keys. The notification ensures that the app doesn’t continue to share proximity events without notifying the user. Users who tap the notification arrive at the transparency details in the Settings app, as described earlier.\n\n## Completion Handlers\n\n- **ENDetectExposuresHandler**: The definition of a handler that returns exposure summaries.\n\n## Obtaining Exposure Information\n\n- **detectExposures(configuration:completionHandler:)**: Detects exposures using the specified configuration to control the scoring algorithm.\n- **getExposureWindows(summary:completionHandler:)**: Obtains information from the provided summary about the user’s exposure within a window of time.\n- **ENGetExposureWindowsHandler**: The handler the system invokes when the acquisition of windows completes.\n- **getUserTraveled(completionHandler:)**: Obtains information about the user’s travel within an exposure period.\n- **ENGetUserTraveledHandler**: The handler the system invokes when acquistiion of the user’s travel status completes.\n- **getExposureInfo(summary:userExplanation:completionHandler:)**: Returns information about each exposure.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The definition of a handler that returns exposure summaries.",
          "name" : "ENDetectExposuresHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENDetectExposuresHandler"
        }
      ],
      "title" : "Completion Handlers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Detects exposures using the specified configuration to control the scoring algorithm.",
          "name" : "detectExposures(configuration:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/detectExposures(configuration:completionHandler:)"
        },
        {
          "description" : "Obtains information from the provided summary about the user’s exposure within a window of time.",
          "name" : "getExposureWindows(summary:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/getExposureWindows(summary:completionHandler:)"
        },
        {
          "description" : "The handler the system invokes when the acquisition of windows completes.",
          "name" : "ENGetExposureWindowsHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENGetExposureWindowsHandler"
        },
        {
          "description" : "Obtains information about the user’s travel within an exposure period.",
          "name" : "getUserTraveled(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/getUserTraveled(completionHandler:)"
        },
        {
          "description" : "The handler the system invokes when acquistiion of the user’s travel status completes.",
          "name" : "ENGetUserTraveledHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENGetUserTraveledHandler"
        },
        {
          "description" : "Returns information about each exposure.",
          "name" : "getExposureInfo(summary:userExplanation:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/getExposureInfo(summary:userExplanation:completionHandler:)"
        }
      ],
      "title" : "Obtaining Exposure Information"
    }
  ],
  "source" : "appleJSON",
  "title" : "detectExposures(configuration:diagnosisKeyURLs:completionHandler:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/ENManager\/detectExposures(configuration:diagnosisKeyURLs:completionHandler:)"
}