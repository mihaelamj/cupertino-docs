{
  "abstract" : "Support exposure key upload and download for app-less exposure notifications.",
  "codeExamples" : [

  ],
  "contentHash" : "d83cd0be8b5d860f6f855ae66b46d3fb1d884e76f528de4f27b2effcaa824f8a",
  "crawledAt" : "2025-12-02T19:47:28Z",
  "id" : "228000E3-7413-4B44-B54C-EE77BF8C46E8",
  "kind" : "article",
  "language" : "swift",
  "module" : "Exposure Notification",
  "overview" : "## Overview\n\nExposure Notifications Key Servers accept key uploads from users with positive diagnoses and enable key downloads to devices to support exposure detection. Exposure Notifications apps must use a specific file format for key archives, but a Public Health Authority (PHA) determines the method by which the server and client app exchange those key archives.\n\nWith Exposure Notifications Express, key servers must implement key upload and download as specified in this article, and must use Apple Business Registry (ABR) to configure the upload and download URLs and set other configurable options.\n\nFor more information on the key archive file formats, see [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/setting-up-a-key-server].\n\n### Configure the Key Server\n\nExposure Notifications Express works by reading configuration values for a PHA from Apple Business Registry (ABR). It uses these configuration values to locate a PHA’s servers and to adjust its calculations and behavior based on the values entered by that PHA. In order to support key upload and download in Exposure Notifications Express, you must configure the following values:\n\nFor a complete list of the configuration options available with Exposure Notifications Express, see [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/configuring-exposure-notifications].\n\n### Publish an Index File\n\nTo support Exposure Notification Express, key servers must publish an index file at the Local Download Index File URL (`tekLocalDownloadIndexFile)` registered in ABR. Index files are UTF-8 text files that contain one line per key archive that is currently available from the key server. The index lists archive files in chronological order, with the oldest key archive on the first line of the file. As the key server adds new files to the index, it also removes any entry pointing to archives more than 14–days old.\n\n### Publish Key Batches as Zip Archives\n\nKey servers periodically publish new key archives that contain any new diagnosis keys uploaded to the server since the last time it published an archive. Health Authorities register a configuration value (`callbackIntervalInMin`) in ABR to control the frequency of the updates. When the server publishes a new key file, it adds the URL of that new archive (excluding the base URL) as the first entry in the local download index file.\n\nExposure Notifications Express uses the same key archive file format as Exposure Notification client apps. Each archive contains one `.dat` and one `.sig` file, as specified in [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/setting-up-a-key-server].\n\nWhen a user enables COVID-19 exposure notifications, Exposure Notifications Express queries the key server’s local download index file to retrieve the index. Exposure Notifications Express then uses that index to retrieve all keys from the key server for the last 14 days. You don’t need to use a specific naming convention to publish key archives, but incorporating region, start time, and end time into the filename simplifies debugging and clarifies logging.\n\n### Accept Key Uploads\n\nTo support Exposure Notifications Express key uploads, a key server must implement the Key Upload URL (`tekUploadURL`) configured in ABR. iOS uploads key batches to that URL by sending a JSON dictionary as the body of an HTTP POST request with all the data the key server needs to authenticate the keys and the diagnosis.\n\nThe request dictionary uses the keys listed below:\n\nThe `temporaryExposureKeys`array contains one JSON dictionary per key being uploaded. The per-exposure-key dictionary supports the keys listed below:\n\nThe key server responds to these requests by returning a JSON dictionary that describes the result in the response body. The response dictionary uses the keys listed below.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/ExposureNotification\/configuring-a-key-server-for-exposure-notifications-express\ncrawled: 2025-12-02T19:47:28Z\n---\n\n# Configuring a Key Server for Exposure Notifications Express\n\n**Article**\n\nSupport exposure key upload and download for app-less exposure notifications.\n\n## Overview\n\nExposure Notifications Key Servers accept key uploads from users with positive diagnoses and enable key downloads to devices to support exposure detection. Exposure Notifications apps must use a specific file format for key archives, but a Public Health Authority (PHA) determines the method by which the server and client app exchange those key archives.\n\nWith Exposure Notifications Express, key servers must implement key upload and download as specified in this article, and must use Apple Business Registry (ABR) to configure the upload and download URLs and set other configurable options.\n\nFor more information on the key archive file formats, see [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/setting-up-a-key-server].\n\n### Configure the Key Server\n\nExposure Notifications Express works by reading configuration values for a PHA from Apple Business Registry (ABR). It uses these configuration values to locate a PHA’s servers and to adjust its calculations and behavior based on the values entered by that PHA. In order to support key upload and download in Exposure Notifications Express, you must configure the following values:\n\n- **Publish Interval**: The `tekPublishInterval` parameter identifies how often your server publishes new key archives, which are specified in increments of 10 minutes.\n- **Local Download Index File**: The `tekLocalDownloadIndexFile` parameter points to an index of key archives that are currently available from the key server.\n- **Local Download Base Path**: The `tekLocalDownloadBasePath` value contains the base URL you use to retrieve key archives listed in the local download index. Exposure Notifications Express appends entries from the local download index file to this value to create a URL that points to the referenced file.\n- **Callback Interval in Minutes**: The `callbackIntervalInMin` parameter indicates how often iOS checks the key server for new archive files.\n- **Key Upload URL**: The `tekUploadURL` value points to the key server’s upload endpoint.\n\nFor a complete list of the configuration options available with Exposure Notifications Express, see [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/configuring-exposure-notifications].\n\n### Publish an Index File\n\nTo support Exposure Notification Express, key servers must publish an index file at the Local Download Index File URL (`tekLocalDownloadIndexFile)` registered in ABR. Index files are UTF-8 text files that contain one line per key archive that is currently available from the key server. The index lists archive files in chronological order, with the oldest key archive on the first line of the file. As the key server adds new files to the index, it also removes any entry pointing to archives more than 14–days old.\n\n### Publish Key Batches as Zip Archives\n\nKey servers periodically publish new key archives that contain any new diagnosis keys uploaded to the server since the last time it published an archive. Health Authorities register a configuration value (`callbackIntervalInMin`) in ABR to control the frequency of the updates. When the server publishes a new key file, it adds the URL of that new archive (excluding the base URL) as the first entry in the local download index file.\n\nExposure Notifications Express uses the same key archive file format as Exposure Notification client apps. Each archive contains one `.dat` and one `.sig` file, as specified in [doc:\/\/com.apple.exposurenotification\/documentation\/ExposureNotification\/setting-up-a-key-server].\n\nWhen a user enables COVID-19 exposure notifications, Exposure Notifications Express queries the key server’s local download index file to retrieve the index. Exposure Notifications Express then uses that index to retrieve all keys from the key server for the last 14 days. You don’t need to use a specific naming convention to publish key archives, but incorporating region, start time, and end time into the filename simplifies debugging and clarifies logging.\n\n### Accept Key Uploads\n\nTo support Exposure Notifications Express key uploads, a key server must implement the Key Upload URL (`tekUploadURL`) configured in ABR. iOS uploads key batches to that URL by sending a JSON dictionary as the body of an HTTP POST request with all the data the key server needs to authenticate the keys and the diagnosis.\n\nThe request dictionary uses the keys listed below:\n\n\n\nThe `temporaryExposureKeys`array contains one JSON dictionary per key being uploaded. The per-exposure-key dictionary supports the keys listed below:\n\n\n\nThe key server responds to these requests by returning a JSON dictionary that describes the result in the response body. The response dictionary uses the keys listed below.\n\n\n\n## Server Configuration\n\n- **Setting Up an Exposure Notifications Express Test Verification Server**: Validate positive diagnoses for app-less exposure notifications.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Validate positive diagnoses for app-less exposure notifications.",
          "name" : "Setting Up an Exposure Notifications Express Test Verification Server",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/setting-up-an-exposure-notifications-express-test-verification-server"
        }
      ],
      "title" : "Server Configuration"
    }
  ],
  "source" : "appleJSON",
  "title" : "Configuring a Key Server for Exposure Notifications Express",
  "url" : "https:\/\/developer.apple.com\/documentation\/ExposureNotification\/configuring-a-key-server-for-exposure-notifications-express"
}