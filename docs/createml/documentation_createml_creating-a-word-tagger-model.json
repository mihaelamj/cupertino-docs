{
  "abstract" : "Train a machine learning model to tag individual words in natural language text.",
  "codeExamples" : [
    {
      "code" : "\/\/ JSON file\n[\n    {\n        \"tokens\": [\"AirPods\", \"are\", \"a\", \"fantastic\", \"Apple\", \"product\", \".\"],\n        \"labels\": [\"PROD\", \"NONE\", \"NONE\", \"NONE\", \"ORG\", \"NONE\", \"NONE\"]\n    },\n    {\n        \"tokens\": [\"The\", \"iPhone\", \"takes\", \"stunning\", \"photos\", \".\"],\n        \"labels\": [\"NONE\", \"PROD\", \"NONE\", \"NONE\", \"NONE\", \"NONE\"]\n    },\n    {\n        \"tokens\": [\"Start\", \"building\", \"a\", \"native\", \"Mac\", \"app\", \"from\", \"your\", \"current\", \"iPad\", \"app\", \"using\", \"Mac\", \"Catalyst\", \".\"],\n        \"labels\": [\"NONE\", \"NONE\", \"NONE\", \"NONE\", \"PROD\", \"NONE\", \"NONE\", \"NONE\", \"NONE\", \"PROD\", \"NONE\", \"NONE\", \"PROD\", \"PROD\", \"NONE\"]\n    }\n]",
      "language" : "javascript"
    },
    {
      "code" : "import CreateML\n\nlet data = try MLDataTable(contentsOf:\n    URL(fileURLWithPath: \"<#\/path\/to\/read\/data.json#>\"))",
      "language" : "javascript"
    },
    {
      "code" : "let (trainingData, testingData) = data.randomSplit(by: 0.8, seed: 5)",
      "language" : "swift"
    },
    {
      "code" : "let wordTagger = try MLWordTagger(trainingData: trainingData,\n                             tokenColumn: \"tokens\",\n                             labelColumn: \"labels\")",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Training accuracy as a percentage\nlet trainingAccuracy = (1.0 - wordTagger.trainingMetrics.taggingError) * 100\n\n\/\/ Validation accuracy as a percentage\nlet validationAccuracy = (1.0 - wordTagger.validationMetrics.taggingError) * 100",
      "language" : "swift"
    },
    {
      "code" : "let evaluationMetrics = wordTagger.evaluation(on: testingData,\n                                              tokenColumn: \"tokens\",\n                                              labelColumn: \"labels\")",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Evaluation accuracy as a percentage\nlet evaluationAccuracy = (1.0 - evaluationMetrics.taggingError) * 100",
      "language" : "swift"
    },
    {
      "code" : "let metadata = MLModelMetadata(author: \"Jane Appleseed\",\n                               shortDescription: \"A model trained to tag Apple products.\",\n                               version: \"1.0\")\n\ntry wordTagger.write(to: URL(fileURLWithPath: \"<#\/path\/to\/save\/AppleTagger.mlmodel#>\"),\n                              metadata: metadata)",
      "language" : "swift"
    },
    {
      "code" : "import NaturalLanguage \nimport CoreML\n\nlet text = \"The iPad is my favorite Apple product.\"\n\ndo {\n    let mlModel = try AppleTagger(configuration: MLModelConfiguration()).model\n\n    let customModel = try NLModel(mlModel: mlModel)\n    let customTagScheme = NLTagScheme(\"Apple\")\n    \n    let tagger = NLTagger(tagSchemes: [.nameType, customTagScheme])\n    tagger.string = text\n    tagger.setModels([customModel], forTagScheme: customTagScheme)\n    \n    tagger.enumerateTags(in: text.startIndex..<text.endIndex, unit: .word, \n                         scheme: customTagScheme, options: .omitWhitespace) { tag, tokenRange  in\n        if let tag = tag {\n            print(\"\\(text[tokenRange]): \\(tag.rawValue)\")\n        }\n        return true\n    }\n} catch {\n    print(error)\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "d7d74f49a1028a9f6bdb76a6c5dd46b196b31a68d6e085d9174eebf007c25720",
  "crawledAt" : "2025-12-01T17:07:27Z",
  "id" : "303CBBF0-025F-4C50-B3F2-F3A4411E2B9F",
  "kind" : "article",
  "module" : "Create ML",
  "overview" : "## Overview\n\nA *word tagger* is a machine learning model that’s been trained to classify natural language text at the word level.\n\nYou train a word tagger by showing it multiple examples of sentences containing words you’ve already tagged — for example, Apple product names like *iPad* and *iPhone*.\n\n### Import your data\n\nStart by gathering textual data and importing it into an [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable] instance. You can create a data table from JSON and CSV formats.\n\nAs an example, consider a JSON file containing sentences with words that you’ve tagged. Each entry contains a pair of keys—`tokens` and `labels`:\n\nThe arrays are the same length, resulting in a one-to-one mapping between each token and its corresponding label.\n\nThe JSON snippet below shows three pairs of tokenized sentences with their associated labels.\n\nIn a macOS playground, create the data table using the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable\/init(contentsOf:options:)] method of [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable].\n\nThe resulting data table has two columns, named `tokens` and `labels`, derived from the keys in the JSON file. The column names can be anything, as long as they’re meaningful to you, because you’ll use them as parameters in other methods.\n\nYou’ll use the data you gathered for two critical tasks: model training and evaluation.\n\n### Prepare your data for training and evaluation\n\nAfter you train your word tagger model, you need to evaluate how good it’s at its tagging task. To test the model’s performance, set aside part of your data in a testing dataset. Training and testing data must be entirely separate, with no overlap. This way, the metrics you calculate based on your testing data tell you how well the classifier performs on examples it hasn’t already seen.\n\nGenerally, the testing dataset is significantly smaller than the training dataset. You might want to use about 80 percent of your overall data to train the model, and 20 percent to test it. However, it’s more important that the testing data is high-quality: as close as possible to real-world examples, well-distributed, and balanced. Use your best data for your testing data.\n\nOne way to generate training and testing data from your dataset is to use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable\/randomSplit(by:seed:)] method of [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable]. This method splits your data into two tables, one for training and the other for testing. Specify a `0.8` split to create a training data table that contains 80 percent of your data, and a testing data table that contains the remaining 20 percent.\n\nAlthough [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable\/randomSplit(by:seed:)] provides a quick way to split your dataset, consider creating separate training and testing datasets manually. That way, you can ensure that your testing data is high quality.\n\n### Create and train the word tagger\n\nCreate an instance of [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger] with your training data table and the names of your columns. Training begins immediately.\n\nWord tagger training requires setting aside a small subset of the training data as a validation dataset, to help keep track of training progress. The validation data allows the training process to gauge the model’s performance on examples the model hasn’t been trained on. Depending on the validation accuracy, the training algorithm could adjust values within the model or even stop the training process, if the accuracy is high enough.\n\nTraining and validation data must be entirely separate, with no overlap. If you want to make this split yourself, you can set aside around 5 to 10 percent of your training data as your validation data, and provide that data by setting custom model parameters. If you don’t do the split yourself, Create ML automatically sets aside a small percentage of the training data to use for validating the model’s progress during the training phase. Because the data is split randomly, you might get a different result each time you train the model.\n\nTo see how accurately the model performed on the training and validation data, use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics\/taggingError] property of the model’s [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger\/trainingMetrics] and [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger\/validationMetrics] properties.\n\n### Evaluate the tagger’s accuracy\n\nNext, evaluate your trained model’s performance by testing it against sentences it’s never seen before. Pass your testing data table to the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger\/evaluation(on:tokenColumn:labelColumn:)-31x1l] method, which returns an [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics] instance.\n\nTo get the evaluation accuracy, use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics\/taggingError] property of the returned [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics] instance.\n\nIf the evaluation performance isn’t good enough, you may need to retrain with more data or make other adjustments. For information about improving model performance, see `Improving Your Model’s Accuracy`.\n\n### Save the Core ML model\n\nWhen your model is performing well enough, you’re ready to save it so you can use it in your app. Use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLTextClassifier\/write(to:metadata:)] method to write the Core ML model file (in this example, `AppleTagger.mlmodel`) to disk. Provide any information about the model, like its author, version, or description, in an [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLModelMetadata] instance.\n\n### Add the model to your app\n\nWith your app open in Xcode, drag the `AppleTagger.mlmodel` file into the navigation pane. Xcode compiles the model and generates an `AppleTagger` class for use in your app. Select the `AppleTagger.mlmodel` file in Xcode to view additional information about the model.\n\nCreate an [doc:\/\/com.apple.documentation\/documentation\/NaturalLanguage\/NLModel] in the Natural Language framework from the `AppleTagger` to ensure that the tokenization is consistent between training and deployment. Attach the model to an [doc:\/\/com.apple.documentation\/documentation\/NaturalLanguage\/NLTagger] to tag sentences or paragraphs, using an existing or custom [doc:\/\/com.apple.documentation\/documentation\/NaturalLanguage\/NLTagScheme].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CreateML\/creating-a-word-tagger-model\ncrawled: 2025-12-01T17:07:27Z\n---\n\n# Creating a word tagger model\n\n**Article**\n\nTrain a machine learning model to tag individual words in natural language text.\n\n## Overview\n\nA *word tagger* is a machine learning model that’s been trained to classify natural language text at the word level.\n\nYou train a word tagger by showing it multiple examples of sentences containing words you’ve already tagged — for example, Apple product names like *iPad* and *iPhone*.\n\n### Import your data\n\nStart by gathering textual data and importing it into an [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable] instance. You can create a data table from JSON and CSV formats.\n\nAs an example, consider a JSON file containing sentences with words that you’ve tagged. Each entry contains a pair of keys—`tokens` and `labels`:\n\n- The value for the `tokens` key is an array of words and punctuation in an individual sentence.\n- The value for `labels` is an array of corresponding labels, or tags, for each of those tokens.\n\nThe arrays are the same length, resulting in a one-to-one mapping between each token and its corresponding label.\n\nThe JSON snippet below shows three pairs of tokenized sentences with their associated labels.\n\n```javascript\n\/\/ JSON file\n[\n    {\n        \"tokens\": [\"AirPods\", \"are\", \"a\", \"fantastic\", \"Apple\", \"product\", \".\"],\n        \"labels\": [\"PROD\", \"NONE\", \"NONE\", \"NONE\", \"ORG\", \"NONE\", \"NONE\"]\n    },\n    {\n        \"tokens\": [\"The\", \"iPhone\", \"takes\", \"stunning\", \"photos\", \".\"],\n        \"labels\": [\"NONE\", \"PROD\", \"NONE\", \"NONE\", \"NONE\", \"NONE\"]\n    },\n    {\n        \"tokens\": [\"Start\", \"building\", \"a\", \"native\", \"Mac\", \"app\", \"from\", \"your\", \"current\", \"iPad\", \"app\", \"using\", \"Mac\", \"Catalyst\", \".\"],\n        \"labels\": [\"NONE\", \"NONE\", \"NONE\", \"NONE\", \"PROD\", \"NONE\", \"NONE\", \"NONE\", \"NONE\", \"PROD\", \"NONE\", \"NONE\", \"PROD\", \"PROD\", \"NONE\"]\n    }\n]\n```\n\nIn a macOS playground, create the data table using the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable\/init(contentsOf:options:)] method of [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable].\n\n```javascript\nimport CreateML\n\nlet data = try MLDataTable(contentsOf:\n    URL(fileURLWithPath: \"<#\/path\/to\/read\/data.json#>\"))\n```\n\nThe resulting data table has two columns, named `tokens` and `labels`, derived from the keys in the JSON file. The column names can be anything, as long as they’re meaningful to you, because you’ll use them as parameters in other methods.\n\nYou’ll use the data you gathered for two critical tasks: model training and evaluation.\n\n### Prepare your data for training and evaluation\n\nAfter you train your word tagger model, you need to evaluate how good it’s at its tagging task. To test the model’s performance, set aside part of your data in a testing dataset. Training and testing data must be entirely separate, with no overlap. This way, the metrics you calculate based on your testing data tell you how well the classifier performs on examples it hasn’t already seen.\n\nGenerally, the testing dataset is significantly smaller than the training dataset. You might want to use about 80 percent of your overall data to train the model, and 20 percent to test it. However, it’s more important that the testing data is high-quality: as close as possible to real-world examples, well-distributed, and balanced. Use your best data for your testing data.\n\nOne way to generate training and testing data from your dataset is to use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable\/randomSplit(by:seed:)] method of [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable]. This method splits your data into two tables, one for training and the other for testing. Specify a `0.8` split to create a training data table that contains 80 percent of your data, and a testing data table that contains the remaining 20 percent.\n\n```swift\nlet (trainingData, testingData) = data.randomSplit(by: 0.8, seed: 5)\n```\n\nAlthough [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLDataTable\/randomSplit(by:seed:)] provides a quick way to split your dataset, consider creating separate training and testing datasets manually. That way, you can ensure that your testing data is high quality.\n\n### Create and train the word tagger\n\nCreate an instance of [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger] with your training data table and the names of your columns. Training begins immediately.\n\n```swift\nlet wordTagger = try MLWordTagger(trainingData: trainingData,\n                             tokenColumn: \"tokens\",\n                             labelColumn: \"labels\")\n```\n\nWord tagger training requires setting aside a small subset of the training data as a validation dataset, to help keep track of training progress. The validation data allows the training process to gauge the model’s performance on examples the model hasn’t been trained on. Depending on the validation accuracy, the training algorithm could adjust values within the model or even stop the training process, if the accuracy is high enough.\n\nTraining and validation data must be entirely separate, with no overlap. If you want to make this split yourself, you can set aside around 5 to 10 percent of your training data as your validation data, and provide that data by setting custom model parameters. If you don’t do the split yourself, Create ML automatically sets aside a small percentage of the training data to use for validating the model’s progress during the training phase. Because the data is split randomly, you might get a different result each time you train the model.\n\nTo see how accurately the model performed on the training and validation data, use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics\/taggingError] property of the model’s [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger\/trainingMetrics] and [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger\/validationMetrics] properties.\n\n```swift\n\/\/ Training accuracy as a percentage\nlet trainingAccuracy = (1.0 - wordTagger.trainingMetrics.taggingError) * 100\n\n\/\/ Validation accuracy as a percentage\nlet validationAccuracy = (1.0 - wordTagger.validationMetrics.taggingError) * 100\n```\n\n### Evaluate the tagger’s accuracy\n\nNext, evaluate your trained model’s performance by testing it against sentences it’s never seen before. Pass your testing data table to the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTagger\/evaluation(on:tokenColumn:labelColumn:)-31x1l] method, which returns an [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics] instance.\n\n```swift\nlet evaluationMetrics = wordTagger.evaluation(on: testingData,\n                                              tokenColumn: \"tokens\",\n                                              labelColumn: \"labels\")\n```\n\nTo get the evaluation accuracy, use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics\/taggingError] property of the returned [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLWordTaggerMetrics] instance.\n\n```swift\n\/\/ Evaluation accuracy as a percentage\nlet evaluationAccuracy = (1.0 - evaluationMetrics.taggingError) * 100\n```\n\nIf the evaluation performance isn’t good enough, you may need to retrain with more data or make other adjustments. For information about improving model performance, see `Improving Your Model’s Accuracy`.\n\n### Save the Core ML model\n\nWhen your model is performing well enough, you’re ready to save it so you can use it in your app. Use the [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLTextClassifier\/write(to:metadata:)] method to write the Core ML model file (in this example, `AppleTagger.mlmodel`) to disk. Provide any information about the model, like its author, version, or description, in an [doc:\/\/com.apple.createml\/documentation\/CreateML\/MLModelMetadata] instance.\n\n```swift\nlet metadata = MLModelMetadata(author: \"Jane Appleseed\",\n                               shortDescription: \"A model trained to tag Apple products.\",\n                               version: \"1.0\")\n\ntry wordTagger.write(to: URL(fileURLWithPath: \"<#\/path\/to\/save\/AppleTagger.mlmodel#>\"),\n                              metadata: metadata)\n```\n\n### Add the model to your app\n\nWith your app open in Xcode, drag the `AppleTagger.mlmodel` file into the navigation pane. Xcode compiles the model and generates an `AppleTagger` class for use in your app. Select the `AppleTagger.mlmodel` file in Xcode to view additional information about the model.\n\nCreate an [doc:\/\/com.apple.documentation\/documentation\/NaturalLanguage\/NLModel] in the Natural Language framework from the `AppleTagger` to ensure that the tokenization is consistent between training and deployment. Attach the model to an [doc:\/\/com.apple.documentation\/documentation\/NaturalLanguage\/NLTagger] to tag sentences or paragraphs, using an existing or custom [doc:\/\/com.apple.documentation\/documentation\/NaturalLanguage\/NLTagScheme].\n\n```swift\nimport NaturalLanguage \nimport CoreML\n\nlet text = \"The iPad is my favorite Apple product.\"\n\ndo {\n    let mlModel = try AppleTagger(configuration: MLModelConfiguration()).model\n\n    let customModel = try NLModel(mlModel: mlModel)\n    let customTagScheme = NLTagScheme(\"Apple\")\n    \n    let tagger = NLTagger(tagSchemes: [.nameType, customTagScheme])\n    tagger.string = text\n    tagger.setModels([customModel], forTagScheme: customTagScheme)\n    \n    tagger.enumerateTags(in: text.startIndex..<text.endIndex, unit: .word, \n                         scheme: customTagScheme, options: .omitWhitespace) { tag, tokenRange  in\n        if let tag = tag {\n            print(\"\\(text[tokenRange]): \\(tag.rawValue)\")\n        }\n        return true\n    }\n} catch {\n    print(error)\n}\n```\n\n## Text models\n\n- **Creating a text classifier model**: Train a machine learning model to classify natural language text.\n- **MLTextClassifier**: A model you train to classify natural language text.\n- **MLWordTagger**: A word-tagging model you train to classify natural language text at the word level.\n- **MLGazetteer**: A collection of terms and their labels, which augments a tagger that analyzes natural language text.\n- **MLWordEmbedding**: A map of strings in a vector space that enable your app to find similar strings by looking at a string’s neighbors.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Train a machine learning model to classify natural language text.",
          "name" : "Creating a text classifier model",
          "url" : "https:\/\/developer.apple.com\/documentation\/CreateML\/creating-a-text-classifier-model"
        },
        {
          "description" : "A model you train to classify natural language text.",
          "name" : "MLTextClassifier",
          "url" : "https:\/\/developer.apple.com\/documentation\/CreateML\/MLTextClassifier"
        },
        {
          "description" : "A word-tagging model you train to classify natural language text at the word level.",
          "name" : "MLWordTagger",
          "url" : "https:\/\/developer.apple.com\/documentation\/CreateML\/MLWordTagger"
        },
        {
          "description" : "A collection of terms and their labels, which augments a tagger that analyzes natural language text.",
          "name" : "MLGazetteer",
          "url" : "https:\/\/developer.apple.com\/documentation\/CreateML\/MLGazetteer"
        },
        {
          "description" : "A map of strings in a vector space that enable your app to find similar strings by looking at a string’s neighbors.",
          "name" : "MLWordEmbedding",
          "url" : "https:\/\/developer.apple.com\/documentation\/CreateML\/MLWordEmbedding"
        }
      ],
      "title" : "Text models"
    }
  ],
  "source" : "appleJSON",
  "title" : "Creating a word tagger model",
  "url" : "https:\/\/developer.apple.com\/documentation\/CreateML\/creating-a-word-tagger-model"
}