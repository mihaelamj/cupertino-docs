{
  "abstract" : "A layer for training recurrent neural networks on Metal Performance Shaders matrices.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSCoding",
    "NSCopying",
    "NSObjectProtocol",
    "NSSecureCoding"
  ],
  "contentHash" : "fc5f94eeb8cdd7a3e335817005b6fd8e437657d8cfc0aec412ac1962aed3f71c",
  "crawledAt" : "2025-12-05T01:03:06Z",
  "declaration" : {
    "code" : "class MPSRNNMatrixTrainingLayer",
    "language" : "swift"
  },
  "id" : "06A6AC96-25F4-4713-B9DF-96ED22DDEEB5",
  "kind" : "class",
  "language" : "swift",
  "module" : "Metal Performance Shaders",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/metalperformanceshaders\/mpsrnnmatrixtraininglayer\ncrawled: 2025-12-05T01:03:06Z\n---\n\n# MPSRNNMatrixTrainingLayer\n\n**Class**\n\nA layer for training recurrent neural networks on Metal Performance Shaders matrices.\n\n## Declaration\n\n```swift\nclass MPSRNNMatrixTrainingLayer\n```\n\n## Initializers\n\n- **init(coder:device:)**\n- **init(device:rnnDescriptor:trainableWeights:)**\n\n## Instance Properties\n\n- **accumulateWeightGradients**\n- **inputFeatureChannels**\n- **outputFeatureChannels**\n- **recurrentOutputIsTemporary**\n- **storeAllIntermediateStates**\n- **trainingStateIsTemporary**\n\n## Instance Methods\n\n- **copy(with:device:)**\n- **createTemporaryWeightGradientMatrices(_:dataType:commandBuffer:)**\n- **createWeightGradientMatrices(_:dataType:)**\n- **createWeightMatrices(_:)**\n- **encodeCopyWeights(commandBuffer:weights:matrixId:matrix:copyFromWeightsToMatrix:matrixOffset:)**\n- **encodeForwardSequence(commandBuffer:sourceMatrices:destinationMatrices:trainingStates:weights:)**\n- **encodeForwardSequence(commandBuffer:sourceMatrices:sourceOffsets:destinationMatrices:destinationOffsets:trainingStates:recurrentInputState:recurrentOutputStates:weights:)**\n- **encodeGradientSequence(commandBuffer:forwardSources:forwardSourceOffsets:sourceGradients:sourceOffsets:destinationGradients:destinationOffsets:weightGradients:trainingStates:recurrentInputState:recurrentOutputStates:weights:)**\n- **encodeGradientSequence(commandBuffer:forwardSources:sourceGradients:destinationGradients:weightGradients:trainingStates:weights:)**\n\n## Recurrent Neural Networks\n\n- **MPSRNNImageInferenceLayer**: A recurrent neural network layer for inference on Metal Performance Shaders images.\n- **MPSRNNMatrixInferenceLayer**: A recurrent neural network layer for inference on Metal Performance Shaders matrices.\n- **MPSRNNSingleGateDescriptor**: A description of a simple recurrent block or layer.\n- **MPSGRUDescriptor**: A description of a gated recurrent unit block or layer.\n- **MPSLSTMDescriptor**: A description of a long short-term memory block or layer.\n- **MPSRNNSequenceDirection**: Directions that a sequence of inputs can be processed by a recurrent neural network layer.\n- **MPSRNNMatrixTrainingState**: A class that holds data from a forward pass to be used in a backward pass.\n\n## Inherits From\n\n- MPSKernel\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSCoding\n- NSCopying\n- NSObjectProtocol\n- NSSecureCoding\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "init(coder:device:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/init(coder:device:)"
        },
        {
          "description" : "",
          "name" : "init(device:rnnDescriptor:trainableWeights:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/init(device:rnnDescriptor:trainableWeights:)"
        }
      ],
      "title" : "Initializers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "accumulateWeightGradients",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/accumulateWeightGradients"
        },
        {
          "description" : "",
          "name" : "inputFeatureChannels",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/inputFeatureChannels"
        },
        {
          "description" : "",
          "name" : "outputFeatureChannels",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/outputFeatureChannels"
        },
        {
          "description" : "",
          "name" : "recurrentOutputIsTemporary",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/recurrentOutputIsTemporary"
        },
        {
          "description" : "",
          "name" : "storeAllIntermediateStates",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/storeAllIntermediateStates"
        },
        {
          "description" : "",
          "name" : "trainingStateIsTemporary",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/trainingStateIsTemporary"
        }
      ],
      "title" : "Instance Properties"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "copy(with:device:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/copy(with:device:)"
        },
        {
          "description" : "",
          "name" : "createTemporaryWeightGradientMatrices(_:dataType:commandBuffer:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/createTemporaryWeightGradientMatrices(_:dataType:commandBuffer:)"
        },
        {
          "description" : "",
          "name" : "createWeightGradientMatrices(_:dataType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/createWeightGradientMatrices(_:dataType:)"
        },
        {
          "description" : "",
          "name" : "createWeightMatrices(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/createWeightMatrices(_:)"
        },
        {
          "description" : "",
          "name" : "encodeCopyWeights(commandBuffer:weights:matrixId:matrix:copyFromWeightsToMatrix:matrixOffset:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/encodeCopyWeights(commandBuffer:weights:matrixId:matrix:copyFromWeightsToMatrix:matrixOffset:)"
        },
        {
          "description" : "",
          "name" : "encodeForwardSequence(commandBuffer:sourceMatrices:destinationMatrices:trainingStates:weights:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/encodeForwardSequence(commandBuffer:sourceMatrices:destinationMatrices:trainingStates:weights:)"
        },
        {
          "description" : "",
          "name" : "encodeForwardSequence(commandBuffer:sourceMatrices:sourceOffsets:destinationMatrices:destinationOffsets:trainingStates:recurrentInputState:recurrentOutputStates:weights:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/encodeForwardSequence(commandBuffer:sourceMatrices:sourceOffsets:destinationMatrices:destinationOffsets:trainingStates:recurrentInputState:recurrentOutputStates:weights:)"
        },
        {
          "description" : "",
          "name" : "encodeGradientSequence(commandBuffer:forwardSources:forwardSourceOffsets:sourceGradients:sourceOffsets:destinationGradients:destinationOffsets:weightGradients:trainingStates:recurrentInputState:recurrentOutputStates:weights:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/encodeGradientSequence(commandBuffer:forwardSources:forwardSourceOffsets:sourceGradients:sourceOffsets:destinationGradients:destinationOffsets:weightGradients:trainingStates:recurrentInputState:recurrentOutputStates:weights:)"
        },
        {
          "description" : "",
          "name" : "encodeGradientSequence(commandBuffer:forwardSources:sourceGradients:destinationGradients:weightGradients:trainingStates:weights:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer\/encodeGradientSequence(commandBuffer:forwardSources:sourceGradients:destinationGradients:weightGradients:trainingStates:weights:)"
        }
      ],
      "title" : "Instance Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A recurrent neural network layer for inference on Metal Performance Shaders images.",
          "name" : "MPSRNNImageInferenceLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNImageInferenceLayer"
        },
        {
          "description" : "A recurrent neural network layer for inference on Metal Performance Shaders matrices.",
          "name" : "MPSRNNMatrixInferenceLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer"
        },
        {
          "description" : "A description of a simple recurrent block or layer.",
          "name" : "MPSRNNSingleGateDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNSingleGateDescriptor"
        },
        {
          "description" : "A description of a gated recurrent unit block or layer.",
          "name" : "MPSGRUDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSGRUDescriptor"
        },
        {
          "description" : "A description of a long short-term memory block or layer.",
          "name" : "MPSLSTMDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSLSTMDescriptor"
        },
        {
          "description" : "Directions that a sequence of inputs can be processed by a recurrent neural network layer.",
          "name" : "MPSRNNSequenceDirection",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNSequenceDirection"
        },
        {
          "description" : "A class that holds data from a forward pass to be used in a backward pass.",
          "name" : "MPSRNNMatrixTrainingState",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingState"
        }
      ],
      "title" : "Recurrent Neural Networks"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "MPSKernel"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "MPSRNNMatrixTrainingLayer",
  "url" : "https:\/\/developer.apple.com\/documentation\/metalperformanceshaders\/mpsrnnmatrixtraininglayer"
}