{
  "abstract" : "A recurrent neural network layer for inference on Metal Performance Shaders matrices.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSCoding",
    "NSCopying",
    "NSObjectProtocol",
    "NSSecureCoding"
  ],
  "contentHash" : "cd7ba7439b4b85752b90b99a91a4d33874593607899bdb5616a07dcf2d0ded59",
  "crawledAt" : "2025-12-05T00:58:26Z",
  "declaration" : {
    "code" : "class MPSRNNMatrixInferenceLayer",
    "language" : "swift"
  },
  "id" : "7AF5F8FF-83CE-4F4E-B942-FA80F3E9DAA1",
  "kind" : "class",
  "language" : "swift",
  "module" : "Metal Performance Shaders",
  "overview" : "## Overview\n\nThe [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer] specifies a recurrent neural network layer for inference on [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSMatrix] objects. Two types of recurrent layers are supported:\n\nYou can use [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNImageInferenceLayer] to implement the latter by using 1 x 1 images, but due to image size restrictions and performance, [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer] is the better choice for linear recurrent layers.\n\n[doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer] is initialized using either of the following:\n\nStacks with bidirectionally traversing encode functions don’t support starting from a previous set of recurrent states. However, you can achieve this effect by defining two separate unidirectional stacks of layers, running the same input sequence on them separately (one forward and one backward), and ultimately combining the two result sequences.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/metalperformanceshaders\/mpsrnnmatrixinferencelayer\ncrawled: 2025-12-05T00:58:26Z\n---\n\n# MPSRNNMatrixInferenceLayer\n\n**Class**\n\nA recurrent neural network layer for inference on Metal Performance Shaders matrices.\n\n## Declaration\n\n```swift\nclass MPSRNNMatrixInferenceLayer\n```\n\n## Overview\n\nThe [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer] specifies a recurrent neural network layer for inference on [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSMatrix] objects. Two types of recurrent layers are supported:\n\n- [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNImageInferenceLayer]—Operates with convolutions on images.\n- [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer]—Operates on matrices.\n\nYou can use [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNImageInferenceLayer] to implement the latter by using 1 x 1 images, but due to image size restrictions and performance, [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer] is the better choice for linear recurrent layers.\n\n[doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer] is initialized using either of the following:\n\n- A single [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNDescriptor] instance, which further specifies the recurrent network layer.\n- An array of [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSRNNDescriptor] instances, which specifies a stack of recurrent layers that can operate in parallel a subset of the inputs in a sequence of inputs and recurrent outputs.\n\nStacks with bidirectionally traversing encode functions don’t support starting from a previous set of recurrent states. However, you can achieve this effect by defining two separate unidirectional stacks of layers, running the same input sequence on them separately (one forward and one backward), and ultimately combining the two result sequences.\n\n## Initializers\n\n- **init(coder:device:)**\n- **init(device:rnnDescriptor:)**\n- **init(device:rnnDescriptors:)**\n- **MPSRNNDescriptor**: A description of a recursive neural network block or layer.\n\n## Instance Properties\n\n- **bidirectionalCombineMode**\n- **MPSRNNBidirectionalCombineMode**: Modes that define how two images or matrices are combined.\n- **inputFeatureChannels**\n- **numberOfLayers**\n- **outputFeatureChannels**\n- **recurrentOutputIsTemporary**\n- **storeAllIntermediateStates**\n\n## Instance Methods\n\n- **copy(with:device:)**\n- **encodeBidirectionalSequence(commandBuffer:sourceSequence:destinationForwardMatrices:destinationBackwardMatrices:)**\n- **encodeSequence(commandBuffer:sourceMatrices:destinationMatrices:recurrentInputState:recurrentOutputStates:)**\n- **MPSRNNRecurrentMatrixState**: A class holds all the data that’s passed from one sequence iteration of the matrix-based recurrent neural network layer to the next.\n- **encodeSequence(commandBuffer:sourceMatrices:sourceOffsets:destinationMatrices:destinationOffsets:recurrentInputState:recurrentOutputStates:)**\n\n## Recurrent Neural Networks\n\n- **MPSRNNImageInferenceLayer**: A recurrent neural network layer for inference on Metal Performance Shaders images.\n- **MPSRNNSingleGateDescriptor**: A description of a simple recurrent block or layer.\n- **MPSGRUDescriptor**: A description of a gated recurrent unit block or layer.\n- **MPSLSTMDescriptor**: A description of a long short-term memory block or layer.\n- **MPSRNNSequenceDirection**: Directions that a sequence of inputs can be processed by a recurrent neural network layer.\n- **MPSRNNMatrixTrainingLayer**: A layer for training recurrent neural networks on Metal Performance Shaders matrices.\n- **MPSRNNMatrixTrainingState**: A class that holds data from a forward pass to be used in a backward pass.\n\n## Inherits From\n\n- MPSKernel\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSCoding\n- NSCopying\n- NSObjectProtocol\n- NSSecureCoding\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "init(coder:device:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/init(coder:device:)"
        },
        {
          "description" : "",
          "name" : "init(device:rnnDescriptor:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/init(device:rnnDescriptor:)"
        },
        {
          "description" : "",
          "name" : "init(device:rnnDescriptors:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/init(device:rnnDescriptors:)"
        },
        {
          "description" : "A description of a recursive neural network block or layer.",
          "name" : "MPSRNNDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNDescriptor"
        }
      ],
      "title" : "Initializers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "bidirectionalCombineMode",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/bidirectionalCombineMode"
        },
        {
          "description" : "Modes that define how two images or matrices are combined.",
          "name" : "MPSRNNBidirectionalCombineMode",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNBidirectionalCombineMode"
        },
        {
          "description" : "",
          "name" : "inputFeatureChannels",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/inputFeatureChannels"
        },
        {
          "description" : "",
          "name" : "numberOfLayers",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/numberOfLayers"
        },
        {
          "description" : "",
          "name" : "outputFeatureChannels",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/outputFeatureChannels"
        },
        {
          "description" : "",
          "name" : "recurrentOutputIsTemporary",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/recurrentOutputIsTemporary"
        },
        {
          "description" : "",
          "name" : "storeAllIntermediateStates",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/storeAllIntermediateStates"
        }
      ],
      "title" : "Instance Properties"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "copy(with:device:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/copy(with:device:)"
        },
        {
          "description" : "",
          "name" : "encodeBidirectionalSequence(commandBuffer:sourceSequence:destinationForwardMatrices:destinationBackwardMatrices:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/encodeBidirectionalSequence(commandBuffer:sourceSequence:destinationForwardMatrices:destinationBackwardMatrices:)"
        },
        {
          "description" : "",
          "name" : "encodeSequence(commandBuffer:sourceMatrices:destinationMatrices:recurrentInputState:recurrentOutputStates:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/encodeSequence(commandBuffer:sourceMatrices:destinationMatrices:recurrentInputState:recurrentOutputStates:)"
        },
        {
          "description" : "A class holds all the data that’s passed from one sequence iteration of the matrix-based recurrent neural network layer to the next.",
          "name" : "MPSRNNRecurrentMatrixState",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNRecurrentMatrixState"
        },
        {
          "description" : "",
          "name" : "encodeSequence(commandBuffer:sourceMatrices:sourceOffsets:destinationMatrices:destinationOffsets:recurrentInputState:recurrentOutputStates:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixInferenceLayer\/encodeSequence(commandBuffer:sourceMatrices:sourceOffsets:destinationMatrices:destinationOffsets:recurrentInputState:recurrentOutputStates:)"
        }
      ],
      "title" : "Instance Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A recurrent neural network layer for inference on Metal Performance Shaders images.",
          "name" : "MPSRNNImageInferenceLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNImageInferenceLayer"
        },
        {
          "description" : "A description of a simple recurrent block or layer.",
          "name" : "MPSRNNSingleGateDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNSingleGateDescriptor"
        },
        {
          "description" : "A description of a gated recurrent unit block or layer.",
          "name" : "MPSGRUDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSGRUDescriptor"
        },
        {
          "description" : "A description of a long short-term memory block or layer.",
          "name" : "MPSLSTMDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSLSTMDescriptor"
        },
        {
          "description" : "Directions that a sequence of inputs can be processed by a recurrent neural network layer.",
          "name" : "MPSRNNSequenceDirection",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNSequenceDirection"
        },
        {
          "description" : "A layer for training recurrent neural networks on Metal Performance Shaders matrices.",
          "name" : "MPSRNNMatrixTrainingLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingLayer"
        },
        {
          "description" : "A class that holds data from a forward pass to be used in a backward pass.",
          "name" : "MPSRNNMatrixTrainingState",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSRNNMatrixTrainingState"
        }
      ],
      "title" : "Recurrent Neural Networks"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "MPSKernel"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "MPSRNNMatrixInferenceLayer",
  "url" : "https:\/\/developer.apple.com\/documentation\/metalperformanceshaders\/mpsrnnmatrixinferencelayer"
}