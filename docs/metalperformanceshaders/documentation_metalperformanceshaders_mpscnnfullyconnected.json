{
  "abstract" : "A fully connected convolution layer, also known as an inner product layer.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSCoding",
    "NSCopying",
    "NSObjectProtocol",
    "NSSecureCoding"
  ],
  "contentHash" : "2e2a4a1b7d94c5fb0a3f504f23d617783427db907624db4c5e6950fd3bc869f6",
  "crawledAt" : "2025-12-02T20:02:20Z",
  "declaration" : {
    "code" : "class MPSCNNFullyConnected",
    "language" : "swift"
  },
  "id" : "46511C24-22EF-4174-A1C8-67E242575141",
  "kind" : "class",
  "language" : "swift",
  "module" : "Metal Performance Shaders",
  "overview" : "## Overview\n\nA fully connected layer in  a Convolutional Neural Network (CNN) is one where every input channel is connected to every output channel. The kernel width is equal to the width of the source image, and the kernel height is equal to the height of the source image. The width and height of the output is `1 x 1`.\n\nA fully connected layer takes an [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSImage] object with dimensions `source.width x source.height x Ni`, convolves it with `Weights[No][source.width][source.height][Ni]`,` `and produces a `1 x 1 x No` output.\n\nThus, the following conditions must be true:\n\nYou can think of a fully connected layer as a matrix multiplication where the image is flattened into a vector of length `source.width*source.height*Ni`, and the weights are arranged in a matrix of dimension `No x (source.width*source.height*Ni)` to produce an output vector of length `No`.\n\nThe value of the `strideInPixelsX`, [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNConvolutionDescriptor\/strideInPixelsY], and [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNConvolution\/groups] properties must be `1`. The [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNKernel\/offset] property is not applicable and it is ignored. Because the clip rectangle is clamped to the destination image bounds, if the destination is `1 x 1`, you do not need to set the [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNKernel\/clipRect] property.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNFullyConnected\ncrawled: 2025-12-02T20:02:20Z\n---\n\n# MPSCNNFullyConnected\n\n**Class**\n\nA fully connected convolution layer, also known as an inner product layer.\n\n## Declaration\n\n```swift\nclass MPSCNNFullyConnected\n```\n\n## Overview\n\nA fully connected layer in  a Convolutional Neural Network (CNN) is one where every input channel is connected to every output channel. The kernel width is equal to the width of the source image, and the kernel height is equal to the height of the source image. The width and height of the output is `1 x 1`.\n\nA fully connected layer takes an [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSImage] object with dimensions `source.width x source.height x Ni`, convolves it with `Weights[No][source.width][source.height][Ni]`,` `and produces a `1 x 1 x No` output.\n\nThus, the following conditions must be true:\n\n- `kernelWidth  == source.width`\n- `kernelHeight == source.height`\n- `clipRect.size.width == 1`\n- `clipRect.size.height == 1`\n\nYou can think of a fully connected layer as a matrix multiplication where the image is flattened into a vector of length `source.width*source.height*Ni`, and the weights are arranged in a matrix of dimension `No x (source.width*source.height*Ni)` to produce an output vector of length `No`.\n\nThe value of the `strideInPixelsX`, [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNConvolutionDescriptor\/strideInPixelsY], and [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNConvolution\/groups] properties must be `1`. The [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNKernel\/offset] property is not applicable and it is ignored. Because the clip rectangle is clamped to the destination image bounds, if the destination is `1 x 1`, you do not need to set the [doc:\/\/com.apple.metalperformanceshaders\/documentation\/MetalPerformanceShaders\/MPSCNNKernel\/clipRect] property.\n\n\n\n## Initializers\n\n- **init(coder:device:)**: Initializes a fully connected convolution layer.\n- **init(device:weights:)**: Initializes a fully connected convolution layer.\n- **MPSCNNConvolutionDataSource**: The protocol that provides convolution filter weights and bias terms.\n- **init(device:convolutionDescriptor:kernelWeights:biasTerms:flags:)**: Initializes a fully connected convolution layer.\n- **MPSCNNConvolutionDescriptor**: A description of the attributes of a convolution kernel.\n- **MPSCNNConvolutionFlags**: Options used to control how kernel weights are stored and used in the CNN kernels\n\n## Fully Connected Layers\n\n- **MPSCNNBinaryFullyConnected**: A fully connected convolution layer with binary weights and optionally binarized input image.\n- **MPSCNNFullyConnectedGradient**: A gradient fully connected convolution layer.\n\n## Inherits From\n\n- MPSCNNConvolution\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSCoding\n- NSCopying\n- NSObjectProtocol\n- NSSecureCoding\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Initializes a fully connected convolution layer.",
          "name" : "init(coder:device:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNFullyConnected\/init(coder:device:)"
        },
        {
          "description" : "Initializes a fully connected convolution layer.",
          "name" : "init(device:weights:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNFullyConnected\/init(device:weights:)"
        },
        {
          "description" : "The protocol that provides convolution filter weights and bias terms.",
          "name" : "MPSCNNConvolutionDataSource",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNConvolutionDataSource"
        },
        {
          "description" : "Initializes a fully connected convolution layer.",
          "name" : "init(device:convolutionDescriptor:kernelWeights:biasTerms:flags:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNFullyConnected\/init(device:convolutionDescriptor:kernelWeights:biasTerms:flags:)"
        },
        {
          "description" : "A description of the attributes of a convolution kernel.",
          "name" : "MPSCNNConvolutionDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNConvolutionDescriptor"
        },
        {
          "description" : "Options used to control how kernel weights are stored and used in the CNN kernels",
          "name" : "MPSCNNConvolutionFlags",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNConvolutionFlags"
        }
      ],
      "title" : "Initializers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A fully connected convolution layer with binary weights and optionally binarized input image.",
          "name" : "MPSCNNBinaryFullyConnected",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNBinaryFullyConnected"
        },
        {
          "description" : "A gradient fully connected convolution layer.",
          "name" : "MPSCNNFullyConnectedGradient",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNFullyConnectedGradient"
        }
      ],
      "title" : "Fully Connected Layers"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "MPSCNNConvolution"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "MPSCNNFullyConnected",
  "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSCNNFullyConnected"
}