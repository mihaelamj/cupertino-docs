{
  "abstract" : "Solve systems of equations, factorize matrices and multiply matrices and vectors.",
  "codeExamples" : [

  ],
  "contentHash" : "5a22a82637fd6991a75d82ba381776225dd900d30c02098b9b432d8569eba6f7",
  "crawledAt" : "2025-12-04T23:52:16Z",
  "id" : "98B3B897-F7DA-445C-8366-BF76811371A5",
  "kind" : "collection",
  "language" : "swift",
  "module" : "Metal Performance Shaders",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/matrices-and-vectors\ncrawled: 2025-12-04T23:52:16Z\n---\n\n# Matrices and Vectors\n\n**API Collection**\n\nSolve systems of equations, factorize matrices and multiply matrices and vectors.\n\n## Matrices\n\n- **MPSMatrix**: A 2D array of data that stores the data’s values.\n- **MPSMatrixDescriptor**: A description of attributes used to create an MPS matrix.\n- **MPSTemporaryMatrix**: A matrix allocated on GPU private memory.\n\n## Vectors\n\n- **MPSVector**: A 1D array of data that stores the data’s values.\n- **MPSVectorDescriptor**: A description of the length and data type of a vector.\n- **MPSTemporaryVector**: A vector allocated on GPU private memory.\n\n## Classes for Decomposition and Solving\n\n- **MPSMatrixDecompositionCholesky**: A kernel for computing the Cholesky factorization of a matrix.\n- **MPSMatrixSolveCholesky**: A kernel for computing the solution of a linear system of equations using a Cholesky factorization.\n- **MPSMatrixDecompositionLU**: A kernel for computing the LU factorization of a matrix using partial pivoting with row interchanges.\n- **MPSMatrixSolveLU**: A kernel for computing the solution of a linear system of equations using an LU factorization.\n- **MPSMatrixSolveTriangular**: A kernel for computing the solution of a linear system of equations using a triangular coefficient matrix.\n- **MPSMatrixUnaryKernel**: A kernel that consumes one matrix and produces one matrix.\n- **MPSMatrixBinaryKernel**: A kernel that consumes two matrices and produces one matrix.\n- **MPSMatrixDecompositionStatus**\n\n## Matrix Arithmetic Operations\n\n- **MPSMatrixSum**: A kernel for performing a pointwise summation of a matrix.\n- **MPSMatrixMultiplication**: A matrix multiplication kernel.\n- **MPSMatrixVectorMultiplication**: A matrix-vector multiplication kernel\n- **MPSMatrixFindTopK**: A kernel for computing the top-K values and their corresponding indices in a matrix.\n\n## Matrix Copying Operations\n\n- **MPSMatrixCopy**: A class that can perform multiple matrix copy operations.\n- **MPSMatrixCopyToImage**: A kernel that copies matrix data to a Metal Performance Shaders image.\n- **MPSMatrixCopyDescriptor**: A description of multiple matrix copy operations.\n- **MPSImageCopyToMatrix**: A class that copies image data to a matrix.\n\n## Matrix Neural Network Operations\n\n- **MPSMatrixFullyConnected**: A kernel for applying a fully connected neural network layer.\n- **MPSMatrixFullyConnectedGradient**: A kernel for applying a fully gradient connected neural network layer.\n- **MPSMatrixNeuron**: A neuron activation kernel that operates on matrices.\n- **MPSMatrixNeuronGradient**: A gradient neuron activation kernel that operates on matrices.\n\n## Matrix Softmax Operations\n\n- **MPSMatrixLogSoftMax**: A logarithmic softmax kernel that operates on matrices.\n- **MPSMatrixLogSoftMaxGradient**: A logarithmic gradient softmax kernel that operates on matrices.\n- **MPSMatrixSoftMax**: A softmax kernel that operates on matrices.\n- **MPSMatrixSoftMaxGradient**: A gradient softmax kernel that operates on matrices.\n\n## Matrix Normalization Operations\n\n- **MPSMatrixBatchNormalization**: A batch normalization kernel that operates on matrices.\n- **MPSMatrixBatchNormalizationGradient**: A batch normalization gradient kernel that operates on matrices.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A 2D array of data that stores the data’s values.",
          "name" : "MPSMatrix",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrix"
        },
        {
          "description" : "A description of attributes used to create an MPS matrix.",
          "name" : "MPSMatrixDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixDescriptor"
        },
        {
          "description" : "A matrix allocated on GPU private memory.",
          "name" : "MPSTemporaryMatrix",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSTemporaryMatrix"
        }
      ],
      "title" : "Matrices"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A 1D array of data that stores the data’s values.",
          "name" : "MPSVector",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSVector"
        },
        {
          "description" : "A description of the length and data type of a vector.",
          "name" : "MPSVectorDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSVectorDescriptor"
        },
        {
          "description" : "A vector allocated on GPU private memory.",
          "name" : "MPSTemporaryVector",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSTemporaryVector"
        }
      ],
      "title" : "Vectors"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A kernel for computing the Cholesky factorization of a matrix.",
          "name" : "MPSMatrixDecompositionCholesky",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixDecompositionCholesky"
        },
        {
          "description" : "A kernel for computing the solution of a linear system of equations using a Cholesky factorization.",
          "name" : "MPSMatrixSolveCholesky",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixSolveCholesky"
        },
        {
          "description" : "A kernel for computing the LU factorization of a matrix using partial pivoting with row interchanges.",
          "name" : "MPSMatrixDecompositionLU",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixDecompositionLU"
        },
        {
          "description" : "A kernel for computing the solution of a linear system of equations using an LU factorization.",
          "name" : "MPSMatrixSolveLU",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixSolveLU"
        },
        {
          "description" : "A kernel for computing the solution of a linear system of equations using a triangular coefficient matrix.",
          "name" : "MPSMatrixSolveTriangular",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixSolveTriangular"
        },
        {
          "description" : "A kernel that consumes one matrix and produces one matrix.",
          "name" : "MPSMatrixUnaryKernel",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixUnaryKernel"
        },
        {
          "description" : "A kernel that consumes two matrices and produces one matrix.",
          "name" : "MPSMatrixBinaryKernel",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixBinaryKernel"
        },
        {
          "description" : "",
          "name" : "MPSMatrixDecompositionStatus",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixDecompositionStatus"
        }
      ],
      "title" : "Classes for Decomposition and Solving"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A kernel for performing a pointwise summation of a matrix.",
          "name" : "MPSMatrixSum",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixSum"
        },
        {
          "description" : "A matrix multiplication kernel.",
          "name" : "MPSMatrixMultiplication",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixMultiplication"
        },
        {
          "description" : "A matrix-vector multiplication kernel",
          "name" : "MPSMatrixVectorMultiplication",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixVectorMultiplication"
        },
        {
          "description" : "A kernel for computing the top-K values and their corresponding indices in a matrix.",
          "name" : "MPSMatrixFindTopK",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixFindTopK"
        }
      ],
      "title" : "Matrix Arithmetic Operations"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A class that can perform multiple matrix copy operations.",
          "name" : "MPSMatrixCopy",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixCopy"
        },
        {
          "description" : "A kernel that copies matrix data to a Metal Performance Shaders image.",
          "name" : "MPSMatrixCopyToImage",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixCopyToImage"
        },
        {
          "description" : "A description of multiple matrix copy operations.",
          "name" : "MPSMatrixCopyDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixCopyDescriptor"
        },
        {
          "description" : "A class that copies image data to a matrix.",
          "name" : "MPSImageCopyToMatrix",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSImageCopyToMatrix"
        }
      ],
      "title" : "Matrix Copying Operations"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A kernel for applying a fully connected neural network layer.",
          "name" : "MPSMatrixFullyConnected",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixFullyConnected"
        },
        {
          "description" : "A kernel for applying a fully gradient connected neural network layer.",
          "name" : "MPSMatrixFullyConnectedGradient",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixFullyConnectedGradient"
        },
        {
          "description" : "A neuron activation kernel that operates on matrices.",
          "name" : "MPSMatrixNeuron",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixNeuron"
        },
        {
          "description" : "A gradient neuron activation kernel that operates on matrices.",
          "name" : "MPSMatrixNeuronGradient",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixNeuronGradient"
        }
      ],
      "title" : "Matrix Neural Network Operations"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A logarithmic softmax kernel that operates on matrices.",
          "name" : "MPSMatrixLogSoftMax",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixLogSoftMax"
        },
        {
          "description" : "A logarithmic gradient softmax kernel that operates on matrices.",
          "name" : "MPSMatrixLogSoftMaxGradient",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixLogSoftMaxGradient"
        },
        {
          "description" : "A softmax kernel that operates on matrices.",
          "name" : "MPSMatrixSoftMax",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixSoftMax"
        },
        {
          "description" : "A gradient softmax kernel that operates on matrices.",
          "name" : "MPSMatrixSoftMaxGradient",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixSoftMaxGradient"
        }
      ],
      "title" : "Matrix Softmax Operations"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A batch normalization kernel that operates on matrices.",
          "name" : "MPSMatrixBatchNormalization",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixBatchNormalization"
        },
        {
          "description" : "A batch normalization gradient kernel that operates on matrices.",
          "name" : "MPSMatrixBatchNormalizationGradient",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/MPSMatrixBatchNormalizationGradient"
        }
      ],
      "title" : "Matrix Normalization Operations"
    }
  ],
  "source" : "appleJSON",
  "title" : "Matrices and Vectors",
  "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShaders\/matrices-and-vectors"
}