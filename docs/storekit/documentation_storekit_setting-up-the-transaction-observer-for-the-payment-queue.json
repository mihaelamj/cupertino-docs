{
  "abstract" : "Enable your app to receive and handle transactions by adding an observer.",
  "codeExamples" : [
    {
      "code" : "class StoreObserver: NSObject, SKPaymentTransactionObserver {\n                ....\n    \/\/Initialize the store observer.\n    override init() {\n        super.init()\n        \/\/Other initialization here.\n    }\n\n    \/\/Observe transaction updates.\n    func paymentQueue(_ queue: SKPaymentQueue,updatedTransactions transactions: [SKPaymentTransaction]) {\n        \/\/Handle transaction states here.\n    }\n                ....\n}",
      "language" : "swift"
    },
    {
      "code" : "let iapObserver = StoreObserver()",
      "language" : "swift"
    },
    {
      "code" : "SKPaymentQueue.default().add(iapObserver)",
      "language" : "swift"
    },
    {
      "code" : "import UIKit\nimport StoreKit\n\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n                ....\n    \/\/ Attach an observer to the payment queue.\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {\n        SKPaymentQueue.default().add(iapObserver)\n        return true\n    }\n\n    \/\/ The system calls this when the app is about to terminate.\n    func applicationWillTerminate(_ application: UIApplication) {\n        \/\/ Remove the observer.\n        SKPaymentQueue.default().remove(iapObserver)\n    }\n                ....\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "982204144bc2c692e9eb698abc84b517a1c62df3cd47aa26e702fc76d7e45ea3",
  "crawledAt" : "2025-12-02T16:15:10Z",
  "id" : "CA7C16F1-8087-45D9-B348-1498CEF9F586",
  "kind" : "article",
  "language" : "swift",
  "module" : "StoreKit",
  "overview" : "## Overview\n\nTo process transactions in your app, you need to create and add an observer to the payment queue. The observer object responds to new transactions and synchronizes the queue of pending transactions with the App Store, and the payment queue prompts users to authorize payment. It’s important to add the transaction observer at app launch to ensure you don’t miss payment queue notifications that the system may send when the app launches.\n\n### Create an observer\n\nCreate and build a custom observer class to handle changes to the payment queue.\n\nCreate an instance of this observer class to act as the observer of changes to the payment queue.\n\nAfter you create the transaction observer, you can add it to the payment queue.\n\n### Add an observer\n\nStoreKit attaches your observer to the queue when your app calls.\n\nStoreKit can notify your [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] instance automatically when the content of the payment queue changes upon resuming or while running your app.\n\nImplement the transaction observer.\n\nIt’s important to add the observer at launch, in [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIApplicationDelegate\/application(_:didFinishLaunchingWithOptions:)], to ensure that it persists during all launches of your app, receives all payment queue notifications, and continues transactions that may initiate outside the app, such as:\n\nThe observer needs to be persistent so the system doesn’t deallocate it when it sends the app to the background. Only a persistent observer can receive transactions that may occur while your app is in the background, such as a renewal transaction for an auto-renewable subscription.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/setting-up-the-transaction-observer-for-the-payment-queue\ncrawled: 2025-12-02T16:15:10Z\n---\n\n# Setting up the transaction observer for the payment queue\n\n**Article**\n\nEnable your app to receive and handle transactions by adding an observer.\n\n## Overview\n\nTo process transactions in your app, you need to create and add an observer to the payment queue. The observer object responds to new transactions and synchronizes the queue of pending transactions with the App Store, and the payment queue prompts users to authorize payment. It’s important to add the transaction observer at app launch to ensure you don’t miss payment queue notifications that the system may send when the app launches.\n\n### Create an observer\n\nCreate and build a custom observer class to handle changes to the payment queue.\n\n```swift\nclass StoreObserver: NSObject, SKPaymentTransactionObserver {\n                ....\n    \/\/Initialize the store observer.\n    override init() {\n        super.init()\n        \/\/Other initialization here.\n    }\n\n    \/\/Observe transaction updates.\n    func paymentQueue(_ queue: SKPaymentQueue,updatedTransactions transactions: [SKPaymentTransaction]) {\n        \/\/Handle transaction states here.\n    }\n                ....\n}\n```\n\nCreate an instance of this observer class to act as the observer of changes to the payment queue.\n\n```swift\nlet iapObserver = StoreObserver()\n```\n\n\n\nAfter you create the transaction observer, you can add it to the payment queue.\n\n### Add an observer\n\nStoreKit attaches your observer to the queue when your app calls.\n\n```swift\nSKPaymentQueue.default().add(iapObserver)\n```\n\nStoreKit can notify your [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] instance automatically when the content of the payment queue changes upon resuming or while running your app.\n\nImplement the transaction observer.\n\n```swift\nimport UIKit\nimport StoreKit\n\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n                ....\n    \/\/ Attach an observer to the payment queue.\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {\n        SKPaymentQueue.default().add(iapObserver)\n        return true\n    }\n\n    \/\/ The system calls this when the app is about to terminate.\n    func applicationWillTerminate(_ application: UIApplication) {\n        \/\/ Remove the observer.\n        SKPaymentQueue.default().remove(iapObserver)\n    }\n                ....\n}\n```\n\nIt’s important to add the observer at launch, in [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIApplicationDelegate\/application(_:didFinishLaunchingWithOptions:)], to ensure that it persists during all launches of your app, receives all payment queue notifications, and continues transactions that may initiate outside the app, such as:\n\n- Promoted in-app purchases. For more information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/promoting-in-app-purchases].\n- Background subscription renewals\n- Interrupted purchases\n\nThe observer needs to be persistent so the system doesn’t deallocate it when it sends the app to the background. Only a persistent observer can receive transactions that may occur while your app is in the background, such as a renewal transaction for an auto-renewable subscription.\n\n## Related Documentation\n\n- **add(_:)**: Adds an observer to the payment queue.\n\n## Essentials\n\n- **Offering, completing, and restoring in-app purchases**: Fetch, display, purchase, validate, and finish transactions in your app.\n- **SKPaymentQueue**: A queue of payment transactions for the App Store to process.\n- **SKPaymentTransactionObserver**: A set of methods that process transactions, unlock purchased functionality, and continue promoted In-App Purchases.\n- **SKPaymentQueueDelegate**: The protocol that provides information needed to complete transactions.\n- **SKRequest**: An abstract class that represents a request to the App Store.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Adds an observer to the payment queue.",
          "name" : "add(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentQueue\/add(_:)-5ciz2"
        }
      ],
      "title" : "Related Documentation"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Fetch, display, purchase, validate, and finish transactions in your app.",
          "name" : "Offering, completing, and restoring in-app purchases",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/offering-completing-and-restoring-in-app-purchases"
        },
        {
          "description" : "A queue of payment transactions for the App Store to process.",
          "name" : "SKPaymentQueue",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentQueue"
        },
        {
          "description" : "A set of methods that process transactions, unlock purchased functionality, and continue promoted In-App Purchases.",
          "name" : "SKPaymentTransactionObserver",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentTransactionObserver"
        },
        {
          "description" : "The protocol that provides information needed to complete transactions.",
          "name" : "SKPaymentQueueDelegate",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentQueueDelegate"
        },
        {
          "description" : "An abstract class that represents a request to the App Store.",
          "name" : "SKRequest",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKRequest"
        }
      ],
      "title" : "Essentials"
    }
  ],
  "source" : "appleJSON",
  "title" : "Setting up the transaction observer for the payment queue",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/setting-up-the-transaction-observer-for-the-payment-queue"
}