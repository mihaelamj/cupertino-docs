{
  "abstract" : "Ensure the validity of a postback you receive after an ad conversion by verifying its cryptographic signature.",
  "codeExamples" : [
    {
      "code" : "version + '\\u2063' + ad-network-id + '\\u2063' + source-identifier + '\\u2063' + app-id + '\\u2063' + transaction-id + '\\u2063' + redownload + '\\u2063' + source-app-id + '\\u2063' + fidelity-type + '\\u2063' + did-win + '\\u2063' + postback-sequence-index",
      "language" : "javascript"
    },
    {
      "code" : "version + '\\u2063' + ad-network-id + '\\u2063' + source-identifier + '\\u2063' + app-id + '\\u2063' + transaction-id + '\\u2063' + redownload + '\\u2063' + source-domain + '\\u2063' + fidelity-type + '\\u2063' + did-win + '\\u2063' + postback-sequence-index",
      "language" : "javascript"
    },
    {
      "code" : "{\n  \"version\": \"4.0\",\n  \"ad-network-id\": \"com.example\",\n  \"source-identifier\": \"5239\",\n  \"app-id\": 525463029,\n  \"transaction-id\": \"6aafb7a5-0170-41b5-bbe4-fe71dedf1e30\",\n  \"redownload\": false,\n  \"source-domain\": \"example.com\", \n  \"fidelity-type\": 1, \n  \"did-win\": true,\n  \"conversion-value\": 63,\n  \"postback-sequence-index\": 0,\n  \"attribution-signature\": \"MEUCIGRmSMrqedNu6uaHyhVcifs118R5z\/AB6cvRaKrRRHWRAiEAv96ne3dKQ5kJpbsfk4eYiePmrZUU6sQmo+7zfP\/1Bxo=\"\n}",
      "language" : "javascript"
    },
    {
      "code" : "{\n  \"version\": \"4.0\",\n  \"ad-network-id\": \"com.example\",\n  \"source-identifier\": \"39\",\n  \"app-id\": 525463029,\n  \"transaction-id\": \"6aafb7a5-0170-41b5-bbe4-fe71dedf1e31\",\n  \"redownload\": false,\n  \"source-domain\": \"example.com\", \n  \"fidelity-type\": 1, \n  \"did-win\": true,\n  \"coarse-conversion-value\": \"high\",\n  \"postback-sequence-index\": 0,\n  \"attribution-signature\": \"MEUCIQD4rX6eh38qEhuUKHdap345UbmlzA7KEZ1bhWZuYM8MJwIgMnyiiZe6heabDkGwOaKBYrUXQhKtF3P\/ERHqkR\/XpuA=\"\n}",
      "language" : "javascript"
    },
    {
      "code" : "MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWdp8GPcGqmhgzEFj9Z2nSpQVddayaPe4FMzqM9wib1+aHaaIzoHoLN9zW4K8y4SPykE3YVK3sVqW6Af0lfx3gg=="
    }
  ],
  "contentHash" : "97b2e5f7369d0ed14d22ece5b649f58de1a8d6a0ff49cfce9bbf3275bc7495a2",
  "crawledAt" : "2025-12-05T12:51:50Z",
  "id" : "0D81AA06-43DA-42B1-AF9E-E944EAB1C1EC",
  "kind" : "article",
  "language" : "swift",
  "module" : "StoreKit",
  "overview" : "## Overview\n\nInstall-validation postbacks contain data that validate an ad conversion. You need to verify the postback signature to make sure it’s signed by Apple before you count the conversion. Follow these steps to validate the postback:\n\n### Receive the postback\n\nDevices send install-validation postbacks to ad networks and developers within a defined timeframe after a user installs and launches an advertised app. Ad networks receive postbacks at the URL they provide when they register to use SKAdNetwork. Developers who opt in receive copies of winning postbacks at the URL they configure in the app’s property list key, [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSAdvertisingAttributionReportEndpoint]. For more information about setting up your postback URL, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/registering-an-ad-network] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/configuring-an-advertised-app].\n\nFor more information about the timeframe for receiving attribution, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/receiving-ad-attributions-and-postbacks] Starting with version 4, you may receive postbacks in three conversion windows. For more information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/receiving-postbacks-in-multiple-conversion-windows].\n\n### Respond to the postback\n\nWhen you receive a postback, respond with an HTTP status code `200` OK. If the device doesn’t receive the `200` status code, it attempts to send the postback up to nine times over a maximum of 9 days.\n\n### Check the postback version number\n\nPostbacks contain a `version` parameter, starting with SKAdNetwork 2. Use the version number to follow the version-specific instructions for verifying a postback signature. For a description of all the parameters in a postback, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/identifying-the-parameters-in-install-validation-postbacks].\n\nThe postback version you receive depends on the version number the ad network uses to sign the ad, the iOS version on the device, and the SDK version that the source app uses. Expect to receive the same version number in the postback as the ad network uses to sign the ad if the device runs the latest iOS version, and the source app uses the latest SDK. For more information about version dependencies, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/skadnetwork-release-notes]. For more information about signing, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/signing-and-providing-ads].\n\n### Recreate the byte array from the postback parameters\n\nTo confirm that Apple sent the postback request, you need to verify Apple’s signature in the postback’s `attribution-signature` parameter. First, decode the signature with Apple’s public key. Next, compare the decoded signature to a byte array that you recreate using the postback parameters. To create the byte array, build a UTF-8 string by combining the parameter values with invisible separators, `‘\\u2063’`, in an exact version-specific order.\n\nUse the version-specific instructions that correspond to the postback’s version:\n\nFor a version 4 postback, combine the postback parameter values in this order:\n\nFor web ads, the postback may include a `source-domain` instead of a `source-app-id`.\n\nThe combined string doesn’t include all of the postback parameters. Include `source-app-id` only if you receive it in the postback. The signature doesn’t include `conversion-value` or `coarse-conversion-value`, even if either is present in the postback. Postbacks that win the attribution have a `did-win` value of `true`. Postbacks that don’t win the attribution have a `did-win` value of `false`, and don’t include `source-app-id`.\n\nThe following example of the UTF-8 string includes `source-app-id:`\n\nThe following example of the UTF-8 string for a web ad includes `source-domain:`\n\nThe following example is a first postback from a web ad, in a high postback data tier. Notice that the `source-identifier` contains four digits, and the postback contains the fine-grained `conversion-value`.\n\nThe following example is a first postback that results from a web ad, in a low postback data tier.  Notice that the `source-identifier` contains two digits, and the postback includes a `coarse-conversion-value`.\n\nThe `attribution-signature` value in both examples is a verified signature. Use the parameter values and signature in the examples to test your code. For more information about the postback data tiers and the parameters available in each tier, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/receiving-postbacks-in-multiple-conversion-windows].\n\n### Verify Apple’s signature\n\nCopy Apple’s public key, below, which you need for the remaining steps. Apple’s NIST P-256 public key that you use to verify signatures for versions 2.1 and later is:\n\nTo verify a signature for version 1 or 2, get the version-appropriate public key from [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/skadnetwork-release-notes].\n\nThen, complete these steps:\n\nIf your verification passes, the postback is valid.\n\nFor version 3 and later, valid postbacks with a `did-win` value of `true` represent an ad attribution.\n\n### Count unique messages only\n\nUse the `transaction-id` value to ensure you’re counting unique ad conversions. If you receive more than one ad-conversion message with the same `transaction-id`, discard the duplicate message.\n\n### Receive a postback during testing\n\nIn test scenarios, the postback always contains the `source-app-id` and `conversion-value` parameters with values of `0`. To trigger test scenarios, use a development-signed source app with an [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier] value equal to `0`.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/verifying-an-install-validation-postback\ncrawled: 2025-12-05T12:51:50Z\n---\n\n# Verifying an install-validation postback\n\n**Article**\n\nEnsure the validity of a postback you receive after an ad conversion by verifying its cryptographic signature.\n\n## Overview\n\nInstall-validation postbacks contain data that validate an ad conversion. You need to verify the postback signature to make sure it’s signed by Apple before you count the conversion. Follow these steps to validate the postback:\n\n1. Receive the postback at a URL you configure.\n2. Respond to the postback when you receive it.\n3. Check the postback version.\n4. Recreate the byte array from the postback parameters in the version-specific order.\n5. Verify Apple’s signature.\n6. Count only unique postbacks with signatures you verify. For version 3 and later, check the `did-win` parameter to learn whether the postback represents a winning attribution.\n\n### Receive the postback\n\nDevices send install-validation postbacks to ad networks and developers within a defined timeframe after a user installs and launches an advertised app. Ad networks receive postbacks at the URL they provide when they register to use SKAdNetwork. Developers who opt in receive copies of winning postbacks at the URL they configure in the app’s property list key, [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSAdvertisingAttributionReportEndpoint]. For more information about setting up your postback URL, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/registering-an-ad-network] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/configuring-an-advertised-app].\n\nFor more information about the timeframe for receiving attribution, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/receiving-ad-attributions-and-postbacks] Starting with version 4, you may receive postbacks in three conversion windows. For more information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/receiving-postbacks-in-multiple-conversion-windows].\n\n### Respond to the postback\n\nWhen you receive a postback, respond with an HTTP status code `200` OK. If the device doesn’t receive the `200` status code, it attempts to send the postback up to nine times over a maximum of 9 days.\n\n### Check the postback version number\n\nPostbacks contain a `version` parameter, starting with SKAdNetwork 2. Use the version number to follow the version-specific instructions for verifying a postback signature. For a description of all the parameters in a postback, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/identifying-the-parameters-in-install-validation-postbacks].\n\nThe postback version you receive depends on the version number the ad network uses to sign the ad, the iOS version on the device, and the SDK version that the source app uses. Expect to receive the same version number in the postback as the ad network uses to sign the ad if the device runs the latest iOS version, and the source app uses the latest SDK. For more information about version dependencies, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/skadnetwork-release-notes]. For more information about signing, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/signing-and-providing-ads].\n\n### Recreate the byte array from the postback parameters\n\nTo confirm that Apple sent the postback request, you need to verify Apple’s signature in the postback’s `attribution-signature` parameter. First, decode the signature with Apple’s public key. Next, compare the decoded signature to a byte array that you recreate using the postback parameters. To create the byte array, build a UTF-8 string by combining the parameter values with invisible separators, `‘\\u2063’`, in an exact version-specific order.\n\nUse the version-specific instructions that correspond to the postback’s version:\n\n- For version 3-specific instructions and postback examples, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/combining-parameters-for-skadnetwork-3-postbacks].\n- For earlier versions, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/combining-parameters-for-previous-skadnetwork-postback-versions].\n\nFor a version 4 postback, combine the postback parameter values in this order:\n\n- `version`\n- `ad-network-id`\n- `source-identifier`` `\n- `app-id`\n- `transaction-id`\n- `redownload` (Use the strings `“true”` or `“false”` to represent the Boolean value of the redownload parameter).\n- `source-app-id` (or `source-domain` for web ads)\n- `fidelity-type`\n- `did-win`\n- `postback-sequence-index`\n\nFor web ads, the postback may include a `source-domain` instead of a `source-app-id`.\n\nThe combined string doesn’t include all of the postback parameters. Include `source-app-id` only if you receive it in the postback. The signature doesn’t include `conversion-value` or `coarse-conversion-value`, even if either is present in the postback. Postbacks that win the attribution have a `did-win` value of `true`. Postbacks that don’t win the attribution have a `did-win` value of `false`, and don’t include `source-app-id`.\n\nThe following example of the UTF-8 string includes `source-app-id:`\n\n```javascript\nversion + '\\u2063' + ad-network-id + '\\u2063' + source-identifier + '\\u2063' + app-id + '\\u2063' + transaction-id + '\\u2063' + redownload + '\\u2063' + source-app-id + '\\u2063' + fidelity-type + '\\u2063' + did-win + '\\u2063' + postback-sequence-index\n```\n\nThe following example of the UTF-8 string for a web ad includes `source-domain:`\n\n```javascript\nversion + '\\u2063' + ad-network-id + '\\u2063' + source-identifier + '\\u2063' + app-id + '\\u2063' + transaction-id + '\\u2063' + redownload + '\\u2063' + source-domain + '\\u2063' + fidelity-type + '\\u2063' + did-win + '\\u2063' + postback-sequence-index\n```\n\nThe following example is a first postback from a web ad, in a high postback data tier. Notice that the `source-identifier` contains four digits, and the postback contains the fine-grained `conversion-value`.\n\n```javascript\n{\n  \"version\": \"4.0\",\n  \"ad-network-id\": \"com.example\",\n  \"source-identifier\": \"5239\",\n  \"app-id\": 525463029,\n  \"transaction-id\": \"6aafb7a5-0170-41b5-bbe4-fe71dedf1e30\",\n  \"redownload\": false,\n  \"source-domain\": \"example.com\", \n  \"fidelity-type\": 1, \n  \"did-win\": true,\n  \"conversion-value\": 63,\n  \"postback-sequence-index\": 0,\n  \"attribution-signature\": \"MEUCIGRmSMrqedNu6uaHyhVcifs118R5z\/AB6cvRaKrRRHWRAiEAv96ne3dKQ5kJpbsfk4eYiePmrZUU6sQmo+7zfP\/1Bxo=\"\n}\n```\n\nThe following example is a first postback that results from a web ad, in a low postback data tier.  Notice that the `source-identifier` contains two digits, and the postback includes a `coarse-conversion-value`.\n\n```javascript\n{\n  \"version\": \"4.0\",\n  \"ad-network-id\": \"com.example\",\n  \"source-identifier\": \"39\",\n  \"app-id\": 525463029,\n  \"transaction-id\": \"6aafb7a5-0170-41b5-bbe4-fe71dedf1e31\",\n  \"redownload\": false,\n  \"source-domain\": \"example.com\", \n  \"fidelity-type\": 1, \n  \"did-win\": true,\n  \"coarse-conversion-value\": \"high\",\n  \"postback-sequence-index\": 0,\n  \"attribution-signature\": \"MEUCIQD4rX6eh38qEhuUKHdap345UbmlzA7KEZ1bhWZuYM8MJwIgMnyiiZe6heabDkGwOaKBYrUXQhKtF3P\/ERHqkR\/XpuA=\"\n}\n```\n\nThe `attribution-signature` value in both examples is a verified signature. Use the parameter values and signature in the examples to test your code. For more information about the postback data tiers and the parameters available in each tier, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/receiving-postbacks-in-multiple-conversion-windows].\n\n### Verify Apple’s signature\n\nCopy Apple’s public key, below, which you need for the remaining steps. Apple’s NIST P-256 public key that you use to verify signatures for versions 2.1 and later is:\n\n```\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWdp8GPcGqmhgzEFj9Z2nSpQVddayaPe4FMzqM9wib1+aHaaIzoHoLN9zW4K8y4SPykE3YVK3sVqW6Af0lfx3gg==\n```\n\nTo verify a signature for version 1 or 2, get the version-appropriate public key from [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/skadnetwork-release-notes].\n\nThen, complete these steps:\n\n1. Decode Apple’s public key, which appears as a Base64-encoded string above. The result is a byte array.\n2. Create an X.509 standard public key from the byte array.\n3. Decode Apple’s signature string value from its Base64 format.\n4. Verify Apple’s signed value from the `attribution-signature` parameter in the postback against the UTF-8 string you create by combining the postback parameters. Use Apple’s public key and a SHA-256 hash using the Elliptic Curve Digital Signature Algorithm (ECDSA).\n\nIf your verification passes, the postback is valid.\n\n\n\nFor version 3 and later, valid postbacks with a `did-win` value of `true` represent an ad attribution.\n\n### Count unique messages only\n\nUse the `transaction-id` value to ensure you’re counting unique ad conversions. If you receive more than one ad-conversion message with the same `transaction-id`, discard the duplicate message.\n\n### Receive a postback during testing\n\nIn test scenarios, the postback always contains the `source-app-id` and `conversion-value` parameters with values of `0`. To trigger test scenarios, use a development-signed source app with an [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKStoreProductParameterAdNetworkSourceAppStoreIdentifier] value equal to `0`.\n\n## SKAdNetworks 3 and earlier postbacks\n\n- **Combining parameters for SKAdNetwork 3 postbacks**: Recreate the byte array for version 3 postbacks that win and don’t win attribution.\n- **Combining parameters for previous SKAdNetwork postback versions**: Recreate the byte array for versions 2.2 or earlier.\n\n## Verifying postbacks\n\n- **Identifying the parameters in install-validation postbacks**: Learn about the postback parameters in all SKAdNetwork versions.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Recreate the byte array for version 3 postbacks that win and don’t win attribution.",
          "name" : "Combining parameters for SKAdNetwork 3 postbacks",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/combining-parameters-for-skadnetwork-3-postbacks"
        },
        {
          "description" : "Recreate the byte array for versions 2.2 or earlier.",
          "name" : "Combining parameters for previous SKAdNetwork postback versions",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/combining-parameters-for-previous-skadnetwork-postback-versions"
        }
      ],
      "title" : "SKAdNetworks 3 and earlier postbacks"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Learn about the postback parameters in all SKAdNetwork versions.",
          "name" : "Identifying the parameters in install-validation postbacks",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/identifying-the-parameters-in-install-validation-postbacks"
        }
      ],
      "title" : "Verifying postbacks"
    }
  ],
  "source" : "appleJSON",
  "title" : "Verifying an install-validation postback",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/verifying-an-install-validation-postback"
}