{
  "abstract" : "Display promoted In-App Purchases on your product page and handle purchases that users initiate on the App Store.",
  "codeExamples" : [
    {
      "code" : "for await purchaseIntent in PurchaseIntent.intents {\n    \/\/ Complete the purchase workflow.\n    do {\n        try await purchaseIntent.product.purchase()\n    }\n    catch {\n        <#Handle Error#>\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Set the product order.\nlet orderedProductIdentifiers = [\n    \"com.example.ExampleApp.product1\",\n    \"com.example.ExampleApp.product2\",\n    \"com.example.ExampleApp.product3\"\n]\n\ndo {\n    try await Product.PromotionInfo.updateProductOrder(byID: orderedProductIdentifiers)\n}\ncatch {\n    <#Handle Error#>\n}\n\n\/\/ Get the current product order.\nvar promotions: [Product.PromotionInfo] = []\n\ndo {\n    promotions = try await Product.PromotionInfo.currentOrder\n}\ncatch {\n    <#Handle Error#>\n}\n\n\/\/ Set the visibility for all the products and save the changes.\nfor i in promotions.indices {\n    promotions[i].visibility = .visible\n}\n\ndo {\n    try await Product.PromotionInfo.updateAll(promotions)\n}\ncatch {\n    <#Handle Error#>\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Change the visibility to hide a promoted product after a user purchases it.\nlet purchasedProductIdentifier = \"com.example.ExampleApp.product1\"\n\ndo {\n    try await Product.PromotionInfo.updateProductVisibility(.hidden, for: purchasedProductIdentifier)\n}\ncatch {\n    <#Handle Error#>\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "08a409f8251b264d9d46c8c91f5691e636725b9b88b058a9096e0958e1466771",
  "crawledAt" : "2025-12-02T17:53:39Z",
  "id" : "D75D8961-FDE7-4273-A574-1EC83319BEB8",
  "kind" : "article",
  "language" : "swift",
  "module" : "StoreKit",
  "overview" : "## Overview\n\nWith iOS, you can promote In-App Purchases so users can browse them directly on the App Store. Promoted In-App Purchases display on your product page, appear in search results, and may be featured on an appropriate tab on the App Store. Users can start a purchase on the App Store, which takes them into your app to continue the transaction.\n\nIf your app isn’t installed when the user selects to purchase the in-app product, the App Store automatically downloads the app or prompts the user to purchase it. If the installed version of your app is an older version that doesn’t support In-App Purchase promotions, the App Store prompts the user to upgrade the app.\n\nPromoting In-App Purchases requires two steps:\n\nYou can optionally customize which promoted In-App Purchases a users sees on a specific device using the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo] API. Using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo] isn’t required for your promoted In-App Purchases to appear on the App Store.\n\nFor marketing guidance on this feature, see [https:\/\/developer.apple.com\/app-store\/promoting-in-app-purchases\/].\n\nTo test promoted In-App Purchases, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-promoted-in-app-purchases].\n\n### Set up promoted In-App Purchases using App Store Connect\n\nIn App Store Connect, set up promoted In-App Purchases by uploading promotional images. Use the App Store Promotions feature in App Store Connect to manage their default order and visibility. For more information about the setup, see [https:\/\/developer.apple.com\/help\/app-store-connect\/configure-in-app-purchase-settings\/promote-in-app-purchases].\n\n### Complete the purchase in your app\n\nWhen users initiate an In-App Purchase on the App Store, StoreKit automatically opens your app and sends the product information in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent\/intents] asynchronous sequence of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent]. Your app needs to complete the purchase transaction and perform any related actions that are specific to it.\n\nTo complete the transaction, call the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/purchase(options:)] method on the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent\/product] of the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent]. Follow the same workflow your app uses for any In-App Purchase, such as unlocking the purchased content and finishing the transaction ([doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction\/finish()]).\n\nThe following code example listens for purchase intents from the App Store. It receives a [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product] object when the user taps a promoted In-App Purchase on the App Store, and performs its purchase workflow.\n\n### Defer or cancel the purchase\n\nIn some cases, your app may need to defer or cancel the purchase transaction. For example, you may need to defer the transaction if the user is in the middle of onboarding, and complete it after they finish. Or, you may need to cancel the transaction if the user has already unlocked the product they’re trying to buy.\n\nTo defer the transaction, store the purchase intent and process it later after the user finishes onboarding or other actions that require deferring.\n\nTo cancel the transaction, don’t call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/purchase(options:)]. Instead, provide feedback to the user. Although this step is optional, if you don’t provide feedback, the app’s lack of action after the user initiates the purchase on the App Store may seem like a bug.\n\n### Customize promoted product order and visibility on a device\n\nTo customize promoted In-App Purchases on a device, you can override their default order and visibility using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo]. Use it to show only promotions that are relevant to your user, based on their experience with your app, or based on their previous purchases. For example, suppose a game has In-App Purchases to promote for each game level. You can show only the promoted products for the user’s game level, and hide those they already purchased.\n\nTo control whether a promoted In-App Purchase appears in the App Store on the device, use any of these methods:\n\nThese overrides are specific to the device, and take effect after the user launches the app at least once.\n\nThe following code example uses an array of product identifiers to set their order. It calls [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/currentOrder] to get the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo] objects, and sets their visibility directly. It then calls [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateAll(_:)] to save the changes.\n\nThe following code example hides a promoted product after the user purchases it:\n\n### Control a promotion’s visibility from App Store Connect\n\nTo control a promotion’s visibility from App Store Connect, set its [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/visibility-swift.property] value in the app to the default of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/Visibility-swift.enum\/appStoreConnectDefault]. Products with this value are visible or hidden based on the setting you configure in App Store Connect. For more information about using App Store Connect, see [https:\/\/developer.apple.com\/help\/app-store-connect\/configure-in-app-purchase-settings\/promote-in-app-purchases].\n\nFor example, to promote a product on a holiday for all users, ensure the app sets the product’s visibility to [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/Visibility-swift.enum\/appStoreConnectDefault]. In App Store Connect, start with its visibility set as hidden. On the holiday, use App Store Connect to manually change the product to be visible. The promoted product becomes visible in the App Store for all users automatically.\n\n### Cancel overrides\n\nTo reset changes your app makes to the promoted products’ order and visibility, call the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateAll(_:)] or [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateProductOrder(byID:)] methods with an empty array. This cancels the overrides so the user can see the promoted In-App Purchases in their default order.\n\nCall [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/currentOrder] to get a list of your overrides. If the list is empty, the device displays promoted In-App Purchases in their default order.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/supporting-promoted-in-app-purchases-in-your-app\ncrawled: 2025-12-02T17:53:39Z\n---\n\n# Supporting promoted In-App Purchases in your app\n\n**Article**\n\nDisplay promoted In-App Purchases on your product page and handle purchases that users initiate on the App Store.\n\n## Overview\n\nWith iOS, you can promote In-App Purchases so users can browse them directly on the App Store. Promoted In-App Purchases display on your product page, appear in search results, and may be featured on an appropriate tab on the App Store. Users can start a purchase on the App Store, which takes them into your app to continue the transaction.\n\nIf your app isn’t installed when the user selects to purchase the in-app product, the App Store automatically downloads the app or prompts the user to purchase it. If the installed version of your app is an older version that doesn’t support In-App Purchase promotions, the App Store prompts the user to upgrade the app.\n\nPromoting In-App Purchases requires two steps:\n\n1. In your app, starting in iOS 16.4, implement [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent] to complete the purchase users initiate on the App Store. To support this feature in apps that run in iOS 11–16.3, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/promoting-in-app-purchases].\n2. In App Store Connect, configure promoted In-App Purchases. For more information, see [https:\/\/developer.apple.com\/help\/app-store-connect\/configure-in-app-purchase-settings\/promote-in-app-purchases].\n\n\n\nYou can optionally customize which promoted In-App Purchases a users sees on a specific device using the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo] API. Using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo] isn’t required for your promoted In-App Purchases to appear on the App Store.\n\nFor marketing guidance on this feature, see [https:\/\/developer.apple.com\/app-store\/promoting-in-app-purchases\/].\n\nTo test promoted In-App Purchases, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-promoted-in-app-purchases].\n\n\n\n### Set up promoted In-App Purchases using App Store Connect\n\nIn App Store Connect, set up promoted In-App Purchases by uploading promotional images. Use the App Store Promotions feature in App Store Connect to manage their default order and visibility. For more information about the setup, see [https:\/\/developer.apple.com\/help\/app-store-connect\/configure-in-app-purchase-settings\/promote-in-app-purchases].\n\n### Complete the purchase in your app\n\nWhen users initiate an In-App Purchase on the App Store, StoreKit automatically opens your app and sends the product information in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent\/intents] asynchronous sequence of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent]. Your app needs to complete the purchase transaction and perform any related actions that are specific to it.\n\nTo complete the transaction, call the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/purchase(options:)] method on the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent\/product] of the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/PurchaseIntent]. Follow the same workflow your app uses for any In-App Purchase, such as unlocking the purchased content and finishing the transaction ([doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction\/finish()]).\n\nThe following code example listens for purchase intents from the App Store. It receives a [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product] object when the user taps a promoted In-App Purchase on the App Store, and performs its purchase workflow.\n\n```swift\nfor await purchaseIntent in PurchaseIntent.intents {\n    \/\/ Complete the purchase workflow.\n    do {\n        try await purchaseIntent.product.purchase()\n    }\n    catch {\n        <#Handle Error#>\n    }\n}\n```\n\n### Defer or cancel the purchase\n\nIn some cases, your app may need to defer or cancel the purchase transaction. For example, you may need to defer the transaction if the user is in the middle of onboarding, and complete it after they finish. Or, you may need to cancel the transaction if the user has already unlocked the product they’re trying to buy.\n\nTo defer the transaction, store the purchase intent and process it later after the user finishes onboarding or other actions that require deferring.\n\nTo cancel the transaction, don’t call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/purchase(options:)]. Instead, provide feedback to the user. Although this step is optional, if you don’t provide feedback, the app’s lack of action after the user initiates the purchase on the App Store may seem like a bug.\n\n### Customize promoted product order and visibility on a device\n\nTo customize promoted In-App Purchases on a device, you can override their default order and visibility using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo]. Use it to show only promotions that are relevant to your user, based on their experience with your app, or based on their previous purchases. For example, suppose a game has In-App Purchases to promote for each game level. You can show only the promoted products for the user’s game level, and hide those they already purchased.\n\nTo control whether a promoted In-App Purchase appears in the App Store on the device, use any of these methods:\n\n- Add or remove it from the list. Set the product order by calling [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateAll(_:)] or [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateProductOrder(byID:)]. Leave out the products you don’t want to display.\n- Set its visibility. Show or hide the product by setting its [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/visibility-swift.property] value and calling [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/update()] or [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateAll(_:)], or call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateProductVisibility(_:for:)].\n\nThese overrides are specific to the device, and take effect after the user launches the app at least once.\n\nThe following code example uses an array of product identifiers to set their order. It calls [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/currentOrder] to get the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo] objects, and sets their visibility directly. It then calls [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateAll(_:)] to save the changes.\n\n```swift\n\/\/ Set the product order.\nlet orderedProductIdentifiers = [\n    \"com.example.ExampleApp.product1\",\n    \"com.example.ExampleApp.product2\",\n    \"com.example.ExampleApp.product3\"\n]\n\ndo {\n    try await Product.PromotionInfo.updateProductOrder(byID: orderedProductIdentifiers)\n}\ncatch {\n    <#Handle Error#>\n}\n\n\/\/ Get the current product order.\nvar promotions: [Product.PromotionInfo] = []\n\ndo {\n    promotions = try await Product.PromotionInfo.currentOrder\n}\ncatch {\n    <#Handle Error#>\n}\n\n\/\/ Set the visibility for all the products and save the changes.\nfor i in promotions.indices {\n    promotions[i].visibility = .visible\n}\n\ndo {\n    try await Product.PromotionInfo.updateAll(promotions)\n}\ncatch {\n    <#Handle Error#>\n}\n```\n\nThe following code example hides a promoted product after the user purchases it:\n\n```swift\n\/\/ Change the visibility to hide a promoted product after a user purchases it.\nlet purchasedProductIdentifier = \"com.example.ExampleApp.product1\"\n\ndo {\n    try await Product.PromotionInfo.updateProductVisibility(.hidden, for: purchasedProductIdentifier)\n}\ncatch {\n    <#Handle Error#>\n}\n```\n\n### Control a promotion’s visibility from App Store Connect\n\nTo control a promotion’s visibility from App Store Connect, set its [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/visibility-swift.property] value in the app to the default of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/Visibility-swift.enum\/appStoreConnectDefault]. Products with this value are visible or hidden based on the setting you configure in App Store Connect. For more information about using App Store Connect, see [https:\/\/developer.apple.com\/help\/app-store-connect\/configure-in-app-purchase-settings\/promote-in-app-purchases].\n\nFor example, to promote a product on a holiday for all users, ensure the app sets the product’s visibility to [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/Visibility-swift.enum\/appStoreConnectDefault]. In App Store Connect, start with its visibility set as hidden. On the holiday, use App Store Connect to manually change the product to be visible. The promoted product becomes visible in the App Store for all users automatically.\n\n### Cancel overrides\n\nTo reset changes your app makes to the promoted products’ order and visibility, call the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateAll(_:)] or [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/updateProductOrder(byID:)] methods with an empty array. This cancels the overrides so the user can see the promoted In-App Purchases in their default order.\n\nCall [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Product\/PromotionInfo\/currentOrder] to get a list of your overrides. If the list is empty, the device displays promoted In-App Purchases in their default order.\n\n## Promoted In-App Purchases\n\n- **PurchaseIntent**: An instance that emits purchase intents, which indicate that the customer initiated a purchase outside of your app, for your app to complete.\n- **Product.PromotionInfo**: Information about a promoted In-App Purchase that customizes its order and visibility on the device.\n- **Testing promoted In-App Purchases**: Test your In-App Purchases before making your app available in the App Store.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An instance that emits purchase intents, which indicate that the customer initiated a purchase outside of your app, for your app to complete.",
          "name" : "PurchaseIntent",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/PurchaseIntent"
        },
        {
          "description" : "Information about a promoted In-App Purchase that customizes its order and visibility on the device.",
          "name" : "Product.PromotionInfo",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/Product\/PromotionInfo"
        },
        {
          "description" : "Test your In-App Purchases before making your app available in the App Store.",
          "name" : "Testing promoted In-App Purchases",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-promoted-in-app-purchases"
        }
      ],
      "title" : "Promoted In-App Purchases"
    }
  ],
  "source" : "appleJSON",
  "title" : "Supporting promoted In-App Purchases in your app",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/supporting-promoted-in-app-purchases-in-your-app"
}