{
  "abstract" : "Tells an observer that the customer is no longer entitled to one or more Family Sharing purchases.",
  "codeExamples" : [

  ],
  "contentHash" : "1b18a765602005e7dbad2a73fa77b6648f1519c2836e0f61bd939166b7aea613",
  "crawledAt" : "2025-12-01T00:08:08Z",
  "declaration" : {
    "code" : "optional func paymentQueue(_ queue: SKPaymentQueue, didRevokeEntitlementsForProductIdentifiers productIdentifiers: [String])",
    "language" : "swift"
  },
  "id" : "D280D7EB-742A-4566-99AC-6C534F202814",
  "kind" : "method",
  "module" : "StoreKit",
  "overview" : "## Discussion\n\nThe system calls this delegate method whenever App Store revokes in-app purchases for a family member based on changes in Family Sharing, or when the purchaser gets a refund for an in-app purchase. Implement this method in your payment queue observer to reestablish a user’s access to products. Revoked transactions have the `cancellation_date` populated in the receipt.\n\nFor products with Family Sharing enabled, the following conditions may trigger this method in the family member’s app:\n\nBy leaving a family group, or disabling sharing in any of the ways listed above, family members are no longer entitled to family-shared purchases. The `productIdentifiers` parameter contains the revoked product IDs. Your app needs to check the receipt on the device, which the system automatically updates prior to calling this method, and provide the correct level of access for the in-app purchases.\n\nIf you receive [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications], your server receives a [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications\/notificationType] `REVOKE` for the family member when the conditions listed above occur.\n\nStoreKit also calls this method in the purchaser’s app when the purchaser receives a refund for a non-consumable or an auto-renewable subscription, regardless if the product is shared with the family. If you receive [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications], your server receives a [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications\/notificationType] `REFUND` for the purchaser.\n\nIf you use server-side receipt validation with the App Store, call your server to reprocess the receipt and update your purchase records.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentTransactionObserver\/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)\ncrawled: 2025-12-01T00:08:08Z\n---\n\n# paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)\n\n**Instance Method**\n\nTells an observer that the customer is no longer entitled to one or more Family Sharing purchases.\n\n## Declaration\n\n```swift\noptional func paymentQueue(_ queue: SKPaymentQueue, didRevokeEntitlementsForProductIdentifiers productIdentifiers: [String])\n```\n\n## Parameters\n\n- **queue**: The payment queue that calls the delegate method.\n- **productIdentifiers**: The list of product identifiers with revoked entitlements.\n\n## Discussion\n\nThe system calls this delegate method whenever App Store revokes in-app purchases for a family member based on changes in Family Sharing, or when the purchaser gets a refund for an in-app purchase. Implement this method in your payment queue observer to reestablish a user’s access to products. Revoked transactions have the `cancellation_date` populated in the receipt.\n\nFor products with Family Sharing enabled, the following conditions may trigger this method in the family member’s app:\n\n- The purchaser receives a refund for a non-consumable or an auto-renewable subscription they shared.\n- The purchaser leaves the family group in which they were sharing subscriptions or non-consumables.\n- The purchaser disables Family Sharing for a non-consumable or stops sharing a subscription.\n- The purchaser hides an app, which makes their non-consumable purchase unavailable for sharing.\n- The family member leaves the group and no longer gets access to shared purchases.\n- The family organizer stops sharing payment in iCloud family settings. This change affects non-consumables.\n\nBy leaving a family group, or disabling sharing in any of the ways listed above, family members are no longer entitled to family-shared purchases. The `productIdentifiers` parameter contains the revoked product IDs. Your app needs to check the receipt on the device, which the system automatically updates prior to calling this method, and provide the correct level of access for the in-app purchases.\n\nIf you receive [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications], your server receives a [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications\/notificationType] `REVOKE` for the family member when the conditions listed above occur.\n\n\n\nStoreKit also calls this method in the purchaser’s app when the purchaser receives a refund for a non-consumable or an auto-renewable subscription, regardless if the product is shared with the family. If you receive [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications], your server receives a [doc:\/\/com.apple.documentation\/documentation\/AppStoreServerNotifications\/notificationType] `REFUND` for the purchaser.\n\nIf you use server-side receipt validation with the App Store, call your server to reprocess the receipt and update your purchase records.\n\n## Family Sharing\n\n- **Supporting Family Sharing in your app**: Provide service to share subscriptions and non-consumable products to family members.\n- **isFamilyShareable**: A Boolean value that indicates whether the product is available for Family Sharing in App Store Connect.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Provide service to share subscriptions and non-consumable products to family members.",
          "name" : "Supporting Family Sharing in your app",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/supporting-family-sharing-in-your-app"
        },
        {
          "description" : "A Boolean value that indicates whether the product is available for Family Sharing in App Store Connect.",
          "name" : "isFamilyShareable",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKProduct\/isFamilyShareable"
        }
      ],
      "title" : "Family Sharing"
    }
  ],
  "source" : "appleJSON",
  "title" : "paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentTransactionObserver\/paymentQueue(_:didRevokeEntitlementsForProductIdentifiers:)"
}