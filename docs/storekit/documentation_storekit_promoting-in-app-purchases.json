{
  "abstract" : "Show promoted In-App Purchases on your product page and handle purchases that customers initiate on the App Store.",
  "codeExamples" : [
    {
      "code" : "\/\/Continuing a transaction from the App Store.\n\n\/\/MARK: - SKPaymentTransactionObserver\n\nfunc paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment,\n        for product: SKProduct) -> Bool {\n    \/\/ Check to see if you can complete the transaction.\n    \/\/ Return true if you can.\n    return true\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/Handling a transaction from the App Store.\n\n\/\/MARK: - SKPaymentTransactionObserver\n\nfunc paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment,\n        for product: SKProduct) -> Bool {\n\n    \/\/ Add code here to check if your app needs to defer the transaction.\n    let shouldDeferPayment = ...\n    \/\/ If you need to defer until onboarding is complete, save the payment and return false.\n    if shouldDeferPayment {\n        self.savedPayment = payment\n        return false\n    }\n\n    \/\/ Add code here to check if your app needs to cancel the transaction.\n    let shouldCancelPayment = ...\n    \/\/ If you need to cancel the transaction, then return false:\n    if shouldCancelPayment {\n        return false\n    }\n}\n\n\/\/ If you cancel the transaction, provide feedback to the user.\n\n\/\/ Continuing a previously deferred payment.\nSKPaymentQueue.default().add(savedPayment)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Reading visibility override of a promoted in-app purchase.\n\n\/\/ Fetch product info for \"Hidden Beaches pack.\"\n\nlet storePromotionController = SKProductStorePromotionController.default()\nstorePromotionController.fetchStorePromotionVisibility(forProduct: hiddenBeaches,\n    completionHandler: { visibility: SKProductSTorePromotionVisiblity, error: Error?) in\n        \/\/ visibility == .default\n})",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Hide the promoted product Pro Subscription after the user purchases it.\n\nlet storePromotionController = SKProductStorePromotionController.default()\nstorePromotionController.update(storePromotionVisibility: .hide, for: proSubscription,\n    completionHandler: { (error: Error?) in\n        \/\/ Completion.\n    })",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Overriding the order of promoted in-app purchases.\n\n\/\/ Fetch product information for three products: Pro Subscription, Fishing Hot Spots, and Hidden Beaches.\nlet storePromotionController = SKProductStorePromotionController.default()\n\n\/\/ Update the order.\nlet newProductsOrder = [hiddenBeaches, proSubscription, fishingHotSpots]\nstorePromotionController.updateStorePromotionOrder(newProductsOrder,\n    completionHandler: { (error: Error?) in\n        \/\/ Complete.\n    })",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Getting the order override of promoted in-app purchases.\n\nlet storePromotionController = SKProductStorePromotionController.default()\nstorePromotionController.fetchStorePromotionOrder(completionHandler: {\n    (products: [SKProduct], error: Error?) in\n        \/\/ products == [hiddenBeaches, proSubscription, fishingHotSpots]\n    })",
      "language" : "swift"
    }
  ],
  "contentHash" : "f81adffa99fa5fb3f9125b90f9e025b23651dd1facd61b9052528332004e1e83",
  "crawledAt" : "2025-12-02T20:23:45Z",
  "id" : "265D2089-5339-4445-8E63-3F7B18F3EF43",
  "kind" : "article",
  "language" : "swift",
  "module" : "StoreKit",
  "overview" : "## Overview\n\nStarting in iOS 11, you can promote in-app purchases on the App Store.\n\nPromoted in-app purchases appear on your product page, can appear in search results, and can appear as featured items on an appropriate tab on the App Store. Users can start an in-app purchase on the App Store and then transition to your app to continue the transaction. If your app isn’t installed, they receive a prompt to download it.\n\nPromoting in-app purchases requires two steps:\n\nTo customize the list of promoted in-app purchases for users, you can override their default order and visibility using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController]. Use overrides to show promotions that are relevant to the user. Overrides are specific to a device, and take effect after the user launches the app at least once. Using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController] is optional and isn’t required for your in-app purchases to appear on the App Store.\n\nFor marketing guidance on this feature, see [https:\/\/developer.apple.com\/app-store\/promoting-in-app-purchases\/].\n\n### Complete the purchase in the app\n\nWhen a user selects an in-app product to purchase on the App Store, StoreKit automatically opens your app and sends the transaction information to the delegate in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] protocol. Your app needs to complete the purchase transaction and any related actions that are specific to it.\n\nIn the delegate method, return `true` to continue the transaction, or `false` to defer or cancel it.\n\nIf your app isn’t installed when the user selects to purchase the in-app product, the App Store automatically downloads the app or prompts the user to purchase it. If the installed version of your app is an older version that doesn’t support in-app purchase promotions, the App Store prompts the user to upgrade the app.\n\n### Continue the transaction\n\nTo continue an in-app purchase transaction, implement the delegate method in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] protocol and return `true`. StoreKit then displays the payment sheet, and the user can complete the transaction.\n\n### Defer or cancel the transaction\n\nIf your app needs to defer or cancel a transaction, return `false`. For example, you may need to defer a transaction if the user is in the middle of onboarding, and continue it after they complete the onboarding. Or, you may need to cancel a transaction if the user has already unlocked the product they’re trying to buy.\n\nTo defer a transaction:\n\nTo cancel a transaction:\n\n### Get visibility settings\n\nTo get the visibility settings for a promoted product, call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/fetchStorePromotionVisibility(for:completionHandler:)], providing the product information.\n\n### Override visibility settings\n\nFor each device, you can decide whether to make in-app purchases visible or hidden. For example, you may want to hide products the customer already purchased, and show only the products they can buy.\n\nFor example, to hide the Pro Subscription product after a user purchases it, fetch the product information and update the store promotion controller with the `.hide` setting, as the following code example shows. The Pro Subscription promoted in-app purchase no longer appears in the App Store on the device.\n\n### Override the order of promoted products\n\nYou can customize the promoted in-app purchases on each device by overriding their default order. Use overrides to show promotions that are relevant to the user. For example, you can override the order to promote an in-app purchase that unlocks a level in your game when a user reaches the preceding level.\n\nTo override the promotion order, add the product information to an array in the order they are to appear. Pass the array to the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/update(storePromotionOrder:completionHandler:)] method. The App Store displays the products in the array, followed by the remaining promoted products, which appear in the same relative order that you set in App Store Connect.\n\n### Cancel order overrides\n\nTo remove overrides and use the default promotion order, send an empty product array to the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/update(storePromotionOrder:completionHandler:)] method. The App Store then displays the promoted in-app purchase products in the default order that you set in App Store Connect.\n\n### Fetch order overrides\n\nTo get the product promotion order for the device, call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/fetchStorePromotionOrder(completionHandler:)]. This method returns an array of products that have an overridden order. If you get an empty array, there aren’t any overrides and the products are in the default order.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/promoting-in-app-purchases\ncrawled: 2025-12-02T20:23:45Z\n---\n\n# Promoting In-App Purchases\n\n**Article**\n\nShow promoted In-App Purchases on your product page and handle purchases that customers initiate on the App Store.\n\n## Overview\n\nStarting in iOS 11, you can promote in-app purchases on the App Store.\n\n\n\nPromoted in-app purchases appear on your product page, can appear in search results, and can appear as featured items on an appropriate tab on the App Store. Users can start an in-app purchase on the App Store and then transition to your app to continue the transaction. If your app isn’t installed, they receive a prompt to download it.\n\nPromoting in-app purchases requires two steps:\n\n1. In App Store Connect, set up promotions by uploading promotional images. Use the App Store Promotions feature in App Store Connect to manage their order and visibility. For more information about the setup, see [https:\/\/developer.apple.com\/help\/app-store-connect\/configure-in-app-purchase-settings\/promote-in-app-purchases].\n2. In your app, implement the delegate method [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver\/paymentQueue(_:shouldAddStorePayment:for:)] from the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] protocol to handle the purchase.\n\n\n\nTo customize the list of promoted in-app purchases for users, you can override their default order and visibility using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController]. Use overrides to show promotions that are relevant to the user. Overrides are specific to a device, and take effect after the user launches the app at least once. Using [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController] is optional and isn’t required for your in-app purchases to appear on the App Store.\n\nFor marketing guidance on this feature, see [https:\/\/developer.apple.com\/app-store\/promoting-in-app-purchases\/].\n\n\n\n### Complete the purchase in the app\n\nWhen a user selects an in-app product to purchase on the App Store, StoreKit automatically opens your app and sends the transaction information to the delegate in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] protocol. Your app needs to complete the purchase transaction and any related actions that are specific to it.\n\nIn the delegate method, return `true` to continue the transaction, or `false` to defer or cancel it.\n\nIf your app isn’t installed when the user selects to purchase the in-app product, the App Store automatically downloads the app or prompts the user to purchase it. If the installed version of your app is an older version that doesn’t support in-app purchase promotions, the App Store prompts the user to upgrade the app.\n\n### Continue the transaction\n\nTo continue an in-app purchase transaction, implement the delegate method in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionObserver] protocol and return `true`. StoreKit then displays the payment sheet, and the user can complete the transaction.\n\n```swift\n\/\/Continuing a transaction from the App Store.\n\n\/\/MARK: - SKPaymentTransactionObserver\n\nfunc paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment,\n        for product: SKProduct) -> Bool {\n    \/\/ Check to see if you can complete the transaction.\n    \/\/ Return true if you can.\n    return true\n}\n```\n\n### Defer or cancel the transaction\n\nIf your app needs to defer or cancel a transaction, return `false`. For example, you may need to defer a transaction if the user is in the middle of onboarding, and continue it after they complete the onboarding. Or, you may need to cancel a transaction if the user has already unlocked the product they’re trying to buy.\n\nTo defer a transaction:\n\n1. Save the `payment` to use when the app is ready. The payment already contains information about the product. Don’t create a new [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPayment] with the same product.\n2. Return `false`.\n3. After the user finishes the onboarding or other actions that require a deferral, send the saved payment to the payment queue as you do with a typical in-app purchase.\n\nTo cancel a transaction:\n\n1. Return `false`.\n2. Provide feedback to the user. Although this step is optional, if you don’t provide feedback, the app’s lack of action after the user selects to purchase an in-app product in the App Store may seem like a bug.\n\n```swift\n\/\/Handling a transaction from the App Store.\n\n\/\/MARK: - SKPaymentTransactionObserver\n\nfunc paymentQueue(_ queue: SKPaymentQueue, shouldAddStorePayment payment: SKPayment,\n        for product: SKProduct) -> Bool {\n\n    \/\/ Add code here to check if your app needs to defer the transaction.\n    let shouldDeferPayment = ...\n    \/\/ If you need to defer until onboarding is complete, save the payment and return false.\n    if shouldDeferPayment {\n        self.savedPayment = payment\n        return false\n    }\n\n    \/\/ Add code here to check if your app needs to cancel the transaction.\n    let shouldCancelPayment = ...\n    \/\/ If you need to cancel the transaction, then return false:\n    if shouldCancelPayment {\n        return false\n    }\n}\n\n\/\/ If you cancel the transaction, provide feedback to the user.\n\n\/\/ Continuing a previously deferred payment.\nSKPaymentQueue.default().add(savedPayment)\n```\n\n### Get visibility settings\n\nTo get the visibility settings for a promoted product, call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/fetchStorePromotionVisibility(for:completionHandler:)], providing the product information.\n\n```swift\n\/\/ Reading visibility override of a promoted in-app purchase.\n\n\/\/ Fetch product info for \"Hidden Beaches pack.\"\n\nlet storePromotionController = SKProductStorePromotionController.default()\nstorePromotionController.fetchStorePromotionVisibility(forProduct: hiddenBeaches,\n    completionHandler: { visibility: SKProductSTorePromotionVisiblity, error: Error?) in\n        \/\/ visibility == .default\n})\n```\n\n### Override visibility settings\n\nFor each device, you can decide whether to make in-app purchases visible or hidden. For example, you may want to hide products the customer already purchased, and show only the products they can buy.\n\nFor example, to hide the Pro Subscription product after a user purchases it, fetch the product information and update the store promotion controller with the `.hide` setting, as the following code example shows. The Pro Subscription promoted in-app purchase no longer appears in the App Store on the device.\n\n```swift\n\/\/ Hide the promoted product Pro Subscription after the user purchases it.\n\nlet storePromotionController = SKProductStorePromotionController.default()\nstorePromotionController.update(storePromotionVisibility: .hide, for: proSubscription,\n    completionHandler: { (error: Error?) in\n        \/\/ Completion.\n    })\n```\n\n### Override the order of promoted products\n\nYou can customize the promoted in-app purchases on each device by overriding their default order. Use overrides to show promotions that are relevant to the user. For example, you can override the order to promote an in-app purchase that unlocks a level in your game when a user reaches the preceding level.\n\nTo override the promotion order, add the product information to an array in the order they are to appear. Pass the array to the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/update(storePromotionOrder:completionHandler:)] method. The App Store displays the products in the array, followed by the remaining promoted products, which appear in the same relative order that you set in App Store Connect.\n\n```swift\n\/\/ Overriding the order of promoted in-app purchases.\n\n\/\/ Fetch product information for three products: Pro Subscription, Fishing Hot Spots, and Hidden Beaches.\nlet storePromotionController = SKProductStorePromotionController.default()\n\n\/\/ Update the order.\nlet newProductsOrder = [hiddenBeaches, proSubscription, fishingHotSpots]\nstorePromotionController.updateStorePromotionOrder(newProductsOrder,\n    completionHandler: { (error: Error?) in\n        \/\/ Complete.\n    })\n```\n\n### Cancel order overrides\n\nTo remove overrides and use the default promotion order, send an empty product array to the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/update(storePromotionOrder:completionHandler:)] method. The App Store then displays the promoted in-app purchase products in the default order that you set in App Store Connect.\n\n### Fetch order overrides\n\nTo get the product promotion order for the device, call [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKProductStorePromotionController\/fetchStorePromotionOrder(completionHandler:)]. This method returns an array of products that have an overridden order. If you get an empty array, there aren’t any overrides and the products are in the default order.\n\n```swift\n\/\/ Getting the order override of promoted in-app purchases.\n\nlet storePromotionController = SKProductStorePromotionController.default()\nstorePromotionController.fetchStorePromotionOrder(completionHandler: {\n    (products: [SKProduct], error: Error?) in\n        \/\/ products == [hiddenBeaches, proSubscription, fishingHotSpots]\n    })\n```\n\n## Promotions\n\n- **Testing promoted In-App Purchases**: Test your In-App Purchases before making your app available in the App Store.\n- **SKProductStorePromotionController**: A product promotion controller for customizing the order and visibility of In-App Purchases per device.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Test your In-App Purchases before making your app available in the App Store.",
          "name" : "Testing promoted In-App Purchases",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-promoted-in-app-purchases"
        },
        {
          "description" : "A product promotion controller for customizing the order and visibility of In-App Purchases per device.",
          "name" : "SKProductStorePromotionController",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKProductStorePromotionController"
        }
      ],
      "title" : "Promotions"
    }
  ],
  "source" : "appleJSON",
  "title" : "Promoting In-App Purchases",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/promoting-in-app-purchases"
}