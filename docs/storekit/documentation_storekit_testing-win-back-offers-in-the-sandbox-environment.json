{
  "abstract" : "Verify that your app receives and handles win-back offer transactions, including those made outside your app.",
  "codeExamples" : [

  ],
  "contentHash" : "ca70a590947ccb93835cb2782e09cc88398f9325d9779a97eeff73fc1f6e8ff9",
  "crawledAt" : "2025-12-03T07:22:45Z",
  "id" : "DA911E8F-BBCA-44DE-A790-3DB747FD5AE0",
  "kind" : "article",
  "language" : "swift",
  "module" : "StoreKit",
  "overview" : "## Overview\n\nAfter you set up win-back offers for auto-renewable subscriptions in App Store Connect, you can begin testing them in the sandbox environment. You can merchandise win-back offers in multiple ways, enabling customers to discover and redeem them in the App Store, in their Apple Account in Subscription settings, in your own marketing channels, and in your app. Within your app, you can merchandise win-back offers by using the win-back offer sheet, StoreKit views, or other StoreKit APIs for full customization.\n\nYou can use the sandbox testing environment to simulate redeeming win-back offers in these ways:\n\nHandle the resulting transactions in your app. StoreKit delivers them through the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction\/updates] asynchronous sequence in [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction].\n\nOther types of offers and transactions can also occur outside your app. For testing information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-purchases-made-outside-your-app]. You can also test win-back offers in Xcode, which doesn’t rely on App Store Connect configurations. For more information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-xcode].\n\n### Set up win-back offer testing in App Store Connect and Account Settings\n\nBefore you begin testing in the sandbox environment, use App Store Connect to configure at least one auto-renewable subscription, and at least one win-back offer. Make a note of the product ID of the auto-renewable subscription and the corresponding win-back offer IDs to use in your tests.\n\nOn the iOS device, set up the testing environment by opening Account Settings, as follows:\n\n### Prepare eligibility conditions\n\nIn the sandbox environment, test accounts are automatically eligible for win-back offers when they have an expired subscription. The account needs to have owned the subscription; having access through Family Sharing doesn’t qualify the account for a win-back offer. Also, the account can’t have any active subscriptions from the same subscription group.\n\nTo make your Sandbox Apple Account eligible for a win-back offer, follow these steps:\n\nThe Sandbox Apple Account is now eligible for the win-back offer in the sandbox environment.\n\nRepeat these steps to repeat a test.\n\n### Test redeeming a win-back offer outside the app\n\nTo simulate a win-back offer redemption outside your app, follow these steps:\n\n### Test redeeming an offer in your app using the win-back offer sheet\n\nTo simulate a win-back offer redemption in your app, follow these steps:\n\n### Test redeeming an offer in your app through StoreKit views or your customized code\n\nIf you merchandise the win-back offer using StoreKit views or other StoreKit APIs to fully customize the experience, you can test your implementation in the sandbox environment. Follow these steps:\n\nFor more information about customizing your in-app experience, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/merchandising-win-back-offers-in-your-app] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/supporting-win-back-offers-in-your-app].\n\n### Restart or conclude a test\n\nTo repeat a test and redeem the same win-back offer, cancel the subscription and wait for it to expire. The test account in the sandbox environment is eligible for the same win-back offer after the subscription expires.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment\ncrawled: 2025-12-03T07:22:45Z\n---\n\n# Testing win-back offers in the sandbox environment\n\n**Article**\n\nVerify that your app receives and handles win-back offer transactions, including those made outside your app.\n\n## Overview\n\nAfter you set up win-back offers for auto-renewable subscriptions in App Store Connect, you can begin testing them in the sandbox environment. You can merchandise win-back offers in multiple ways, enabling customers to discover and redeem them in the App Store, in their Apple Account in Subscription settings, in your own marketing channels, and in your app. Within your app, you can merchandise win-back offers by using the win-back offer sheet, StoreKit views, or other StoreKit APIs for full customization.\n\nYou can use the sandbox testing environment to simulate redeeming win-back offers in these ways:\n\n\n\nHandle the resulting transactions in your app. StoreKit delivers them through the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction\/updates] asynchronous sequence in [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction].\n\n\n\nOther types of offers and transactions can also occur outside your app. For testing information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-purchases-made-outside-your-app]. You can also test win-back offers in Xcode, which doesn’t rely on App Store Connect configurations. For more information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-xcode].\n\n### Set up win-back offer testing in App Store Connect and Account Settings\n\nBefore you begin testing in the sandbox environment, use App Store Connect to configure at least one auto-renewable subscription, and at least one win-back offer. Make a note of the product ID of the auto-renewable subscription and the corresponding win-back offer IDs to use in your tests.\n\n\n\nOn the iOS device, set up the testing environment by opening Account Settings, as follows:\n\n1. Open Settings and select Developer.\n2. Select the Sandbox Apple Account. If you’re not yet signed in, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-in-app-purchases-with-sandbox#Sign-in-to-your-Sandbox-Apple-Account-for-a-development-signed-app] to sign in. A popover appears.\n3. Select Manage on the popover. The Account Settings page appears.\n4. Check that the Allow Purchases & Renewals toggle remains on. If it’s off, all purchases fail, which represents a different test case. For more information, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-failing-subscription-renewals-and-in-app-purchases].\n5. Turn on or off the Win-Back Offer Sheet toggle.  Turn it on to enable the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Message] API to display the win-back offer sheet when you launch the app.  Turn it off to prevent the sheet from appearing, even if the customer is eligible for the offer. This toggle only affects sandbox testing.  In either case, StoreKit delivers the new transaction to your app through the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction\/updates] asynchronous sequence in [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction].\n\n### Prepare eligibility conditions\n\nIn the sandbox environment, test accounts are automatically eligible for win-back offers when they have an expired subscription. The account needs to have owned the subscription; having access through Family Sharing doesn’t qualify the account for a win-back offer. Also, the account can’t have any active subscriptions from the same subscription group.\n\nTo make your Sandbox Apple Account eligible for a win-back offer, follow these steps:\n\n1. Cancel any subscriptions that are from the same subscription group as the win-back offer’s subscription.\n2. If the test account has an active subscription through Family Sharing in the same subscription group, it’s ineligible for a win-back offer in that subscription group. To make the account eligible, leave the family group, or stop sharing the subscription with the family.\n3. Wait for the subscription to expire. By default, a monthly subscription expires in 5 minutes in the sandbox. For more information, see [https:\/\/developer.apple.com\/help\/app-store-connect\/test-in-app-purchases\/manage-sandbox-apple-account-settings\/].\n4. Subscribe to the auto-renewable subscription that has the win-back offer you’re testing.\n5. Cancel the subscription and wait for it to expire.\n6. Close the app.\n\nThe Sandbox Apple Account is now eligible for the win-back offer in the sandbox environment.\n\nRepeat these steps to repeat a test.\n\n### Test redeeming a win-back offer outside the app\n\nTo simulate a win-back offer redemption outside your app, follow these steps:\n\n1. Complete the steps in the preceding sections: [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions]. Close your app.\n2. On the Account Settings page (Settings > Developer > Sandbox Apple Account > Manage), select Test Transactions.\n3. Enter the auto-renewable subscription’s product ID and the bundle ID in the applicable text boxes.\n4. Enter the win-back offer ID in the Win-Back ID text box. The win-back offer ID needs to be a valid offer for the product, that you configure in App Store Connect.\n5. The system presents the App Store [Sandbox] payment sheet for the sandbox environment. Confirm the purchase.\n6. Launch your app. StoreKit provides the transaction in the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/Transaction\/updates] asynchronous sequence.\n7. Check that your app receives and processes the win-back offer transaction.\n\n\n\n### Test redeeming an offer in your app using the win-back offer sheet\n\nTo simulate a win-back offer redemption in your app, follow these steps:\n\n1. Complete the steps in the preceding sections: [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions]. Close the app.\n2. On the Account Settings page (Settings > Developer > Sandbox Apple Account > Manage), turn on the Display Win-back Offer Sheet toggle.\n3. Launch your app. The system presents the win-back offer sheet.\n4. Accept the offer. The system presents the App Store [Sandbox] payment sheet for the sandbox environment. Confirm the purchase.\n5. Check that your app receives and processes the win-back offer transaction.\n\n### Test redeeming an offer in your app through StoreKit views or your customized code\n\nIf you merchandise the win-back offer using StoreKit views or other StoreKit APIs to fully customize the experience, you can test your implementation in the sandbox environment. Follow these steps:\n\n1. Complete the steps in the preceding sections to ensure the test account is eligible for one or more win-back offers: [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment#Set-up-win-back-offer-testing-in-App-Store-Connect-and-Account-Settings] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment#Prepare-eligibility-conditions]. Close the app.\n2. Optionally, on the Account Settings page (Settings > Developer > Sandbox Apple Account > Manage), turn off the Display Win-back Offer Sheet toggle to prevent the win-back offer sheet from appearing.\n3. Launch your app. Open your app’s store and exercise the offer API.\n4. StoreKit views automatically chooses an offer to display. If there are multiple offers, your app indicates a preference using the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/View\/preferredSubscriptionOffer(_:)] API.\n\nFor more information about customizing your in-app experience, see [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/merchandising-win-back-offers-in-your-app] and [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/supporting-win-back-offers-in-your-app].\n\n### Restart or conclude a test\n\nTo repeat a test and redeem the same win-back offer, cancel the subscription and wait for it to expire. The test account in the sandbox environment is eligible for the same win-back offer after the subscription expires.\n\n## Payment transactions\n\n- **Testing purchases made outside your app**: Verify that your app receives and handles transactions that occur outside your app, such as subscription purchases, renewals, and offer and promo code redemptions.\n- **Testing an interrupted purchase**: Verify that your app handles an interrupted purchase by inspecting and invoking payment transactions.\n- **Testing failing subscription renewals and In-App Purchases**: Verify that your app handles failed subscription renewals that are in the billing retry or billing grace period states, as well as failed In-App Purchases.\n- **Testing a payment request**: Verify that requests for payment function properly in the sandbox environment by inspecting the calls to the payment transaction observer.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Verify that your app receives and handles transactions that occur outside your app, such as subscription purchases, renewals, and offer and promo code redemptions.",
          "name" : "Testing purchases made outside your app",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-purchases-made-outside-your-app"
        },
        {
          "description" : "Verify that your app handles an interrupted purchase by inspecting and invoking payment transactions.",
          "name" : "Testing an interrupted purchase",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-an-interrupted-purchase"
        },
        {
          "description" : "Verify that your app handles failed subscription renewals that are in the billing retry or billing grace period states, as well as failed In-App Purchases.",
          "name" : "Testing failing subscription renewals and In-App Purchases",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-failing-subscription-renewals-and-in-app-purchases"
        },
        {
          "description" : "Verify that requests for payment function properly in the sandbox environment by inspecting the calls to the payment transaction observer.",
          "name" : "Testing a payment request",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-a-payment-request"
        }
      ],
      "title" : "Payment transactions"
    }
  ],
  "source" : "appleJSON",
  "title" : "Testing win-back offers in the sandbox environment",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/testing-win-back-offers-in-the-sandbox-environment"
}