{
  "abstract" : "Give customers functionality that restores their purchases in your app to maintain access to purchased content.",
  "codeExamples" : [

  ],
  "contentHash" : "9063ce8e745748169c314312b78e39551eef14121c3b52909f111d5e2a61c5a7",
  "crawledAt" : "2025-12-01T12:12:50Z",
  "id" : "4A7773B0-0585-49EE-A474-67224AB9F7F9",
  "kind" : "article",
  "module" : "StoreKit",
  "overview" : "## Overview\n\nCustomers sometimes need to restore purchased content, such as when they upgrade to a new phone. Include some mechanism in your app, such as a Restore Purchases button, to let them restore their purchases.\n\nIn most cases, you only need to refresh the app receipt and deliver the products on the receipt. The refreshed receipt contains a record of the user’s purchases in the app, from any device the user’s App Store account is logged into. However, an app might require an alternative approach under the given circumstances:\n\nRefreshing a receipt doesn’t create new transactions; it requests the latest copy of the receipt from the App Store. Refresh the receipt only once; refreshing it multiple times in a row has the same result.\n\nRestoring completed transactions creates a new transaction for each previously completed transaction, essentially replaying history for your transaction queue observer. Your app maintains its own state to keep track of why it’s restoring completed transactions and how to handle them. Restoring multiple times creates multiple restored transactions for each completed transaction.\n\nGive the user an appropriate level of control over the content that’s downloaded again. For example, don’t automatically download three years of daily newspapers or hundreds of megabytes of game levels at the same time.\n\n### Refresh the app receipt\n\nCreate a receipt refresh request, set a delegate, and start the request. The request supports optional properties for obtaining receipts in various states, such as expired receipts, during testing. For details, see the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKReceiptRefreshRequest\/init(receiptProperties:)] method of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKReceiptRefreshRequest].\n\nAfter the app receipt refreshes, examine it and deliver any additional products, as necessary.\n\n### Restore completed transactions\n\nYour app starts restoring completed transactions by calling the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentQueue\/restoreCompletedTransactions()] method of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentQueue]. This call sends a request to the App Store to restore all of your app’s completed transactions. If your app sets a value for the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKMutablePayment\/applicationUsername] property of its payment requests, use the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentQueue\/restoreCompletedTransactions(withApplicationUsername:)] method to provide the same information when restoring the transactions.\n\nThe App Store generates a new transaction to restore each previously completed transaction. The restored transaction refers to the original transaction. Instances of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransaction] have an [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransaction\/original] property, and the entries in the receipt have an [doc:\/\/com.apple.documentation\/documentation\/AppStoreReceipts\/original_transaction_id] field value.\n\nStoreKit calls the transaction queue observer with a status of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionState\/restored] for each restored transaction, as described in [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/processing-a-transaction]. The action you take depends on your app’s design.\n\nIf your app uses the app receipt and doesn’t have Apple-hosted content, this code isn’t needed because your app doesn’t restore completed transactions. Finish any restored transactions immediately.\n\nIf your app uses the app receipt and has Apple-hosted content, let the user select which products to restore before starting the restoration process. During restoration, download the user-selected content before finishing those transactions, and finish any other transactions immediately.\n\nIf your app doesn’t use the app receipt, it examines all completed transactions as it restores them. It uses a similar code path to the original purchase logic to make the product available and then finishes the transaction. Apps with more than a few products, especially products with associated content, let the user select which products to restore instead of restoring everything. These apps keep track of which completed transactions to process as they restore them, and which transactions to ignore by finishing them immediately without restoring them.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKit\/restoring-purchased-products\ncrawled: 2025-12-01T12:12:50Z\n---\n\n# Restoring purchased products\n\n**Article**\n\nGive customers functionality that restores their purchases in your app to maintain access to purchased content.\n\n## Overview\n\nCustomers sometimes need to restore purchased content, such as when they upgrade to a new phone. Include some mechanism in your app, such as a Restore Purchases button, to let them restore their purchases.\n\n\n\nIn most cases, you only need to refresh the app receipt and deliver the products on the receipt. The refreshed receipt contains a record of the user’s purchases in the app, from any device the user’s App Store account is logged into. However, an app might require an alternative approach under the given circumstances:\n\n- You use Apple-hosted content — Restore completed transactions to give your app the transaction objects it uses to download the content.\n- You need to support your app on devices where the app receipt isn’t available — Restore completed transactions instead.\n- Your app uses non-renewing subscriptions — Your app is responsible for the restoration process.\n\nRefreshing a receipt doesn’t create new transactions; it requests the latest copy of the receipt from the App Store. Refresh the receipt only once; refreshing it multiple times in a row has the same result.\n\nRestoring completed transactions creates a new transaction for each previously completed transaction, essentially replaying history for your transaction queue observer. Your app maintains its own state to keep track of why it’s restoring completed transactions and how to handle them. Restoring multiple times creates multiple restored transactions for each completed transaction.\n\n\n\nGive the user an appropriate level of control over the content that’s downloaded again. For example, don’t automatically download three years of daily newspapers or hundreds of megabytes of game levels at the same time.\n\n### Refresh the app receipt\n\nCreate a receipt refresh request, set a delegate, and start the request. The request supports optional properties for obtaining receipts in various states, such as expired receipts, during testing. For details, see the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKReceiptRefreshRequest\/init(receiptProperties:)] method of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKReceiptRefreshRequest].\n\n\n\nAfter the app receipt refreshes, examine it and deliver any additional products, as necessary.\n\n### Restore completed transactions\n\nYour app starts restoring completed transactions by calling the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentQueue\/restoreCompletedTransactions()] method of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentQueue]. This call sends a request to the App Store to restore all of your app’s completed transactions. If your app sets a value for the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKMutablePayment\/applicationUsername] property of its payment requests, use the [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentQueue\/restoreCompletedTransactions(withApplicationUsername:)] method to provide the same information when restoring the transactions.\n\nThe App Store generates a new transaction to restore each previously completed transaction. The restored transaction refers to the original transaction. Instances of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransaction] have an [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransaction\/original] property, and the entries in the receipt have an [doc:\/\/com.apple.documentation\/documentation\/AppStoreReceipts\/original_transaction_id] field value.\n\n\n\nStoreKit calls the transaction queue observer with a status of [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/SKPaymentTransactionState\/restored] for each restored transaction, as described in [doc:\/\/com.apple.storekit\/documentation\/StoreKit\/processing-a-transaction]. The action you take depends on your app’s design.\n\nIf your app uses the app receipt and doesn’t have Apple-hosted content, this code isn’t needed because your app doesn’t restore completed transactions. Finish any restored transactions immediately.\n\nIf your app uses the app receipt and has Apple-hosted content, let the user select which products to restore before starting the restoration process. During restoration, download the user-selected content before finishing those transactions, and finish any other transactions immediately.\n\n\n\nIf your app doesn’t use the app receipt, it examines all completed transactions as it restores them. It uses a similar code path to the original purchase logic to make the product available and then finishes the transaction. Apps with more than a few products, especially products with associated content, let the user select which products to restore instead of restoring everything. These apps keep track of which completed transactions to process as they restore them, and which transactions to ignore by finishing them immediately without restoring them.\n\n## Providing access to previously purchased products\n\n- **SKReceiptRefreshRequest**: A request to the App Store to get the app receipt, which represents the customer’s transactions with your app.\n- **SKRequest**: An abstract class that represents a request to the App Store.\n- **SKPaymentTransaction**: An object in the payment queue.\n- **SKTerminateForInvalidReceipt()**: Terminates an app if the license to use the app has expired.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A request to the App Store to get the app receipt, which represents the customer’s transactions with your app.",
          "name" : "SKReceiptRefreshRequest",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKReceiptRefreshRequest"
        },
        {
          "description" : "An abstract class that represents a request to the App Store.",
          "name" : "SKRequest",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKRequest"
        },
        {
          "description" : "An object in the payment queue.",
          "name" : "SKPaymentTransaction",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKPaymentTransaction"
        },
        {
          "description" : "Terminates an app if the license to use the app has expired.",
          "name" : "SKTerminateForInvalidReceipt()",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/SKTerminateForInvalidReceipt()"
        }
      ],
      "title" : "Providing access to previously purchased products"
    }
  ],
  "source" : "appleJSON",
  "title" : "Restoring purchased products",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKit\/restoring-purchased-products"
}