{
  "abstract" : "Manage shared content collaboration in your app using CloudKit and iCloud Drive.",
  "codeExamples" : [
    {
      "code" : "\/\/ Create a new collaboration object.\n\nlet itemProvider = NSItemProvider()\nitemProvider.registerCKShare(container: container, allowedSharingOptions: CKAllowedSharingOptions.standard, preparationHandler: {\n    \/\/ Create your share and save to the server or throw an error.\n    return savedShare\n})",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Retrieve an existing collaboration object.\n\nlet itemProvider = NSItemProvider()\nitemProvider.registerCKShare(share, container: container, allowedSharingOptions: CKAllowedSharingOptions.standard)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Present a share sheet in iOS.\n\nlet activityViewController = UIActivityViewController(activityItems: [collaborationObject], applicationActivities: nil)\n\npresentingViewController.present(activityViewController, animated: true)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Present a share popover in macOS.\n\nlet sharingServicePicker = NSSharingServicePicker(items: [collaborationObject])\n\nsharingServicePicker.show(relativeTo: view.bounds, of: view, preferredEdge: .minY)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Provide CloudKit metadata in iOS.\n\nlet configuration = UIActivityItemsConfiguration(itemProviders: [collaborationItemProvider])\nconfiguration.perItemMetadataProvider = { (_, key) in\n    switch key {\n    case .linkPresentationMetadata:\n        \/\/ Create LPLinkMetadata with the title and imageProvider.\n        return metadata\n    default:\n        return nil\n    }\n}\n\nlet activityViewController = UIActivityViewController(activityItemsConfiguration: configuration)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Provide CloudKit metadata in macOS.\n\nlet title = “Shared Item”\nlet image = NSImage(contentsOfFile: “Shared_Item_Preview_Image.png”)\nlet icon = NSImage(contentsOfFile: “App_Icon.png”)\n\nlet previewRepresentingItem = NSPreviewRepresentingActivityItem(item: collaborationItemProvider, title: title, image: image, icon: icon)\n\nlet picker = NSSharingServicePicker(items: [previewRepresentingItem])",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Create a SwiftUI Transferable object.\n\nstruct Note: Transferable {\n    var share: CKShare?\n    func saveCKShareToServer() async throws -> CKShare { … }\n\n    static var transferRepresentation: some TransferRepresentation {\n        CKShareTransferRepresentation { note in\n            if let share = note.share {\n                return .existing(share, container: container, options: options)\n            } else {\n                return .prepareShare(container: container, options: options) {\n                    return try await note.saveCKShareToServer()\n                }\n            }\n        }\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Adopt a SwiftUI ShareLink.\n\nstruct ContentView: View {\n    \/\/ SharedPhoto() returns an object that conforms to the Transferable protocol.\n    @State let photo = SharedPhoto()\n\n    var body: some View {\n        ShareLink(item: photo, preview: SharePreview(photo.title, image: photo.image))\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Initialize the collaboration view.\n\nlet collaborationView = SWCollaborationView(itemProvider: itemProvider)\n\ncollaborationView.activeParticipantCount = myModel.activePeople.count",
      "language" : "swift"
    },
    {
      "code" : "collaborationView.contentView = MyView(model: myModel)",
      "language" : "swift"
    },
    {
      "code" : "collaborationView.manageButtonTitle = \"Custom Manage Button\"",
      "language" : "swift"
    },
    {
      "code" : "let observer = CKSystemSharingUIObserver(container: container)",
      "language" : "swift"
    },
    {
      "code" : "observer.systemSharingUIDidSaveShareBlock = { _, result in\n    switch result {\n    case .success(let share):\n        \/\/ Handle the successful save of a share.\n    case .failure(let error):\n        \/\/ Handle the error for an unsuccessful save.\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "observer.systemSharingUIDidStopSharingBlock = { _, result in\n    switch result {\n    case .success(let share):\n        \/\/ Handle the successful share deletion.\n    case .failure(let error):\n        \/\/ Handle the error when a deletion fails.\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Retrieve the collaboration highlight from the highlight center.\n\nlet highlightCenter: SWHighlightCenter = self.highlightCenter\n\nlet highlight = try highlightCenter.collaborationHighlight(forURL: ckShareURL, error: &error)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Post a change event notice.\n\nlet editEvent = SWHighlightChangeEvent(highlight: highlight, trigger: .edit)\n\nhighlightCenter.postNotice(for: editEvent)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Post a persistence event notice that shows your app renamed a document.\n\nlet renamedEvent = SWHighlightPersistenceEvent(highlight: highlight, trigger: .renamed)\n\nhighlightCenter.postNotice(for: renamedEvent)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Post a membership event notice that shows your app added a collaborator.\n\nlet membershipEvent = SWHighlightMembershipEvent(highlight: highlight, trigger: .addedCollaborator)\n\nhighlightCenter.postNotice(for: membershipEvent)",
      "language" : "swift"
    }
  ],
  "contentHash" : "4517a025d2712c876e0ef13ab029c6384aeffedd17d62e14b995f558b30dd893",
  "crawledAt" : "2025-12-02T07:47:31Z",
  "id" : "36F148D7-2794-4779-BA4F-EE9B57FCBB43",
  "kind" : "article",
  "module" : "Shared with You",
  "overview" : "## Overview\n\nYour app can create collaborations and share content in a Messages conversation by leveraging [doc:\/\/com.apple.documentation\/documentation\/CloudKit] and iCloud Drive to create and store content on the server. Collaborators add a document to conversations by sharing content using Messages. The system displays collaboration activity in Messages conversations and in active FaceTime calls.\n\nThis collaboration process builds on existing technologies, like drag and drop and the system share sheet. If your app doesn’t use [doc:\/\/com.apple.documentation\/documentation\/Foundation\/icloud] for shared content, the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou] framework provides an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYouCore\/SWCollaborationMetadata] object wrapped in [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSItemProvider] to implement a custom collaboration infrastructure.\n\n### Create a collaboration object\n\nIf your app is sharing a file URL using iCloud Drive, that URL is your collaboration object. To manage a CloudKit collaboration, your app uses [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSItemProvider] to register a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] container and create a collaboration object. The system transports your app’s data to other processes using the `CKShare` container.\n\nYour app gives an existing `CKShare` to the collaboration object or provides a preparation handler to create a `CKShare` when collaboration starts. In the example below, your app starts a new collaboration and creates the `CKShare` container.\n\nFor an existing collaboration, your app retrieves the existing collaboration object from the server.\n\n### Present collaboration controls\n\nA collaborator can modify the share options from the share sheet. To add the collaboration controls to the header of a share sheet, your app provides the collaboration object that it created or retrieved from the server.\n\n\n\nIn macOS, a share popover offers similar options to the iOS share sheet.\n\n\n\n### Provide a title and image for the collaboration header\n\nIf your app provides a file as shared data, the system automatically populates a title and image for the collaboration header in the share sheet. Otherwise, if your app uses CloudKit data as shared content, or if you’d like to override the default title and image, you can provide a title and image for the collaboration header.\n\nIn iOS, create a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIActivityItemsConfiguration] with a title and image that your app passes to a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIActivityViewController].\n\nIn macOS, create an [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSPreviewRepresentingActivityItem] with a title, image, and icon that your app passes to an [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSSharingServicePicker]. The image represents the shared content, and the icon represents the source of the shared content.\n\n### Create a SwiftUI transferable object for collaboration through ShareLink\n\nIn SwiftUI, use [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/ShareLink] to support collaboration mode in the share sheet. The object your app shares must adopt [doc:\/\/com.apple.documentation\/documentation\/CoreTransferable\/Transferable], a protocol for sharing and data transfer.\n\nIn the example below, a structure provides a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShareTransferRepresentation] by either returning an existing [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] or creating a new one.\n\nIf your app is sharing a file URL using iCloud Drive, that URL is the `Transferable` object shared through `ShareLink`.\n\nOnce your app creates a `Transferable` object, pass it to `ShareLink`. When your app shares a URL or string, the system automatically creates a preview. Optionally, your app can include a [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/SharePreview] object, which the system uses to display the title and image for the preview.\n\n### Initialize the collaboration view\n\nA collaborator accesses the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationView] using an icon in the navigation bar. This icon shows the app that manages the shared content and the number of collaborators associated with the collaboration.\n\n\n\nThe system handles the layout and formatting of the collaboration view. Your app is responsible for providing the `itemProvider(_:)` and the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationView\/activeParticipantCount]. The [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSItemProvider] contains the [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] for CloudKit-based apps, the file URL for iCloud Drive-based apps, or the `\/SharedWithYouCore\/SWCollaborationMetadata\/Representation` for custom collaboration infrastructures.\n\nTo add a completely customized view on the collaboration view, your app creates a view and assigns it to the `contentView`.\n\nFor CloudKit and iCloud Drive adopters, the collaboration view includes a manage button. The button brings up the manage user interface, where collaborators can add and remove participants or change the share settings. Your app can also assign a custom title to the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationView\/manageButtonTitle]. The title defaults to “Manage Share” if your app doesn’t customize it.\n\nIf your app uses a custom collaboration infrastructure, you must provide your own manage button.\n\n### Observe when a server saves a share\n\nSince your app needs to manage active content sharing, it’s critical to know when a share starts or stops. If your app uses CloudKit or iCloud Drive, Shared with You provides a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKSystemSharingUIObserver] protocol that your app uses to observe and handle updates to collaborations.\n\nFirst, your app passes a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKContainer] to `CKSystemSharingUIObserver` to create an observer.\n\nThen use the [doc:\/\/com.apple.documentation\/documentation\/cloudkit\/cksystemsharinguiobserver\/4027493-systemsharinguididsaveshareblock] in that observer to capture and react to the result of the server-side save of the share.\n\nUse the [doc:\/\/com.apple.documentation\/documentation\/cloudkit\/cksystemsharinguiobserver\/4027494-systemsharinguididstopsharingblo] in that same observer to handle when a share stops.\n\n### Post notices for shared content collaboration\n\nYour app can post notices to summarize updates to a collaboration. These notices appear at the top of the related Messages thread. These updates include changes to the shared content, new mentions, server-side changes, and updates to the collaborators.\n\nTo post a notice, retrieve the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationHighlight] and use it to create an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightEvent] that matches the type of update.\n\nUse [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightChangeEvent] to post a notice about content updates or comments. Use [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightCenter] to retrieve a collaboration highlight with the URL of the [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] your app used to initiate the collaboration.\n\nNext, create an `SWHighlightChangeEvent` instance. The initializer takes an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlight] object and an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightChangeEventTrigger] value. In this case, the app sets the trigger type to [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightChangeEventTrigger\/edit]. Lastly, post the notice for that event to the highlight center.\n\n### Post a persistence event notice\n\nUse the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightPersistenceEvent] to post a notice when your app moves, renames, or deletes content on the server. In the example below, the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightPersistenceEventTrigger\/renamed] trigger type signifies the document name has changed.\n\n### Post a membership event notice\n\nWhen your app alters the membership for a collaboration and triggers a membership event, the system posts an update to the collaborators.\n\nAfter your app retrieves the highlight, create the membership event by passing in the retrieved highlight. Use either [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightMembershipEventTrigger\/addedCollaborator] or [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightMembershipEventTrigger\/removedCollaborator] as the trigger for the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightMembershipEvent].\n\nIf the membership of a Messages group changes, Shared with You keeps collaborators on your shared documents in sync. For CloudKit and iCloud Drive, your app doesn’t have to do anything.\n\n\n\nWhen a person adds someone new to a Messages conversation for a collaboration, the system prompts the document owner in Messages to add them to the share. When a person removes someone from a Messages conversation, the system prompts the document owner in Messages to remove them from the share.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/sharedwithyou\/adding-shared-content-collaboration-to-your-app\ncrawled: 2025-12-02T07:47:31Z\n---\n\n# Adding shared content collaboration to your app\n\n**Article**\n\nManage shared content collaboration in your app using CloudKit and iCloud Drive.\n\n## Overview\n\nYour app can create collaborations and share content in a Messages conversation by leveraging [doc:\/\/com.apple.documentation\/documentation\/CloudKit] and iCloud Drive to create and store content on the server. Collaborators add a document to conversations by sharing content using Messages. The system displays collaboration activity in Messages conversations and in active FaceTime calls.\n\nThis collaboration process builds on existing technologies, like drag and drop and the system share sheet. If your app doesn’t use [doc:\/\/com.apple.documentation\/documentation\/Foundation\/icloud] for shared content, the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou] framework provides an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYouCore\/SWCollaborationMetadata] object wrapped in [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSItemProvider] to implement a custom collaboration infrastructure.\n\n### Create a collaboration object\n\nIf your app is sharing a file URL using iCloud Drive, that URL is your collaboration object. To manage a CloudKit collaboration, your app uses [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSItemProvider] to register a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] container and create a collaboration object. The system transports your app’s data to other processes using the `CKShare` container.\n\nYour app gives an existing `CKShare` to the collaboration object or provides a preparation handler to create a `CKShare` when collaboration starts. In the example below, your app starts a new collaboration and creates the `CKShare` container.\n\n```swift\n\/\/ Create a new collaboration object.\n\nlet itemProvider = NSItemProvider()\nitemProvider.registerCKShare(container: container, allowedSharingOptions: CKAllowedSharingOptions.standard, preparationHandler: {\n    \/\/ Create your share and save to the server or throw an error.\n    return savedShare\n})\n```\n\nFor an existing collaboration, your app retrieves the existing collaboration object from the server.\n\n```swift\n\/\/ Retrieve an existing collaboration object.\n\nlet itemProvider = NSItemProvider()\nitemProvider.registerCKShare(share, container: container, allowedSharingOptions: CKAllowedSharingOptions.standard)\n```\n\n### Present collaboration controls\n\nA collaborator can modify the share options from the share sheet. To add the collaboration controls to the header of a share sheet, your app provides the collaboration object that it created or retrieved from the server.\n\n\n\n```swift\n\/\/ Present a share sheet in iOS.\n\nlet activityViewController = UIActivityViewController(activityItems: [collaborationObject], applicationActivities: nil)\n\npresentingViewController.present(activityViewController, animated: true)\n```\n\nIn macOS, a share popover offers similar options to the iOS share sheet.\n\n\n\n```swift\n\/\/ Present a share popover in macOS.\n\nlet sharingServicePicker = NSSharingServicePicker(items: [collaborationObject])\n\nsharingServicePicker.show(relativeTo: view.bounds, of: view, preferredEdge: .minY)\n```\n\n### Provide a title and image for the collaboration header\n\nIf your app provides a file as shared data, the system automatically populates a title and image for the collaboration header in the share sheet. Otherwise, if your app uses CloudKit data as shared content, or if you’d like to override the default title and image, you can provide a title and image for the collaboration header.\n\nIn iOS, create a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIActivityItemsConfiguration] with a title and image that your app passes to a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIActivityViewController].\n\n```swift\n\/\/ Provide CloudKit metadata in iOS.\n\nlet configuration = UIActivityItemsConfiguration(itemProviders: [collaborationItemProvider])\nconfiguration.perItemMetadataProvider = { (_, key) in\n    switch key {\n    case .linkPresentationMetadata:\n        \/\/ Create LPLinkMetadata with the title and imageProvider.\n        return metadata\n    default:\n        return nil\n    }\n}\n\nlet activityViewController = UIActivityViewController(activityItemsConfiguration: configuration)\n```\n\nIn macOS, create an [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSPreviewRepresentingActivityItem] with a title, image, and icon that your app passes to an [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSSharingServicePicker]. The image represents the shared content, and the icon represents the source of the shared content.\n\n```swift\n\/\/ Provide CloudKit metadata in macOS.\n\nlet title = “Shared Item”\nlet image = NSImage(contentsOfFile: “Shared_Item_Preview_Image.png”)\nlet icon = NSImage(contentsOfFile: “App_Icon.png”)\n\nlet previewRepresentingItem = NSPreviewRepresentingActivityItem(item: collaborationItemProvider, title: title, image: image, icon: icon)\n\nlet picker = NSSharingServicePicker(items: [previewRepresentingItem])\n```\n\n### Create a SwiftUI transferable object for collaboration through ShareLink\n\nIn SwiftUI, use [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/ShareLink] to support collaboration mode in the share sheet. The object your app shares must adopt [doc:\/\/com.apple.documentation\/documentation\/CoreTransferable\/Transferable], a protocol for sharing and data transfer.\n\nIn the example below, a structure provides a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShareTransferRepresentation] by either returning an existing [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] or creating a new one.\n\n```swift\n\/\/ Create a SwiftUI Transferable object.\n\nstruct Note: Transferable {\n    var share: CKShare?\n    func saveCKShareToServer() async throws -> CKShare { … }\n\n    static var transferRepresentation: some TransferRepresentation {\n        CKShareTransferRepresentation { note in\n            if let share = note.share {\n                return .existing(share, container: container, options: options)\n            } else {\n                return .prepareShare(container: container, options: options) {\n                    return try await note.saveCKShareToServer()\n                }\n            }\n        }\n    }\n}\n```\n\nIf your app is sharing a file URL using iCloud Drive, that URL is the `Transferable` object shared through `ShareLink`.\n\nOnce your app creates a `Transferable` object, pass it to `ShareLink`. When your app shares a URL or string, the system automatically creates a preview. Optionally, your app can include a [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/SharePreview] object, which the system uses to display the title and image for the preview.\n\n```swift\n\/\/ Adopt a SwiftUI ShareLink.\n\nstruct ContentView: View {\n    \/\/ SharedPhoto() returns an object that conforms to the Transferable protocol.\n    @State let photo = SharedPhoto()\n\n    var body: some View {\n        ShareLink(item: photo, preview: SharePreview(photo.title, image: photo.image))\n    }\n}\n```\n\n### Initialize the collaboration view\n\nA collaborator accesses the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationView] using an icon in the navigation bar. This icon shows the app that manages the shared content and the number of collaborators associated with the collaboration.\n\n\n\nThe system handles the layout and formatting of the collaboration view. Your app is responsible for providing the `itemProvider(_:)` and the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationView\/activeParticipantCount]. The [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSItemProvider] contains the [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] for CloudKit-based apps, the file URL for iCloud Drive-based apps, or the `\/SharedWithYouCore\/SWCollaborationMetadata\/Representation` for custom collaboration infrastructures.\n\n```swift\n\/\/ Initialize the collaboration view.\n\nlet collaborationView = SWCollaborationView(itemProvider: itemProvider)\n\ncollaborationView.activeParticipantCount = myModel.activePeople.count\n```\n\nTo add a completely customized view on the collaboration view, your app creates a view and assigns it to the `contentView`.\n\n```swift\ncollaborationView.contentView = MyView(model: myModel)\n```\n\nFor CloudKit and iCloud Drive adopters, the collaboration view includes a manage button. The button brings up the manage user interface, where collaborators can add and remove participants or change the share settings. Your app can also assign a custom title to the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationView\/manageButtonTitle]. The title defaults to “Manage Share” if your app doesn’t customize it.\n\n```swift\ncollaborationView.manageButtonTitle = \"Custom Manage Button\"\n```\n\nIf your app uses a custom collaboration infrastructure, you must provide your own manage button.\n\n### Observe when a server saves a share\n\nSince your app needs to manage active content sharing, it’s critical to know when a share starts or stops. If your app uses CloudKit or iCloud Drive, Shared with You provides a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKSystemSharingUIObserver] protocol that your app uses to observe and handle updates to collaborations.\n\nFirst, your app passes a [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKContainer] to `CKSystemSharingUIObserver` to create an observer.\n\n```swift\nlet observer = CKSystemSharingUIObserver(container: container)\n```\n\nThen use the [doc:\/\/com.apple.documentation\/documentation\/cloudkit\/cksystemsharinguiobserver\/4027493-systemsharinguididsaveshareblock] in that observer to capture and react to the result of the server-side save of the share.\n\n```swift\nobserver.systemSharingUIDidSaveShareBlock = { _, result in\n    switch result {\n    case .success(let share):\n        \/\/ Handle the successful save of a share.\n    case .failure(let error):\n        \/\/ Handle the error for an unsuccessful save.\n    }\n}\n```\n\nUse the [doc:\/\/com.apple.documentation\/documentation\/cloudkit\/cksystemsharinguiobserver\/4027494-systemsharinguididstopsharingblo] in that same observer to handle when a share stops.\n\n```swift\nobserver.systemSharingUIDidStopSharingBlock = { _, result in\n    switch result {\n    case .success(let share):\n        \/\/ Handle the successful share deletion.\n    case .failure(let error):\n        \/\/ Handle the error when a deletion fails.\n    }\n}\n```\n\n### Post notices for shared content collaboration\n\nYour app can post notices to summarize updates to a collaboration. These notices appear at the top of the related Messages thread. These updates include changes to the shared content, new mentions, server-side changes, and updates to the collaborators.\n\nTo post a notice, retrieve the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWCollaborationHighlight] and use it to create an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightEvent] that matches the type of update.\n\nUse [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightChangeEvent] to post a notice about content updates or comments. Use [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightCenter] to retrieve a collaboration highlight with the URL of the [doc:\/\/com.apple.documentation\/documentation\/CloudKit\/CKShare] your app used to initiate the collaboration.\n\n```swift\n\/\/ Retrieve the collaboration highlight from the highlight center.\n\nlet highlightCenter: SWHighlightCenter = self.highlightCenter\n\nlet highlight = try highlightCenter.collaborationHighlight(forURL: ckShareURL, error: &error)\n```\n\nNext, create an `SWHighlightChangeEvent` instance. The initializer takes an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlight] object and an [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightChangeEventTrigger] value. In this case, the app sets the trigger type to [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightChangeEventTrigger\/edit]. Lastly, post the notice for that event to the highlight center.\n\n```swift\n\/\/ Post a change event notice.\n\nlet editEvent = SWHighlightChangeEvent(highlight: highlight, trigger: .edit)\n\nhighlightCenter.postNotice(for: editEvent)\n```\n\n### Post a persistence event notice\n\nUse the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightPersistenceEvent] to post a notice when your app moves, renames, or deletes content on the server. In the example below, the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightPersistenceEventTrigger\/renamed] trigger type signifies the document name has changed.\n\n```swift\n\/\/ Post a persistence event notice that shows your app renamed a document.\n\nlet renamedEvent = SWHighlightPersistenceEvent(highlight: highlight, trigger: .renamed)\n\nhighlightCenter.postNotice(for: renamedEvent)\n```\n\n### Post a membership event notice\n\nWhen your app alters the membership for a collaboration and triggers a membership event, the system posts an update to the collaborators.\n\nAfter your app retrieves the highlight, create the membership event by passing in the retrieved highlight. Use either [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightMembershipEventTrigger\/addedCollaborator] or [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightMembershipEventTrigger\/removedCollaborator] as the trigger for the [doc:\/\/com.apple.sharedwithyou\/documentation\/SharedWithYou\/SWHighlightMembershipEvent].\n\n```swift\n\/\/ Post a membership event notice that shows your app added a collaborator.\n\nlet membershipEvent = SWHighlightMembershipEvent(highlight: highlight, trigger: .addedCollaborator)\n\nhighlightCenter.postNotice(for: membershipEvent)\n```\n\nIf the membership of a Messages group changes, Shared with You keeps collaborators on your shared documents in sync. For CloudKit and iCloud Drive, your app doesn’t have to do anything.\n\n\n\nWhen a person adds someone new to a Messages conversation for a collaboration, the system prompts the document owner in Messages to add them to the share. When a person removes someone from a Messages conversation, the system prompts the document owner in Messages to remove them from the share.\n\n## Collaboration\n\n- **Adding custom collaboration to your app**: Integrate your custom collaboration app with Messages.\n- **Collaboration views**: Create and customize a collaboration view to manage the shared content actions.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Integrate your custom collaboration app with Messages.",
          "name" : "Adding custom collaboration to your app",
          "url" : "https:\/\/developer.apple.com\/documentation\/SharedWithYou\/adding-custom-collaboration-to-your-app"
        },
        {
          "description" : "Create and customize a collaboration view to manage the shared content actions.",
          "name" : "Collaboration views",
          "url" : "https:\/\/developer.apple.com\/documentation\/SharedWithYou\/collaboration-views"
        }
      ],
      "title" : "Collaboration"
    }
  ],
  "source" : "appleJSON",
  "title" : "Adding shared content collaboration to your app",
  "url" : "https:\/\/developer.apple.com\/documentation\/sharedwithyou\/adding-shared-content-collaboration-to-your-app"
}