{
  "abstract" : "Sets the offset of the guest timestamp-counter (TSC) relative to the Hypervisor’s TSC clock.",
  "codeExamples" : [
    {
      "code" : "\/\/ initialization - set guest TSC to zero\nint64_t vtsc_offset = - scale * hv_tsc_clock();\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ compute the guest TSC at runtime from the host\nuint64_t vtsc = scale * hv_tsc_clock() + vtsc_offset;\n\n\/\/ guest writing to the IA32_TSC MSR\nvtsc_offset = newTSCvalue - scale * hv_tsc_clock();\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ guest writing to the IA32_TSC_ADJUST MSR\nvtsc_offset += adjustment;\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ at entry to inner hypervisor\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ at entry to inner guest\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset + nested_offset);",
      "language" : "objc"
    }
  ],
  "contentHash" : "1c5a440d7ba86e28571fd997d8500b1a669d3ac0cec02557b7d86083bb0b0f18",
  "crawledAt" : "2025-12-02T14:20:37Z",
  "declaration" : {
    "code" : "func hv_vcpu_set_tsc_relative(_ vcpu: hv_vcpuid_t, _ offset: Int64) -> hv_return_t",
    "language" : "swift"
  },
  "id" : "F7E24522-2FEF-4AFC-883D-FE41C1579543",
  "kind" : "function",
  "module" : "Hypervisor",
  "overview" : "## Return Value\n\n`0` on success, or an [doc:\/\/com.apple.hypervisor\/documentation\/Hypervisor\/hv_return_t] error code.\n\n## Discussion\n\nUse this function to set the TSC-offset field in the VMCS so that the TSC value in the guest is the value of [doc:\/\/com.apple.hypervisor\/documentation\/Hypervisor\/hv_tsc_clock()] plus the given offset. The examples below show simple ways to calculate and set the TSC offset:",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Hypervisor\/hv_vcpu_set_tsc_relative(_:_:)\ncrawled: 2025-12-02T14:20:37Z\n---\n\n# hv_vcpu_set_tsc_relative(_:_:)\n\n**Function**\n\nSets the offset of the guest timestamp-counter (TSC) relative to the Hypervisor’s TSC clock.\n\n## Declaration\n\n```swift\nfunc hv_vcpu_set_tsc_relative(_ vcpu: hv_vcpuid_t, _ offset: Int64) -> hv_return_t\n```\n\n## Parameters\n\n- **vcpu**: The vCPU ID.\n- **offset**: The relative offset value to apply to VMCS TSC-offset field.\n\n## Return Value\n\n`0` on success, or an [doc:\/\/com.apple.hypervisor\/documentation\/Hypervisor\/hv_return_t] error code.\n\n## Discussion\n\nUse this function to set the TSC-offset field in the VMCS so that the TSC value in the guest is the value of [doc:\/\/com.apple.hypervisor\/documentation\/Hypervisor\/hv_tsc_clock()] plus the given offset. The examples below show simple ways to calculate and set the TSC offset:\n\n```objc\n\/\/ initialization - set guest TSC to zero\nint64_t vtsc_offset = - scale * hv_tsc_clock();\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ compute the guest TSC at runtime from the host\nuint64_t vtsc = scale * hv_tsc_clock() + vtsc_offset;\n\n\/\/ guest writing to the IA32_TSC MSR\nvtsc_offset = newTSCvalue - scale * hv_tsc_clock();\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ guest writing to the IA32_TSC_ADJUST MSR\nvtsc_offset += adjustment;\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ at entry to inner hypervisor\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset);\n\n\/\/ at entry to inner guest\nhv_vcpu_tsc_relative_offset(vcpu, vtsc_offset + nested_offset);\n```\n\n## Time-stamp counter functions\n\n- **hv_tsc_clock()**: Returns the value of an abstract clock.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns the value of an abstract clock.",
          "name" : "hv_tsc_clock()",
          "url" : "https:\/\/developer.apple.com\/documentation\/Hypervisor\/hv_tsc_clock()"
        }
      ],
      "title" : "Time-stamp counter functions"
    }
  ],
  "source" : "appleJSON",
  "title" : "hv_vcpu_set_tsc_relative(_:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Hypervisor\/hv_vcpu_set_tsc_relative(_:_:)"
}