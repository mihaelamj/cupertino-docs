{
  "abstract" : "Add an image and other data from a photo capture to the photo library.",
  "codeExamples" : [
    {
      "code" : "var isPhotoLibraryReadWriteAccessGranted: Bool {\n    get async {\n        let status = PHPhotoLibrary.authorizationStatus(for: .readWrite)\n        \n        \/\/ Determine if the user previously authorized read\/write access.\n        var isAuthorized = status == .authorized\n        \n        \/\/ If the system hasn't determined the user's authorization status,\n        \/\/ explicitly prompt them for approval.\n        if status == .notDetermined {\n            isAuthorized = await PHPhotoLibrary.requestAuthorization(for: .readWrite) == .authorized\n        }\n        \n        return isAuthorized\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "func photoOutput(_ output: AVCapturePhotoOutput, didFinishProcessingPhoto photo: AVCapturePhoto, error: Error?) {\n    if let error {\n        print(\"Error processing photo: \\(error.localizedDescription)\")\n        return\n    }\n    \n    Task {\n        await save(photo: photo)\n    }\n}\n\nfunc save(photo: AVCapturePhoto) async {\n    \/\/ Confirm the user granted read\/write access.\n    guard await isPhotoLibraryReadWriteAccessGranted else { return }\n    \n    \/\/ Create a data representation of the photo and its attachments.\n    if let photoData = photo.fileDataRepresentation() {\n        PHPhotoLibrary.shared().performChanges {\n            \/\/ Save the photo data.\n            let creationRequest = PHAssetCreationRequest.forAsset()\n            creationRequest.addResource(with: .photo, data: photoData, options: nil)\n        } completionHandler: { success, error in\n            if let error {\n                print(\"Error saving photo: \\(error.localizedDescription)\")\n                return\n            }\n        }\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "f2812d810101ac24770780b6190cb88a8c81ed9f16b5252370bb5fcb70746e84",
  "crawledAt" : "2025-12-02T19:04:59Z",
  "id" : "E8FC208C-8725-4C6D-84A9-7C391C0F60F5",
  "kind" : "article",
  "language" : "swift",
  "module" : "AVFoundation",
  "overview" : "## Overview\n\nWhen you complete a photo capture with [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoOutput], you receive an [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object that contains the image data, camera metadata, and any auxiliary images you requested, such as thumbnails or depth maps. You can retrieve this data individually from the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object. Or you can call its [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation()] method to get a [doc:\/\/com.apple.documentation\/documentation\/Foundation\/Data] object that’s ready to save using the codec and file format you requested for that photo in [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoSettings].\n\nAfter capturing a photo, use [doc:\/\/com.apple.documentation\/documentation\/PhotoKit] to add that data to the user’s photo library.\n\n### Configure properties and capabilities for your app targets\n\nYou can use [doc:\/\/com.apple.documentation\/documentation\/PhotoKit] to enable read\/write access to the user’s photo library. To do so, provide a static message for the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSPhotoLibraryUsageDescription] key in the `Info.plist` file to display to the user when your app requests access.\n\n\n\nIn macOS, you also need to enable the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.security.personal-information.photos-library] in the Signing & Capabilities tab for your app targets.\n\n\n\n### Request permission to access the user’s photo library\n\nUse the [doc:\/\/com.apple.documentation\/documentation\/Photos\/PHPhotoLibrary] [doc:\/\/com.apple.documentation\/documentation\/Photos\/PHPhotoLibrary\/requestAuthorization(for:handler:)] to request access to the photo library at an appropriate time, such as when the user first opens your app’s camera feature. Here’s an example:\n\n### Use a creation request to add a photo asset\n\nPerform these steps to receive a captured photo and save it to the photo library:\n\nThe following code provides an example of this workflow:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AVFoundation\/saving-captured-photos\ncrawled: 2025-12-02T19:04:59Z\n---\n\n# Saving captured photos\n\n**Article**\n\nAdd an image and other data from a photo capture to the photo library.\n\n## Overview\n\nWhen you complete a photo capture with [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoOutput], you receive an [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object that contains the image data, camera metadata, and any auxiliary images you requested, such as thumbnails or depth maps. You can retrieve this data individually from the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object. Or you can call its [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation()] method to get a [doc:\/\/com.apple.documentation\/documentation\/Foundation\/Data] object that’s ready to save using the codec and file format you requested for that photo in [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoSettings].\n\nAfter capturing a photo, use [doc:\/\/com.apple.documentation\/documentation\/PhotoKit] to add that data to the user’s photo library.\n\n\n\n### Configure properties and capabilities for your app targets\n\nYou can use [doc:\/\/com.apple.documentation\/documentation\/PhotoKit] to enable read\/write access to the user’s photo library. To do so, provide a static message for the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSPhotoLibraryUsageDescription] key in the `Info.plist` file to display to the user when your app requests access.\n\n\n\nIn macOS, you also need to enable the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.security.personal-information.photos-library] in the Signing & Capabilities tab for your app targets.\n\n\n\n\n\n### Request permission to access the user’s photo library\n\nUse the [doc:\/\/com.apple.documentation\/documentation\/Photos\/PHPhotoLibrary] [doc:\/\/com.apple.documentation\/documentation\/Photos\/PHPhotoLibrary\/requestAuthorization(for:handler:)] to request access to the photo library at an appropriate time, such as when the user first opens your app’s camera feature. Here’s an example:\n\n```swift\nvar isPhotoLibraryReadWriteAccessGranted: Bool {\n    get async {\n        let status = PHPhotoLibrary.authorizationStatus(for: .readWrite)\n        \n        \/\/ Determine if the user previously authorized read\/write access.\n        var isAuthorized = status == .authorized\n        \n        \/\/ If the system hasn't determined the user's authorization status,\n        \/\/ explicitly prompt them for approval.\n        if status == .notDetermined {\n            isAuthorized = await PHPhotoLibrary.requestAuthorization(for: .readWrite) == .authorized\n        }\n        \n        return isAuthorized\n    }\n}\n```\n\n\n\n### Use a creation request to add a photo asset\n\nPerform these steps to receive a captured photo and save it to the photo library:\n\n1. Adopt the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoCaptureDelegate] protocol and implement its [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoCaptureDelegate\/photoOutput(_:didFinishProcessingPhoto:error:)] method to receive a callback for each photo delivered in a capture request.\n2. Call [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation()] on the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object provided by the protocol method to receive a data object containing the photo image data and its attachments, such as camera metadata and auxilliary images.\n3. Create a [doc:\/\/com.apple.documentation\/documentation\/Photos\/PHAssetCreationRequest] to add the photo resource.\n\nThe following code provides an example of this workflow:\n\n```swift\nfunc photoOutput(_ output: AVCapturePhotoOutput, didFinishProcessingPhoto photo: AVCapturePhoto, error: Error?) {\n    if let error {\n        print(\"Error processing photo: \\(error.localizedDescription)\")\n        return\n    }\n    \n    Task {\n        await save(photo: photo)\n    }\n}\n\nfunc save(photo: AVCapturePhoto) async {\n    \/\/ Confirm the user granted read\/write access.\n    guard await isPhotoLibraryReadWriteAccessGranted else { return }\n    \n    \/\/ Create a data representation of the photo and its attachments.\n    if let photoData = photo.fileDataRepresentation() {\n        PHPhotoLibrary.shared().performChanges {\n            \/\/ Save the photo data.\n            let creationRequest = PHAssetCreationRequest.forAsset()\n            creationRequest.addResource(with: .photo, data: photoData, options: nil)\n        } completionHandler: { success, error in\n            if let error {\n                print(\"Error saving photo: \\(error.localizedDescription)\")\n                return\n            }\n        }\n    }\n}\n```\n\n## Next steps\n\n- **Tracking photo capture progress**: Monitor key events during capture to provide feedback in your camera UI.\n- **Capturing and saving Live Photos**: Capture Live Photos like those created in the system Camera app and save them to the Photos library.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Monitor key events during capture to provide feedback in your camera UI.",
          "name" : "Tracking photo capture progress",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/tracking-photo-capture-progress"
        },
        {
          "description" : "Capture Live Photos like those created in the system Camera app and save them to the Photos library.",
          "name" : "Capturing and saving Live Photos",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/capturing-and-saving-live-photos"
        }
      ],
      "title" : "Next steps"
    }
  ],
  "source" : "appleJSON",
  "title" : "Saving captured photos",
  "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/saving-captured-photos"
}