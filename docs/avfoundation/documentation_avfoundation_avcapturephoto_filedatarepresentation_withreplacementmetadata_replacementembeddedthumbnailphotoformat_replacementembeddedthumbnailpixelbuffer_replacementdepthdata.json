{
  "abstract" : "Generates and returns a flat data representation of the photo using the specified replacements for some or all of its attachments.",
  "codeExamples" : [

  ],
  "contentHash" : "060d388609cfa437289365f6dcbb1d1e63a87102a72e1fb69657cf86ff175cc9",
  "crawledAt" : "2025-11-30T23:08:18Z",
  "declaration" : {
    "code" : "func fileDataRepresentation(withReplacementMetadata replacementMetadata: [String : Any]?, replacementEmbeddedThumbnailPhotoFormat: [String : Any]?, replacementEmbeddedThumbnailPixelBuffer: CVPixelBuffer?, replacementDepthData: AVDepthData?) -> Data?",
    "language" : "swift"
  },
  "id" : "0B8305AB-5D6D-4240-931F-1674FCCC7945",
  "kind" : "method",
  "module" : "AVFoundation",
  "overview" : "## Return Value\n\nData appropriate for writing to a file of the type specified when requesting photo capture, or `nil` if the photo and attachment data cannot be flattened.\n\n## Discussion\n\nWhen you request a photo capture with the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoOutput] [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoOutput\/capturePhoto(with:delegate:)] method, the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoSettings] object you provide specifies image data formats (such as JPEG and HEVC) and container file formats (such as JFIF and HEIF) for the resulting image file. Calling this method formats and packages the image pixel buffer, along with metadata and other attachments created during capture (such as preview photos and depth maps), into data appropriate for writing to a file of that type.\n\nThis method is equivalent to the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation()] method, but allows you to replace attachments (metadata, preview thumbnail, or depth data) captured along with the photo with alternative data.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation(withReplacementMetadata:replacementEmbeddedThumbnailPhotoFormat:replacementEmbeddedThumbnailPixelBuffer:replacementDepthData:)\ncrawled: 2025-11-30T23:08:18Z\n---\n\n# fileDataRepresentation(withReplacementMetadata:replacementEmbeddedThumbnailPhotoFormat:replacementEmbeddedThumbnailPixelBuffer:replacementDepthData:)\n\n**Instance Method**\n\nGenerates and returns a flat data representation of the photo using the specified replacements for some or all of its attachments.\n\n## Declaration\n\n```swift\nfunc fileDataRepresentation(withReplacementMetadata replacementMetadata: [String : Any]?, replacementEmbeddedThumbnailPhotoFormat: [String : Any]?, replacementEmbeddedThumbnailPixelBuffer: CVPixelBuffer?, replacementDepthData: AVDepthData?) -> Data?\n```\n\n## Parameters\n\n- **replacementMetadata**: A dictionary (see `CGImageProperties` for possible keys and values) containing metadata to embed in the output file data.\n\nTo preserve existing metadata from the photo capture, pass this [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object’s [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/metadata] dictionary. To discard metadata, pass `nil`.\n- **replacementEmbeddedThumbnailPhotoFormat**: A dictionary (see Video Settings Dictionaries for possible keys and values) specifying the data format for a thumbnail preview image to embed in the output file data.\n\nTo preserve the existing thumbnail image from the photo capture, pass this [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object’s [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/embeddedThumbnailPhotoFormat] dictionary. To discard the thumbnail, pass `nil`. (This parameter’s value must be consistent with that of the `replacementEmbeddedThumbnailPixelBuffer` parameter.)\n- **replacementEmbeddedThumbnailPixelBuffer**: A pixel buffer containing a source image to be encoded to the file as the replacement thumbnail image.\n\nTo preserve the existing thumbnail image from the photo capture, pass `nil` for this parameter but pass this [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object’s [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/embeddedThumbnailPhotoFormat] dictionary for the `replacementEmbeddedThumbnailPhotoFormat` parameter.\n\nTo discard the thumbnail, pass `nil` for both `replacementEmbeddedThumbnail` parameters.\n- **replacementDepthData**: Replacement depth data to embed in the output file data.\n\nTo preserve the existing depth data from the photo capture (if any), pass this [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto] object’s [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/depthData] object. To discard depth data, pass `nil`.\n\n## Return Value\n\nData appropriate for writing to a file of the type specified when requesting photo capture, or `nil` if the photo and attachment data cannot be flattened.\n\n## Discussion\n\nWhen you request a photo capture with the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoOutput] [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoOutput\/capturePhoto(with:delegate:)] method, the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhotoSettings] object you provide specifies image data formats (such as JPEG and HEVC) and container file formats (such as JFIF and HEIF) for the resulting image file. Calling this method formats and packages the image pixel buffer, along with metadata and other attachments created during capture (such as preview photos and depth maps), into data appropriate for writing to a file of that type.\n\nThis method is equivalent to the [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation()] method, but allows you to replace attachments (metadata, preview thumbnail, or depth data) captured along with the photo with alternative data.\n\n## Packaging data for file output\n\n- **fileDataRepresentation(with:)**: Gets a customized representation of the photo data.\n- **AVCapturePhotoFileDataRepresentationCustomizer**: A protocol that defines the methods to implement to customize the packaging of photo data.\n- **fileDataRepresentation()**: Generates and returns a flat data representation of the photo and its attachments.\n- **cgImageRepresentation()**: Extracts and returns the captured photo’s primary image as a Core Graphics image object.\n- **previewCGImageRepresentation()**: Extracts and returns the captured photo’s preview image as a Core Graphics image object.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Gets a customized representation of the photo data.",
          "name" : "fileDataRepresentation(with:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation(with:)"
        },
        {
          "description" : "A protocol that defines the methods to implement to customize the packaging of photo data.",
          "name" : "AVCapturePhotoFileDataRepresentationCustomizer",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhotoFileDataRepresentationCustomizer"
        },
        {
          "description" : "Generates and returns a flat data representation of the photo and its attachments.",
          "name" : "fileDataRepresentation()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation()"
        },
        {
          "description" : "Extracts and returns the captured photo’s primary image as a Core Graphics image object.",
          "name" : "cgImageRepresentation()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhoto\/cgImageRepresentation()"
        },
        {
          "description" : "Extracts and returns the captured photo’s preview image as a Core Graphics image object.",
          "name" : "previewCGImageRepresentation()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhoto\/previewCGImageRepresentation()"
        }
      ],
      "title" : "Packaging data for file output"
    }
  ],
  "source" : "appleJSON",
  "title" : "fileDataRepresentation(withReplacementMetadata:replacementEmbeddedThumbnailPhotoFormat:replacementEmbeddedThumbnailPixelBuffer:replacementDepthData:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVCapturePhoto\/fileDataRepresentation(withReplacementMetadata:replacementEmbeddedThumbnailPhotoFormat:replacementEmbeddedThumbnailPixelBuffer:replacementDepthData:)"
}