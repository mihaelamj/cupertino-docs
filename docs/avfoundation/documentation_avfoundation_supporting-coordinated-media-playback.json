{
  "abstract" : "Create synchronized media experiences that enable users to watch and listen across devices.",
  "codeExamples" : [
    {
      "code" : "struct Movie: Hashable, Codable {\n    var url: URL\n    var title: String\n    var description: String\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ A group activity to watch a movie together.\nstruct MovieWatchingActivity: GroupActivity {\n    \n    \/\/ The movie to watch.\n    let movie: Movie\n    \n    \/\/ Metadata that the system displays to participants.\n    var metadata: GroupActivityMetadata {\n        var metadata = GroupActivityMetadata()\n        metadata.type = .watchTogether\n        metadata.fallbackURL = movie.url\n        metadata.title = movie.title\n        return metadata\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Create a new activity for the selected movie.\nlet activity = MovieWatchingActivity(movie: selectedMovie)\n\n\/\/ Await the result of the preparation call.\nswitch await activity.prepareForActivation() {\n    \ncase .activationDisabled:\n    \/\/ Playback coordination isn't active, or the user prefers to play the\n    \/\/ movie apart from the group. Enqueue the movie for local playback only.\n    self.enqueuedMovie = selectedMovie\n    \ncase .activationPreferred:\n    \/\/ The user prefers to share this activity with the group.\n    \/\/ The app enqueues the movie for playback when the activity starts.\n    do {\n        _ = try await activity.activate()\n    } catch {\n        print(\"Unable to activate the activity: \\(error)\")\n    }\n    \ncase .cancelled:\n    \/\/ The user cancels the operation. Do nothing.\n    break\n    \ndefault: ()\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Await new sessions to watch movies together.\nfor await groupSession in MovieWatchingActivity.sessions() {\n    \/\/ Set the app's active group session.\n    self.groupSession = groupSession\n    \n    \/\/ Remove previous subscriptions.\n    subscriptions.removeAll()\n    \n    \/\/ Observe changes to the session state.\n    groupSession.$state.sink { [weak self] state in\n        if case .invalidated = state {\n            \/\/ Set the groupSession to nil to publish\n            \/\/ the invalidated session state.\n            self?.groupSession = nil\n            self?.subscriptions.removeAll()\n        }\n    }.store(in: &subscriptions)\n    \n    \/\/ Join the session to participate in playback coordination.\n    groupSession.join()\n    \n    \/\/ Observe when the local user or a remote participant starts an activity.\n    groupSession.$activity.sink { [weak self] activity in\n        \/\/ Set the movie to enqueue it in the player.\n        self?.enqueuedMovie = activity.movie\n    }.store(in: &subscriptions)\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ The group session to coordinate playback with.\nprivate var groupSession: GroupSession<MovieWatchingActivity>? {\n    didSet {\n        guard let session = groupSession else {\n            \/\/ Stop playback if a session terminates.\n            player.rate = 0\n            return\n        }\n        \/\/ Coordinate playback with the active session.\n        player.playbackCoordinator.coordinateWithSession(session)\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "extension AVCoordinatedPlaybackSuspension.Reason {\n    static var whatHappened = AVCoordinatedPlaybackSuspension.Reason(rawValue: \"com.example.groupwatching.suspension.what-happened\")\n}",
      "language" : "swift"
    },
    {
      "code" : "func performWhatHappened() {\n    \n    \/\/ Rewind 10 seconds.\n    let rewindDuration = CMTime(value: 10, timescale: 1)\n    let rewindTime = player.currentTime() - rewindDuration\n    \n    \/\/ Start a custom suspension.\n    let suspension = player.playbackCoordinator.beginSuspension(for: .whatHappened)\n    player.seek(to: rewindTime)\n    player.rate = 2.0\n    \n    DispatchQueue.main.asyncAfter(deadline: .now() + rewindDuration.seconds) {\n        \/\/ End the suspension and resume playback with the group.\n        suspension.end()\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "d2791043a9d57ebd28e7beed4c87d5f1b54ab355bc85fdc4c5f91498288b18eb",
  "crawledAt" : "2025-12-02T19:11:10Z",
  "id" : "990975E8-8E68-45FD-8E25-11C62A63E386",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "AVFoundation",
  "overview" : "## Overview\n\nWatching TV and movies, and listening to music, can be more fun when you do it with friends and family. However, getting together in person isn’t always an option. Beginning with iOS 15, tvOS 15, and macOS 12, you have the ability to create media apps that let people watch and listen together wherever they are. This capability is possible using AVFoundation and the new GroupActivities frameworks.\n\nAVFoundation introduces a new class, [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayerPlaybackCoordinator], that synchronizes the timing of [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer] objects across devices. Apps use the GroupActivities framework to connect playback coordinators using a [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupSession] object.\n\n\n\nThis sample app shows you how to add coordinated media playback support to your app. It provides a simple movie-playing app, where a user selects a movie from the library and plays it in a standard player user interface.\n\n### Configure the sample code project\n\nTo experience coordinated playback, you need to install the app on two or more devices with unique Apple IDs. Start a FaceTime call between the devices, and select an item from the library on one of them. The system prompts you to play the movie locally or with the group. Select to play it with the group, and starting playback on one device starts it on the other. The system automatically propagates rate and time changes to all playback coordinators to keep group playback in sync.\n\n### Create an activity\n\nThe sample app plays movies, which it represents with a `Movie` structure that defines essential data about an item in its library.\n\nTo make movie watching a group experience, the sample creates a structure called `MovieWatchingActivity` that adopts the [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity] protocol. This protocol defines a shareable experience in the app. The activity stores the movie to share with the group, and provides supporting metadata that the system displays when a user shares an activity.\n\n### Share an activity\n\nWhen a user selects a movie, the sample determines whether it needs to play the movie for the current user only, or share it with the group. It makes this determination by calling the activity’s asynchronous [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity\/prepareForActivation()] method, which enables the system to present an interface for the user to select their preferred action.\n\nThe call returns a result that indicates the appropriate action to take. A result of [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivityActivationResult\/activationDisabled] indicates that group playback isn’t active, or the user selects to play the movie locally only. In this case, the app sets the movie as the `enqueuedMovie`, which enqueues it for local playback. A result of [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivityActivationResult\/activationPreferred] indicates that group playback is possible, and the user wants to start a group activity. When this occurs, the sample calls the activity’s [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity\/activate()] method, which starts a group session and shares the activity with the group. The sample doesn’t immediately enqueue the movie for playback, but instead waits until the group session notifies all participants of the new activity.\n\n### Await group sessions\n\nWhen the sample activates a `MovieWatchingActivity`, the system creates a group session. It accesses the session by calling the [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity\/sessions()] method, which returns sessions for the activity as an asynchronous sequence.\n\nWhen the sample receives a new session, it sets it as the active group session, and then joins it, which makes the app eligible to participate in the session. Then it subscribes to the session’s activity publisher and, when it receives a new value, it enqueues the activity’s movie for playback.\n\n### Prepare for coordinated playback\n\nThe last step the sample takes to enable group playback is to access the player’s coordinator and connect it with the group session. It does this by calling the coordinator object’s [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlaybackCoordinator\/coordinateWithSession(_:)] method, which connects it with the coordinators of other participants in the session.\n\nAfter the sample makes this connection, the system coordinates rate and time changes across participant players. The app continues to enqueue movies in a typical way, and controls playback using the player’s standard transport methods like [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer\/play()], [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer\/pause()], and [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer\/seek(to:)-87h2r]. The coordinator intercepts these changes and communicates them to other coordinators as appropriate. Likewise, it also responds to rate and time changes from other participants and sets them on its local player.\n\n### Suspend participation in coordinated playback\n\nIn most cases, the sample keeps playback in sync with the group. However, there are times when it needs to prevent local interruptions from impacting other participants. In these situations, it disconnects from the group temporarily by issuing a playback suspension. An [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayerPlaybackCoordinator] automatically issues playback suspensions for common system events like network stalls and audio session interruptions. Apps can also define custom suspensions.\n\nThe sample provides a feature that lets a viewer quickly catch up with content they miss. This action doesn’t impact the group, so the app begins a custom playback suspension. It creates an extension on [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCoordinatedPlaybackSuspension\/Reason-swift.struct] that defines a new `whatHappened` suspension reason.\n\nWhen a user taps the feature’s button in the user interface, the sample calls its `performWhatHappened()`  method. In this method, it starts the custom suspension, rewinds by 10 seconds, and then plays at double speed until playback catches up with the group.\n\nAfter the local device catches up with group playback, the sample ends the suspension. Although it sets the player’s rate to `2.0` after beginning the suspension, it doesn’t have to explicitly set it back to the original rate when it ends because the coordinator sets it automatically when the player rejoins group playback.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/avfoundation\/supporting-coordinated-media-playback\ncrawled: 2025-12-02T19:11:10Z\n---\n\n# Supporting coordinated media playback\n\n**Sample Code**\n\nCreate synchronized media experiences that enable users to watch and listen across devices.\n\n## Overview\n\nWatching TV and movies, and listening to music, can be more fun when you do it with friends and family. However, getting together in person isn’t always an option. Beginning with iOS 15, tvOS 15, and macOS 12, you have the ability to create media apps that let people watch and listen together wherever they are. This capability is possible using AVFoundation and the new GroupActivities frameworks.\n\nAVFoundation introduces a new class, [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayerPlaybackCoordinator], that synchronizes the timing of [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer] objects across devices. Apps use the GroupActivities framework to connect playback coordinators using a [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupSession] object.\n\n\n\nThis sample app shows you how to add coordinated media playback support to your app. It provides a simple movie-playing app, where a user selects a movie from the library and plays it in a standard player user interface.\n\n### Configure the sample code project\n\n- You must build the sample with Xcode 13 and Swift 5.5.\n- You must run the sample on a physical device with iOS 15 or later.\n\nTo experience coordinated playback, you need to install the app on two or more devices with unique Apple IDs. Start a FaceTime call between the devices, and select an item from the library on one of them. The system prompts you to play the movie locally or with the group. Select to play it with the group, and starting playback on one device starts it on the other. The system automatically propagates rate and time changes to all playback coordinators to keep group playback in sync.\n\n### Create an activity\n\nThe sample app plays movies, which it represents with a `Movie` structure that defines essential data about an item in its library.\n\n```swift\nstruct Movie: Hashable, Codable {\n    var url: URL\n    var title: String\n    var description: String\n}\n```\n\nTo make movie watching a group experience, the sample creates a structure called `MovieWatchingActivity` that adopts the [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity] protocol. This protocol defines a shareable experience in the app. The activity stores the movie to share with the group, and provides supporting metadata that the system displays when a user shares an activity.\n\n```swift\n\/\/ A group activity to watch a movie together.\nstruct MovieWatchingActivity: GroupActivity {\n    \n    \/\/ The movie to watch.\n    let movie: Movie\n    \n    \/\/ Metadata that the system displays to participants.\n    var metadata: GroupActivityMetadata {\n        var metadata = GroupActivityMetadata()\n        metadata.type = .watchTogether\n        metadata.fallbackURL = movie.url\n        metadata.title = movie.title\n        return metadata\n    }\n}\n```\n\n\n\n### Share an activity\n\nWhen a user selects a movie, the sample determines whether it needs to play the movie for the current user only, or share it with the group. It makes this determination by calling the activity’s asynchronous [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity\/prepareForActivation()] method, which enables the system to present an interface for the user to select their preferred action.\n\n```swift\n\/\/ Create a new activity for the selected movie.\nlet activity = MovieWatchingActivity(movie: selectedMovie)\n\n\/\/ Await the result of the preparation call.\nswitch await activity.prepareForActivation() {\n    \ncase .activationDisabled:\n    \/\/ Playback coordination isn't active, or the user prefers to play the\n    \/\/ movie apart from the group. Enqueue the movie for local playback only.\n    self.enqueuedMovie = selectedMovie\n    \ncase .activationPreferred:\n    \/\/ The user prefers to share this activity with the group.\n    \/\/ The app enqueues the movie for playback when the activity starts.\n    do {\n        _ = try await activity.activate()\n    } catch {\n        print(\"Unable to activate the activity: \\(error)\")\n    }\n    \ncase .cancelled:\n    \/\/ The user cancels the operation. Do nothing.\n    break\n    \ndefault: ()\n}\n```\n\nThe call returns a result that indicates the appropriate action to take. A result of [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivityActivationResult\/activationDisabled] indicates that group playback isn’t active, or the user selects to play the movie locally only. In this case, the app sets the movie as the `enqueuedMovie`, which enqueues it for local playback. A result of [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivityActivationResult\/activationPreferred] indicates that group playback is possible, and the user wants to start a group activity. When this occurs, the sample calls the activity’s [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity\/activate()] method, which starts a group session and shares the activity with the group. The sample doesn’t immediately enqueue the movie for playback, but instead waits until the group session notifies all participants of the new activity.\n\n### Await group sessions\n\nWhen the sample activates a `MovieWatchingActivity`, the system creates a group session. It accesses the session by calling the [doc:\/\/com.apple.documentation\/documentation\/GroupActivities\/GroupActivity\/sessions()] method, which returns sessions for the activity as an asynchronous sequence.\n\n```swift\n\/\/ Await new sessions to watch movies together.\nfor await groupSession in MovieWatchingActivity.sessions() {\n    \/\/ Set the app's active group session.\n    self.groupSession = groupSession\n    \n    \/\/ Remove previous subscriptions.\n    subscriptions.removeAll()\n    \n    \/\/ Observe changes to the session state.\n    groupSession.$state.sink { [weak self] state in\n        if case .invalidated = state {\n            \/\/ Set the groupSession to nil to publish\n            \/\/ the invalidated session state.\n            self?.groupSession = nil\n            self?.subscriptions.removeAll()\n        }\n    }.store(in: &subscriptions)\n    \n    \/\/ Join the session to participate in playback coordination.\n    groupSession.join()\n    \n    \/\/ Observe when the local user or a remote participant starts an activity.\n    groupSession.$activity.sink { [weak self] activity in\n        \/\/ Set the movie to enqueue it in the player.\n        self?.enqueuedMovie = activity.movie\n    }.store(in: &subscriptions)\n}\n```\n\nWhen the sample receives a new session, it sets it as the active group session, and then joins it, which makes the app eligible to participate in the session. Then it subscribes to the session’s activity publisher and, when it receives a new value, it enqueues the activity’s movie for playback.\n\n### Prepare for coordinated playback\n\nThe last step the sample takes to enable group playback is to access the player’s coordinator and connect it with the group session. It does this by calling the coordinator object’s [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlaybackCoordinator\/coordinateWithSession(_:)] method, which connects it with the coordinators of other participants in the session.\n\n```swift\n\/\/ The group session to coordinate playback with.\nprivate var groupSession: GroupSession<MovieWatchingActivity>? {\n    didSet {\n        guard let session = groupSession else {\n            \/\/ Stop playback if a session terminates.\n            player.rate = 0\n            return\n        }\n        \/\/ Coordinate playback with the active session.\n        player.playbackCoordinator.coordinateWithSession(session)\n    }\n}\n```\n\nAfter the sample makes this connection, the system coordinates rate and time changes across participant players. The app continues to enqueue movies in a typical way, and controls playback using the player’s standard transport methods like [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer\/play()], [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer\/pause()], and [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayer\/seek(to:)-87h2r]. The coordinator intercepts these changes and communicates them to other coordinators as appropriate. Likewise, it also responds to rate and time changes from other participants and sets them on its local player.\n\n### Suspend participation in coordinated playback\n\nIn most cases, the sample keeps playback in sync with the group. However, there are times when it needs to prevent local interruptions from impacting other participants. In these situations, it disconnects from the group temporarily by issuing a playback suspension. An [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVPlayerPlaybackCoordinator] automatically issues playback suspensions for common system events like network stalls and audio session interruptions. Apps can also define custom suspensions.\n\nThe sample provides a feature that lets a viewer quickly catch up with content they miss. This action doesn’t impact the group, so the app begins a custom playback suspension. It creates an extension on [doc:\/\/com.apple.avfoundation\/documentation\/AVFoundation\/AVCoordinatedPlaybackSuspension\/Reason-swift.struct] that defines a new `whatHappened` suspension reason.\n\n```swift\nextension AVCoordinatedPlaybackSuspension.Reason {\n    static var whatHappened = AVCoordinatedPlaybackSuspension.Reason(rawValue: \"com.example.groupwatching.suspension.what-happened\")\n}\n```\n\nWhen a user taps the feature’s button in the user interface, the sample calls its `performWhatHappened()`  method. In this method, it starts the custom suspension, rewinds by 10 seconds, and then plays at double speed until playback catches up with the group.\n\n```swift\nfunc performWhatHappened() {\n    \n    \/\/ Rewind 10 seconds.\n    let rewindDuration = CMTime(value: 10, timescale: 1)\n    let rewindTime = player.currentTime() - rewindDuration\n    \n    \/\/ Start a custom suspension.\n    let suspension = player.playbackCoordinator.beginSuspension(for: .whatHappened)\n    player.seek(to: rewindTime)\n    player.rate = 2.0\n    \n    DispatchQueue.main.asyncAfter(deadline: .now() + rewindDuration.seconds) {\n        \/\/ End the suspension and resume playback with the group.\n        suspension.end()\n    }\n}\n```\n\nAfter the local device catches up with group playback, the sample ends the suspension. Although it sets the player’s rate to `2.0` after beginning the suspension, it doesn’t have to explicitly set it back to the original rate when it ends because the coordinator sets it automatically when the player rejoins group playback.\n\n## SharePlay\n\n- **Destination Video**: Leverage SwiftUI to build an immersive media experience in a multiplatform app.\n- **AVPlaybackCoordinator**: An object that coordinates the playback of players in a connected group.\n- **AVPlayerPlaybackCoordinator**: A playback coordinator subclass that coordinates the playback of player objects in a connected group.\n- **AVDelegatingPlaybackCoordinator**: A playback coordinator subclass that coordinates the playback of custom player objects in a connected group.\n- **AVPlaybackCoordinationMedium**\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Leverage SwiftUI to build an immersive media experience in a multiplatform app.",
          "name" : "Destination Video",
          "url" : "https:\/\/developer.apple.com\/documentation\/visionOS\/destination-video"
        },
        {
          "description" : "An object that coordinates the playback of players in a connected group.",
          "name" : "AVPlaybackCoordinator",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVPlaybackCoordinator"
        },
        {
          "description" : "A playback coordinator subclass that coordinates the playback of player objects in a connected group.",
          "name" : "AVPlayerPlaybackCoordinator",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVPlayerPlaybackCoordinator"
        },
        {
          "description" : "A playback coordinator subclass that coordinates the playback of custom player objects in a connected group.",
          "name" : "AVDelegatingPlaybackCoordinator",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVDelegatingPlaybackCoordinator"
        },
        {
          "description" : "",
          "name" : "AVPlaybackCoordinationMedium",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFoundation\/AVPlaybackCoordinationMedium"
        }
      ],
      "title" : "SharePlay"
    }
  ],
  "source" : "appleJSON",
  "title" : "Supporting coordinated media playback",
  "url" : "https:\/\/developer.apple.com\/documentation\/avfoundation\/supporting-coordinated-media-playback"
}