{
  "abstract" : "Create and run activity summary queries.",
  "codeExamples" : [
    {
      "code" : "let calendar = NSCalendar.current\nlet endDate = Date()\n \nguard let startDate = calendar.date(byAdding: .day, value: -7, to: endDate) else {\n    fatalError(\"*** Unable to create the start date ***\")\n}\n\nlet units: Set<Calendar.Component> = [.day, .month, .year, .era]\n\nvar startDateComponents = calendar.dateComponents(units, from: startDate)\nstartDateComponents.calendar = calendar\n\nvar endDateComponents = calendar.dateComponents(units, from: endDate)\nendDateComponents.calendar = calendar\n\n\/\/ Create the predicate for the query\nlet summariesWithinRange = HKQuery.predicate(forActivitySummariesBetweenStart: startDateComponents,\n                                             end: endDateComponents)",
      "language" : "swift"
    },
    {
      "code" : "let query = HKActivitySummaryQuery(predicate: summariesWithinRange) { (query, summariesOrNil, errorOrNil) -> Void in\n    \n    guard let summaries = summariesOrNil else {\n        \/\/ Handle any errors here.\n        return\n    }\n    \n    for summary in summaries {\n        \/\/ Process each summary here.\n    }\n    \n    \/\/ The results come back on an anonymous background queue.\n    \/\/ Dispatch to the main queue before modifying the UI.\n    \n    DispatchQueue.main.async {\n        \/\/ Update the UI here.\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "store.execute(query)",
      "language" : "swift"
    }
  ],
  "contentHash" : "64017245701ca00282f3d5809ca2686c5328c968339b87e66ecf61e48510e517",
  "crawledAt" : "2025-12-03T08:12:54Z",
  "id" : "09AEC445-D899-45D9-8502-244AFD05953F",
  "kind" : "article",
  "language" : "swift",
  "module" : "HealthKit",
  "overview" : "## Overview\n\nUse activity summary queries to read [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKActivitySummary] objects from the HealthKit store. Apps can display summary information using an activity ring view ([doc:\/\/com.apple.healthkit\/documentation\/HealthKitUI\/HKActivityRingView] on iOS or [doc:\/\/com.apple.documentation\/documentation\/WatchKit\/WKInterfaceActivityRing] on watchOS).\n\n### Create the Predicate\n\nStart by creating a predicate for summaries over the previous week.\n\n### Create the Query\n\nThen create an activity summary query by calling the [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKActivitySummaryQuery\/init(predicate:resultsHandler:)] initializer.\n\nThe query returns an array of activity summary objects. The results handler should check for errors before processing the summaries. It should also dispatch updates to the user interface back to the main thread.\n\n### Run the Query\n\nAfter instantiating the query, call the HealthKit store’s [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKHealthStore\/execute(_:)] method.\n\nThis method runs the query on an anonymous background queue. When the query is complete, it executes the results handler on the same background queue (but not necessarily on the same thread).",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/HealthKit\/executing-activity-summary-queries\ncrawled: 2025-12-03T08:12:54Z\n---\n\n# Executing Activity Summary Queries\n\n**Article**\n\nCreate and run activity summary queries.\n\n## Overview\n\nUse activity summary queries to read [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKActivitySummary] objects from the HealthKit store. Apps can display summary information using an activity ring view ([doc:\/\/com.apple.healthkit\/documentation\/HealthKitUI\/HKActivityRingView] on iOS or [doc:\/\/com.apple.documentation\/documentation\/WatchKit\/WKInterfaceActivityRing] on watchOS).\n\n### Create the Predicate\n\nStart by creating a predicate for summaries over the previous week.\n\n```swift\nlet calendar = NSCalendar.current\nlet endDate = Date()\n \nguard let startDate = calendar.date(byAdding: .day, value: -7, to: endDate) else {\n    fatalError(\"*** Unable to create the start date ***\")\n}\n\nlet units: Set<Calendar.Component> = [.day, .month, .year, .era]\n\nvar startDateComponents = calendar.dateComponents(units, from: startDate)\nstartDateComponents.calendar = calendar\n\nvar endDateComponents = calendar.dateComponents(units, from: endDate)\nendDateComponents.calendar = calendar\n\n\/\/ Create the predicate for the query\nlet summariesWithinRange = HKQuery.predicate(forActivitySummariesBetweenStart: startDateComponents,\n                                             end: endDateComponents)\n```\n\n### Create the Query\n\nThen create an activity summary query by calling the [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKActivitySummaryQuery\/init(predicate:resultsHandler:)] initializer.\n\n```swift\nlet query = HKActivitySummaryQuery(predicate: summariesWithinRange) { (query, summariesOrNil, errorOrNil) -> Void in\n    \n    guard let summaries = summariesOrNil else {\n        \/\/ Handle any errors here.\n        return\n    }\n    \n    for summary in summaries {\n        \/\/ Process each summary here.\n    }\n    \n    \/\/ The results come back on an anonymous background queue.\n    \/\/ Dispatch to the main queue before modifying the UI.\n    \n    DispatchQueue.main.async {\n        \/\/ Update the UI here.\n    }\n}\n```\n\nThe query returns an array of activity summary objects. The results handler should check for errors before processing the summaries. It should also dispatch updates to the user interface back to the main thread.\n\n### Run the Query\n\nAfter instantiating the query, call the HealthKit store’s [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKHealthStore\/execute(_:)] method.\n\n```swift\nstore.execute(query)\n```\n\nThis method runs the query on an anonymous background queue. When the query is complete, it executes the results handler on the same background queue (but not necessarily on the same thread).\n\n## Creating activity summary queries\n\n- **init(predicate:resultsHandler:)**: Initializes a new active summary query.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Initializes a new active summary query.",
          "name" : "init(predicate:resultsHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKActivitySummaryQuery\/init(predicate:resultsHandler:)"
        }
      ],
      "title" : "Creating activity summary queries"
    }
  ],
  "source" : "appleJSON",
  "title" : "Executing Activity Summary Queries",
  "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/executing-activity-summary-queries"
}