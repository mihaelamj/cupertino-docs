{
  "abstract" : "A query that performs complex searches based on the correlation’s contents, and returns a snapshot of all matching samples.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSObjectProtocol",
    "Sendable",
    "SendableMetatype"
  ],
  "contentHash" : "cee8eefd051d1364294e87d68aebd67d6dcf7f4cdb59216dee1bbe1ac51d7b8b",
  "crawledAt" : "2025-12-02T18:11:09Z",
  "declaration" : {
    "code" : "class HKCorrelationQuery",
    "language" : "swift"
  },
  "id" : "0354CC43-11D8-41A1-82B0-755D9E7662EE",
  "kind" : "class",
  "language" : "swift",
  "module" : "HealthKit",
  "overview" : "## Overview\n\nCorrelation samples act as a container, grouping multiple quantity or category samples. While you can use [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKSample] objects to search for correlations, correlation queries allow more complex filtering based on the contained samples. Specifically, correlation queries let you provide a separate predicate for each of the sample types stored in the correlation. A correlation is  returned only if the correlation’s predicate and all of the sample predicates match.\n\n### Requesting Permission to Share and Read\n\nUnlike other sample types, you do not request permission to share and read correlation types directly. Instead, you request permission to share and read each of the sample types contained within the correlation.\n\nWhen saving a correlation, the app must have permission to share all of the contained objects. If the app does not have permission to share one or more of the contained objects, the operation fails.\n\nWhen your app queries for correlation data, HealthKit only returns samples that contain objects you have permission to read. If the app has permission to read only some of the contained objects, HealthKit still returns the correlation; however, the correlation appears to only contain those objects that your app has permission to read. HealthKit hides all of the other contained objects from your app.\n\n### Executing Queries\n\nYou create a correlation query by calling the [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKCorrelationQuery\/init(type:predicate:samplePredicates:completion:)] initializer. After the query is instantiated, you run it by calling the HealthKit store’s [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKHealthStore\/execute(_:)] method. This method runs the query on an anonymous background queue. When the query is complete, it executes the results handler on the same background queue (though not necessarily the same thread). Typically, you dispatch these results back to the main thread to update your user interface.\n\nThe following example builds a correlation query that searches for food samples with more than 800 calories.\n\nIt begins by setting up an array to store our high calorie foods. Next, the sample code creates a predicate that matches quantities greater than or equal to 800 kcal. It then creates a dictionary using a quantity type object for dietary energy consumed as the key and the newly-created predicate as the value. It uses this dictionary as the sample predicates for a correlation query.\n\nIn the query’s completion handler, the sample code first checks to see if an error occurred. If no errors occurred, it adds the results to the array of high calorie foods. Then it logs the number of matching samples found, and the contents of the high calorie foods array.\n\nOnce the sample code finishes declaring the completion handler, the query is ready to use. The sample code simply executes the query on the HeathKit store.\n\n### Subclassing Correlation Queries\n\nLike many HealthKit classes, the `HKCorrelationQuery` class should not be subclassed.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/HealthKit\/HKCorrelationQuery\ncrawled: 2025-12-02T18:11:09Z\n---\n\n# HKCorrelationQuery\n\n**Class**\n\nA query that performs complex searches based on the correlation’s contents, and returns a snapshot of all matching samples.\n\n## Declaration\n\n```swift\nclass HKCorrelationQuery\n```\n\n## Overview\n\nCorrelation samples act as a container, grouping multiple quantity or category samples. While you can use [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKSample] objects to search for correlations, correlation queries allow more complex filtering based on the contained samples. Specifically, correlation queries let you provide a separate predicate for each of the sample types stored in the correlation. A correlation is  returned only if the correlation’s predicate and all of the sample predicates match.\n\n### Requesting Permission to Share and Read\n\nUnlike other sample types, you do not request permission to share and read correlation types directly. Instead, you request permission to share and read each of the sample types contained within the correlation.\n\nWhen saving a correlation, the app must have permission to share all of the contained objects. If the app does not have permission to share one or more of the contained objects, the operation fails.\n\nWhen your app queries for correlation data, HealthKit only returns samples that contain objects you have permission to read. If the app has permission to read only some of the contained objects, HealthKit still returns the correlation; however, the correlation appears to only contain those objects that your app has permission to read. HealthKit hides all of the other contained objects from your app.\n\n### Executing Queries\n\nYou create a correlation query by calling the [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKCorrelationQuery\/init(type:predicate:samplePredicates:completion:)] initializer. After the query is instantiated, you run it by calling the HealthKit store’s [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKHealthStore\/execute(_:)] method. This method runs the query on an anonymous background queue. When the query is complete, it executes the results handler on the same background queue (though not necessarily the same thread). Typically, you dispatch these results back to the main thread to update your user interface.\n\nThe following example builds a correlation query that searches for food samples with more than 800 calories.\n\n\n\nIt begins by setting up an array to store our high calorie foods. Next, the sample code creates a predicate that matches quantities greater than or equal to 800 kcal. It then creates a dictionary using a quantity type object for dietary energy consumed as the key and the newly-created predicate as the value. It uses this dictionary as the sample predicates for a correlation query.\n\nIn the query’s completion handler, the sample code first checks to see if an error occurred. If no errors occurred, it adds the results to the array of high calorie foods. Then it logs the number of matching samples found, and the contents of the high calorie foods array.\n\nOnce the sample code finishes declaring the completion handler, the query is ready to use. The sample code simply executes the query on the HeathKit store.\n\n### Subclassing Correlation Queries\n\nLike many HealthKit classes, the `HKCorrelationQuery` class should not be subclassed.\n\n## Creating Correlation Queries\n\n- **init(type:predicate:samplePredicates:completion:)**: Instantiates and returns a correlation query.\n\n## Getting Property Data\n\n- **correlationType**: The type of correlation to search for.\n- **samplePredicates**: A dictionary whose keys are [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKSampleType] instances and whose values are [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSPredicate] instances.\n\n## Basic queries\n\n- **HKSampleQueryDescriptor**: A query interface that reads samples using Swift concurrency.\n- **HKSampleQuery**: A general query that returns a snapshot of all the matching samples currently saved in the HealthKit store.\n- **HKQueryDescriptor**: A descriptor that specifies a set of samples based on the data type and a predicate.\n- **HKQuery**: An abstract class for all the query classes in HealthKit.\n\n## Inherits From\n\n- HKQuery\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSObjectProtocol\n- Sendable\n- SendableMetatype\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Instantiates and returns a correlation query.",
          "name" : "init(type:predicate:samplePredicates:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKCorrelationQuery\/init(type:predicate:samplePredicates:completion:)"
        }
      ],
      "title" : "Creating Correlation Queries"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The type of correlation to search for.",
          "name" : "correlationType",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKCorrelationQuery\/correlationType"
        },
        {
          "description" : "A dictionary whose keys are [doc:\/\/com.apple.healthkit\/documentation\/HealthKit\/HKSampleType] instances and whose values are [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSPredicate] instances.",
          "name" : "samplePredicates",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKCorrelationQuery\/samplePredicates"
        }
      ],
      "title" : "Getting Property Data"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A query interface that reads samples using Swift concurrency.",
          "name" : "HKSampleQueryDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKSampleQueryDescriptor"
        },
        {
          "description" : "A general query that returns a snapshot of all the matching samples currently saved in the HealthKit store.",
          "name" : "HKSampleQuery",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKSampleQuery"
        },
        {
          "description" : "A descriptor that specifies a set of samples based on the data type and a predicate.",
          "name" : "HKQueryDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKQueryDescriptor"
        },
        {
          "description" : "An abstract class for all the query classes in HealthKit.",
          "name" : "HKQuery",
          "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKQuery"
        }
      ],
      "title" : "Basic queries"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "HKQuery"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "HKCorrelationQuery",
  "url" : "https:\/\/developer.apple.com\/documentation\/HealthKit\/HKCorrelationQuery"
}