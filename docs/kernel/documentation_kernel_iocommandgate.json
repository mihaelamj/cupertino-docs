{
  "abstract" : "Single-threaded work-loop client request mechanism.",
  "codeExamples" : [

  ],
  "contentHash" : "148f1d1e921ee5564cbbd56d420e52db71b9a3aac0211cffac95d2643818fc22",
  "crawledAt" : "2025-12-07T00:43:26Z",
  "declaration" : {
    "code" : "class IOCommandGate : IOEventSource",
    "language" : "swift"
  },
  "id" : "4275F3F6-6F47-4CEA-B7FA-B0F526CEF13B",
  "kind" : "class",
  "language" : "occ",
  "module" : "Kernel",
  "overview" : "## Overview\n\nAn IOCommandGate instance is an extremely lightweight mechanism that executes an action on the driver's work-loop. 'On the work-loop' is actually a lie but the work-loop single threaded semantic is maintained for this event source. Using the work-loop gate rather than execution by the workloop. The command gate tests for a potential self dead lock by checking if the runCommand request is made from the work-loop's thread, it doesn't check for a mutual dead lock though where a pair of work loop's dead lock each other.\n\nThe IOCommandGate is a lighter weight version of the IOCommandQueue and should be used in preference. Generally use a command queue whenever you need a client to submit a request to a work loop. A typical command gate action would check if the hardware is active, if so it will add the request to a pending queue internal to the device or the device's family. Otherwise if the hardware is inactive then this request can be acted upon immediately.\n\nCAUTION: The runAction, runCommand, and attemptCommand functions cannot be called from an interrupt context.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\ncrawled: 2025-12-07T00:43:26Z\n---\n\n# IOCommandGate\n\n**Class**\n\nSingle-threaded work-loop client request mechanism.\n\n## Declaration\n\n```swift\nclass IOCommandGate : IOEventSource\n```\n\n## Overview\n\nAn IOCommandGate instance is an extremely lightweight mechanism that executes an action on the driver's work-loop. 'On the work-loop' is actually a lie but the work-loop single threaded semantic is maintained for this event source. Using the work-loop gate rather than execution by the workloop. The command gate tests for a potential self dead lock by checking if the runCommand request is made from the work-loop's thread, it doesn't check for a mutual dead lock though where a pair of work loop's dead lock each other.\n\nThe IOCommandGate is a lighter weight version of the IOCommandQueue and should be used in preference. Generally use a command queue whenever you need a client to submit a request to a work loop. A typical command gate action would check if the hardware is active, if so it will add the request to a pending queue internal to the device or the device's family. Otherwise if the hardware is inactive then this request can be acted upon immediately.\n\nCAUTION: The runAction, runCommand, and attemptCommand functions cannot be called from an interrupt context.\n\n## Miscellaneous\n\n- **attemptAction**: Single thread a call to an action with the target work-loop.\n- **attemptCommand**: Single thread a command with the target work-loop.\n- **commandGate**: Factory method to create and initialise an IOCommandGate, See $link init.\n- **commandSleep(void *, AbsoluteTime, UInt32)**: Put a thread that is currently holding the command gate to sleep.\n- **commandSleep(void *, UInt32)**: Put a thread that is currently holding the command gate to sleep.\n- **commandWakeup**: Wakeup one or more threads that are asleep on an event.\n- **disable**: Disable the command gate\n- **enable**: Enable command gate, this will unblock any blocked Commands and Actions.\n- **init**: Class initialiser.\n- **runAction**: Single thread a call to an action with the target work-loop.\n- **runCommand**: Single thread a command with the target work-loop.\n\n## Callbacks\n\n- **Action**\n\n## DataTypes\n\n- **ExpansionData**\n\n## Instance Variables\n\n- **reserved**\n\n## Instance Methods\n\n- **attemptAction**\n- **attemptCommand**\n- **commandSleep**\n- **commandSleep**\n- **commandWakeup**\n- **disable**\n- **enable**\n- **free**\n- **getMetaClass**\n- **init**\n- **runAction**\n- **runActionBlock**\n- **runCommand**\n- **setWorkLoop**\n\n## Type Methods\n\n- **commandGate**\n\n## Base Types\n\n- **IOCommandPool**: Manipulates a pool of commands which inherit from IOCommand.\n- **IOCommand**: This class is an abstract class which represents an I\/O command.\n- **IODispatchSource**\n- **IOEventSource**: Abstract class for all work-loop event sources.\n\n## Inherits From\n\n- IOEventSource\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Single thread a call to an action with the target work-loop.",
          "name" : "attemptAction",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811105-attemptaction"
        },
        {
          "description" : "Single thread a command with the target work-loop.",
          "name" : "attemptCommand",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811141-attemptcommand"
        },
        {
          "description" : "Factory method to create and initialise an IOCommandGate, See $link init.",
          "name" : "commandGate",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811293-commandgate"
        },
        {
          "description" : "Put a thread that is currently holding the command gate to sleep.",
          "name" : "commandSleep(void *, AbsoluteTime, UInt32)",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811482-commandsleep"
        },
        {
          "description" : "Put a thread that is currently holding the command gate to sleep.",
          "name" : "commandSleep(void *, UInt32)",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811498-commandsleep"
        },
        {
          "description" : "Wakeup one or more threads that are asleep on an event.",
          "name" : "commandWakeup",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811517-commandwakeup"
        },
        {
          "description" : "Disable the command gate",
          "name" : "disable",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811531-disable"
        },
        {
          "description" : "Enable command gate, this will unblock any blocked Commands and Actions.",
          "name" : "enable",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811547-enable"
        },
        {
          "description" : "Class initialiser.",
          "name" : "init",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811560-init"
        },
        {
          "description" : "Single thread a call to an action with the target work-loop.",
          "name" : "runAction",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811576-runaction"
        },
        {
          "description" : "Single thread a command with the target work-loop.",
          "name" : "runCommand",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1811585-runcommand"
        }
      ],
      "title" : "Miscellaneous"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "Action",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/ioworkloop\/action"
        }
      ],
      "title" : "Callbacks"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "ExpansionData",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/ioservice\/expansiondata"
        }
      ],
      "title" : "DataTypes"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "reserved",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/reserved"
        }
      ],
      "title" : "Instance Variables"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "attemptAction",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573823-attemptaction"
        },
        {
          "name" : "attemptCommand",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573825-attemptcommand"
        },
        {
          "name" : "commandSleep",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573818-commandsleep"
        },
        {
          "name" : "commandSleep",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/3516447-commandsleep"
        },
        {
          "name" : "commandWakeup",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573826-commandwakeup"
        },
        {
          "name" : "disable",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573828-disable"
        },
        {
          "name" : "enable",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573822-enable"
        },
        {
          "name" : "free",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573821-free"
        },
        {
          "name" : "getMetaClass",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573820-getmetaclass"
        },
        {
          "name" : "init",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573817-init"
        },
        {
          "name" : "runAction",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573816-runaction"
        },
        {
          "name" : "runActionBlock",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/2967266-runactionblock"
        },
        {
          "name" : "runCommand",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573824-runcommand"
        },
        {
          "name" : "setWorkLoop",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573827-setworkloop"
        }
      ],
      "title" : "Instance Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "commandGate",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate\/1573819-commandgate"
        }
      ],
      "title" : "Type Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Manipulates a pool of commands which inherit from IOCommand.",
          "name" : "IOCommandPool",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandpool"
        },
        {
          "description" : "This class is an abstract class which represents an I\/O command.",
          "name" : "IOCommand",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommand"
        },
        {
          "name" : "IODispatchSource",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iodispatchsource"
        },
        {
          "description" : "Abstract class for all work-loop event sources.",
          "name" : "IOEventSource",
          "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/ioeventsource"
        }
      ],
      "title" : "Base Types"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "IOEventSource"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "IOCommandGate",
  "url" : "https:\/\/developer.apple.com\/documentation\/kernel\/iocommandgate"
}