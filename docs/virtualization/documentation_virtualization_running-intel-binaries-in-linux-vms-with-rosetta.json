{
  "abstract" : "Run x86_64 Linux binaries under ARM Linux on Apple silicon.",
  "codeExamples" : [
    {
      "code" : "% mkdir \/tmp\/mountpoint\n% sudo mount -t virtiofs EXAMPLE_TAG \/tmp\/mountpoint\n% ls \/tmp\/mountpoint rosetta\n% sudo \/usr\/sbin\/update-binfmts --install rosetta \/tmp\/mountpoint\/rosetta \\\n    --magic \"\\x7fELF\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x3e\\x00\" \\\n    --mask \"\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xfe\\xff\\xff\\xff\" \\\n    --credentials yes --preserve yes --fix-binary yes",
      "language" : "bash"
    }
  ],
  "contentHash" : "9e5609040d0fe66b35b7b982d6bb3edc7876846dd5e044a6598446b3b76a9299",
  "crawledAt" : "2025-12-02T15:58:14Z",
  "id" : "AF352CC0-672A-4CEF-A9A0-D6077A3FDFB6",
  "kind" : "article",
  "language" : "swift",
  "module" : "Virtualization",
  "overview" : "## Overview\n\nIn macOS 13 and later on Mac computers with Apple silicon chips, the Virtualization framework supports Rosetta in ARM Linux virtual machines (VMs). Rosetta is a translation process that allows users to run apps that contain x86_64 instructions on Apple silicon. In macOS, this allows apps built for Intel-based Mac computers to run seamlessly on Apple silicon; Rosetta allows the same capability for Intel Linux apps in ARM Linux VMs.\n\n### Test for Rosetta Availability\n\nBefore trying to install, run, or activate Rosetta, your app should check to ensure that the capability is available in the version of macOS running on the host computer. The [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaDirectoryShare\/availability] class method returns a value from the [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaAvailability] enumeration that describes whether the current host supports Rosetta or if the capability is already installed on the host Mac. The example below shows the process for checking for Rosetta availability:\n\n### Install Rosetta\n\nInstalling Rosetta is a one-time process per computer that requires the user to grant permission for the system to install Rosetta. If Rosetta is already installed in macOS, the system activates it for use under the Virtualization framework; if Rosetta isn’t installed, the framework downloads the installer from the network and performs the installation. The installer interactively prompts the user for authorization, and your app should handle any of the possible error conditions that could occur during the authorization, download, and installation process. The example below shows how to start the installation:\n\n### Create the Rosetta Directory Share\n\nAfter installing Rosetta, your app needs to configure a Rosetta directory share in the Linux guest. The shared directory must have a tag that uniquely identifies the share and that you validate using [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZVirtioFileSystemDeviceConfiguration\/validateTag(_:)] to ensure it conforms to the length and format for file system tags:\n\n### Mount the Shared Directory and Register Rosetta\n\nIn order to use Rosetta in the Linux guest, the user must mount the Rosetta share in the guest VM and install Rosetta as the application the system uses to run x86_64 binaries using the following process:\n\nThe example below lists the commands, with the exception of the `update-binfmts` command installation, required to enable Rosetta in the Linux guest:\n\n### Ensure Shared Libraries are Available for Dynamically Linked Apps\n\nRosetta can run statically linked x86_64 binaries without additional configuration. Binaries that are dynamically linked and that depend on shared libraries require the installation of the shared libraries, or library hierarchies, in the Linux guest in paths that are accessible to both the user and to Rosetta.\n\n### Configure Rosetta’s ahead of time (AOT) caching options\n\nIn macOS 14 and later, Rosetta supports options that allow you control the ahead of time (AOT) cache characteristics; this can improve the performance of some X86 workloads.\n\nThere are two modes of operation for AOT caching: The first is communication using a Unix Domain Socket where the Virtualization framework shares a file that represents the socket between the Rosetta daemon and Rosetta runtime through a symlink or bind-mount. The second is communication through an abstract socket where the framework defines a shared name rather than a shared file. \n\nYou enable these options after you create the Rosetta directory share by setting one of the [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaDirectoryShare\/CachingOptions-swift.enum] using [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaDirectoryShare\/setCachingOptions(_:)]. This example shows how to configure Rosetta’s caching options in a new virtual machine configuration using a Unix Domain Socket though a shared, named file:\n\nThe following example shows how to configure Rosetta’s caching options in a new virtual machine configuration using an abstract socket:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Virtualization\/running-intel-binaries-in-linux-vms-with-rosetta\ncrawled: 2025-12-02T15:58:14Z\n---\n\n# Running Intel Binaries in Linux VMs with Rosetta\n\n**Article**\n\nRun x86_64 Linux binaries under ARM Linux on Apple silicon.\n\n## Overview\n\nIn macOS 13 and later on Mac computers with Apple silicon chips, the Virtualization framework supports Rosetta in ARM Linux virtual machines (VMs). Rosetta is a translation process that allows users to run apps that contain x86_64 instructions on Apple silicon. In macOS, this allows apps built for Intel-based Mac computers to run seamlessly on Apple silicon; Rosetta allows the same capability for Intel Linux apps in ARM Linux VMs.\n\n\n\n### Test for Rosetta Availability\n\nBefore trying to install, run, or activate Rosetta, your app should check to ensure that the capability is available in the version of macOS running on the host computer. The [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaDirectoryShare\/availability] class method returns a value from the [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaAvailability] enumeration that describes whether the current host supports Rosetta or if the capability is already installed on the host Mac. The example below shows the process for checking for Rosetta availability:\n\n\n\n### Install Rosetta\n\nInstalling Rosetta is a one-time process per computer that requires the user to grant permission for the system to install Rosetta. If Rosetta is already installed in macOS, the system activates it for use under the Virtualization framework; if Rosetta isn’t installed, the framework downloads the installer from the network and performs the installation. The installer interactively prompts the user for authorization, and your app should handle any of the possible error conditions that could occur during the authorization, download, and installation process. The example below shows how to start the installation:\n\n\n\n### Create the Rosetta Directory Share\n\nAfter installing Rosetta, your app needs to configure a Rosetta directory share in the Linux guest. The shared directory must have a tag that uniquely identifies the share and that you validate using [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZVirtioFileSystemDeviceConfiguration\/validateTag(_:)] to ensure it conforms to the length and format for file system tags:\n\n\n\n### Mount the Shared Directory and Register Rosetta\n\nIn order to use Rosetta in the Linux guest, the user must mount the Rosetta share in the guest VM and install Rosetta as the application the system uses to run x86_64 binaries using the following process:\n\n\n\n1. Install the `update-binfmts` command, if necessary. The command is part of the binfmt-support package in most Linux distributions; installation methods vary by distribution. Additionally, in order to run this command, the user must be able to use the `sudo` command, which requires adding their username to the system’s `\/etc\/sudoers` file.\n2. Create a directory as a mount point.\n3. Mount the VirtioFS file system tag to the mount point. This is the file system tag the app uses to identify the share and must be the same as the tag the user specifies on the command line demonstrated here.\n4. Check if the mounted directory has the Rosetta runtime. You should see `rosetta` in the mounted directory.\n5. Register the Rosetta runtime binary as the handler for x86_64 ELF format executable files using the `update-binfmts` command. The `magic` parameter describes the first 20 bytes of the ELF header for x86_64 binaries. The Linux kernel performs a bitwise logical `AND` with the first 20 bytes of a binary a user attempts to run with the `mask` value. If it matches the `magic` value, the kernel uses the registered handler as the interpreter for that binary. If the system can’t find a handler for the specified binary, it reports an error.\n\nThe example below lists the commands, with the exception of the `update-binfmts` command installation, required to enable Rosetta in the Linux guest:\n\n\n\n```bash\n% mkdir \/tmp\/mountpoint\n% sudo mount -t virtiofs EXAMPLE_TAG \/tmp\/mountpoint\n% ls \/tmp\/mountpoint rosetta\n% sudo \/usr\/sbin\/update-binfmts --install rosetta \/tmp\/mountpoint\/rosetta \\\n    --magic \"\\x7fELF\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x3e\\x00\" \\\n    --mask \"\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xfe\\xff\\xff\\xff\" \\\n    --credentials yes --preserve yes --fix-binary yes\n```\n\n### Ensure Shared Libraries are Available for Dynamically Linked Apps\n\nRosetta can run statically linked x86_64 binaries without additional configuration. Binaries that are dynamically linked and that depend on shared libraries require the installation of the shared libraries, or library hierarchies, in the Linux guest in paths that are accessible to both the user and to Rosetta.\n\n### Configure Rosetta’s ahead of time (AOT) caching options\n\nIn macOS 14 and later, Rosetta supports options that allow you control the ahead of time (AOT) cache characteristics; this can improve the performance of some X86 workloads.\n\nThere are two modes of operation for AOT caching: The first is communication using a Unix Domain Socket where the Virtualization framework shares a file that represents the socket between the Rosetta daemon and Rosetta runtime through a symlink or bind-mount. The second is communication through an abstract socket where the framework defines a shared name rather than a shared file. \n\nYou enable these options after you create the Rosetta directory share by setting one of the [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaDirectoryShare\/CachingOptions-swift.enum] using [doc:\/\/com.apple.virtualization\/documentation\/Virtualization\/VZLinuxRosettaDirectoryShare\/setCachingOptions(_:)]. This example shows how to configure Rosetta’s caching options in a new virtual machine configuration using a Unix Domain Socket though a shared, named file:\n\n\n\nThe following example shows how to configure Rosetta’s caching options in a new virtual machine configuration using an abstract socket:\n\n\n\n## Virtual machine setup\n\n- **Running macOS in a virtual machine on Apple silicon**: Install and run macOS in a virtual machine using the Virtualization framework.\n- **Running Linux in a Virtual Machine**: Run a Linux operating system on your Mac using the Virtualization framework.\n- **Running GUI Linux in a virtual machine on a Mac**: Install and run GUI Linux in a virtual machine using the Virtualization framework.\n- **Installing macOS on a Virtual Machine**: Download a macOS restore image and install it in a new VM.\n- **Creating and Running a Linux Virtual Machine**: Design and run custom Linux guests on Apple silicon or Intel-based Mac Computers.\n- **Virtualize macOS on a Mac**: Configure and run macOS guests on Apple silicon.\n- **Virtualize Linux on a Mac**: Configure and run Linux guests on Apple silicon and Intel-based Mac computers.\n- **Accelerating the performance of Rosetta**: Improve Rosetta performance by adding support for the total store ordering (TSO) memory model to your Linux kernel.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Install and run macOS in a virtual machine using the Virtualization framework.",
          "name" : "Running macOS in a virtual machine on Apple silicon",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/running-macos-in-a-virtual-machine-on-apple-silicon"
        },
        {
          "description" : "Run a Linux operating system on your Mac using the Virtualization framework.",
          "name" : "Running Linux in a Virtual Machine",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/running-linux-in-a-virtual-machine"
        },
        {
          "description" : "Install and run GUI Linux in a virtual machine using the Virtualization framework.",
          "name" : "Running GUI Linux in a virtual machine on a Mac",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/running-gui-linux-in-a-virtual-machine-on-a-mac"
        },
        {
          "description" : "Download a macOS restore image and install it in a new VM.",
          "name" : "Installing macOS on a Virtual Machine",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/installing-macos-on-a-virtual-machine"
        },
        {
          "description" : "Design and run custom Linux guests on Apple silicon or Intel-based Mac Computers.",
          "name" : "Creating and Running a Linux Virtual Machine",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/creating-and-running-a-linux-virtual-machine"
        },
        {
          "description" : "Configure and run macOS guests on Apple silicon.",
          "name" : "Virtualize macOS on a Mac",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/virtualize-macos-on-a-mac"
        },
        {
          "description" : "Configure and run Linux guests on Apple silicon and Intel-based Mac computers.",
          "name" : "Virtualize Linux on a Mac",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/virtualize-linux-on-a-mac"
        },
        {
          "description" : "Improve Rosetta performance by adding support for the total store ordering (TSO) memory model to your Linux kernel.",
          "name" : "Accelerating the performance of Rosetta",
          "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/accelerating-the-performance-of-rosetta"
        }
      ],
      "title" : "Virtual machine setup"
    }
  ],
  "source" : "appleJSON",
  "title" : "Running Intel Binaries in Linux VMs with Rosetta",
  "url" : "https:\/\/developer.apple.com\/documentation\/Virtualization\/running-intel-binaries-in-linux-vms-with-rosetta"
}