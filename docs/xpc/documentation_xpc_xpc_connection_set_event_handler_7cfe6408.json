{
  "abstract" : "Sets the event handler block for the connection.",
  "codeExamples" : [

  ],
  "contentHash" : "a93ee650aacb86eaff282dc17ac3f5505b78d644d4005067646d2bf0736cb9d2",
  "crawledAt" : "2025-12-07T15:30:01Z",
  "declaration" : {
    "code" : "func xpc_connection_set_event_handler(_ connection: xpc_connection_t, _ handler: @escaping (xpc_object_t) -> Void)",
    "language" : "swift"
  },
  "id" : "7225DB42-DB19-4FB2-A097-4216000B9270",
  "kind" : "function",
  "language" : "swift",
  "module" : "XPC",
  "overview" : "## Discussion\n\nSetting the event handler is asynchronous and non-preemptive, and therefore this method will not interrupt the execution of an already-running event handler block. If the event handler is executing at the time of this call, it will finish, and then the connection’s event handler will be changed before the next invocation of the event handler. The XPC runtime guarantees this non-preemptiveness even for concurrent target queues.\n\nConnection event handlers are non-reentrant, so it is safe to call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_set_event_handler(_:_:)] from within the event handler block.\n\nThe event handler’s execution should be treated as a barrier to all connection activity. When it is executing, the connection will not attempt to send or receive messages, including reply messages. So, it is not safe to call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_send_message_with_reply_sync(_:_:)] on the connection from within the event handler.\n\nYou do not hold a reference on the object received as the event handler’s only argument. Regardless of the type of object received, it is safe to call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_retain] on the object to obtain a reference to it.\n\nA connection may receive different events depending upon whether it is a listener or not. Any connection may receive an error in its event handler. But while normal connections may receive messages in addition to errors, listener connections will receive connections and and not messages.\n\nConnections received by listeners are equivalent to those returned by [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_create(_:_:)] with a non-`NULL` name argument and a `NULL` `targetq` argument with the exception that you do not hold a reference on them. You must set an event handler and resume the connection. If you do not wish to accept the connection, you may simply call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_cancel(_:)] on it and return. The runtime will dispose of it for you.\n\nIf there is an error in the connection, this handler will be invoked with the error dictionary as its argument. This dictionary will be one of the well-known `XPC_ERROR` dictionaries.\n\nRegardless of the type of event, ownership of the event object is NOT implicitly transferred. So, the object will be released and deallocated at some point in the future after the event handler returns. If you wish the event’s lifetime to persist, you must retain it with [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_retain].\n\nConnections received through the event handler will be released and deallocated after the connection has gone invalid and delivered that event to its event handler.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/XPC\/xpc_connection_set_event_handler(_:_:)\ncrawled: 2025-12-07T15:30:01Z\n---\n\n# xpc_connection_set_event_handler(_:_:)\n\n**Function**\n\nSets the event handler block for the connection.\n\n## Declaration\n\n```swift\nfunc xpc_connection_set_event_handler(_ connection: xpc_connection_t, _ handler: @escaping (xpc_object_t) -> Void)\n```\n\n## Parameters\n\n- **connection**: The connection object which is to be manipulated.\n- **handler**: The event handler block.\n\n## Discussion\n\nSetting the event handler is asynchronous and non-preemptive, and therefore this method will not interrupt the execution of an already-running event handler block. If the event handler is executing at the time of this call, it will finish, and then the connection’s event handler will be changed before the next invocation of the event handler. The XPC runtime guarantees this non-preemptiveness even for concurrent target queues.\n\nConnection event handlers are non-reentrant, so it is safe to call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_set_event_handler(_:_:)] from within the event handler block.\n\nThe event handler’s execution should be treated as a barrier to all connection activity. When it is executing, the connection will not attempt to send or receive messages, including reply messages. So, it is not safe to call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_send_message_with_reply_sync(_:_:)] on the connection from within the event handler.\n\nYou do not hold a reference on the object received as the event handler’s only argument. Regardless of the type of object received, it is safe to call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_retain] on the object to obtain a reference to it.\n\nA connection may receive different events depending upon whether it is a listener or not. Any connection may receive an error in its event handler. But while normal connections may receive messages in addition to errors, listener connections will receive connections and and not messages.\n\nConnections received by listeners are equivalent to those returned by [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_create(_:_:)] with a non-`NULL` name argument and a `NULL` `targetq` argument with the exception that you do not hold a reference on them. You must set an event handler and resume the connection. If you do not wish to accept the connection, you may simply call [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_connection_cancel(_:)] on it and return. The runtime will dispose of it for you.\n\nIf there is an error in the connection, this handler will be invoked with the error dictionary as its argument. This dictionary will be one of the well-known `XPC_ERROR` dictionaries.\n\nRegardless of the type of event, ownership of the event object is NOT implicitly transferred. So, the object will be released and deallocated at some point in the future after the event handler returns. If you wish the event’s lifetime to persist, you must retain it with [doc:\/\/com.apple.xpc\/documentation\/XPC\/xpc_retain].\n\nConnections received through the event handler will be released and deallocated after the connection has gone invalid and delivered that event to its event handler.\n\n## Event handling\n\n- **xpc_handler_t**: The type of block that the XPC connection APIs accept.\n- **xpc_connection_handler_t**: The type of the function to invoke for a bundled XPC service when there’s a new connection on the service.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The type of block that the XPC connection APIs accept.",
          "name" : "xpc_handler_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/XPC\/xpc_handler_t"
        },
        {
          "description" : "The type of the function to invoke for a bundled XPC service when there’s a new connection on the service.",
          "name" : "xpc_connection_handler_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/XPC\/xpc_connection_handler_t"
        }
      ],
      "title" : "Event handling"
    }
  ],
  "source" : "appleJSON",
  "title" : "xpc_connection_set_event_handler(_:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/XPC\/xpc_connection_set_event_handler(_:_:)"
}