{
  "abstract" : "Implement a web server to register, update, and unregister a pass on a device.",
  "codeExamples" : [
    {
      "code" : "{\n    \"serialNumbers\" : [\"001\", \"020\", \"3019\"],\n    \"lastUpdated\" : \"1351981923\"\n}",
      "language" : "other"
    }
  ],
  "contentHash" : "60946e635f6045c3fe81a795429d597f391f66bc9f722b6174bdafb9389d3f05",
  "crawledAt" : "2025-12-04T04:33:45Z",
  "id" : "F1B9E007-2BFE-452B-BDED-F7FAED58E3E8",
  "kind" : "article",
  "language" : "data",
  "module" : "Wallet Passes",
  "overview" : "## Overview\n\nKeep your users’ pass updated with the latest information, such as the time of a flight or the location of the next geocached object in a game.\n\n\n\nCreate an updatable pass by adding the `webServiceURL` and `authenticationToken` keys to [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/Pass]. The system calls your server endpoints using the base URL you provide. Updating a pass is a cooperative effort between the user’s device, Apple servers, and your server. The high-level steps are:\n\n### Server Configuration\n\nAuthenticate each call to your server using a shared secret before responding using one of two shared secrets. Use the value of `authenticationToken` for the pass to authenticate the calls that register and unregister a pass, and to send an updated pass. The other shared secret is the *device library ID*, a value that’s sent by the device when the device registers a pass. Use this secret to authenticate the call for the serial numbers of updated passes.\n\n#### Store Information\n\nUpdating passes requires storing information for the registered passes and for their associated devices. One way you can store these details is to use a traditional relational database with two entities – devices and passes – and one relationship, registrations. The three tables are:\n\n### Register and Unregister a Pass\n\nAdd the relationship when a device registers an updatable pass.\n\n\n\nComplete these tasks to register a pass:\n\nRemove the relationship when a device unregisters an updateable pass.\n\n\n\nComplete these tasks to unregister a pass:\n\n### Update a Pass\n\nYou can update any type of pass and any information in the pass, except for the authentication token and the serial number. An updated pass is a new pass with the same pass type identifier and serial number. For more information on creating a pass, see [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/creating-the-source-for-a-pass] and [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/building-a-pass].\n\nUpdating the pass involves several steps for both your server and the client device that contains the pass:\n\n#### Send a Push Notification\n\n\n\nSend a push notification to a registered device to indicate that there’s an updated pass. Do this using the following steps:\n\nDelete a device if the Apple Push Notification service (APNs) returns an error that the push token is invalid.\n\nFor more information on sending push notifications, see [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-notification-requests-to-apns].\n\n#### Return the Updated Passes\n\nA device that receives the push notification requests a list of serial numbers for updated passes, such as a tickets to an event. Your server sends the serial numbers for updated passes.\n\n\n\nKeep track of the update time of a pass to limit the number of serial numbers your server sends when a device requests the updated passes. Set the `lastUpdated` key of [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/SerialNumbers] to the last update time. The device saves the value and uses it to set the `previousLastUpdated` command line argument of [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/Get-the-List-of-Updatable-Passes].\n\nTo send the list of serial numbers:\n\nThe device then sends a request to your server for each updated pass.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/WalletPasses\/adding-a-web-service-to-update-passes\ncrawled: 2025-12-04T04:33:45Z\n---\n\n# Adding a Web Service to Update Passes\n\n**Article**\n\nImplement a web server to register, update, and unregister a pass on a device.\n\n## Overview\n\nKeep your users’ pass updated with the latest information, such as the time of a flight or the location of the next geocached object in a game.\n\n\n\nCreate an updatable pass by adding the `webServiceURL` and `authenticationToken` keys to [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/Pass]. The system calls your server endpoints using the base URL you provide. Updating a pass is a cooperative effort between the user’s device, Apple servers, and your server. The high-level steps are:\n\n1. The user installs a pass that supports updates on their device.\n2. The user’s device registers the pass with your server and provides a device identifier and a push token.\n3. Pass information changes and your server sends a push notification.\n4. The user’s device receives the notification and queries your server for updated passes.\n5. The user’s device requests each pass that has changed.\n\n### Server Configuration\n\nAuthenticate each call to your server using a shared secret before responding using one of two shared secrets. Use the value of `authenticationToken` for the pass to authenticate the calls that register and unregister a pass, and to send an updated pass. The other shared secret is the *device library ID*, a value that’s sent by the device when the device registers a pass. Use this secret to authenticate the call for the serial numbers of updated passes.\n\n\n\n#### Store Information\n\nUpdating passes requires storing information for the registered passes and for their associated devices. One way you can store these details is to use a traditional relational database with two entities – devices and passes – and one relationship, registrations. The three tables are:\n\n\n\n### Register and Unregister a Pass\n\nAdd the relationship when a device registers an updatable pass.\n\n\n\nComplete these tasks to register a pass:\n\n- Create a new entry for the pass if one doesn’t exist.\n- Create a new entry for the device if one doesn’t exist.\n- Store the mapping between the pass and the device library identifier in the registrations table.\n\nRemove the relationship when a device unregisters an updateable pass.\n\n\n\nComplete these tasks to unregister a pass:\n\n- Delete the mapping between the pass and the device library identifier from the registrations table.\n- Delete the device entry from the device table if the registration table has no more entries for that device.\n\n### Update a Pass\n\nYou can update any type of pass and any information in the pass, except for the authentication token and the serial number. An updated pass is a new pass with the same pass type identifier and serial number. For more information on creating a pass, see [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/creating-the-source-for-a-pass] and [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/building-a-pass].\n\nUpdating the pass involves several steps for both your server and the client device that contains the pass:\n\n- Your server sends a push notification to the device.\n- The device requests the serial numbers for updated passes.\n- Your server sends the serial numbers for the updated passes.\n- The device requests a specific pass.\n- Your server sends the updated pass.\n\n#### Send a Push Notification\n\n\n\nSend a push notification to a registered device to indicate that there’s an updated pass. Do this using the following steps:\n\n- Find the registered devices for the updated pass.\n- Create and send a push notification for each registered device. The notification uses the same certificate and private key that the creator of the pass used to sign the original, the push token registered by the device, and an empty JSON dictionary for the payload.\n\nDelete a device if the Apple Push Notification service (APNs) returns an error that the push token is invalid.\n\nFor more information on sending push notifications, see [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-notification-requests-to-apns].\n\n\n\n#### Return the Updated Passes\n\nA device that receives the push notification requests a list of serial numbers for updated passes, such as a tickets to an event. Your server sends the serial numbers for updated passes.\n\n\n\nKeep track of the update time of a pass to limit the number of serial numbers your server sends when a device requests the updated passes. Set the `lastUpdated` key of [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/SerialNumbers] to the last update time. The device saves the value and uses it to set the `previousLastUpdated` command line argument of [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/Get-the-List-of-Updatable-Passes].\n\nTo send the list of serial numbers:\n\n1. Find the list of passes registered for the device using the registrations table.\n2. Select the passes that have been updated since your web service provided the `updated` tag, or all passes when there’s no tag. If there are multiple updates to a pass, select the one with the most recent update.\n3. Create the [doc:\/\/com.apple.walletpasses\/documentation\/WalletPasses\/SerialNumbers] JSON response dictionary and send it with the response. For example:\n\n```other\n{\n    \"serialNumbers\" : [\"001\", \"020\", \"3019\"],\n    \"lastUpdated\" : \"1351981923\"\n}\n```\n\nThe device then sends a request to your server for each updated pass.\n\n## Pass Updates\n\n- **Register a Pass for Update Notifications**: Set up change notifications for a pass on a device.\n- **Get the List of Updatable Passes**: Send the serial numbers for updated passes to a device.\n- **Send an Updated Pass**: Create and sign an updated pass, and send it to the device.\n- **Unregister a Pass for Update Notifications**: Stop sending update notifications for a pass on a device.\n- **Log a Message**: Record a message on your server.\n- **PushToken**: An object that contains the push notification token for a registered pass on a device.\n- **SerialNumbers**: An object that contains serial numbers for the updatable passes on a device.\n- **LogEntries**: An object that contains an array of messages.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Set up change notifications for a pass on a device.",
          "name" : "Register a Pass for Update Notifications",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/Register-a-Pass-for-Update-Notifications"
        },
        {
          "description" : "Send the serial numbers for updated passes to a device.",
          "name" : "Get the List of Updatable Passes",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/Get-the-List-of-Updatable-Passes"
        },
        {
          "description" : "Create and sign an updated pass, and send it to the device.",
          "name" : "Send an Updated Pass",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/Send-an-Updated-Pass"
        },
        {
          "description" : "Stop sending update notifications for a pass on a device.",
          "name" : "Unregister a Pass for Update Notifications",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/Unregister-a-Pass-for-Update-Notifications"
        },
        {
          "description" : "Record a message on your server.",
          "name" : "Log a Message",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/Log-a-Message"
        },
        {
          "description" : "An object that contains the push notification token for a registered pass on a device.",
          "name" : "PushToken",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/PushToken"
        },
        {
          "description" : "An object that contains serial numbers for the updatable passes on a device.",
          "name" : "SerialNumbers",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/SerialNumbers"
        },
        {
          "description" : "An object that contains an array of messages.",
          "name" : "LogEntries",
          "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/LogEntries"
        }
      ],
      "title" : "Pass Updates"
    }
  ],
  "source" : "appleJSON",
  "title" : "Adding a Web Service to Update Passes",
  "url" : "https:\/\/developer.apple.com\/documentation\/WalletPasses\/adding-a-web-service-to-update-passes"
}