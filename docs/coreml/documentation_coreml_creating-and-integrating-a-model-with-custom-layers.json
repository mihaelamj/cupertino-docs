{
  "abstract" : "Add models with custom neural-network layers to your app.",
  "codeExamples" : [
    {
      "code" : "bindings = {\n    'class_name'  : 'AAPLCustomAdd',\n    'description' : \"Custom implementation of addition.\"\n    ...\n}",
      "language" : "python"
    }
  ],
  "contentHash" : "b319366d8fa44d5923bbf411cbe644b0cf2862814077f3cfd015709e34849dc6",
  "crawledAt" : "2025-12-02T19:14:03Z",
  "id" : "3A46955A-1267-4FB2-9EDE-2C6CBAAC6DA6",
  "kind" : "article",
  "language" : "swift",
  "module" : "Core ML",
  "overview" : "## Overview\n\nNew network layers and architectures solve problems that might be difficult or impractical with code. You can support each new layer type before Core ML directly supports it by implementing a *custom layer*. A custom layer is a class that adopts [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLCustomLayer] and implements the methods to run a neural network layer in code.\n\n### Add a model you acquire or create\n\nIf you have a Core ML model with custom layers, add the model to your Xcode project.\n\nOtherwise, convert a third-party model and designate the new layers as custom with the [https:\/\/coremltools.readme.io]. Follow the steps on the [https:\/\/coremltools.readme.io\/docs\/custom-operators] page to define the new layers as custom. Give each custom layer a unique name by assigning a unique string to the operator’s class name binding.\n\nSave the Core ML model you converted and add it to your Xcode project.\n\n### Integrate or create a class for each custom layer\n\nIf the author of the model you plan to add to your Xcode project implemented the custom layers in source-code files, add the source files into your Xcode project.\n\nOtherwise, implement each custom layer by creating a Swift or Objective-C class for each layer. Inspect the names of the model’s custom layers by opening the model in Xcode:\n\n\n\nCreate a class for each custom layer that the model has in its list of dependencies and name each class to match the custom layer it implements.\n\nAdopt the [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLCustomLayer] protocol by implementing the following:\n\nCore ML invokes the appropriate [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLCustomLayer] methods for each custom layer at runtime when your app calls the [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLModel\/prediction(from:)-9y2aa] method.\n\n### Test the custom layers\n\nIf applicable, test the custom layers by using the model to make predictions with input values from one or more test cases. Confirm the model layers function correctly by comparing the model’s prediction values to the output values for each test case.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CoreML\/creating-and-integrating-a-model-with-custom-layers\ncrawled: 2025-12-02T19:14:03Z\n---\n\n# Creating and Integrating a Model with Custom Layers\n\n**Article**\n\nAdd models with custom neural-network layers to your app.\n\n## Overview\n\nNew network layers and architectures solve problems that might be difficult or impractical with code. You can support each new layer type before Core ML directly supports it by implementing a *custom layer*. A custom layer is a class that adopts [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLCustomLayer] and implements the methods to run a neural network layer in code.\n\n\n\n### Add a model you acquire or create\n\nIf you have a Core ML model with custom layers, add the model to your Xcode project.\n\nOtherwise, convert a third-party model and designate the new layers as custom with the [https:\/\/coremltools.readme.io]. Follow the steps on the [https:\/\/coremltools.readme.io\/docs\/custom-operators] page to define the new layers as custom. Give each custom layer a unique name by assigning a unique string to the operator’s class name binding.\n\n```python\nbindings = {\n    'class_name'  : 'AAPLCustomAdd',\n    'description' : \"Custom implementation of addition.\"\n    ...\n}\n```\n\nSave the Core ML model you converted and add it to your Xcode project.\n\n### Integrate or create a class for each custom layer\n\nIf the author of the model you plan to add to your Xcode project implemented the custom layers in source-code files, add the source files into your Xcode project.\n\nOtherwise, implement each custom layer by creating a Swift or Objective-C class for each layer. Inspect the names of the model’s custom layers by opening the model in Xcode:\n\n\n\nCreate a class for each custom layer that the model has in its list of dependencies and name each class to match the custom layer it implements.\n\n\n\nAdopt the [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLCustomLayer] protocol by implementing the following:\n\n\n\nCore ML invokes the appropriate [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLCustomLayer] methods for each custom layer at runtime when your app calls the [doc:\/\/com.apple.coreml\/documentation\/CoreML\/MLModel\/prediction(from:)-9y2aa] method.\n\n\n\n### Test the custom layers\n\nIf applicable, test the custom layers by using the model to make predictions with input values from one or more test cases. Confirm the model layers function correctly by comparing the model’s prediction values to the output values for each test case.\n\n## Custom model layers\n\n- **MLCustomLayer**: An interface that defines the behavior of a custom layer in your neural network model.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An interface that defines the behavior of a custom layer in your neural network model.",
          "name" : "MLCustomLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreML\/MLCustomLayer"
        }
      ],
      "title" : "Custom model layers"
    }
  ],
  "source" : "appleJSON",
  "title" : "Creating and Integrating a Model with Custom Layers",
  "url" : "https:\/\/developer.apple.com\/documentation\/CoreML\/creating-and-integrating-a-model-with-custom-layers"
}