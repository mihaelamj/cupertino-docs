{
  "abstract" : "Calls the given closure with a pointer to the array’s mutable storage that has a specified buffer layout.",
  "codeExamples" : [
    {
      "code" : "\/\/ Initialize 2x3 shaped array using an external data that lays out scalars in\n\/\/ last-major order.\nlet data: [Int32] = [0, 3,\n                     1, 4,\n                     2, 5]\nvar array = MLShapedArray<Int32>(repeating: 0, shape: [2, 3])\narray.withUnsafeMutableShapedBufferPointer(using: .lastMajorContiguous) { destinationPtr, _, _ in\n    data.withUnsafeBufferPointer() { sourcePtr in\n        destinationPtr.update(from: sourcePtr)\n    }\n}\n\nprint(array.strides) \/\/  [1, 2]\nprint(array.scalars) \/\/ [0, 1, 2, 3, 4, 5])",
      "language" : "swift"
    }
  ],
  "contentHash" : "c38bba148e8d3738d9365102ba48f7107138d2c00b4477bdb4aa9670e17c4bc1",
  "crawledAt" : "2025-12-01T09:55:25Z",
  "declaration" : {
    "code" : "mutating func withUnsafeMutableShapedBufferPointer<R>(using bufferLayout: MLShapedArrayBufferLayout, _ body: (inout UnsafeMutableBufferPointer<Scalar>, [Int], [Int]) throws -> R) rethrows -> R",
    "language" : "swift"
  },
  "id" : "34DBA985-277F-45B4-B73E-ACC9AAB71CE5",
  "kind" : "method",
  "module" : "Core ML",
  "overview" : "## Discussion\n\nThe storage contains the scalars according to buffer layout parameter. For example, the scalar at `[x1, x2, ... xn]` with strides `[s1, s2, ... sn]` is stored at `ptr[x1 * s1 + x2 * s2 + ... + xn * sn]`\n\nUnlike `withUnsafeMutableShapedBufferPointer(:)`, this function allows the caller to specify the buffer layout.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CoreML\/MLShapedArray\/withUnsafeMutableShapedBufferPointer(using:_:)\ncrawled: 2025-12-01T09:55:25Z\n---\n\n# withUnsafeMutableShapedBufferPointer(using:_:)\n\n**Instance Method**\n\nCalls the given closure with a pointer to the array’s mutable storage that has a specified buffer layout.\n\n## Declaration\n\n```swift\nmutating func withUnsafeMutableShapedBufferPointer<R>(using bufferLayout: MLShapedArrayBufferLayout, _ body: (inout UnsafeMutableBufferPointer<Scalar>, [Int], [Int]) throws -> R) rethrows -> R\n```\n\n## Discussion\n\nThe storage contains the scalars according to buffer layout parameter. For example, the scalar at `[x1, x2, ... xn]` with strides `[s1, s2, ... sn]` is stored at `ptr[x1 * s1 + x2 * s2 + ... + xn * sn]`\n\nUnlike `withUnsafeMutableShapedBufferPointer(:)`, this function allows the caller to specify the buffer layout.\n\n```swift\n\/\/ Initialize 2x3 shaped array using an external data that lays out scalars in\n\/\/ last-major order.\nlet data: [Int32] = [0, 3,\n                     1, 4,\n                     2, 5]\nvar array = MLShapedArray<Int32>(repeating: 0, shape: [2, 3])\narray.withUnsafeMutableShapedBufferPointer(using: .lastMajorContiguous) { destinationPtr, _, _ in\n    data.withUnsafeBufferPointer() { sourcePtr in\n        destinationPtr.update(from: sourcePtr)\n    }\n}\n\nprint(array.strides) \/\/  [1, 2]\nprint(array.scalars) \/\/ [0, 1, 2, 3, 4, 5])\n```\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "withUnsafeMutableShapedBufferPointer(using:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/CoreML\/MLShapedArray\/withUnsafeMutableShapedBufferPointer(using:_:)"
}