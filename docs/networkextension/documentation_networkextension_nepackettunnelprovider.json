{
  "abstract" : "The principal class for a packet tunnel provider app extension.",
  "codeExamples" : [
    {
      "code" : "<key>NSExtension<\/key>\n<dict>\n    <key>NSExtensionPointIdentifier<\/key>\n    <string>com.apple.networkextension.packet-tunnel<\/string>\n    <key>NSExtensionPrincipalClass<\/key>\n    <string>MyCustomPacketTunnelProvider<\/string>\n<\/dict>",
      "language" : "xml"
    }
  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSObjectProtocol"
  ],
  "contentHash" : "58f7411aea20f219d79187865c3aad8464d206dfe1171e23162b343c8d60343a",
  "crawledAt" : "2025-12-04T09:17:12Z",
  "declaration" : {
    "code" : "class NEPacketTunnelProvider",
    "language" : "swift"
  },
  "id" : "4B65A17B-2F01-4137-AACA-0A2AF52EEE66",
  "inheritedBy" : [
    "NEEthernetTunnelProvider"
  ],
  "kind" : "class",
  "language" : "swift",
  "module" : "Network Extension",
  "overview" : "## Overview\n\nThe [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider] class gives its subclasses access to a virtual network interface via the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow] property. Use the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NETunnelProvider\/setTunnelNetworkSettings(_:completionHandler:)] method in the Packet Tunnel Provider to specify that the following network settings be associated with the virtual interface:\n\nBy specifying IP destination networks, the Packet Tunnel Provider can dictate what IP destinations will be routed to the virtual interface. IP packets with matching destination addresses will then be diverted to Packet Tunnel Provider and can be read using the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow] property. The Packet Tunnel Provider can then encapsulate the IP packets per a custom tunneling protocol and send them to a tunnel server. When the Packet Tunnel Provider decapsulates IP packets received from the tunnel server, it can use the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow] property to inject the packets into the networking stack.\n\n### Creating a Packet Tunnel Provider Extension\n\nPacket Tunnel Providers run as App Extensions for the `com.apple.networkextension.packet-tunnel` extension point.\n\nTo create a Packet Tunnel Provider extension, first create a new App Extension target in your project.\n\nFor an example of an Xcode build target for this app extension, see the [https:\/\/developer.apple.com\/library\/archive\/samplecode\/SimpleTunnel\/Introduction\/Intro.html#\/\/apple_ref\/doc\/uid\/TP40016140] sample code project.\n\nOnce you have a Packet Tunnel Provider extension target, create a subclass of NEPacketTunnelProvider. Then, set the `NSExtensionPrincipalClass` key in the the extension’s `Info.plist` to the name of your subclass.\n\nIf it is not already, set the `NSExtensionPointIdentifier` key in the extension’s `Info.plist` to `com.apple.networkextension.packet-tunnel`.\n\nHere is an example of the NSExtension dictionary in a Packet Tunnel Provider extension’s `Info.plist`:\n\nFinally, add the Packet Tunnel Provider extension target to your app’s Embed App Extensions build phase.\n\n### Subclassing Notes\n\nIn order to create a Packet Tunnel Provider extension, you must create a subclass of `NEPacketTunnelProvider` and override the methods listed below.\n\n#### Methods to Override",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\ncrawled: 2025-12-04T09:17:12Z\n---\n\n# NEPacketTunnelProvider\n\n**Class**\n\nThe principal class for a packet tunnel provider app extension.\n\n## Declaration\n\n```swift\nclass NEPacketTunnelProvider\n```\n\n## Overview\n\nThe [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider] class gives its subclasses access to a virtual network interface via the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow] property. Use the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NETunnelProvider\/setTunnelNetworkSettings(_:completionHandler:)] method in the Packet Tunnel Provider to specify that the following network settings be associated with the virtual interface:\n\n- Virtual IP address\n- DNS resolver configuration\n- HTTP proxy configuration\n- IP destination networks to be routed through the tunnel\n- IP destination networks to be routed outside the tunnel\n- Interface MTU\n\nBy specifying IP destination networks, the Packet Tunnel Provider can dictate what IP destinations will be routed to the virtual interface. IP packets with matching destination addresses will then be diverted to Packet Tunnel Provider and can be read using the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow] property. The Packet Tunnel Provider can then encapsulate the IP packets per a custom tunneling protocol and send them to a tunnel server. When the Packet Tunnel Provider decapsulates IP packets received from the tunnel server, it can use the [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow] property to inject the packets into the networking stack.\n\n\n\n### Creating a Packet Tunnel Provider Extension\n\nPacket Tunnel Providers run as App Extensions for the `com.apple.networkextension.packet-tunnel` extension point.\n\nTo create a Packet Tunnel Provider extension, first create a new App Extension target in your project.\n\nFor an example of an Xcode build target for this app extension, see the [https:\/\/developer.apple.com\/library\/archive\/samplecode\/SimpleTunnel\/Introduction\/Intro.html#\/\/apple_ref\/doc\/uid\/TP40016140] sample code project.\n\nOnce you have a Packet Tunnel Provider extension target, create a subclass of NEPacketTunnelProvider. Then, set the `NSExtensionPrincipalClass` key in the the extension’s `Info.plist` to the name of your subclass.\n\nIf it is not already, set the `NSExtensionPointIdentifier` key in the extension’s `Info.plist` to `com.apple.networkextension.packet-tunnel`.\n\nHere is an example of the NSExtension dictionary in a Packet Tunnel Provider extension’s `Info.plist`:\n\n```xml\n<key>NSExtension<\/key>\n<dict>\n    <key>NSExtensionPointIdentifier<\/key>\n    <string>com.apple.networkextension.packet-tunnel<\/string>\n    <key>NSExtensionPrincipalClass<\/key>\n    <string>MyCustomPacketTunnelProvider<\/string>\n<\/dict>\n```\n\nFinally, add the Packet Tunnel Provider extension target to your app’s Embed App Extensions build phase.\n\n### Subclassing Notes\n\nIn order to create a Packet Tunnel Provider extension, you must create a subclass of `NEPacketTunnelProvider` and override the methods listed below.\n\n#### Methods to Override\n\n- [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/startTunnel(options:completionHandler:)]\n- [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/stopTunnel(with:completionHandler:)]\n\n## Managing the tunnel life cycle\n\n- **startTunnel(options:completionHandler:)**: Start the network tunnel.\n- **stopTunnel(with:completionHandler:)**: Stop the network tunnel.\n- **cancelTunnelWithError(_:)**: Stop the network tunnel from the Packet Tunnel Provider.\n\n## Handling IP packets\n\n- **packetFlow**: A [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelFlow] object which is used to receive IP packets routed to the tunnel’s virtual interface and inject IP packets into the networking stack via the tunnel’s virtual interface.\n\n## Creating network connections through the tunnel\n\n- **createTCPConnectionThroughTunnel(to:enableTLS:tlsParameters:delegate:)**: Create a TCP connection through the current tunnel.\n- **createUDPSessionThroughTunnel(to:from:)**: Creates a UDP session through the current tunnel.\n\n## Instance Properties\n\n- **virtualInterface**\n\n## Packet tunnel provider\n\n- **NETunnelProvider**: An abstract base class shared by NEPacketTunnelProvider and NEAppProxyProvider.\n- **NEProvider**: An abstract base class for all NetworkExtension providers.\n- **NEPacketTunnelNetworkSettings**: The configuration for a packet tunnel provider’s virtual interface.\n- **NETunnelNetworkSettings**: The configuration for a tunnel provider’s virtual interface.\n- **NEEthernetTunnelProvider**: A type that implements the client side of a custom link-layer packet tunneling protocol.\n- **NEEthernetTunnelNetworkSettings**: The network settings for an ethernet-based VPN tunnel.\n\n## Inherits From\n\n- NETunnelProvider\n\n## Inherited By\n\n- NEEthernetTunnelProvider\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSObjectProtocol\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Start the network tunnel.",
          "name" : "startTunnel(options:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/startTunnel(options:completionHandler:)"
        },
        {
          "description" : "Stop the network tunnel.",
          "name" : "stopTunnel(with:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/stopTunnel(with:completionHandler:)"
        },
        {
          "description" : "Stop the network tunnel from the Packet Tunnel Provider.",
          "name" : "cancelTunnelWithError(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/cancelTunnelWithError(_:)"
        }
      ],
      "title" : "Managing the tunnel life cycle"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A [doc:\/\/com.apple.networkextension\/documentation\/NetworkExtension\/NEPacketTunnelFlow] object which is used to receive IP packets routed to the tunnel’s virtual interface and inject IP packets into the networking stack via the tunnel’s virtual interface.",
          "name" : "packetFlow",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/packetFlow"
        }
      ],
      "title" : "Handling IP packets"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Create a TCP connection through the current tunnel.",
          "name" : "createTCPConnectionThroughTunnel(to:enableTLS:tlsParameters:delegate:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/createTCPConnectionThroughTunnel(to:enableTLS:tlsParameters:delegate:)"
        },
        {
          "description" : "Creates a UDP session through the current tunnel.",
          "name" : "createUDPSessionThroughTunnel(to:from:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/createUDPSessionThroughTunnel(to:from:)"
        }
      ],
      "title" : "Creating network connections through the tunnel"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "virtualInterface",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider\/virtualInterface-7l3ol"
        }
      ],
      "title" : "Instance Properties"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "An abstract base class shared by NEPacketTunnelProvider and NEAppProxyProvider.",
          "name" : "NETunnelProvider",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NETunnelProvider"
        },
        {
          "description" : "An abstract base class for all NetworkExtension providers.",
          "name" : "NEProvider",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEProvider"
        },
        {
          "description" : "The configuration for a packet tunnel provider’s virtual interface.",
          "name" : "NEPacketTunnelNetworkSettings",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelNetworkSettings"
        },
        {
          "description" : "The configuration for a tunnel provider’s virtual interface.",
          "name" : "NETunnelNetworkSettings",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NETunnelNetworkSettings"
        },
        {
          "description" : "A type that implements the client side of a custom link-layer packet tunneling protocol.",
          "name" : "NEEthernetTunnelProvider",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEEthernetTunnelProvider"
        },
        {
          "description" : "The network settings for an ethernet-based VPN tunnel.",
          "name" : "NEEthernetTunnelNetworkSettings",
          "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEEthernetTunnelNetworkSettings"
        }
      ],
      "title" : "Packet tunnel provider"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NETunnelProvider"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "NEPacketTunnelProvider",
  "url" : "https:\/\/developer.apple.com\/documentation\/NetworkExtension\/NEPacketTunnelProvider"
}