{
  "abstract" : "Create an app extension to perform tasks in a separate process from a host app.",
  "codeExamples" : [
    {
      "code" : "struct MyAppExtension: AppExtension {\n    @AppExtensionPoint.Bind\n    var boundAppExtensionPoint: AppExtensionPoint { \n        AppExtensionPoint.Identifier(\"com.example.hostapp\", name \"HostAppFeature\")\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "struct ExampleConfiguration<E:ExampleExtension>: AppExtensionConfiguration {\n        \n    \/\/ Determine whether to accept the XPC connection from the host.\n    func accept(connection: NSXPCConnection) -> Bool {\n        connection.exportedObject = myCustomObject\n        connection.exportedInterface = NSXPCInterface(with: HostAppInterface.self)\n        connection.resume()\n        return true\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "public extension MyTextTransformerExtension {\n    var configuration: some AppExtensionConfiguration {\n        return ConnectionHandler { request  in\n            let handler = Handler(appex: self)\n            return request.accept { session in\n                return handler\n            }\n        }\n    }\n}\n\n\/\/ Process text translation requests using an XPCSession.  \nstruct Handler<E: MyTextTransformerExtension>: XPCPeerHandler {\n    let appex: E\n    \n    func handleIncomingRequest(_ input: TranslateMessage) -> (any Encodable)? {\n        let text = input.text\n        let result = appex.translate(text:text)\n        return TranslateMessage.Response(translatedText: result)\n    }\n}\n\n\/\/ The input message from the host app and the translation response.\nstruct TranslateMessage: Codable {\n    let text: String\n    \n    struct Response: Codable {\n        let translatedText: Text\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "eafc08f558440ede61110902ac9e23c107c6e8a1f1f6565348530279334a2f99",
  "crawledAt" : "2025-12-05T11:53:59Z",
  "id" : "A2881578-083D-4E9F-A5AF-042008B5D2D9",
  "kind" : "article",
  "language" : "swift",
  "module" : "ExtensionFoundation",
  "overview" : "## Overview\n\nAn app extension extends the features of the host app it supports, and runs code in a separate process. You can develop an app extension together with your app, or develop app extensions separately to support a different app. The host app provides the interface your app extension must implement, and both the app and app extension adopt the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation] framework to manage interactions.\n\nIn an app extension, the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation] framework provides the code for running the main event loop and accepting XPC connections. When you create an app extension in Xcode, the generic extension template provides most of the code you need to get started. With that template, you add code to establish communications with the host app, and to implement the expected features.\n\n### Create your app extension target\n\nAn app extension is a bundle that ships inside an existing app, so you must already have an Xcode project with an app before adding an app extension to it. When writing app extensions for one of your apps, or for another app on the App Store, start your app extension from the Generic Extension target type. The following steps walk you through the process of adding this target type to your existing Xcode project:\n\nThe Generic Extension target template provides the initial code your app extension needs to run. Specifically, it contains a customization of the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtension] type that is the entry point for your app extension’s code. You don’t override this type’s existing behavior, but you do augment it with details about your app extension. For example, you provide it with an [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionConfiguration] object, which creates the XPC connection between your app extension and the host app.\n\n### Bind your app extension to an appropriate extension point\n\nEach time you create an app extension, you target one of the extension points of the associated host app. Extension points are features or capabilities for which the host app supports app extensions. For example, an image-editing app might define an extension point to support custom image filters. In your app extension code, you programmatically specify the extension point you support using a binding. At runtime, the system uses your binding information to match your app extension to the host app on a person’s device.\n\nTo create a binding in your app extension code, add a variable with the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint] type to your existing [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtension] structure. Set the contents of this variable to a closure with an [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint\/Identifier] type, which specifies the name of the extension point and the host app’s bundle identifier. Precede the definition of this variable with the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint\/Bind] property wrapper to tell the compiler that this variable contains your binding details. The following example shows a binding to an app with the extension point name `HostAppFeature`:\n\nAt build time, you use the compiler to generate the actual binding information the system needs. Add a user-defined build setting to your app extension target in Xcode, and set its name to `EX_ENABLE_EXTENSION_POINT_GENERATION` and its value to `YES`. When this setting is present, the compiler extracts the details from your binding code and puts the relevant details in your app extension’s information property list. When someone installs the app containing your app extension, the system reads the keys from this property list and uses them to match your app extension to its host app.\n\n### Configure the XPC connection to the host app\n\nApart from adopting the host app’s required API, an app extension’s only requirement is to establish a communications channel with that app. After launching an app extension, the host app is responsible for initiating an XPC connection to that extension. Accept this connection in your app extension code to start communication with the host.\n\nTo accept an incoming XPC connection request, create a custom type that adopts the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionConfiguration] protocol and initialize your [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtension] type with it. When the host app initiates an XPC connection, the system redirects the request to the code you provide in this type. Use that code to configure the XPC connection details and call the connection’s [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSXPCConnection\/resume()] method. The following code shows an implementation of the protocol’s [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionConfiguration\/accept(connection:)] method, which is where you put your connection code. In the code, the app extension configures the connection with a local object and the interface that both it and the host app recognize.\n\nIf the host app uses the [doc:\/\/com.apple.documentation\/documentation\/XPC] framework for communication, establish a connection using a [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/ConnectionHandler] structure instead of a custom configuration type. The XPC framework is a lower-level version of the Foundation API that offers better options for communicating with hardened app extensions. The host app might require the use of this framework, especially if its extension point includes the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint\/EnhancedSecurity] attribute.\n\nThe following code shows the configuration of a text translation app extension that uses the [doc:\/\/com.apple.documentation\/documentation\/XPC] framework. The app extension’s configuration property returns a [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/ConnectionHandler] type to process incoming requests. The provided closure creates a custom object to handle incoming requests and return a response. The app extension defines the `translate()` method to generate the translation for a host-provided string.\n\nFor more information about using XPC for communicating between processes, see the [doc:\/\/com.apple.documentation\/documentation\/XPC] framework and the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/xpc] in the Foundation framework.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/extensionfoundation\/building-an-app-extension-to-support-a-host-app\ncrawled: 2025-12-05T11:53:59Z\n---\n\n# Building an app extension to support a host app\n\n**Article**\n\nCreate an app extension to perform tasks in a separate process from a host app.\n\n## Overview\n\nAn app extension extends the features of the host app it supports, and runs code in a separate process. You can develop an app extension together with your app, or develop app extensions separately to support a different app. The host app provides the interface your app extension must implement, and both the app and app extension adopt the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation] framework to manage interactions.\n\nIn an app extension, the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation] framework provides the code for running the main event loop and accepting XPC connections. When you create an app extension in Xcode, the generic extension template provides most of the code you need to get started. With that template, you add code to establish communications with the host app, and to implement the expected features.\n\n\n\n### Create your app extension target\n\nAn app extension is a bundle that ships inside an existing app, so you must already have an Xcode project with an app before adding an app extension to it. When writing app extensions for one of your apps, or for another app on the App Store, start your app extension from the Generic Extension target type. The following steps walk you through the process of adding this target type to your existing Xcode project:\n\n1. Open your Xcode project.\n2. Select File > New > Target.\n3. Choose the appropriate platform.\n4. In the app extension section of the panel, select Generic Extension.\n5. Click Next.\n6. Provide a name for the extension.\n7. Set the extension type to Non-UI Extension.\n8. Select your app from the Embed in Application field.\n9. Click Finish to create the target.\n\nThe Generic Extension target template provides the initial code your app extension needs to run. Specifically, it contains a customization of the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtension] type that is the entry point for your app extension’s code. You don’t override this type’s existing behavior, but you do augment it with details about your app extension. For example, you provide it with an [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionConfiguration] object, which creates the XPC connection between your app extension and the host app.\n\n### Bind your app extension to an appropriate extension point\n\nEach time you create an app extension, you target one of the extension points of the associated host app. Extension points are features or capabilities for which the host app supports app extensions. For example, an image-editing app might define an extension point to support custom image filters. In your app extension code, you programmatically specify the extension point you support using a binding. At runtime, the system uses your binding information to match your app extension to the host app on a person’s device.\n\nTo create a binding in your app extension code, add a variable with the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint] type to your existing [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtension] structure. Set the contents of this variable to a closure with an [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint\/Identifier] type, which specifies the name of the extension point and the host app’s bundle identifier. Precede the definition of this variable with the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint\/Bind] property wrapper to tell the compiler that this variable contains your binding details. The following example shows a binding to an app with the extension point name `HostAppFeature`:\n\n```swift\nstruct MyAppExtension: AppExtension {\n    @AppExtensionPoint.Bind\n    var boundAppExtensionPoint: AppExtensionPoint { \n        AppExtensionPoint.Identifier(\"com.example.hostapp\", name \"HostAppFeature\")\n    }\n}\n```\n\nAt build time, you use the compiler to generate the actual binding information the system needs. Add a user-defined build setting to your app extension target in Xcode, and set its name to `EX_ENABLE_EXTENSION_POINT_GENERATION` and its value to `YES`. When this setting is present, the compiler extracts the details from your binding code and puts the relevant details in your app extension’s information property list. When someone installs the app containing your app extension, the system reads the keys from this property list and uses them to match your app extension to its host app.\n\n\n\n### Configure the XPC connection to the host app\n\nApart from adopting the host app’s required API, an app extension’s only requirement is to establish a communications channel with that app. After launching an app extension, the host app is responsible for initiating an XPC connection to that extension. Accept this connection in your app extension code to start communication with the host.\n\nTo accept an incoming XPC connection request, create a custom type that adopts the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionConfiguration] protocol and initialize your [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtension] type with it. When the host app initiates an XPC connection, the system redirects the request to the code you provide in this type. Use that code to configure the XPC connection details and call the connection’s [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSXPCConnection\/resume()] method. The following code shows an implementation of the protocol’s [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionConfiguration\/accept(connection:)] method, which is where you put your connection code. In the code, the app extension configures the connection with a local object and the interface that both it and the host app recognize.\n\n```swift\nstruct ExampleConfiguration<E:ExampleExtension>: AppExtensionConfiguration {\n        \n    \/\/ Determine whether to accept the XPC connection from the host.\n    func accept(connection: NSXPCConnection) -> Bool {\n        connection.exportedObject = myCustomObject\n        connection.exportedInterface = NSXPCInterface(with: HostAppInterface.self)\n        connection.resume()\n        return true\n    }\n}\n```\n\nIf the host app uses the [doc:\/\/com.apple.documentation\/documentation\/XPC] framework for communication, establish a connection using a [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/ConnectionHandler] structure instead of a custom configuration type. The XPC framework is a lower-level version of the Foundation API that offers better options for communicating with hardened app extensions. The host app might require the use of this framework, especially if its extension point includes the [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/AppExtensionPoint\/EnhancedSecurity] attribute.\n\nThe following code shows the configuration of a text translation app extension that uses the [doc:\/\/com.apple.documentation\/documentation\/XPC] framework. The app extension’s configuration property returns a [doc:\/\/com.apple.extensionfoundation\/documentation\/ExtensionFoundation\/ConnectionHandler] type to process incoming requests. The provided closure creates a custom object to handle incoming requests and return a response. The app extension defines the `translate()` method to generate the translation for a host-provided string.\n\n```swift\npublic extension MyTextTransformerExtension {\n    var configuration: some AppExtensionConfiguration {\n        return ConnectionHandler { request  in\n            let handler = Handler(appex: self)\n            return request.accept { session in\n                return handler\n            }\n        }\n    }\n}\n\n\/\/ Process text translation requests using an XPCSession.  \nstruct Handler<E: MyTextTransformerExtension>: XPCPeerHandler {\n    let appex: E\n    \n    func handleIncomingRequest(_ input: TranslateMessage) -> (any Encodable)? {\n        let text = input.text\n        let result = appex.translate(text:text)\n        return TranslateMessage.Response(translatedText: result)\n    }\n}\n\n\/\/ The input message from the host app and the translation response.\nstruct TranslateMessage: Codable {\n    let text: String\n    \n    struct Response: Codable {\n        let translatedText: Text\n    }\n}\n```\n\nFor more information about using XPC for communicating between processes, see the [doc:\/\/com.apple.documentation\/documentation\/XPC] framework and the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/xpc] in the Foundation framework.\n\n## App-extension setup\n\n- **AppExtension**: An interface you use to declare the content, structure, and behavior of an app extension.\n- **AppExtensionConfiguration**: An interface you use to configure the XPC connection in your app extension.\n- **ConnectionHandler**: A type that contains a custom closure that handles incoming XPC connections.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An interface you use to declare the content, structure, and behavior of an app extension.",
          "name" : "AppExtension",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExtensionFoundation\/AppExtension"
        },
        {
          "description" : "An interface you use to configure the XPC connection in your app extension.",
          "name" : "AppExtensionConfiguration",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExtensionFoundation\/AppExtensionConfiguration"
        },
        {
          "description" : "A type that contains a custom closure that handles incoming XPC connections.",
          "name" : "ConnectionHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/ExtensionFoundation\/ConnectionHandler"
        }
      ],
      "title" : "App-extension setup"
    }
  ],
  "source" : "appleJSON",
  "title" : "Building an app extension to support a host app",
  "url" : "https:\/\/developer.apple.com\/documentation\/extensionfoundation\/building-an-app-extension-to-support-a-host-app"
}