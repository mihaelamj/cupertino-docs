{
  "abstract" : "Create and initialize missing contexts.",
  "codeExamples" : [
    {
      "code" : "\/\/ Extension to MyClass for adopting the data store delegate protocol.\nextension MyClass: CLSDataStoreDelegate {\n\n    \/\/ Call this once at app launch.\n    func setupClassKit() {\n        CLSDataStore.shared.delegate = self\n    }\n\n    \/\/ The delegate callback for creating new contexts.\n    func createContext(forIdentifier identifier: String, parentContext: CLSContext, parentIdentifierPath: [String]) -> CLSContext? {\n        let identifierPath = parentIdentifierPath + [identifier]\n        \n        let object = <# A model object based on identifierPath #>\n        let context = CLSContext(type: object.contextType, identifier: identifier, title: object.title)\n        \n        return context\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "if let chapter = object as? Chapter {\n    context.displayOrder = chapter.number\n}",
      "language" : "swift"
    },
    {
      "code" : "dataStore.mainAppContext.topic = .literacyAndWriting",
      "language" : "swift"
    }
  ],
  "contentHash" : "b15f6d8bc3818ccda1e354d9f99776ce6ffd9d01fb93094c1fbba30ce80478ec",
  "crawledAt" : "2025-12-02T18:26:58Z",
  "id" : "AB10EDB0-8180-450D-8853-C6DAB7E5844C",
  "kind" : "article",
  "language" : "swift",
  "module" : "ClassKit",
  "overview" : "## Overview\n\nWhen you request a context with a call to the [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContext\/descendant(matchingIdentifierPath:completion:)] method, whether because you are declaring it or because you want to do something with it, the data store returns the context indicated by the identifier path. But if that context or any of its ancestors doesn’t already exist, the data store asks its delegate to create new ones.\n\n### Adopt the data store delegate protocol\n\nTo enable the delegate to create a context, you adopt the [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSDataStoreDelegate] protocol in your app.\n\nThe data store uses the delegate callback to ask for each new context it encounters. You use the identifier path to determine exactly what the new context should look like. A good way to do this is to map the identifier path to a model object you already have and use its properties to inform context creation. For example, your model objects might represent books, chapters, sections, and quizzes, all of which implement a `title` parameter suitable for use on the context. By also storing a `contextType` parameter on each model instance, with values like [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/book], [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/chapter], [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/section], or [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/quiz], you can create contexts based entirely on model instances, as shown above.\n\n### Provide descriptive titles\n\nThe title you provide at context initialization is what teachers see when browsing your content in the Schoolwork app. Make it easy for teachers to understand what your app offers by choosing good context titles and localizing them, as appropriate. Because titles are the most visible aspect of your hierarchy, it’s important that you make them both clear and descriptive. The title “Thermodynamics Quiz” is much more self-explanatory than “Quiz 8” for example.\n\n### Optionally, indicate display order\n\nIf appropriate, provide guidance for ordering your contexts using the [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContext\/displayOrder] property. For example, immediately after instantiating a context that represents a chapter, you might indicate its position as the chapter number:\n\n### Classify contexts by subject\n\nYou can further classify a context with an optional topic using one of the values from [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextTopic], like [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextTopic\/math] or [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextTopic\/socialScience]. For apps covering a variety of different subject matters, topics help teachers differentiate between the various parts of your app. An app that has a singular focus can simply set its top-level context to the topic that best matches that subject. For example, for a book reader:\n\n### Return the context\n\nOnce you create and configure the context, you simply return it to the data store. The data store associates the context with the appropriate parent and keeps it in memory. The next time you ask the data store for that context, it returns the previously generated one instead of requesting a new one from the delegate. Additionally, for a user logged in as a teacher, the data store saves the changes to an internal database that’s shared with the Schoolwork app and synchronized over iCloud. This allows the context to persist even across launches of your app, but only for teachers. For privacy reasons, other users don’t record contexts in the database.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/ClassKit\/building-missing-contexts\ncrawled: 2025-12-02T18:26:58Z\n---\n\n# Building missing contexts\n\n**Article**\n\nCreate and initialize missing contexts.\n\n## Overview\n\nWhen you request a context with a call to the [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContext\/descendant(matchingIdentifierPath:completion:)] method, whether because you are declaring it or because you want to do something with it, the data store returns the context indicated by the identifier path. But if that context or any of its ancestors doesn’t already exist, the data store asks its delegate to create new ones.\n\n### Adopt the data store delegate protocol\n\nTo enable the delegate to create a context, you adopt the [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSDataStoreDelegate] protocol in your app.\n\n```swift\n\/\/ Extension to MyClass for adopting the data store delegate protocol.\nextension MyClass: CLSDataStoreDelegate {\n\n    \/\/ Call this once at app launch.\n    func setupClassKit() {\n        CLSDataStore.shared.delegate = self\n    }\n\n    \/\/ The delegate callback for creating new contexts.\n    func createContext(forIdentifier identifier: String, parentContext: CLSContext, parentIdentifierPath: [String]) -> CLSContext? {\n        let identifierPath = parentIdentifierPath + [identifier]\n        \n        let object = <# A model object based on identifierPath #>\n        let context = CLSContext(type: object.contextType, identifier: identifier, title: object.title)\n        \n        return context\n    }\n}\n```\n\nThe data store uses the delegate callback to ask for each new context it encounters. You use the identifier path to determine exactly what the new context should look like. A good way to do this is to map the identifier path to a model object you already have and use its properties to inform context creation. For example, your model objects might represent books, chapters, sections, and quizzes, all of which implement a `title` parameter suitable for use on the context. By also storing a `contextType` parameter on each model instance, with values like [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/book], [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/chapter], [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/section], or [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextType\/quiz], you can create contexts based entirely on model instances, as shown above.\n\n### Provide descriptive titles\n\nThe title you provide at context initialization is what teachers see when browsing your content in the Schoolwork app. Make it easy for teachers to understand what your app offers by choosing good context titles and localizing them, as appropriate. Because titles are the most visible aspect of your hierarchy, it’s important that you make them both clear and descriptive. The title “Thermodynamics Quiz” is much more self-explanatory than “Quiz 8” for example.\n\n### Optionally, indicate display order\n\nIf appropriate, provide guidance for ordering your contexts using the [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContext\/displayOrder] property. For example, immediately after instantiating a context that represents a chapter, you might indicate its position as the chapter number:\n\n```swift\nif let chapter = object as? Chapter {\n    context.displayOrder = chapter.number\n}\n```\n\n### Classify contexts by subject\n\nYou can further classify a context with an optional topic using one of the values from [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextTopic], like [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextTopic\/math] or [doc:\/\/com.apple.classkit\/documentation\/ClassKit\/CLSContextTopic\/socialScience]. For apps covering a variety of different subject matters, topics help teachers differentiate between the various parts of your app. An app that has a singular focus can simply set its top-level context to the topic that best matches that subject. For example, for a book reader:\n\n```swift\ndataStore.mainAppContext.topic = .literacyAndWriting\n```\n\n### Return the context\n\nOnce you create and configure the context, you simply return it to the data store. The data store associates the context with the appropriate parent and keeps it in memory. The next time you ask the data store for that context, it returns the previously generated one instead of requesting a new one from the delegate. Additionally, for a user logged in as a teacher, the data store saves the changes to an internal database that’s shared with the Schoolwork app and synchronized over iCloud. This allows the context to persist even across launches of your app, but only for teachers. For privacy reasons, other users don’t record contexts in the database.\n\n\n\n## Managing the delegate\n\n- **delegate**: The data store delegate instance.\n- **CLSDataStoreDelegate**: An interface the data store uses to request new contexts.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The data store delegate instance.",
          "name" : "delegate",
          "url" : "https:\/\/developer.apple.com\/documentation\/ClassKit\/CLSDataStore\/delegate"
        },
        {
          "description" : "An interface the data store uses to request new contexts.",
          "name" : "CLSDataStoreDelegate",
          "url" : "https:\/\/developer.apple.com\/documentation\/ClassKit\/CLSDataStoreDelegate"
        }
      ],
      "title" : "Managing the delegate"
    }
  ],
  "source" : "appleJSON",
  "title" : "Building missing contexts",
  "url" : "https:\/\/developer.apple.com\/documentation\/ClassKit\/building-missing-contexts"
}