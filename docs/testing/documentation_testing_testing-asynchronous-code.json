{
  "abstract" : "Validate whether your code causes expected events to happen.",
  "codeExamples" : [
    {
      "code" : "@Test func priceLookupYieldsExpectedValue() async {\n  let mozarellaPrice = await unitPrice(for: .mozarella)\n  #expect(mozarellaPrice == 3)\n}",
      "language" : "swift"
    },
    {
      "code" : "@Test(\"OrderCalculator successfully calculates subtotal for no pizzas\")\nfunc subtotalForNoPizzas() async {\n  let calculator = OrderCalculator()\n  await confirmation() { confirmation in\n    calculator.successHandler = { _ in confirmation() }\n    _ = await calculator.subtotal(for: PizzaToppings(bases: []))\n  }\n}",
      "language" : "swift"
    },
    {
      "code" : "@Test(\"Customers bought sandwiches\")\nfunc boughtSandwiches() async {\n  await confirmation(expectedCount: 0 ..< 1000) { boughtSandwich in\n    var foodTruck = FoodTruck()\n    foodTruck.orderHandler = { order in\n      if order.contains(.sandwich) {\n        boughtSandwich()\n      }\n    }\n    await FoodTruck.operate()\n  }\n}",
      "language" : "swift"
    },
    {
      "code" : "@Test func orderCalculatorEncountersNoErrors() async {\n  let calculator = OrderCalculator()\n  await confirmation(expectedCount: 0) { confirmation in\n    calculator.errorHandler = { _ in confirmation() }\n    calculator.subtotal(for: PizzaToppings(bases: []))\n  }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "9020176925dd00cb1ade8d1567a115e1443b1ab5fc6e5745ce2eaa5307f37aaa",
  "crawledAt" : "2025-12-02T17:02:32Z",
  "id" : "365BDE83-ABBD-4F77-A704-393278A42921",
  "kind" : "article",
  "language" : "swift",
  "module" : "Swift Testing",
  "overview" : "## Overview\n\nThe testing library integrates with Swift concurrency, meaning that in many situations you can test asynchronous code using standard Swift features.  Mark your test function as `async` and, in the function body, `await` any asynchronous interactions:\n\nIn more complex situations you can use [doc:\/\/org.swift.testing\/documentation\/Testing\/Confirmation] to discover whether an expected event happens.\n\n### Confirm that an event happens\n\nCall [doc:\/\/org.swift.testing\/documentation\/Testing\/confirmation(_:expectedCount:isolation:sourceLocation:_:)-5mqz2] in your asynchronous test function to create a `Confirmation` for the expected event. In the trailing closure parameter, call the code under test. Swift Testing passes a `Confirmation` as the parameter to the closure, which you call as a function in the event handler for the code under test when the event you’re testing for occurs:\n\nIf you expect the event to happen more than once, set the `expectedCount` parameter to the number of expected occurrences. The test passes if the number of occurrences during the test matches the expected count, and fails otherwise.\n\nYou can also pass a range to [doc:\/\/org.swift.testing\/documentation\/Testing\/confirmation(_:expectedCount:isolation:sourceLocation:_:)-l3il] if the exact number of times the event occurs may change over time or is random:\n\nIn this example, there may be zero customers or up to (but not including) 1,000 customers who order sandwiches. Any [https:\/\/developer.apple.com\/documentation\/swift\/rangeexpression] which includes an explicit lower bound can be used:\n\n### Confirm that an event doesn’t happen\n\nTo validate that a particular event doesn’t occur during a test, create a `Confirmation` with an expected count of `0`:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Testing\/testing-asynchronous-code\ncrawled: 2025-12-02T17:02:32Z\n---\n\n# Testing asynchronous code\n\n**Article**\n\nValidate whether your code causes expected events to happen.\n\n## Overview\n\nThe testing library integrates with Swift concurrency, meaning that in many situations you can test asynchronous code using standard Swift features.  Mark your test function as `async` and, in the function body, `await` any asynchronous interactions:\n\n```swift\n@Test func priceLookupYieldsExpectedValue() async {\n  let mozarellaPrice = await unitPrice(for: .mozarella)\n  #expect(mozarellaPrice == 3)\n}\n```\n\nIn more complex situations you can use [doc:\/\/org.swift.testing\/documentation\/Testing\/Confirmation] to discover whether an expected event happens.\n\n### Confirm that an event happens\n\nCall [doc:\/\/org.swift.testing\/documentation\/Testing\/confirmation(_:expectedCount:isolation:sourceLocation:_:)-5mqz2] in your asynchronous test function to create a `Confirmation` for the expected event. In the trailing closure parameter, call the code under test. Swift Testing passes a `Confirmation` as the parameter to the closure, which you call as a function in the event handler for the code under test when the event you’re testing for occurs:\n\n```swift\n@Test(\"OrderCalculator successfully calculates subtotal for no pizzas\")\nfunc subtotalForNoPizzas() async {\n  let calculator = OrderCalculator()\n  await confirmation() { confirmation in\n    calculator.successHandler = { _ in confirmation() }\n    _ = await calculator.subtotal(for: PizzaToppings(bases: []))\n  }\n}\n```\n\nIf you expect the event to happen more than once, set the `expectedCount` parameter to the number of expected occurrences. The test passes if the number of occurrences during the test matches the expected count, and fails otherwise.\n\nYou can also pass a range to [doc:\/\/org.swift.testing\/documentation\/Testing\/confirmation(_:expectedCount:isolation:sourceLocation:_:)-l3il] if the exact number of times the event occurs may change over time or is random:\n\n```swift\n@Test(\"Customers bought sandwiches\")\nfunc boughtSandwiches() async {\n  await confirmation(expectedCount: 0 ..< 1000) { boughtSandwich in\n    var foodTruck = FoodTruck()\n    foodTruck.orderHandler = { order in\n      if order.contains(.sandwich) {\n        boughtSandwich()\n      }\n    }\n    await FoodTruck.operate()\n  }\n}\n```\n\nIn this example, there may be zero customers or up to (but not including) 1,000 customers who order sandwiches. Any [https:\/\/developer.apple.com\/documentation\/swift\/rangeexpression] which includes an explicit lower bound can be used:\n\n\n\n### Confirm that an event doesn’t happen\n\nTo validate that a particular event doesn’t occur during a test, create a `Confirmation` with an expected count of `0`:\n\n```swift\n@Test func orderCalculatorEncountersNoErrors() async {\n  let calculator = OrderCalculator()\n  await confirmation(expectedCount: 0) { confirmation in\n    calculator.errorHandler = { _ in confirmation() }\n    calculator.subtotal(for: PizzaToppings(bases: []))\n  }\n}\n```\n\n## Confirming that asynchronous events occur\n\n- **confirmation(_:expectedCount:isolation:sourceLocation:_:)**: Confirm that some event occurs during the invocation of a function.\n- **confirmation(_:expectedCount:isolation:sourceLocation:_:)**: Confirm that some event occurs during the invocation of a function.\n- **Confirmation**: A type that can be used to confirm that an event occurs zero or more times.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Confirm that some event occurs during the invocation of a function.",
          "name" : "confirmation(_:expectedCount:isolation:sourceLocation:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/confirmation(_:expectedCount:isolation:sourceLocation:_:)-5mqz2"
        },
        {
          "description" : "Confirm that some event occurs during the invocation of a function.",
          "name" : "confirmation(_:expectedCount:isolation:sourceLocation:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/confirmation(_:expectedCount:isolation:sourceLocation:_:)-l3il"
        },
        {
          "description" : "A type that can be used to confirm that an event occurs zero or more times.",
          "name" : "Confirmation",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/Confirmation"
        }
      ],
      "title" : "Confirming that asynchronous events occur"
    }
  ],
  "source" : "appleJSON",
  "title" : "Testing asynchronous code",
  "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/testing-asynchronous-code"
}