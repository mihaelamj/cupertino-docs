{
  "abstract" : "Use exit tests to test functionality that might cause a test process to exit.",
  "codeExamples" : [
    {
      "code" : "extension Customer {\n  func eat(_ food: consuming some Food) {\n    precondition(food.isDelicious, \"Tasty food only!\")\n    precondition(food.isNutritious, \"Healthy food only!\")\n    ...\n  }\n}",
      "language" : "swift"
    },
    {
      "code" : "@Test func `Customer won't eat food unless it's delicious`() async {\n  let result = await #expect(processExitsWith: .failure) {\n    var food = ...\n    food.isDelicious = false\n    Customer.current.eat(food)\n  }\n}",
      "language" : "swift"
    },
    {
      "code" : "extension Customer {\n  func eat(_ food: consuming some Food) {\n    print(\"Let's see if I want to eat \\(food)...\")\n    precondition(food.isDelicious, \"Tasty food only!\")\n    precondition(food.isNutritious, \"Healthy food only!\")\n    ...\n  }\n}\n\n@Test func `Customer won't eat food unless it's delicious`() async {\n  let result = await #expect(\n    processExitsWith: .failure,\n    observing: [\\.standardOutputContent]\n  ) {\n    var food = ...\n    food.isDelicious = false\n    Customer.current.eat(food)\n  }\n  if let result {\n    #expect(result.standardOutputContent.contains(UInt8(ascii: \"L\")))\n  }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "c8a1352179362a5d486f5a94179738cb84fc89623150e87c74338098a4cf365d",
  "crawledAt" : "2025-12-04T02:36:30Z",
  "id" : "FE22B16C-011B-459E-8141-BC40F140FED1",
  "kind" : "article",
  "language" : "swift",
  "module" : "Swift Testing",
  "overview" : "## Overview\n\nYour code might contain calls to [https:\/\/developer.apple.com\/documentation\/swift\/precondition(_:_:file:line:)], [https:\/\/developer.apple.com\/documentation\/swift\/fatalerror(_:file:line:)], or other functions that can cause the current process to exit. For example:\n\nIn this function, if `food.isDelicious` or `food.isNutritious` is `false`, the precondition fails and Swift forces the process to exit. You can write an exit test to validate preconditions like the ones above and to make sure that your functions correctly catch invalid inputs.\n\n### Create an exit test\n\nTo create an exit test, call either the [doc:\/\/org.swift.testing\/documentation\/Testing\/expect(processExitsWith:observing:_:sourceLocation:performing:)] or the [doc:\/\/org.swift.testing\/documentation\/Testing\/require(processExitsWith:observing:_:sourceLocation:performing:)] macro:\n\nThe closure or function reference you pass to the macro is the *body* of the exit test. When an exit test is performed at runtime, the testing library starts a new process with the same executable as the current process. The current task is then suspended (as with `await`) and waits for the child process to exit.\n\nThe parent process doesn’t call the body of the exit test. Instead, the child process treats the body of the exit test as its `main()` function and calls it directly.\n\nIf the body returns before the child process exits, the process exits as if `main()` returned normally. If the body throws an error, Swift handles it as if it were thrown from `main()` and forces the process to exit abnormally.\n\n### Specify an exit condition\n\nWhen you create an exit test, specify how you expect the child process exits by passing an instance of [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Condition]:\n\nWhen the child process exits, the parent process resumes and compares the exit status of the child process against the expected exit condition you passed. If they match, the exit test passes; otherwise, it fails and the testing library records an issue.\n\n### Gather output from the child process\n\nThe [doc:\/\/org.swift.testing\/documentation\/Testing\/expect(processExitsWith:observing:_:sourceLocation:performing:)] and [doc:\/\/org.swift.testing\/documentation\/Testing\/require(processExitsWith:observing:_:sourceLocation:performing:)] macros return an instance of [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Result] that contains information about the state of the child process.\n\nBy default, the child process is configured without a standard output or standard error stream. If your test needs to review the content of either of these streams, pass the key path to the corresponding [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Result] property to the macro:\n\nThe testing library always sets [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Result\/exitStatus] to the actual exit status of the child process (as reported by the system) even if you do not observe `\\.exitStatus`.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Testing\/exit-testing\ncrawled: 2025-12-04T02:36:30Z\n---\n\n# Exit testing\n\n**Article**\n\nUse exit tests to test functionality that might cause a test process to exit.\n\n## Overview\n\nYour code might contain calls to [https:\/\/developer.apple.com\/documentation\/swift\/precondition(_:_:file:line:)], [https:\/\/developer.apple.com\/documentation\/swift\/fatalerror(_:file:line:)], or other functions that can cause the current process to exit. For example:\n\n```swift\nextension Customer {\n  func eat(_ food: consuming some Food) {\n    precondition(food.isDelicious, \"Tasty food only!\")\n    precondition(food.isNutritious, \"Healthy food only!\")\n    ...\n  }\n}\n```\n\nIn this function, if `food.isDelicious` or `food.isNutritious` is `false`, the precondition fails and Swift forces the process to exit. You can write an exit test to validate preconditions like the ones above and to make sure that your functions correctly catch invalid inputs.\n\n\n\n### Create an exit test\n\nTo create an exit test, call either the [doc:\/\/org.swift.testing\/documentation\/Testing\/expect(processExitsWith:observing:_:sourceLocation:performing:)] or the [doc:\/\/org.swift.testing\/documentation\/Testing\/require(processExitsWith:observing:_:sourceLocation:performing:)] macro:\n\n```swift\n@Test func `Customer won't eat food unless it's delicious`() async {\n  let result = await #expect(processExitsWith: .failure) {\n    var food = ...\n    food.isDelicious = false\n    Customer.current.eat(food)\n  }\n}\n```\n\nThe closure or function reference you pass to the macro is the *body* of the exit test. When an exit test is performed at runtime, the testing library starts a new process with the same executable as the current process. The current task is then suspended (as with `await`) and waits for the child process to exit.\n\n\n\nThe parent process doesn’t call the body of the exit test. Instead, the child process treats the body of the exit test as its `main()` function and calls it directly.\n\n\n\nIf the body returns before the child process exits, the process exits as if `main()` returned normally. If the body throws an error, Swift handles it as if it were thrown from `main()` and forces the process to exit abnormally.\n\n### Specify an exit condition\n\nWhen you create an exit test, specify how you expect the child process exits by passing an instance of [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Condition]:\n\n- If you expect the exit test’s body to run to completion or exit normally (for example, by calling [https:\/\/developer.apple.com\/library\/archive\/documentation\/System\/Conceptual\/ManPages_iPhoneOS\/man3\/exit.3.html] from the C standard library), pass [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Condition\/success].\n- If you expect the body to cause the child process to exit abnormally, but the exact status reported by the system is not important, pass [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Condition\/failure].\n- If you need to check for a specific exit code or signal, pass [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Condition\/exitCode(_:)] or [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Condition\/signal(_:)].\n\nWhen the child process exits, the parent process resumes and compares the exit status of the child process against the expected exit condition you passed. If they match, the exit test passes; otherwise, it fails and the testing library records an issue.\n\n### Gather output from the child process\n\nThe [doc:\/\/org.swift.testing\/documentation\/Testing\/expect(processExitsWith:observing:_:sourceLocation:performing:)] and [doc:\/\/org.swift.testing\/documentation\/Testing\/require(processExitsWith:observing:_:sourceLocation:performing:)] macros return an instance of [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Result] that contains information about the state of the child process.\n\nBy default, the child process is configured without a standard output or standard error stream. If your test needs to review the content of either of these streams, pass the key path to the corresponding [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Result] property to the macro:\n\n```swift\nextension Customer {\n  func eat(_ food: consuming some Food) {\n    print(\"Let's see if I want to eat \\(food)...\")\n    precondition(food.isDelicious, \"Tasty food only!\")\n    precondition(food.isNutritious, \"Healthy food only!\")\n    ...\n  }\n}\n\n@Test func `Customer won't eat food unless it's delicious`() async {\n  let result = await #expect(\n    processExitsWith: .failure,\n    observing: [\\.standardOutputContent]\n  ) {\n    var food = ...\n    food.isDelicious = false\n    Customer.current.eat(food)\n  }\n  if let result {\n    #expect(result.standardOutputContent.contains(UInt8(ascii: \"L\")))\n  }\n}\n```\n\n\n\nThe testing library always sets [doc:\/\/org.swift.testing\/documentation\/Testing\/ExitTest\/Result\/exitStatus] to the actual exit status of the child process (as reported by the system) even if you do not observe `\\.exitStatus`.\n\n## Checking how processes exit\n\n- **expect(processExitsWith:observing:_:sourceLocation:performing:)**: Check that an expression causes the process to terminate in a given fashion.\n- **require(processExitsWith:observing:_:sourceLocation:performing:)**: Check that an expression causes the process to terminate in a given fashion and throw an error if it did not.\n- **ExitStatus**: An enumeration describing possible status a process will report on exit.\n- **ExitTest**: A type describing an exit test.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Check that an expression causes the process to terminate in a given fashion.",
          "name" : "expect(processExitsWith:observing:_:sourceLocation:performing:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/expect(processExitsWith:observing:_:sourceLocation:performing:)"
        },
        {
          "description" : "Check that an expression causes the process to terminate in a given fashion and throw an error if it did not.",
          "name" : "require(processExitsWith:observing:_:sourceLocation:performing:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/require(processExitsWith:observing:_:sourceLocation:performing:)"
        },
        {
          "description" : "An enumeration describing possible status a process will report on exit.",
          "name" : "ExitStatus",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/ExitStatus"
        },
        {
          "description" : "A type describing an exit test.",
          "name" : "ExitTest",
          "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/ExitTest"
        }
      ],
      "title" : "Checking how processes exit"
    }
  ],
  "source" : "appleJSON",
  "title" : "Exit testing",
  "url" : "https:\/\/developer.apple.com\/documentation\/Testing\/exit-testing"
}