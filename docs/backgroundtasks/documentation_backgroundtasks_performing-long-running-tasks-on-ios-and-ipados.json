{
  "abstract" : "Use a continuous background task to do work that can complete as needed.",
  "codeExamples" : [
    {
      "code" : "private let taskIdentifier = \"<bundle-id><task-name>\" \/\/ Use your app's bundle ID.   \n\n\/\/ Create the task request. \nlet request = BGContinuedProcessingTaskRequest(\n    identifier: taskIdentifier,\n    title: \"A video export\",\n    subtitle: \"About to start...\",\n)",
      "language" : "swift"
    },
    {
      "code" : "if BGTaskScheduler.supportedResources.contains(.gpu) {\n    request.requiredResources = .gpu\n}",
      "language" : "swift"
    },
    {
      "code" : "request.strategy = .fail",
      "language" : "swift"
    },
    {
      "code" : "BGTaskScheduler.shared.register(forTaskWithIdentifier: taskIdentifier, using: nil) { task in\n    guard let task = task as? BGContinuedProcessingTask else { return }\n    ... ",
      "language" : "swift"
    },
    {
      "code" : "\/\/ App-defined function that registers a continuous background task and defines its long-running work.\nprivate func register() {\n    \/\/ Submission bookkeeping. \n    if submitted {\n        return\n    }\n    submitted = true\n    \n    \/\/ Register the continuous background task. \n    scheduler.register(forTaskWithIdentifier: taskIdentifier, using: nil) { task in\n        guard let task = task as? BGContinuedProcessingTask else {\n            return\n        }\n        \/* Do long-running work here. *\/\n    }\n}\n",
      "language" : "swift"
    },
    {
      "code" : "\/\/ App-defined function that submits a video export job through a continuous background task.\nprivate func submit() {\n    \/\/ Create the task request. \n    let request = BGContinuedProcessingTaskRequest(identifier: taskIdentifier, title: \"A video export\", subtitle: \"About to start...\")\n\n    \/\/ Submit the task request.\n    do {\n        try scheduler.submit(request)\n    } catch {\n        print(\"Failed to submit request: \\(error)\")\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Create a progress instance.\nlet stepCount: Int64 = 100 \/\/ For example, percentage of completion.\nlet progress = Progress(totalUnitCount: stepCount)\n\nfor i in 1...stepCount {\n    \/\/ Update progress.\n    task.progress.completedUnitCount = Int64(i)\n} ",
      "language" : "swift"
    },
    {
      "code" : "\/\/\/ App-defined function that exports a video through a continuous background task.\nfunc export(_ task: BGContinuedProcessingTask) -> Result<(), PipelineError> {\n    var wasExpired = false\n\n    \/\/ Check the expiration handler to confirm job completion.\n    task.expirationHandler = {\n        wasExpired = true\n    }\n\n    \/\/ Update progress.\n    let progress = task.progress\n    progress.totalUnitCount = 100\n    while !progress.isFinished && !wasExpired {\n        progress.completedUnitCount += 1\n        let formattedProgress = String(format: \"%.2f\", progress.fractionCompleted * 100)\n\n        \/\/ Update task for displayed progress.\n        task.updateTitle(task.title, subtitle: \"Completed \\(formattedProgress)%\")\n        sleep(1)\n    }\n\n    \/\/ Check progress to confirm job completion.\n    if progress.isFinished {\n        return .success(())\n    } else {\n        return .failure(.expired)\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "724af7db496ac25f1694529209df945de35e6f8e6bc984301fb998fdc9142075",
  "crawledAt" : "2025-12-02T15:25:50Z",
  "id" : "266EAC80-A464-47F9-8AFC-16511A9AF66A",
  "kind" : "article",
  "language" : "swift",
  "module" : "Background Tasks",
  "overview" : "## Overview\n\nOn iOS and iPadOS, apps can execute long-running jobs using the Continuous Background Task ([doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask]), which enables your app’s critical work that can take minutes or more, to complete in the background if a person backgrounds the app before the job completes.\n\nUnlike other [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTask] subclasses, [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask] starts in the foreground. In addition, your app needs to run the task only in response to someone’s action, such as tapping a button. If a person backgrounds the app before the task completes, a continuous background task can still perform operations, for example, Core ML processing or sensor data analysis, that leverage the GPU (on supported devices). In the background, continuous background tasks can also use the network and perform intenstive CPU-based operations, for example, image processing with Core Image, Vision, and Accelerate. Example tasks include:\n\nFor added flexibility, you can set the system to fail any task if, under resource constraints, the system can’t begin processing the task immediately. Otherwise, the system queues the task to begin as soon as possible.\n\n\n\nWhen the system runs a continuous background task and a person backgrounds the app, the system keeps them informed of the task’s progress through a system interface. For power and performance considerations, people can cancel a continuous background task if they desire, through the interface. Your app regularly reports progress of the task, which enables the system to make informed suggestions through the interface about possibly stuck tasks that a person can cancel.\n\nIf a person cancels a task through the interface, the framework invokes the task’s expiration handler and the app handles the failure. Otherwise, the framework returns control to the app’s completion handler with a success status.\n\n\n\n## Create a Continuous Background Task request\n\nTo begin a job that you want to complete even if a person backgrounds the app, start by creating a task request ([doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest]). Choose a name the system can use to identify the specific job in the `taskIdentifier` parameter of the initializer and prefix it with your app’s bundle ID:\n\nMake the `task-name` portion of the task identifier unique for this specific job. The system displays the `title` and `subtitle` arguments you choose in a Live Activity, where a person can monitor the job’s progress and cancel it, if they choose.\n\n## Enable background GPU use\n\nIf your job includes API that can utilize the GPU, enable background GPU use for your task by setting [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/requiredResources] to [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/Resources\/gpu]. First, check whether the device supports background GPU use by seeing if [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler\/supportedResources] contains `.gpu`:\n\nThe system requires your app to have the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.background-tasks.continued-processing.gpu] entitlement with a value of `true` to use the GPU in the background. To do that, enable the Background GPU Access capability on your app’s target. For more information about capabilities in Xcode, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/adding-capabilities-to-your-app].\n\n## Choose a processing strategy\n\nWhen the system is busy or resource constrained, it might queue your task request for later execution. The default submission strategy, [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/SubmissionStrategy\/queue], instructs the system to add your task request to a queue if there’s no immediately available room to run it.\n\nIf instead you want the task submission to fail if the system is unable to run the task immediately, set [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/strategy] to [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/SubmissionStrategy\/fail]  .\n\nThe system cancels a `fail` task right away if it can’t begin processing the task immediately, for example, when the system reaches a maximum number of concurrent tasks.\n\n## Run the continuous background task\n\nTo run the job, register the task request with the shared [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler] using the unique `taskIdentifier`:\n\nThe [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler\/register(forTaskWithIdentifier:using:launchHandler:)] launch handler provides the [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask] reference for you to control execution.\n\nInside the launch handler, define your task’s long-running code:\n\nNext, submit the request by passing it to the shared scheduler’s [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler\/submit(_:)] method:\n\n## Report progress\n\nThe system displays the job and other continuous background tasks in a Live Activity to inform people of background task progress. It’s important to display accurate progress, as a person can cancel a task through the Live Activity widget if the task appears to be stuck.\n\nTo set progress, use the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/ProgressReporting] protocol that [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask] conforms to:\n\nThe system also prioritizes the termination of tasks that reflect minimal progress, if resource constraints occur at run time.\n\n## Respond to task completion\n\nPrepare to handle task failure or success by checking the tasks [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTask\/expirationHandler]:\n\nA task can fail if your code encounters an error or the system expires your task, as occurs when a person cancels the task in the system UI.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/BackgroundTasks\/performing-long-running-tasks-on-ios-and-ipados\ncrawled: 2025-12-02T15:25:50Z\n---\n\n# Performing long-running tasks on iOS and iPadOS\n\n**Article**\n\nUse a continuous background task to do work that can complete as needed.\n\n## Overview\n\nOn iOS and iPadOS, apps can execute long-running jobs using the Continuous Background Task ([doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask]), which enables your app’s critical work that can take minutes or more, to complete in the background if a person backgrounds the app before the job completes.\n\nUnlike other [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTask] subclasses, [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask] starts in the foreground. In addition, your app needs to run the task only in response to someone’s action, such as tapping a button. If a person backgrounds the app before the task completes, a continuous background task can still perform operations, for example, Core ML processing or sensor data analysis, that leverage the GPU (on supported devices). In the background, continuous background tasks can also use the network and perform intenstive CPU-based operations, for example, image processing with Core Image, Vision, and Accelerate. Example tasks include:\n\n- Exporting video in a film-editing app, or audio in a digital audio workstation (DAW)\n- Creating thumbnails for a new batch of photo uploads\n- Applying visual filters (HDR, etc) or compressing images for social media posts\n\nFor added flexibility, you can set the system to fail any task if, under resource constraints, the system can’t begin processing the task immediately. Otherwise, the system queues the task to begin as soon as possible.\n\n\n\nWhen the system runs a continuous background task and a person backgrounds the app, the system keeps them informed of the task’s progress through a system interface. For power and performance considerations, people can cancel a continuous background task if they desire, through the interface. Your app regularly reports progress of the task, which enables the system to make informed suggestions through the interface about possibly stuck tasks that a person can cancel.\n\nIf a person cancels a task through the interface, the framework invokes the task’s expiration handler and the app handles the failure. Otherwise, the framework returns control to the app’s completion handler with a success status.\n\n\n\n## Create a Continuous Background Task request\n\nTo begin a job that you want to complete even if a person backgrounds the app, start by creating a task request ([doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest]). Choose a name the system can use to identify the specific job in the `taskIdentifier` parameter of the initializer and prefix it with your app’s bundle ID:\n\n```swift\nprivate let taskIdentifier = \"<bundle-id><task-name>\" \/\/ Use your app's bundle ID.   \n\n\/\/ Create the task request. \nlet request = BGContinuedProcessingTaskRequest(\n    identifier: taskIdentifier,\n    title: \"A video export\",\n    subtitle: \"About to start...\",\n)\n```\n\nMake the `task-name` portion of the task identifier unique for this specific job. The system displays the `title` and `subtitle` arguments you choose in a Live Activity, where a person can monitor the job’s progress and cancel it, if they choose.\n\n## Enable background GPU use\n\nIf your job includes API that can utilize the GPU, enable background GPU use for your task by setting [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/requiredResources] to [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/Resources\/gpu]. First, check whether the device supports background GPU use by seeing if [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler\/supportedResources] contains `.gpu`:\n\n```swift\nif BGTaskScheduler.supportedResources.contains(.gpu) {\n    request.requiredResources = .gpu\n}\n```\n\nThe system requires your app to have the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.background-tasks.continued-processing.gpu] entitlement with a value of `true` to use the GPU in the background. To do that, enable the Background GPU Access capability on your app’s target. For more information about capabilities in Xcode, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/adding-capabilities-to-your-app].\n\n## Choose a processing strategy\n\nWhen the system is busy or resource constrained, it might queue your task request for later execution. The default submission strategy, [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/SubmissionStrategy\/queue], instructs the system to add your task request to a queue if there’s no immediately available room to run it.\n\nIf instead you want the task submission to fail if the system is unable to run the task immediately, set [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/strategy] to [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTaskRequest\/SubmissionStrategy\/fail]  .\n\n```swift\nrequest.strategy = .fail\n```\n\nThe system cancels a `fail` task right away if it can’t begin processing the task immediately, for example, when the system reaches a maximum number of concurrent tasks.\n\n## Run the continuous background task\n\nTo run the job, register the task request with the shared [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler] using the unique `taskIdentifier`:\n\n```swift\nBGTaskScheduler.shared.register(forTaskWithIdentifier: taskIdentifier, using: nil) { task in\n    guard let task = task as? BGContinuedProcessingTask else { return }\n    ... \n```\n\nThe [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler\/register(forTaskWithIdentifier:using:launchHandler:)] launch handler provides the [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask] reference for you to control execution.\n\nInside the launch handler, define your task’s long-running code:\n\n```swift\n\/\/ App-defined function that registers a continuous background task and defines its long-running work.\nprivate func register() {\n    \/\/ Submission bookkeeping. \n    if submitted {\n        return\n    }\n    submitted = true\n    \n    \/\/ Register the continuous background task. \n    scheduler.register(forTaskWithIdentifier: taskIdentifier, using: nil) { task in\n        guard let task = task as? BGContinuedProcessingTask else {\n            return\n        }\n        \/* Do long-running work here. *\/\n    }\n}\n\n```\n\nNext, submit the request by passing it to the shared scheduler’s [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTaskScheduler\/submit(_:)] method:\n\n```swift\n\/\/ App-defined function that submits a video export job through a continuous background task.\nprivate func submit() {\n    \/\/ Create the task request. \n    let request = BGContinuedProcessingTaskRequest(identifier: taskIdentifier, title: \"A video export\", subtitle: \"About to start...\")\n\n    \/\/ Submit the task request.\n    do {\n        try scheduler.submit(request)\n    } catch {\n        print(\"Failed to submit request: \\(error)\")\n    }\n}\n```\n\n## Report progress\n\nThe system displays the job and other continuous background tasks in a Live Activity to inform people of background task progress. It’s important to display accurate progress, as a person can cancel a task through the Live Activity widget if the task appears to be stuck.\n\nTo set progress, use the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/ProgressReporting] protocol that [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGContinuedProcessingTask] conforms to:\n\n```swift\n\/\/ Create a progress instance.\nlet stepCount: Int64 = 100 \/\/ For example, percentage of completion.\nlet progress = Progress(totalUnitCount: stepCount)\n\nfor i in 1...stepCount {\n    \/\/ Update progress.\n    task.progress.completedUnitCount = Int64(i)\n} \n```\n\nThe system also prioritizes the termination of tasks that reflect minimal progress, if resource constraints occur at run time.\n\n## Respond to task completion\n\nPrepare to handle task failure or success by checking the tasks [doc:\/\/com.apple.backgroundtasks\/documentation\/BackgroundTasks\/BGTask\/expirationHandler]:\n\n```swift\n\/\/\/ App-defined function that exports a video through a continuous background task.\nfunc export(_ task: BGContinuedProcessingTask) -> Result<(), PipelineError> {\n    var wasExpired = false\n\n    \/\/ Check the expiration handler to confirm job completion.\n    task.expirationHandler = {\n        wasExpired = true\n    }\n\n    \/\/ Update progress.\n    let progress = task.progress\n    progress.totalUnitCount = 100\n    while !progress.isFinished && !wasExpired {\n        progress.completedUnitCount += 1\n        let formattedProgress = String(format: \"%.2f\", progress.fractionCompleted * 100)\n\n        \/\/ Update task for displayed progress.\n        task.updateTitle(task.title, subtitle: \"Completed \\(formattedProgress)%\")\n        sleep(1)\n    }\n\n    \/\/ Check progress to confirm job completion.\n    if progress.isFinished {\n        return .success(())\n    } else {\n        return .failure(.expired)\n    }\n}\n```\n\nA task can fail if your code encounters an error or the system expires your task, as occurs when a person cancels the task in the system UI.\n\n\n\n## Foreground tasks with background support\n\n- **BGContinuedProcessingTask**: A task that starts in the foreground and can continue running in the background as needed.\n- **Background GPU Access**: The entitlement the system requires for a continuous background task to use the GPU.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A task that starts in the foreground and can continue running in the background as needed.",
          "name" : "BGContinuedProcessingTask",
          "url" : "https:\/\/developer.apple.com\/documentation\/BackgroundTasks\/BGContinuedProcessingTask"
        },
        {
          "description" : "The entitlement the system requires for a continuous background task to use the GPU.",
          "name" : "Background GPU Access",
          "url" : "https:\/\/developer.apple.com\/documentation\/BundleResources\/Entitlements\/com.apple.developer.background-tasks.continued-processing.gpu"
        }
      ],
      "title" : "Foreground tasks with background support"
    }
  ],
  "source" : "appleJSON",
  "title" : "Performing long-running tasks on iOS and iPadOS",
  "url" : "https:\/\/developer.apple.com\/documentation\/BackgroundTasks\/performing-long-running-tasks-on-ios-and-ipados"
}