{
  "abstract" : "A set of methods that declares the interface for objects that draw text attachment icons and handle mouse events on their icons.",
  "codeExamples" : [

  ],
  "conformingTypes" : [
    "NSTextAttachmentCell"
  ],
  "contentHash" : "1c6e72c8f4655c0d0c51ad65ab9880169f3e2939b79ea3aaf0f34112f025d5d6",
  "crawledAt" : "2025-12-03T04:15:28Z",
  "declaration" : {
    "code" : "protocol NSTextAttachmentCellProtocol : NSObjectProtocol",
    "language" : "swift"
  },
  "id" : "245633A9-05E5-4D60-98F6-EBEC9174DA58",
  "kind" : "protocol",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Overview\n\nWith the exceptions of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/cellBaselineOffset()], [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/attachment], and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/attachment], all of these methods are implemented by the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCell] class.For general information on text attachments, see [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextView].",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\ncrawled: 2025-12-03T04:15:28Z\n---\n\n# NSTextAttachmentCellProtocol\n\n**Protocol**\n\nA set of methods that declares the interface for objects that draw text attachment icons and handle mouse events on their icons.\n\n## Declaration\n\n```swift\nprotocol NSTextAttachmentCellProtocol : NSObjectProtocol\n```\n\n## Overview\n\nWith the exceptions of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/cellBaselineOffset()], [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/attachment], and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/attachment], all of these methods are implemented by the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCell] class.For general information on text attachments, see [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextView].\n\n## Setting the attachment\n\n- **attachment**: Returns the text attachment object that owns the cell.\n- **attachment**: Returns the text attachment object that owns the cell.\n\n## Drawing the cell contents\n\n- **draw(withFrame:in:)**: Draws the cell’s image in the specified rectangle of the currently focused view.\n- **draw(withFrame:in:characterIndex:)**: Draws the cell’s image at the specified index point in the view.\n- **draw(withFrame:in:characterIndex:layoutManager:)**: Draws the cell’s image using the specified layout manager.\n- **highlight(_:withFrame:in:)**: Draws the receiver’s image with optional highlighting.\n\n## Providing the cell metrics\n\n- **cellSize()**: Returns the size of the attachment’s icon.\n- **cellBaselineOffset()**: Returns the text position where you draw the attachment cell’s image, relative to the current point established in the glyph layout.\n- **cellFrame(for:proposedLineFragment:glyphPosition:characterIndex:)**: Returns the frame of the cell to draw at the specified position in a text container.\n\n## Responding to mouse events\n\n- **wantsToTrackMouse()**: Returns a Boolean value that indicates whether the attachment handles mouse events occurring over its image.\n- **wantsToTrackMouse(for:in:of:atCharacterIndex:)**: Allows an attachment to specify the events for which it tracks the mouse.\n- **trackMouse(with:in:of:untilMouseUp:)**: Handles a mouse-down event on the cell’s image, and optionally waits until a mouse-up event\n- **trackMouse(with:in:of:atCharacterIndex:untilMouseUp:)**: Handles a mouse-down event on the image at the specified character position.\n\n## Attachments\n\n- **NSTextAttachment**: The values for the attachment characteristics of attributed strings and related objects.\n- **NSTextAttachmentViewProvider**: A container object that associates a text attachment at a particular document location with a view object.\n- **NSAdaptiveImageGlyph**: A data object for an emoji-like image that can appear in attributed text.\n- **NSTextAttachmentContainer**: A set of methods that defines the interface to text attachment objects from a layout manager.\n- **NSTextAttachmentLayout**: A set of methods that defines the interface to attachment objects from a text layout manager.\n- **NSTextAttachmentCell**: An object that implements the functionality of the text attachment cell protocol.\n\n## Inherits From\n\n- NSObjectProtocol\n\n## Conforming Types\n\n- NSTextAttachmentCell\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns the text attachment object that owns the cell.",
          "name" : "attachment",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/attachment"
        },
        {
          "description" : "Returns the text attachment object that owns the cell.",
          "name" : "attachment",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/attachment"
        }
      ],
      "title" : "Setting the attachment"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Draws the cell’s image in the specified rectangle of the currently focused view.",
          "name" : "draw(withFrame:in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/draw(withFrame:in:)"
        },
        {
          "description" : "Draws the cell’s image at the specified index point in the view.",
          "name" : "draw(withFrame:in:characterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/draw(withFrame:in:characterIndex:)"
        },
        {
          "description" : "Draws the cell’s image using the specified layout manager.",
          "name" : "draw(withFrame:in:characterIndex:layoutManager:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/draw(withFrame:in:characterIndex:layoutManager:)"
        },
        {
          "description" : "Draws the receiver’s image with optional highlighting.",
          "name" : "highlight(_:withFrame:in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/highlight(_:withFrame:in:)"
        }
      ],
      "title" : "Drawing the cell contents"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns the size of the attachment’s icon.",
          "name" : "cellSize()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/cellSize()"
        },
        {
          "description" : "Returns the text position where you draw the attachment cell’s image, relative to the current point established in the glyph layout.",
          "name" : "cellBaselineOffset()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/cellBaselineOffset()"
        },
        {
          "description" : "Returns the frame of the cell to draw at the specified position in a text container.",
          "name" : "cellFrame(for:proposedLineFragment:glyphPosition:characterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/cellFrame(for:proposedLineFragment:glyphPosition:characterIndex:)"
        }
      ],
      "title" : "Providing the cell metrics"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns a Boolean value that indicates whether the attachment handles mouse events occurring over its image.",
          "name" : "wantsToTrackMouse()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/wantsToTrackMouse()"
        },
        {
          "description" : "Allows an attachment to specify the events for which it tracks the mouse.",
          "name" : "wantsToTrackMouse(for:in:of:atCharacterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/wantsToTrackMouse(for:in:of:atCharacterIndex:)"
        },
        {
          "description" : "Handles a mouse-down event on the cell’s image, and optionally waits until a mouse-up event",
          "name" : "trackMouse(with:in:of:untilMouseUp:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/trackMouse(with:in:of:untilMouseUp:)"
        },
        {
          "description" : "Handles a mouse-down event on the image at the specified character position.",
          "name" : "trackMouse(with:in:of:atCharacterIndex:untilMouseUp:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol\/trackMouse(with:in:of:atCharacterIndex:untilMouseUp:)"
        }
      ],
      "title" : "Responding to mouse events"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The values for the attachment characteristics of attributed strings and related objects.",
          "name" : "NSTextAttachment",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachment"
        },
        {
          "description" : "A container object that associates a text attachment at a particular document location with a view object.",
          "name" : "NSTextAttachmentViewProvider",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentViewProvider"
        },
        {
          "description" : "A data object for an emoji-like image that can appear in attributed text.",
          "name" : "NSAdaptiveImageGlyph",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSAdaptiveImageGlyph"
        },
        {
          "description" : "A set of methods that defines the interface to text attachment objects from a layout manager.",
          "name" : "NSTextAttachmentContainer",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentContainer"
        },
        {
          "description" : "A set of methods that defines the interface to attachment objects from a text layout manager.",
          "name" : "NSTextAttachmentLayout",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentLayout"
        },
        {
          "description" : "An object that implements the functionality of the text attachment cell protocol.",
          "name" : "NSTextAttachmentCell",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCell-swift.class"
        }
      ],
      "title" : "Attachments"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NSObjectProtocol"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "NSTextAttachmentCellProtocol",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextAttachmentCellProtocol"
}