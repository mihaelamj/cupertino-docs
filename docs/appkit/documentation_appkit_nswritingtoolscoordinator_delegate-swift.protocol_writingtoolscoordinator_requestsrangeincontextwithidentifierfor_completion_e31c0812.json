{
  "abstract" : "Asks the delegate to provide the location of the character at the specified point in your view’s coordinate system.",
  "codeExamples" : [

  ],
  "contentHash" : "447346b9656dd1432ccb192c7b29c3d2414d827777366108920401cf217685bc",
  "crawledAt" : "2025-12-02T18:02:44Z",
  "declaration" : {
    "code" : "optional func writingToolsCoordinator(_ writingToolsCoordinator: NSWritingToolsCoordinator, requestsRangeInContextWithIdentifierFor point: NSPoint, completion: @escaping (NSRange, UUID) -> Void)",
    "language" : "swift"
  },
  "id" : "D2385182-9F3A-4A90-ACF4-6629C7D66A11",
  "kind" : "method",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Discussion\n\nWhen someone interacts with your view during a proofreading operation, Writing Tools calls this method to get the location of the interaction. If the interaction occurs in the text of one of your [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/Context] objects, configure an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSRange-c.struct] with the character’s location in that context object and a length of `1`. If the interaction occurs outside of the text of your context objects, configure the range with a location of `NSNotFound`.\n\nWhen specifying the location of a character in your context object, provide a location relative to the start of your context object’s text. The first character in a context object’s text is always at location `0`, and it’s your responsibility to track the location of the context object’s text in your text storage object. When the context object’s text begins in the middle of your text storage, subtract the starting location of the context object’s text from the location you specify in your range value. For example, if the context object’s text starts at character `100` in your text storage, and an interaction occurs with the character at location `102`, specify a range with a location of `2` and a length of `1`.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsRangeInContextWithIdentifierFor:completion:)\ncrawled: 2025-12-02T18:02:44Z\n---\n\n# writingToolsCoordinator(_:requestsRangeInContextWithIdentifierFor:completion:)\n\n**Instance Method**\n\nAsks the delegate to provide the location of the character at the specified point in your view’s coordinate system.\n\n## Declaration\n\n```swift\noptional func writingToolsCoordinator(_ writingToolsCoordinator: NSWritingToolsCoordinator, requestsRangeInContextWithIdentifierFor point: NSPoint, completion: @escaping (NSRange, UUID) -> Void)\n```\n\n```swift\noptional func writingToolsCoordinator(_ writingToolsCoordinator: NSWritingToolsCoordinator, rangeInContextWithIdentifierFor point: NSPoint) async -> (NSRange, UUID)\n```\n\n## Parameters\n\n- **writingToolsCoordinator**: The coordinator object requesting information from your custom view.\n- **point**: A point in your view’s coordinate space. Find the location of the text under this point, if any.\n- **completion**: A handler to execute with the required information. This handler has no return value and takes an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSRange-c.struct] and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/UUID] as parameters. Set the range to the character’s location in one of your [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/Context] objects, which you specify using the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/UUID] parameter. You must call this handler at some point during your method’s implementation.\n\n## Discussion\n\nWhen someone interacts with your view during a proofreading operation, Writing Tools calls this method to get the location of the interaction. If the interaction occurs in the text of one of your [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/Context] objects, configure an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSRange-c.struct] with the character’s location in that context object and a length of `1`. If the interaction occurs outside of the text of your context objects, configure the range with a location of `NSNotFound`.\n\nWhen specifying the location of a character in your context object, provide a location relative to the start of your context object’s text. The first character in a context object’s text is always at location `0`, and it’s your responsibility to track the location of the context object’s text in your text storage object. When the context object’s text begins in the middle of your text storage, subtract the starting location of the context object’s text from the location you specify in your range value. For example, if the context object’s text starts at character `100` in your text storage, and an interaction occurs with the character at location `102`, specify a range with a location of `2` and a length of `1`.\n\n## Displaying proofreading marks\n\n- **writingToolsCoordinator(_:requestsBoundingBezierPathsFor:in:completion:)**: Asks the delegate to provide the bounding paths for the specified text in your view.\n- **writingToolsCoordinator(_:requestsUnderlinePathsFor:in:completion:)**: Asks the delegate to provide an underline shape for the specified text during a proofreading session.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Asks the delegate to provide the bounding paths for the specified text in your view.",
          "name" : "writingToolsCoordinator(_:requestsBoundingBezierPathsFor:in:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsBoundingBezierPathsFor:in:completion:)"
        },
        {
          "description" : "Asks the delegate to provide an underline shape for the specified text during a proofreading session.",
          "name" : "writingToolsCoordinator(_:requestsUnderlinePathsFor:in:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsUnderlinePathsFor:in:completion:)"
        }
      ],
      "title" : "Displaying proofreading marks"
    }
  ],
  "source" : "appleJSON",
  "title" : "writingToolsCoordinator(_:requestsRangeInContextWithIdentifierFor:completion:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsRangeInContextWithIdentifierFor:completion:)"
}