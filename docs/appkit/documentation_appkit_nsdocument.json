{
  "abstract" : "An abstract class that defines the interface for macOS documents.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "Copyable",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSEditorRegistration",
    "NSFilePresenter",
    "NSMenuItemValidation",
    "NSObjectProtocol",
    "NSUserActivityRestoring",
    "NSUserInterfaceValidations",
    "Sendable"
  ],
  "contentHash" : "5a310a06487bfc8b8d8f93ba0458fb304987ec9d5bbf16e8f08569083b0d180c",
  "crawledAt" : "2025-12-03T09:17:44Z",
  "declaration" : {
    "code" : "@MainActor class NSDocument",
    "language" : "swift"
  },
  "id" : "8BFDC908-19C4-4E16-A66B-936D6BF5CDE5",
  "inheritedBy" : [
    "NSPersistentDocument"
  ],
  "kind" : "class",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Overview\n\nA document is an object that can internally represent data displayed in a window and that can read data from and write data to a file or file package. Documents create and manage one or more window controllers and are in turn managed by a document controller. Documents respond to first-responder action messages to save, revert, and print their data.\n\nConceptually, a document is a container for a body of information identified by a name under which it is stored in a disk file. In this sense, however, the document is not the same as the file but is an object in memory that owns and manages the document data. In the context of AppKit, a document is an instance of a custom [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] subclass that knows how to represent internally, in one or more formats, persistent data that is displayed in windows.\n\nA document can read that data from a file and write it to a file. It is also the first-responder target for many menu commands related to documents, such as Save, Revert, and Print. A document manages its window’s edited status and is set up to perform undo and redo operations. When a window is closing, the document is asked before the window delegate to approve the closing.\n\n[doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] is one of the triad of AppKit classes that establish an architectural basis for document-based apps (the others being [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocumentController] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWindowController]).\n\nFor more information about using [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] in a document-based app, see [doc:\/\/com.apple.appkit\/documentation\/AppKit\/developing-a-document-based-app].\n\n### Subclassing NSDocument\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class is designed to be subclassed. That is, the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class is abstract, and your app must create at least one [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] subclass in order to use the document architecture. To create a useful [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] subclass, you must override some methods, and you can optionally override others.\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class itself knows how to handle document data as undifferentiated lumps; although it understands that these lumps are typed, it knows nothing about particular types. In their overrides of the data-based reading and writing methods, subclasses must add the knowledge of particular types and how data of the document’s native type is structured internally. Subclasses are also responsible for the creation of the window controllers that manage document windows and for the implementation of undo and redo. The `NSDocument` class takes care of much of the rest, including generally managing the state of the document.\n\nSee [https:\/\/developer.apple.com\/library\/archive\/documentation\/DataManagement\/Conceptual\/DocBasedAppProgrammingGuideForOSX\/Introduction\/Introduction.html#\/\/apple_ref\/doc\/uid\/TP40011179] for more information about creating subclasses of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument], particularly the list of primitive methods that subclasses must override and those that you can optionally override.\n\n### Document Saving Behavior\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class implements document saving in a way that preserves, when possible, various attributes of each document, including:\n\nCare is also taken to save documents in a way that does not break any user-created aliases that may point to documents. As a result, some methods in any class of `NSDocument` may be invoked with parameters that do not have the same meaning as they did in early releases of macOS. It is important that overrides of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/write(to:ofType:)] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/write(to:ofType:for:originalContentsURL:)] make no assumptions about the file paths passed as parameters, including:\n\nWhen updating your app to link against OS X v10.5, keep in mind that it is usually more appropriate to invoke in your app code one of the `NSDocument` `save...` methods than one of the `write...` methods. The `write...` methods are there primarily for you to override. The [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/saveToURL:ofType:forSaveOperation:error:] method that is meant always to be invoked during document saving, sets the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/fileModificationDate] property  with the file’s new modification date after it has been written (for [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/SaveOperationType\/saveOperation] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/SaveOperationType\/saveAsOperation] only).\n\nLikewise, it’s usually more appropriate to invoke in your app code one of the `NSDocument` `revert...` methods than one of the `read...` methods. The `read...` methods are there primarily for you to override. The [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/revert(toContentsOf:ofType:)] method that is meant always to be invoked during rereading of an open document, sets the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/fileModificationDate] property with the file’s modification date after it has been read.\n\n### iCloud Support\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class implements the file coordination support that is required for an iCloud-enabled, document-based Mac app (see [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/iCloudDesignGuide\/Chapters\/DesigningForDocumentsIniCloud.html#\/\/apple_ref\/doc\/uid\/TP40012094-CH2-SW10] in [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/iCloudDesignGuide\/Chapters\/Introduction.html#\/\/apple_ref\/doc\/uid\/TP40012094]). In addition, this class’s methods for moving and renaming documents, new in OS X v10.8, ensure that these operations are performed in a safe manner for iCloud-enabled apps.\n\n### Multicore Considerations\n\nIn macOS 10.6 and later, `NSDocument` supports the ability to open multiple documents concurrently. However, this support requires the cooperation of the document object. If your document subclass is able to read specific document types independently of other similar documents, you should override the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/canConcurrentlyReadDocuments(ofType:)] class method and return [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] for the appropriate document types. If specific document types rely on shared state information, however, you should return [doc:\/\/com.apple.documentation\/documentation\/Swift\/false] for those types.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/appkit\/nsdocument\ncrawled: 2025-12-03T09:17:44Z\n---\n\n# NSDocument\n\n**Class**\n\nAn abstract class that defines the interface for macOS documents.\n\n## Declaration\n\n```swift\n@MainActor class NSDocument\n```\n\n## Overview\n\nA document is an object that can internally represent data displayed in a window and that can read data from and write data to a file or file package. Documents create and manage one or more window controllers and are in turn managed by a document controller. Documents respond to first-responder action messages to save, revert, and print their data.\n\nConceptually, a document is a container for a body of information identified by a name under which it is stored in a disk file. In this sense, however, the document is not the same as the file but is an object in memory that owns and manages the document data. In the context of AppKit, a document is an instance of a custom [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] subclass that knows how to represent internally, in one or more formats, persistent data that is displayed in windows.\n\nA document can read that data from a file and write it to a file. It is also the first-responder target for many menu commands related to documents, such as Save, Revert, and Print. A document manages its window’s edited status and is set up to perform undo and redo operations. When a window is closing, the document is asked before the window delegate to approve the closing.\n\n[doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] is one of the triad of AppKit classes that establish an architectural basis for document-based apps (the others being [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocumentController] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWindowController]).\n\nFor more information about using [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] in a document-based app, see [doc:\/\/com.apple.appkit\/documentation\/AppKit\/developing-a-document-based-app].\n\n### Subclassing NSDocument\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class is designed to be subclassed. That is, the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class is abstract, and your app must create at least one [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] subclass in order to use the document architecture. To create a useful [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] subclass, you must override some methods, and you can optionally override others.\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class itself knows how to handle document data as undifferentiated lumps; although it understands that these lumps are typed, it knows nothing about particular types. In their overrides of the data-based reading and writing methods, subclasses must add the knowledge of particular types and how data of the document’s native type is structured internally. Subclasses are also responsible for the creation of the window controllers that manage document windows and for the implementation of undo and redo. The `NSDocument` class takes care of much of the rest, including generally managing the state of the document.\n\nSee [https:\/\/developer.apple.com\/library\/archive\/documentation\/DataManagement\/Conceptual\/DocBasedAppProgrammingGuideForOSX\/Introduction\/Introduction.html#\/\/apple_ref\/doc\/uid\/TP40011179] for more information about creating subclasses of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument], particularly the list of primitive methods that subclasses must override and those that you can optionally override.\n\n### Document Saving Behavior\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class implements document saving in a way that preserves, when possible, various attributes of each document, including:\n\n- Creation date\n- Permissions\/privileges\n- Location of the document’s icon in its parent folder’s Icon View Finder window\n- Value of the document’s Show Extension setting\n\nCare is also taken to save documents in a way that does not break any user-created aliases that may point to documents. As a result, some methods in any class of `NSDocument` may be invoked with parameters that do not have the same meaning as they did in early releases of macOS. It is important that overrides of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/write(to:ofType:)] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/write(to:ofType:for:originalContentsURL:)] make no assumptions about the file paths passed as parameters, including:\n\n- The location to which the file is being written. This location might be a hidden temporary directory.\n- The name of the file being written. It is possible that this file has no obvious relation to the document name.\n- The relation of any file being passed, including the original file, to the value in [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/fileURL].\n\nWhen updating your app to link against OS X v10.5, keep in mind that it is usually more appropriate to invoke in your app code one of the `NSDocument` `save...` methods than one of the `write...` methods. The `write...` methods are there primarily for you to override. The [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/saveToURL:ofType:forSaveOperation:error:] method that is meant always to be invoked during document saving, sets the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/fileModificationDate] property  with the file’s new modification date after it has been written (for [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/SaveOperationType\/saveOperation] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/SaveOperationType\/saveAsOperation] only).\n\nLikewise, it’s usually more appropriate to invoke in your app code one of the `NSDocument` `revert...` methods than one of the `read...` methods. The `read...` methods are there primarily for you to override. The [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/revert(toContentsOf:ofType:)] method that is meant always to be invoked during rereading of an open document, sets the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/fileModificationDate] property with the file’s modification date after it has been read.\n\n### iCloud Support\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument] class implements the file coordination support that is required for an iCloud-enabled, document-based Mac app (see [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/iCloudDesignGuide\/Chapters\/DesigningForDocumentsIniCloud.html#\/\/apple_ref\/doc\/uid\/TP40012094-CH2-SW10] in [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/iCloudDesignGuide\/Chapters\/Introduction.html#\/\/apple_ref\/doc\/uid\/TP40012094]). In addition, this class’s methods for moving and renaming documents, new in OS X v10.8, ensure that these operations are performed in a safe manner for iCloud-enabled apps.\n\n### Multicore Considerations\n\nIn macOS 10.6 and later, `NSDocument` supports the ability to open multiple documents concurrently. However, this support requires the cooperation of the document object. If your document subclass is able to read specific document types independently of other similar documents, you should override the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSDocument\/canConcurrentlyReadDocuments(ofType:)] class method and return [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] for the appropriate document types. If specific document types rely on shared state information, however, you should return [doc:\/\/com.apple.documentation\/documentation\/Swift\/false] for those types.\n\n## Creating a Document Object\n\n- **init()**: Initializes and returns an empty document object.\n- **init(contentsOf:ofType:)**: Initializes a document located by a URL of a specified type.\n- **init(for:withContentsOf:ofType:)**: Initializes a document with the specified contents, and places the resulting document’s file at the designated location.\n- **init(type:)**: Initializes a document of a specified type.\n\n## Reading the Document’s Content\n\n- **canConcurrentlyReadDocuments(ofType:)**: Returns a Boolean value that indicates whether the receiver reads multiple documents of the given type concurrently.\n- **read(from:ofType:)**: Sets the contents of this document by reading from a file or file package, of a specified type, located by a URL.\n- **read(from:ofType:)**: Sets the contents of this document by reading from a file wrapper of a specified type.\n- **read(from:ofType:)**: Sets the contents of this document by reading from data of a specified type.\n\n## Writing the Document’s Content\n\n- **canAsynchronouslyWrite(to:ofType:for:)**: Returns whether the receiver can concurrently write to a file or file package located by a URL, that is formatted for a specific type, for a specific kind of save operation.\n- **unblockUserInteraction()**: Unblocks the main thread during asynchronous saving.\n- **write(to:ofType:)**: Writes the contents of the document to a file or file package located by a URL, that is formatted to a specified type.\n- **writeSafely(to:ofType:for:)**: Writes the contents of the document to a file or file package located by a URL.\n- **fileWrapper(ofType:)**: Creates and returns a file wrapper that contains the contents of the document, formatted to the specified type.\n- **data(ofType:)**: Creates and returns a data object that contains the contents of the document, formatted to a specified type.\n- **write(to:ofType:for:originalContentsURL:)**: Writes the contents of the document to a file or file package located by a URL.\n- **save(to:ofType:for:delegate:didSave:contextInfo:)**: Saves the contents of the document to a file or file package located by a URL, that is formatted to a specified type, for a particular kind of save operation.\n- **save(to:ofType:for:completionHandler:)**: Saves the contents of the document to a file or file package located by a URL, that is formatted to a specified type, for a particular kind of save operation, and invokes the passed-in completion handler.\n- **fileAttributesToWrite(to:ofType:for:originalContentsURL:)**: Returns the attributes to write to the file or file package at the specified URL, and targeting the specified type of save operation.\n- **NSDocument.SaveOperationType**: Constants for specifying the type of document-save operation to perform.\n\n## Getting Document Metadata\n\n- **fileURL**: The location of the document’s on-disk representation.\n- **isEntireFileLoaded**: A Boolean value that indicates whether the document’s file is completely loaded into memory.\n- **fileModificationDate**: The last-known modification date of the document’s on-disk representation.\n- **keepBackupFile**: A Boolean value that indicates whether the document archives previously saved versions of the document.\n- **isDraft**: A Boolean value that indicates whether the document is a draft that the user has not yet saved.\n- **fileType**: The name of the document type, as specified in the app’s information property-list file.\n- **isDocumentEdited**: A Boolean value that indicates whether the document has unsaved changes.\n- **isInViewingMode**: A Boolean value that indicates whether the document is in read-only mode.\n\n## Managing File Type Information\n\n- **readableTypes**: Returns the types of data the receiver can read natively and any types filterable to that native type.\n- **writableTypes**: Returns the types of data the receiver can write natively and any types filterable to that native type.\n- **isNativeType(_:)**: Returns a Boolean value that indicates whether the document can read and write the data natively.\n- **writableTypes(for:)**: Returns the names of the types to which this document can be saved for a specified kind of save operation.\n- **fileNameExtension(forType:saveOperation:)**: Returns a filename extension that can be appended to a base filename, for a specified file type and kind of save operation.\n\n## Creating and Managing Window Controllers\n\n- **makeWindowControllers()**: Creates the window controller objects that the document uses to display its content.\n- **addWindowController(_:)**: Adds the specified window controller to the current document.\n- **removeWindowController(_:)**: Removes the specified window controller from the receiver’s array of window controllers.\n- **windowControllers**: The document’s current window controllers.\n- **windowNibName**: The name of the document’s sole nib file.\n- **windowControllerDidLoadNib(_:)**: Called after one of the document’s window controllers loads its nib file.\n- **windowControllerWillLoadNib(_:)**: Called before one of the document’s window controllers loads its nib file.\n- **shouldCloseWindowController(_:delegate:shouldClose:contextInfo:)**: Determines whether the system should close the document and its associated window.\n\n## Managing Document Windows\n\n- **showWindows()**: Displays all of the document’s windows, bringing them to the front and making them main or key as necessary.\n- **setWindow(_:)**: Sets the window outlet of this document to the specified value.\n- **windowForSheet**: Returns the document window to use as the parent of a document-modal sheet.\n- **displayName**: The name of the document as displayed in the title bars of the document’s windows and in alert dialogs related to the document.\n- **defaultDraftName()**: Returns the default draft name for the document subclass.\n- **encodeRestorableState(with:backgroundQueue:)**: Saves the interface-related state of the document.\n\n## Configuring the Autosave Behavior\n\n- **autosavesInPlace**: A Boolean value that indicates whether the document subclass supports autosaving in place.\n- **autosavesDrafts**: A Boolean value that indicates whether the document subclass supports autosaving of drafts.\n- **preservesVersions**: A Boolean value that indicates whether the document subclass supports version management.\n- **autosavedContentsFileURL**: The location of the most recently autosaved document contents.\n- **autosavingFileType**: The document type to use for an autosave operation.\n- **autosavingIsImplicitlyCancellable**: A Boolean value that indicates whether you can cancel an in-progress autosave operation.\n\n## Autosaving the Document\n\n- **checkAutosavingSafety()**: Returns a Boolean value that indicates whether it is safe to autosave document changes.\n- **hasUnautosavedChanges**: A Boolean value that indicates whether the document has changes that have not been autosaved.\n- **scheduleAutosaving()**: Schedules periodic autosaving for the purpose of crash protection.\n- **autosave(withDelegate:didAutosave:contextInfo:)**: Autosaves the document’s contents to an appropriate location in the file system.\n- **autosave(withImplicitCancellability:completionHandler:)**: Autosaves the document’s contents to an appropriate file-system location, as needed.\n- **backupFileURL**: The URL for the document’s backup file that was created during an autosave operation.\n\n## Browsing Document Versions\n\n- **browseVersions(_:)**: Opens the Versions browser in the document’s main window.\n- **isBrowsingVersions**: A Boolean value that indicates whether the document is currently displaying the Versions browser.\n- **stopBrowsingVersions(completionHandler:)**: Dismiss the Versions browser for the current document.\n\n## Storing Documents in iCloud\n\n- **moveToUbiquityContainer(_:)**: Moves the document to the user’s iCloud storage.\n- **usesUbiquitousStorage**: Returns whether the document object stores its contents in the user’s iCloud document storage.\n\n## Managing Undo and Redo Actions\n\n- **undoManager**: The object that the document uses to support undo\/redo operations.\n- **hasUndoManager**: A Boolean value that indicates whether the document owns an undo manager object.\n\n## Updating the Document Change Count\n\n- **updateChangeCount(withToken:for:)**: Updates the document’s change count settings after a successful save operation.\n- **updateChangeCount(_:)**: Updates the receiver’s change count according to the given change type.\n- **NSDocument.ChangeType**: Values that indicate a document’s edit status.\n- **changeCountToken(for:)**: Returns an object that encapsulates the current record of document changes at the beginning of a save operation.\n\n## Handling Window Restoration\n\n- **allowedClasses(forRestorableStateKeyPath:)**: Returns the classes that support secure coding.\n- **encodeRestorableState(with:)**: Saves the interface-related state of the document.\n- **restoreState(with:)**: Restores the interface-related state of the document.\n- **restorableStateKeyPaths**: Returns an array of key paths that represent the restorable attributes of the document.\n- **invalidateRestorableState()**: Marks the document’s interface-related state as dirty.\n- **restoreWindow(withIdentifier:state:completionHandler:)**: Restores a window that was associated with a document, after that document is reopened.\n\n## Presenting a Save Panel\n\n- **runModalSavePanel(for:delegate:didSave:contextInfo:)**: Presents a modal Save panel to the user, then tries to save the document if the user approves the operation.\n- **prepareSavePanel(_:)**: Tells the document to customize the specified Save panel.\n- **shouldRunSavePanelWithAccessoryView**: A Boolean value that indicates whether the document’s Save panel displays a list of supported writable document types.\n- **fileTypeFromLastRunSavePanel**: The file type that was last selected in the Save panel.\n- **fileNameExtensionWasHiddenInLastRunSavePanel**: A Boolean value that indicates whether the user chose to hide the document’s filename extension.\n\n## Supporting User Activities\n\n- **userActivity**: An object that encapsulates a user activity the document supports.\n- **updateUserActivityState(_:)**: Updates the state of the given user activity.\n- **NSUserActivityDocumentURLKey**: The key that identifies the document associated with a user activity.\n\n## Validating User Interface Items\n\n- **validateUserInterfaceItem(_:)**: Validates the specified user interface item that the receiver manages.\n\n## Performing Tasks Serially\n\n- **performSynchronousFileAccess(_:)**: Waits for any scheduled file access to complete, then invokes the passed-in block.\n- **performAsynchronousFileAccess(_:)**: Waits for any scheduled file access to complete but without blocking the main thread, then invokes the passed-in block.\n- **performActivity(withSynchronousWaiting:using:)**: Waits for any work scheduled by previous invocations of this method to complete, then invokes the passed-in block.\n- **continueActivity(_:)**: Continues to perform the task for a user activity object using a different block.\n- **continueAsynchronousWorkOnMainThread(_:)**: Invokes the passed-in block on the main thread.\n\n## Handling User Actions\n\n- **printDocument(_:)**: Prints the receiver in response to the user choosing the Print menu command.\n- **runPageLayout(_:)**: The action method invoked in the receiver as first responder when the user chooses the Page Setup menu command.\n- **revertToSaved(_:)**: The action of the File menu item Revert in a document-based app.\n- **save(_:)**: The action method invoked in the receiver as first responder when the user chooses the Save menu command.\n- **saveAs(_:)**: The action method invoked in the receiver as first responder when the user chooses the Save As menu command.\n- **saveTo(_:)**: The action method invoked in the receiver as first responder when the user chooses the Save To menu command.\n- **save(withDelegate:didSave:contextInfo:)**: Saves the document and delivers the results to the provided delegate object.\n\n## Closing the Document\n\n- **canClose(withDelegate:shouldClose:contextInfo:)**: Determines whether to close the document, prompting the user as needed to choose a course of action.\n- **close()**: Closes all of the document’s windows and removes the document from its document controller.\n\n## Reverting the Document Contents\n\n- **revert(toContentsOf:ofType:)**: Discards all unsaved document modifications and replaces the document’s contents by reading a file or file package located by a URL of a specified type.\n\n## Duplicating the Document\n\n- **duplicate()**: Creates a new document whose contents are the same as the receiver and returns an error object if unsuccessful.\n- **duplicate(_:)**: Creates a copy of the receiving document in response to the user choosing Duplicate from the File menu.\n- **duplicate(withDelegate:didDuplicate:contextInfo:)**: Creates a new document whose contents are the same as the current document.\n\n## Renaming the Document\n\n- **rename(_:)**: Renames the current document in response to the user choosing the Rename menu item.\n\n## Moving the Document\n\n- **move(_:)**: Moves the document to a new location in response to the user choosing the Move To… menu item.\n- **move(completionHandler:)**: Moves the document to a user-selected location.\n- **move(to:completionHandler:)**: Moves the document’s file to the given URL.\n\n## Locking the Document\n\n- **lock(_:)**: Locks the document in response to the user choosing the Lock menu item.\n- **unlock(_:)**: Unlocks the document in response to the user choosing the Unlock menu item.\n- **lock(completionHandler:)**: Prevents the user from making further changes to the document.\n- **lock(completionHandler:)**: Prevents the user from making changes to the document’s file.\n- **unlock(completionHandler:)**: Allows the user to make modifications to the document.\n- **unlock(completionHandler:)**: Allows the user to make modifications to the document’s file.\n- **isLocked**: A Boolean value that indicates whether or not the file can be written to.\n\n## Printing the Document\n\n- **printInfo**: The printing information associated with the document.\n- **preparePageLayout(_:)**: Adds document-specific content to the Page Layout panel.\n- **runModalPageLayout(with:delegate:didRun:contextInfo:)**: Runs the modal page layout panel with the receiver’s printing information object.\n- **runModalPrintOperation(_:delegate:didRun:contextInfo:)**: Runs the specified print operation modally.\n- **shouldChangePrintInfo(_:)**: Returns a Boolean value that indicates whether the document allows changes to the default printing information.\n- **print(withSettings:showPrintPanel:delegate:didPrint:contextInfo:)**: Prints the document’s contents, optionally displaying a print panel to the user.\n- **printOperation(withSettings:)**: Creates and returns a print operation for the document’s contents.\n- **pdfPrintOperation**: A print operation you can use to create a PDF representation of the document’s current contents.\n- **saveToPDF(_:)**: Exports a PDF representation of the document’s current contents.\n\n## Sharing the Document\n\n- **allowsDocumentSharing**: A Boolean value that indicates whether the document is shareable from the standard Share menu.\n- **prepare(_:)**: Perform any custom setup associated with a sharing service picker.\n- **share(with:completionHandler:)**: Share the document’s file using the specified sharing service.\n\n## Handling Script Commands\n\n- **handleClose(_:)**: Handles the Close AppleScript command by attempting to close the document.\n- **handlePrint(_:)**: Handles the Print AppleScript command by attempting to print the document.\n- **handleSave(_:)**: Handles the Save AppleScript command by attempting to save the document.\n- **objectSpecifier**: Returns the object specifier that represents the document.\n- **lastComponentOfFileName**: The name of the document seen by the user in AppleScript.\n\n## Displaying Errors to the User\n\n- **presentError(_:modalFor:delegate:didPresent:contextInfo:)**: Presents an error alert to the user as a modal panel.\n- **presentError(_:)**: Presents an error alert to the user as a modal panel.\n- **willPresentError(_:)**: Called when the receiver is about to present an error.\n- **willNotPresentError(_:)**: Confirms that the error object is not to be presented to the user and the error cannot be recovered from, so cleanup can be done.\n\n## Deprecated\n\n- **Deprecated Symbols**: Review symbols that are no longer supported, and find replacements.\n\n## Instance Properties\n\n- **observedPresentedItemUbiquityAttributes**\n- **presentedItemURL**\n- **previewRepresentableActivityItems**\n- **savePanelShowsFileFormatsControl**\n\n## Instance Methods\n\n- **accommodatePresentedItemDeletion(completionHandler:)**\n- **presentedItemDidChange()**\n- **presentedItemDidChangeUbiquityAttributes(_:)**\n- **presentedItemDidGain(_:)**\n- **presentedItemDidLose(_:)**\n- **presentedItemDidMove(to:)**\n- **presentedItemDidResolveConflict(_:)**\n- **relinquishPresentedItem(toReader:)**\n- **relinquishPresentedItem(toWriter:)**\n- **savePresentedItemChanges(completionHandler:)**\n\n## Documents\n\n- **Developing a Document-Based App**: Write an app that creates, manages, edits, and saves text documents.\n- **NSDocumentController**: An object that manages an app’s documents.\n- **NSPersistentDocument**: A document object that can integrate with Core Data.\n\n## Inherits From\n\n- NSObject\n\n## Inherited By\n\n- NSPersistentDocument\n\n## Conforms To\n\n- CVarArg\n- Copyable\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSEditorRegistration\n- NSFilePresenter\n- NSMenuItemValidation\n- NSObjectProtocol\n- NSUserActivityRestoring\n- NSUserInterfaceValidations\n- Sendable\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Initializes and returns an empty document object.",
          "name" : "init()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/init()"
        },
        {
          "description" : "Initializes a document located by a URL of a specified type.",
          "name" : "init(contentsOf:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/init(contentsOf:ofType:)"
        },
        {
          "description" : "Initializes a document with the specified contents, and places the resulting document’s file at the designated location.",
          "name" : "init(for:withContentsOf:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/init(for:withContentsOf:ofType:)"
        },
        {
          "description" : "Initializes a document of a specified type.",
          "name" : "init(type:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/init(type:)"
        }
      ],
      "title" : "Creating a Document Object"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns a Boolean value that indicates whether the receiver reads multiple documents of the given type concurrently.",
          "name" : "canConcurrentlyReadDocuments(ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/canConcurrentlyReadDocuments(ofType:)"
        },
        {
          "description" : "Sets the contents of this document by reading from a file or file package, of a specified type, located by a URL.",
          "name" : "read(from:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/read(from:ofType:)-1vttv"
        },
        {
          "description" : "Sets the contents of this document by reading from a file wrapper of a specified type.",
          "name" : "read(from:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/read(from:ofType:)-3rzsi"
        },
        {
          "description" : "Sets the contents of this document by reading from data of a specified type.",
          "name" : "read(from:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/read(from:ofType:)-6g6ai"
        }
      ],
      "title" : "Reading the Document’s Content"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns whether the receiver can concurrently write to a file or file package located by a URL, that is formatted for a specific type, for a specific kind of save operation.",
          "name" : "canAsynchronouslyWrite(to:ofType:for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/canAsynchronouslyWrite(to:ofType:for:)"
        },
        {
          "description" : "Unblocks the main thread during asynchronous saving.",
          "name" : "unblockUserInteraction()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/unblockUserInteraction()"
        },
        {
          "description" : "Writes the contents of the document to a file or file package located by a URL, that is formatted to a specified type.",
          "name" : "write(to:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/write(to:ofType:)"
        },
        {
          "description" : "Writes the contents of the document to a file or file package located by a URL.",
          "name" : "writeSafely(to:ofType:for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/writeSafely(to:ofType:for:)"
        },
        {
          "description" : "Creates and returns a file wrapper that contains the contents of the document, formatted to the specified type.",
          "name" : "fileWrapper(ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileWrapper(ofType:)"
        },
        {
          "description" : "Creates and returns a data object that contains the contents of the document, formatted to a specified type.",
          "name" : "data(ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/data(ofType:)"
        },
        {
          "description" : "Writes the contents of the document to a file or file package located by a URL.",
          "name" : "write(to:ofType:for:originalContentsURL:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/write(to:ofType:for:originalContentsURL:)"
        },
        {
          "description" : "Saves the contents of the document to a file or file package located by a URL, that is formatted to a specified type, for a particular kind of save operation.",
          "name" : "save(to:ofType:for:delegate:didSave:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/save(to:ofType:for:delegate:didSave:contextInfo:)"
        },
        {
          "description" : "Saves the contents of the document to a file or file package located by a URL, that is formatted to a specified type, for a particular kind of save operation, and invokes the passed-in completion handler.",
          "name" : "save(to:ofType:for:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/save(to:ofType:for:completionHandler:)"
        },
        {
          "description" : "Returns the attributes to write to the file or file package at the specified URL, and targeting the specified type of save operation.",
          "name" : "fileAttributesToWrite(to:ofType:for:originalContentsURL:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileAttributesToWrite(to:ofType:for:originalContentsURL:)"
        },
        {
          "description" : "Constants for specifying the type of document-save operation to perform.",
          "name" : "NSDocument.SaveOperationType",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/SaveOperationType"
        }
      ],
      "title" : "Writing the Document’s Content"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The location of the document’s on-disk representation.",
          "name" : "fileURL",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileURL"
        },
        {
          "description" : "A Boolean value that indicates whether the document’s file is completely loaded into memory.",
          "name" : "isEntireFileLoaded",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isEntireFileLoaded"
        },
        {
          "description" : "The last-known modification date of the document’s on-disk representation.",
          "name" : "fileModificationDate",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileModificationDate"
        },
        {
          "description" : "A Boolean value that indicates whether the document archives previously saved versions of the document.",
          "name" : "keepBackupFile",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/keepBackupFile"
        },
        {
          "description" : "A Boolean value that indicates whether the document is a draft that the user has not yet saved.",
          "name" : "isDraft",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isDraft"
        },
        {
          "description" : "The name of the document type, as specified in the app’s information property-list file.",
          "name" : "fileType",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileType"
        },
        {
          "description" : "A Boolean value that indicates whether the document has unsaved changes.",
          "name" : "isDocumentEdited",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isDocumentEdited"
        },
        {
          "description" : "A Boolean value that indicates whether the document is in read-only mode.",
          "name" : "isInViewingMode",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isInViewingMode"
        }
      ],
      "title" : "Getting Document Metadata"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns the types of data the receiver can read natively and any types filterable to that native type.",
          "name" : "readableTypes",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/readableTypes"
        },
        {
          "description" : "Returns the types of data the receiver can write natively and any types filterable to that native type.",
          "name" : "writableTypes",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/writableTypes"
        },
        {
          "description" : "Returns a Boolean value that indicates whether the document can read and write the data natively.",
          "name" : "isNativeType(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isNativeType(_:)"
        },
        {
          "description" : "Returns the names of the types to which this document can be saved for a specified kind of save operation.",
          "name" : "writableTypes(for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/writableTypes(for:)"
        },
        {
          "description" : "Returns a filename extension that can be appended to a base filename, for a specified file type and kind of save operation.",
          "name" : "fileNameExtension(forType:saveOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileNameExtension(forType:saveOperation:)"
        }
      ],
      "title" : "Managing File Type Information"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Creates the window controller objects that the document uses to display its content.",
          "name" : "makeWindowControllers()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/makeWindowControllers()"
        },
        {
          "description" : "Adds the specified window controller to the current document.",
          "name" : "addWindowController(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/addWindowController(_:)"
        },
        {
          "description" : "Removes the specified window controller from the receiver’s array of window controllers.",
          "name" : "removeWindowController(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/removeWindowController(_:)"
        },
        {
          "description" : "The document’s current window controllers.",
          "name" : "windowControllers",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/windowControllers"
        },
        {
          "description" : "The name of the document’s sole nib file.",
          "name" : "windowNibName",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/windowNibName"
        },
        {
          "description" : "Called after one of the document’s window controllers loads its nib file.",
          "name" : "windowControllerDidLoadNib(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/windowControllerDidLoadNib(_:)"
        },
        {
          "description" : "Called before one of the document’s window controllers loads its nib file.",
          "name" : "windowControllerWillLoadNib(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/windowControllerWillLoadNib(_:)"
        },
        {
          "description" : "Determines whether the system should close the document and its associated window.",
          "name" : "shouldCloseWindowController(_:delegate:shouldClose:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/shouldCloseWindowController(_:delegate:shouldClose:contextInfo:)"
        }
      ],
      "title" : "Creating and Managing Window Controllers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Displays all of the document’s windows, bringing them to the front and making them main or key as necessary.",
          "name" : "showWindows()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/showWindows()"
        },
        {
          "description" : "Sets the window outlet of this document to the specified value.",
          "name" : "setWindow(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/setWindow(_:)"
        },
        {
          "description" : "Returns the document window to use as the parent of a document-modal sheet.",
          "name" : "windowForSheet",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/windowForSheet"
        },
        {
          "description" : "The name of the document as displayed in the title bars of the document’s windows and in alert dialogs related to the document.",
          "name" : "displayName",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/displayName"
        },
        {
          "description" : "Returns the default draft name for the document subclass.",
          "name" : "defaultDraftName()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/defaultDraftName()"
        },
        {
          "description" : "Saves the interface-related state of the document.",
          "name" : "encodeRestorableState(with:backgroundQueue:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/encodeRestorableState(with:backgroundQueue:)"
        }
      ],
      "title" : "Managing Document Windows"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that indicates whether the document subclass supports autosaving in place.",
          "name" : "autosavesInPlace",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosavesInPlace"
        },
        {
          "description" : "A Boolean value that indicates whether the document subclass supports autosaving of drafts.",
          "name" : "autosavesDrafts",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosavesDrafts"
        },
        {
          "description" : "A Boolean value that indicates whether the document subclass supports version management.",
          "name" : "preservesVersions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/preservesVersions"
        },
        {
          "description" : "The location of the most recently autosaved document contents.",
          "name" : "autosavedContentsFileURL",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosavedContentsFileURL"
        },
        {
          "description" : "The document type to use for an autosave operation.",
          "name" : "autosavingFileType",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosavingFileType"
        },
        {
          "description" : "A Boolean value that indicates whether you can cancel an in-progress autosave operation.",
          "name" : "autosavingIsImplicitlyCancellable",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosavingIsImplicitlyCancellable"
        }
      ],
      "title" : "Configuring the Autosave Behavior"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns a Boolean value that indicates whether it is safe to autosave document changes.",
          "name" : "checkAutosavingSafety()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/checkAutosavingSafety()"
        },
        {
          "description" : "A Boolean value that indicates whether the document has changes that have not been autosaved.",
          "name" : "hasUnautosavedChanges",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/hasUnautosavedChanges"
        },
        {
          "description" : "Schedules periodic autosaving for the purpose of crash protection.",
          "name" : "scheduleAutosaving()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/scheduleAutosaving()"
        },
        {
          "description" : "Autosaves the document’s contents to an appropriate location in the file system.",
          "name" : "autosave(withDelegate:didAutosave:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosave(withDelegate:didAutosave:contextInfo:)"
        },
        {
          "description" : "Autosaves the document’s contents to an appropriate file-system location, as needed.",
          "name" : "autosave(withImplicitCancellability:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/autosave(withImplicitCancellability:completionHandler:)"
        },
        {
          "description" : "The URL for the document’s backup file that was created during an autosave operation.",
          "name" : "backupFileURL",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/backupFileURL"
        }
      ],
      "title" : "Autosaving the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Opens the Versions browser in the document’s main window.",
          "name" : "browseVersions(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/browseVersions(_:)"
        },
        {
          "description" : "A Boolean value that indicates whether the document is currently displaying the Versions browser.",
          "name" : "isBrowsingVersions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isBrowsingVersions"
        },
        {
          "description" : "Dismiss the Versions browser for the current document.",
          "name" : "stopBrowsingVersions(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/stopBrowsingVersions(completionHandler:)"
        }
      ],
      "title" : "Browsing Document Versions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Moves the document to the user’s iCloud storage.",
          "name" : "moveToUbiquityContainer(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/moveToUbiquityContainer(_:)"
        },
        {
          "description" : "Returns whether the document object stores its contents in the user’s iCloud document storage.",
          "name" : "usesUbiquitousStorage",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/usesUbiquitousStorage"
        }
      ],
      "title" : "Storing Documents in iCloud"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The object that the document uses to support undo\/redo operations.",
          "name" : "undoManager",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/undoManager"
        },
        {
          "description" : "A Boolean value that indicates whether the document owns an undo manager object.",
          "name" : "hasUndoManager",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/hasUndoManager"
        }
      ],
      "title" : "Managing Undo and Redo Actions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Updates the document’s change count settings after a successful save operation.",
          "name" : "updateChangeCount(withToken:for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/updateChangeCount(withToken:for:)"
        },
        {
          "description" : "Updates the receiver’s change count according to the given change type.",
          "name" : "updateChangeCount(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/updateChangeCount(_:)"
        },
        {
          "description" : "Values that indicate a document’s edit status.",
          "name" : "NSDocument.ChangeType",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/ChangeType"
        },
        {
          "description" : "Returns an object that encapsulates the current record of document changes at the beginning of a save operation.",
          "name" : "changeCountToken(for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/changeCountToken(for:)"
        }
      ],
      "title" : "Updating the Document Change Count"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns the classes that support secure coding.",
          "name" : "allowedClasses(forRestorableStateKeyPath:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/allowedClasses(forRestorableStateKeyPath:)"
        },
        {
          "description" : "Saves the interface-related state of the document.",
          "name" : "encodeRestorableState(with:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/encodeRestorableState(with:)"
        },
        {
          "description" : "Restores the interface-related state of the document.",
          "name" : "restoreState(with:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/restoreState(with:)"
        },
        {
          "description" : "Returns an array of key paths that represent the restorable attributes of the document.",
          "name" : "restorableStateKeyPaths",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/restorableStateKeyPaths"
        },
        {
          "description" : "Marks the document’s interface-related state as dirty.",
          "name" : "invalidateRestorableState()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/invalidateRestorableState()"
        },
        {
          "description" : "Restores a window that was associated with a document, after that document is reopened.",
          "name" : "restoreWindow(withIdentifier:state:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/restoreWindow(withIdentifier:state:completionHandler:)"
        }
      ],
      "title" : "Handling Window Restoration"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Presents a modal Save panel to the user, then tries to save the document if the user approves the operation.",
          "name" : "runModalSavePanel(for:delegate:didSave:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/runModalSavePanel(for:delegate:didSave:contextInfo:)"
        },
        {
          "description" : "Tells the document to customize the specified Save panel.",
          "name" : "prepareSavePanel(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/prepareSavePanel(_:)"
        },
        {
          "description" : "A Boolean value that indicates whether the document’s Save panel displays a list of supported writable document types.",
          "name" : "shouldRunSavePanelWithAccessoryView",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/shouldRunSavePanelWithAccessoryView"
        },
        {
          "description" : "The file type that was last selected in the Save panel.",
          "name" : "fileTypeFromLastRunSavePanel",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileTypeFromLastRunSavePanel"
        },
        {
          "description" : "A Boolean value that indicates whether the user chose to hide the document’s filename extension.",
          "name" : "fileNameExtensionWasHiddenInLastRunSavePanel",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/fileNameExtensionWasHiddenInLastRunSavePanel"
        }
      ],
      "title" : "Presenting a Save Panel"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that encapsulates a user activity the document supports.",
          "name" : "userActivity",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/userActivity"
        },
        {
          "description" : "Updates the state of the given user activity.",
          "name" : "updateUserActivityState(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/updateUserActivityState(_:)"
        },
        {
          "description" : "The key that identifies the document associated with a user activity.",
          "name" : "NSUserActivityDocumentURLKey",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSUserActivityDocumentURLKey"
        }
      ],
      "title" : "Supporting User Activities"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Validates the specified user interface item that the receiver manages.",
          "name" : "validateUserInterfaceItem(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/validateUserInterfaceItem(_:)"
        }
      ],
      "title" : "Validating User Interface Items"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Waits for any scheduled file access to complete, then invokes the passed-in block.",
          "name" : "performSynchronousFileAccess(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/performSynchronousFileAccess(_:)"
        },
        {
          "description" : "Waits for any scheduled file access to complete but without blocking the main thread, then invokes the passed-in block.",
          "name" : "performAsynchronousFileAccess(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/performAsynchronousFileAccess(_:)"
        },
        {
          "description" : "Waits for any work scheduled by previous invocations of this method to complete, then invokes the passed-in block.",
          "name" : "performActivity(withSynchronousWaiting:using:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/performActivity(withSynchronousWaiting:using:)"
        },
        {
          "description" : "Continues to perform the task for a user activity object using a different block.",
          "name" : "continueActivity(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/continueActivity(_:)"
        },
        {
          "description" : "Invokes the passed-in block on the main thread.",
          "name" : "continueAsynchronousWorkOnMainThread(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/continueAsynchronousWorkOnMainThread(_:)"
        }
      ],
      "title" : "Performing Tasks Serially"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Prints the receiver in response to the user choosing the Print menu command.",
          "name" : "printDocument(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/printDocument(_:)"
        },
        {
          "description" : "The action method invoked in the receiver as first responder when the user chooses the Page Setup menu command.",
          "name" : "runPageLayout(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/runPageLayout(_:)"
        },
        {
          "description" : "The action of the File menu item Revert in a document-based app.",
          "name" : "revertToSaved(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/revertToSaved(_:)"
        },
        {
          "description" : "The action method invoked in the receiver as first responder when the user chooses the Save menu command.",
          "name" : "save(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/save(_:)"
        },
        {
          "description" : "The action method invoked in the receiver as first responder when the user chooses the Save As menu command.",
          "name" : "saveAs(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/saveAs(_:)"
        },
        {
          "description" : "The action method invoked in the receiver as first responder when the user chooses the Save To menu command.",
          "name" : "saveTo(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/saveTo(_:)"
        },
        {
          "description" : "Saves the document and delivers the results to the provided delegate object.",
          "name" : "save(withDelegate:didSave:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/save(withDelegate:didSave:contextInfo:)"
        }
      ],
      "title" : "Handling User Actions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Determines whether to close the document, prompting the user as needed to choose a course of action.",
          "name" : "canClose(withDelegate:shouldClose:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/canClose(withDelegate:shouldClose:contextInfo:)"
        },
        {
          "description" : "Closes all of the document’s windows and removes the document from its document controller.",
          "name" : "close()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/close()"
        }
      ],
      "title" : "Closing the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Discards all unsaved document modifications and replaces the document’s contents by reading a file or file package located by a URL of a specified type.",
          "name" : "revert(toContentsOf:ofType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/revert(toContentsOf:ofType:)"
        }
      ],
      "title" : "Reverting the Document Contents"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Creates a new document whose contents are the same as the receiver and returns an error object if unsuccessful.",
          "name" : "duplicate()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/duplicate()"
        },
        {
          "description" : "Creates a copy of the receiving document in response to the user choosing Duplicate from the File menu.",
          "name" : "duplicate(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/duplicate(_:)"
        },
        {
          "description" : "Creates a new document whose contents are the same as the current document.",
          "name" : "duplicate(withDelegate:didDuplicate:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/duplicate(withDelegate:didDuplicate:contextInfo:)"
        }
      ],
      "title" : "Duplicating the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Renames the current document in response to the user choosing the Rename menu item.",
          "name" : "rename(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/rename(_:)"
        }
      ],
      "title" : "Renaming the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Moves the document to a new location in response to the user choosing the Move To… menu item.",
          "name" : "move(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/move(_:)"
        },
        {
          "description" : "Moves the document to a user-selected location.",
          "name" : "move(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/move(completionHandler:)"
        },
        {
          "description" : "Moves the document’s file to the given URL.",
          "name" : "move(to:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/move(to:completionHandler:)"
        }
      ],
      "title" : "Moving the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Locks the document in response to the user choosing the Lock menu item.",
          "name" : "lock(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/lock(_:)"
        },
        {
          "description" : "Unlocks the document in response to the user choosing the Unlock menu item.",
          "name" : "unlock(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/unlock(_:)"
        },
        {
          "description" : "Prevents the user from making further changes to the document.",
          "name" : "lock(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/lock(completionHandler:)-6zuhh"
        },
        {
          "description" : "Prevents the user from making changes to the document’s file.",
          "name" : "lock(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/lock(completionHandler:)-161qv"
        },
        {
          "description" : "Allows the user to make modifications to the document.",
          "name" : "unlock(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/unlock(completionHandler:)-8p8zd"
        },
        {
          "description" : "Allows the user to make modifications to the document’s file.",
          "name" : "unlock(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/unlock(completionHandler:)-6m7rh"
        },
        {
          "description" : "A Boolean value that indicates whether or not the file can be written to.",
          "name" : "isLocked",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/isLocked"
        }
      ],
      "title" : "Locking the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The printing information associated with the document.",
          "name" : "printInfo",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/printInfo"
        },
        {
          "description" : "Adds document-specific content to the Page Layout panel.",
          "name" : "preparePageLayout(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/preparePageLayout(_:)"
        },
        {
          "description" : "Runs the modal page layout panel with the receiver’s printing information object.",
          "name" : "runModalPageLayout(with:delegate:didRun:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/runModalPageLayout(with:delegate:didRun:contextInfo:)"
        },
        {
          "description" : "Runs the specified print operation modally.",
          "name" : "runModalPrintOperation(_:delegate:didRun:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/runModalPrintOperation(_:delegate:didRun:contextInfo:)"
        },
        {
          "description" : "Returns a Boolean value that indicates whether the document allows changes to the default printing information.",
          "name" : "shouldChangePrintInfo(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/shouldChangePrintInfo(_:)"
        },
        {
          "description" : "Prints the document’s contents, optionally displaying a print panel to the user.",
          "name" : "print(withSettings:showPrintPanel:delegate:didPrint:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/print(withSettings:showPrintPanel:delegate:didPrint:contextInfo:)"
        },
        {
          "description" : "Creates and returns a print operation for the document’s contents.",
          "name" : "printOperation(withSettings:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/printOperation(withSettings:)"
        },
        {
          "description" : "A print operation you can use to create a PDF representation of the document’s current contents.",
          "name" : "pdfPrintOperation",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/pdfPrintOperation"
        },
        {
          "description" : "Exports a PDF representation of the document’s current contents.",
          "name" : "saveToPDF(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/saveToPDF(_:)"
        }
      ],
      "title" : "Printing the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that indicates whether the document is shareable from the standard Share menu.",
          "name" : "allowsDocumentSharing",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/allowsDocumentSharing"
        },
        {
          "description" : "Perform any custom setup associated with a sharing service picker.",
          "name" : "prepare(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/prepare(_:)"
        },
        {
          "description" : "Share the document’s file using the specified sharing service.",
          "name" : "share(with:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/share(with:completionHandler:)"
        }
      ],
      "title" : "Sharing the Document"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Handles the Close AppleScript command by attempting to close the document.",
          "name" : "handleClose(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/handleClose(_:)"
        },
        {
          "description" : "Handles the Print AppleScript command by attempting to print the document.",
          "name" : "handlePrint(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/handlePrint(_:)"
        },
        {
          "description" : "Handles the Save AppleScript command by attempting to save the document.",
          "name" : "handleSave(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/handleSave(_:)"
        },
        {
          "description" : "Returns the object specifier that represents the document.",
          "name" : "objectSpecifier",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/objectSpecifier"
        },
        {
          "description" : "The name of the document seen by the user in AppleScript.",
          "name" : "lastComponentOfFileName",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/lastComponentOfFileName"
        }
      ],
      "title" : "Handling Script Commands"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Presents an error alert to the user as a modal panel.",
          "name" : "presentError(_:modalFor:delegate:didPresent:contextInfo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentError(_:modalFor:delegate:didPresent:contextInfo:)"
        },
        {
          "description" : "Presents an error alert to the user as a modal panel.",
          "name" : "presentError(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentError(_:)"
        },
        {
          "description" : "Called when the receiver is about to present an error.",
          "name" : "willPresentError(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/willPresentError(_:)"
        },
        {
          "description" : "Confirms that the error object is not to be presented to the user and the error cannot be recovered from, so cleanup can be done.",
          "name" : "willNotPresentError(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/willNotPresentError(_:)"
        }
      ],
      "title" : "Displaying Errors to the User"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Review symbols that are no longer supported, and find replacements.",
          "name" : "Deprecated Symbols",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/nsdocument-deprecated-symbols"
        }
      ],
      "title" : "Deprecated"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "observedPresentedItemUbiquityAttributes",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/observedPresentedItemUbiquityAttributes"
        },
        {
          "description" : "",
          "name" : "presentedItemURL",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemURL"
        },
        {
          "description" : "",
          "name" : "previewRepresentableActivityItems",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/previewRepresentableActivityItems"
        },
        {
          "description" : "",
          "name" : "savePanelShowsFileFormatsControl",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/savePanelShowsFileFormatsControl"
        }
      ],
      "title" : "Instance Properties"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "accommodatePresentedItemDeletion(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/accommodatePresentedItemDeletion(completionHandler:)"
        },
        {
          "description" : "",
          "name" : "presentedItemDidChange()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemDidChange()"
        },
        {
          "description" : "",
          "name" : "presentedItemDidChangeUbiquityAttributes(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemDidChangeUbiquityAttributes(_:)"
        },
        {
          "description" : "",
          "name" : "presentedItemDidGain(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemDidGain(_:)"
        },
        {
          "description" : "",
          "name" : "presentedItemDidLose(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemDidLose(_:)"
        },
        {
          "description" : "",
          "name" : "presentedItemDidMove(to:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemDidMove(to:)"
        },
        {
          "description" : "",
          "name" : "presentedItemDidResolveConflict(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/presentedItemDidResolveConflict(_:)"
        },
        {
          "description" : "",
          "name" : "relinquishPresentedItem(toReader:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/relinquishPresentedItem(toReader:)"
        },
        {
          "description" : "",
          "name" : "relinquishPresentedItem(toWriter:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/relinquishPresentedItem(toWriter:)"
        },
        {
          "description" : "",
          "name" : "savePresentedItemChanges(completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocument\/savePresentedItemChanges(completionHandler:)"
        }
      ],
      "title" : "Instance Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Write an app that creates, manages, edits, and saves text documents.",
          "name" : "Developing a Document-Based App",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/developing-a-document-based-app"
        },
        {
          "description" : "An object that manages an app’s documents.",
          "name" : "NSDocumentController",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDocumentController"
        },
        {
          "description" : "A document object that can integrate with Core Data.",
          "name" : "NSPersistentDocument",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSPersistentDocument"
        }
      ],
      "title" : "Documents"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NSObject"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "NSDocument",
  "url" : "https:\/\/developer.apple.com\/documentation\/appkit\/nsdocument"
}