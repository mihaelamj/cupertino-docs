{
  "abstract" : "Creates and returns a drag image to represent the specified items during a drag.",
  "codeExamples" : [

  ],
  "contentHash" : "d52db2a5f99178876b148d1efe0b6b00486ba13ebe97fb27292a7451a7c3f20b",
  "crawledAt" : "2025-12-04T19:40:28Z",
  "declaration" : {
    "code" : "@MainActor optional func collectionView(_ collectionView: NSCollectionView, draggingImageForItemsAt indexPaths: Set<IndexPath>, with event: NSEvent, offset dragImageOffset: NSPointPointer) -> NSImage",
    "language" : "swift"
  },
  "id" : "43A5D1C7-F366-4F2C-AACD-3373735FDF4C",
  "kind" : "method",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Return Value\n\nThe image to use for the dragged items.\n\n## Discussion\n\nYour implementation of this method should create an appropriate image to use during the drag operation.  The collection view places the center of your image at the current mouse location. Update the value in the `dragImageOffset` parameter to shift the position of your image by the specified amount.\n\nIf you do not implement this method, the collection view uses the drag image returned by the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionView\/draggingImageForItems(at:with:offset:)-7rc4k] method instead.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingImageForItemsAt:with:offset:)-898js\ncrawled: 2025-12-04T19:40:28Z\n---\n\n# collectionView(_:draggingImageForItemsAt:with:offset:)\n\n**Instance Method**\n\nCreates and returns a drag image to represent the specified items during a drag.\n\n## Declaration\n\n```swift\n@MainActor optional func collectionView(_ collectionView: NSCollectionView, draggingImageForItemsAt indexPaths: Set<IndexPath>, with event: NSEvent, offset dragImageOffset: NSPointPointer) -> NSImage\n```\n\n## Parameters\n\n- **collectionView**: The collection view making the request.\n- **indexPaths**: The index paths of the items being dragged.\n- **event**: The mouse-down event that began the drag operation. You can use the mouse location when determining what value to return in the `dragImageOffset` parameter.\n- **dragImageOffset**: The offset value to use when positioning the image. On input, the point is [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSZeroPoint], which centers the returned image under the mouse. Your method can return a different point that repositions the drag image by the specified offset values.\n\n## Return Value\n\nThe image to use for the dragged items.\n\n## Discussion\n\nYour implementation of this method should create an appropriate image to use during the drag operation.  The collection view places the center of your image at the current mouse location. Update the value in the `dragImageOffset` parameter to shift the position of your image by the specified amount.\n\nIf you do not implement this method, the collection view uses the drag image returned by the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionView\/draggingImageForItems(at:with:offset:)-7rc4k] method instead.\n\n## Drag and Drop Support\n\n- **Supporting Collection View Drag and Drop Through File Promises**: Share data between macOS apps during drag and drop by using an item provider.\n- **collectionView(_:canDragItemsAt:with:)**: Returns a Boolean indicating whether a drag operation involving the specified items can begin.\n- **collectionView(_:pasteboardWriterForItemAt:)**: Provides the pasteboard writer for the item at the specified index path.\n- **collectionView(_:writeItemsAt:to:)**: Places the data for the drag operation on the pasteboard.\n- **collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)**: Returns the names of the promised files that you created for a drag operation.\n- **collectionView(_:draggingSession:willBeginAt:forItemsAt:)**: Notifies your delegate that a drag session is about to begin.\n- **collectionView(_:draggingSession:endedAt:dragOperation:)**: Notifies your delegate that a drag session ended.\n- **collectionView(_:updateDraggingItemsForDrag:)**: Asks your delegate to update the dragging items during a drag operation.\n- **collectionView(_:validateDrop:proposedIndexPath:dropOperation:)**: Validates whether a drop operation is possible at the specified location.\n- **collectionView(_:acceptDrop:indexPath:dropOperation:)**: Incorporates the dropped content into the collection view.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Share data between macOS apps during drag and drop by using an item provider.",
          "name" : "Supporting Collection View Drag and Drop Through File Promises",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/supporting-collection-view-drag-and-drop-through-file-promises"
        },
        {
          "description" : "Returns a Boolean indicating whether a drag operation involving the specified items can begin.",
          "name" : "collectionView(_:canDragItemsAt:with:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:canDragItemsAt:with:)-49wix"
        },
        {
          "description" : "Provides the pasteboard writer for the item at the specified index path.",
          "name" : "collectionView(_:pasteboardWriterForItemAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:pasteboardWriterForItemAt:)-5eyyl"
        },
        {
          "description" : "Places the data for the drag operation on the pasteboard.",
          "name" : "collectionView(_:writeItemsAt:to:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:writeItemsAt:to:)-23ozm"
        },
        {
          "description" : "Returns the names of the promised files that you created for a drag operation.",
          "name" : "collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)-6yag4"
        },
        {
          "description" : "Notifies your delegate that a drag session is about to begin.",
          "name" : "collectionView(_:draggingSession:willBeginAt:forItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingSession:willBeginAt:forItemsAt:)-68x2y"
        },
        {
          "description" : "Notifies your delegate that a drag session ended.",
          "name" : "collectionView(_:draggingSession:endedAt:dragOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingSession:endedAt:dragOperation:)"
        },
        {
          "description" : "Asks your delegate to update the dragging items during a drag operation.",
          "name" : "collectionView(_:updateDraggingItemsForDrag:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:updateDraggingItemsForDrag:)"
        },
        {
          "description" : "Validates whether a drop operation is possible at the specified location.",
          "name" : "collectionView(_:validateDrop:proposedIndexPath:dropOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:validateDrop:proposedIndexPath:dropOperation:)"
        },
        {
          "description" : "Incorporates the dropped content into the collection view.",
          "name" : "collectionView(_:acceptDrop:indexPath:dropOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:acceptDrop:indexPath:dropOperation:)"
        }
      ],
      "title" : "Drag and Drop Support"
    }
  ],
  "source" : "appleJSON",
  "title" : "collectionView(_:draggingImageForItemsAt:with:offset:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingImageForItemsAt:with:offset:)-898js"
}