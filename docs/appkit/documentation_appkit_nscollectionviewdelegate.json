{
  "abstract" : "A set of methods that you use to manage the behavior of a collection view.",
  "codeExamples" : [

  ],
  "contentHash" : "92e5ac26cdf24fa75d5c307cb1f24f31aad458d76b2c1bc7337b999ad11ef8ee",
  "crawledAt" : "2025-12-03T08:26:13Z",
  "declaration" : {
    "code" : "protocol NSCollectionViewDelegate : NSObjectProtocol",
    "language" : "swift"
  },
  "id" : "44B3CF26-C82A-48C7-8763-A1206FF5B5E1",
  "inheritedBy" : [
    "NSCollectionViewDelegateFlowLayout"
  ],
  "kind" : "protocol",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Overview\n\nYou use the methods of this protocol to facilitate the user-initiated selection and highlighting of items, to track changes to the collection view’s visual elements, and to implement drag and drop support. The methods of this protocol are optional, but for some features, you must implement specific methods to support the feature.\n\nImplement the methods of this protocol in an object that you use to manage your collection view. Typically, you implement delegate support in the view controller or window controller that manages the collection view itself, but you can implement these methods in another object if you prefer. Assign your delegate object to the collection view either programmatically (by setting the value of the collection view’s [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionView\/delegate] property) or at design time in Interface Builder.\n\nTo implement drag and drop support in your collection view, implement the following methods:\n\nFor more information about handling drag and drop operations, see [https:\/\/developer.apple.com\/library\/archive\/documentation\/Cocoa\/Conceptual\/DragandDrop\/DragandDrop.html#\/\/apple_ref\/doc\/uid\/10000069i].\n\n### Legacy Support\n\nBefore OS X 10.11, collection views supported only a single section of items organized in a grid layout. The drag and drop methods of this protocol include variants that take a single index or an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSIndexSet] as a parameter. Although you can use those methods to implement your drag and drop support, it is recommended that you use the newer methods that take [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSIndexPath] objects instead.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\ncrawled: 2025-12-03T08:26:13Z\n---\n\n# NSCollectionViewDelegate\n\n**Protocol**\n\nA set of methods that you use to manage the behavior of a collection view.\n\n## Declaration\n\n```swift\nprotocol NSCollectionViewDelegate : NSObjectProtocol\n```\n\n## Overview\n\nYou use the methods of this protocol to facilitate the user-initiated selection and highlighting of items, to track changes to the collection view’s visual elements, and to implement drag and drop support. The methods of this protocol are optional, but for some features, you must implement specific methods to support the feature.\n\nImplement the methods of this protocol in an object that you use to manage your collection view. Typically, you implement delegate support in the view controller or window controller that manages the collection view itself, but you can implement these methods in another object if you prefer. Assign your delegate object to the collection view either programmatically (by setting the value of the collection view’s [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionView\/delegate] property) or at design time in Interface Builder.\n\nTo implement drag and drop support in your collection view, implement the following methods:\n\n- To support the dragging of content from the collection view, implement either the  [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:pasteboardWriterForItemAt:)-5eyyl] or [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:writeItemsAt:to:)-23ozm] method.\n- To support the dropping of content into the collection view, implement the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:validateDrop:proposedIndexPath:dropOperation:)] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:acceptDrop:indexPath:dropOperation:)] methods.\n- To support multi-image drag and drop, you must implement the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:pasteboardWriterForItemAt:)-5eyyl] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:updateDraggingItemsForDrag:)] methods.\n\nFor more information about handling drag and drop operations, see [https:\/\/developer.apple.com\/library\/archive\/documentation\/Cocoa\/Conceptual\/DragandDrop\/DragandDrop.html#\/\/apple_ref\/doc\/uid\/10000069i].\n\n### Legacy Support\n\nBefore OS X 10.11, collection views supported only a single section of items organized in a grid layout. The drag and drop methods of this protocol include variants that take a single index or an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSIndexSet] as a parameter. Although you can use those methods to implement your drag and drop support, it is recommended that you use the newer methods that take [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSIndexPath] objects instead.\n\n## Managing the Selection\n\n- **collectionView(_:shouldSelectItemsAt:)**: Asks the delegate to approve the pending selection of items.\n- **collectionView(_:didSelectItemsAt:)**: Notifies the delegate object that one or more items were selected.\n- **collectionView(_:shouldDeselectItemsAt:)**: Asks the delegate object to approve the pending deselection of items.\n- **collectionView(_:didDeselectItemsAt:)**: Notifies the delegate object that one or more items were deselected.\n\n## Managing Item Highlighting\n\n- **collectionView(_:shouldChangeItemsAt:to:)**: Asks the delegate to approve the pending highlighting of the specified items.\n- **collectionView(_:didChangeItemsAt:to:)**: Notifies the delegate that the highlight state of the specified items changed.\n\n## Tracking the Addition and Removal of Items\n\n- **collectionView(_:willDisplay:forRepresentedObjectAt:)**: Notifies the delegate that the specified item is about to be displayed by the collection view.\n- **collectionView(_:didEndDisplaying:forRepresentedObjectAt:)**: Notifies the delegate that the specified item was removed from the collection view.\n- **collectionView(_:willDisplaySupplementaryView:forElementKind:at:)**: Notifies the delegate that the specified supplementary view is about to be displayed by the collection view.\n- **collectionView(_:didEndDisplayingSupplementaryView:forElementOfKind:at:)**: Notifies the delegate that the specified supplementary view was removed from the collection view.\n\n## Handling Layout Changes\n\n- **collectionView(_:transitionLayoutForOldLayout:newLayout:)**: Returns the transition layout object to use when performing an animated change between different layouts.\n\n## Drag and Drop Support\n\n- **Supporting Collection View Drag and Drop Through File Promises**: Share data between macOS apps during drag and drop by using an item provider.\n- **collectionView(_:canDragItemsAt:with:)**: Returns a Boolean indicating whether a drag operation involving the specified items can begin.\n- **collectionView(_:pasteboardWriterForItemAt:)**: Provides the pasteboard writer for the item at the specified index path.\n- **collectionView(_:writeItemsAt:to:)**: Places the data for the drag operation on the pasteboard.\n- **collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)**: Returns the names of the promised files that you created for a drag operation.\n- **collectionView(_:draggingImageForItemsAt:with:offset:)**: Creates and returns a drag image to represent the specified items during a drag.\n- **collectionView(_:draggingSession:willBeginAt:forItemsAt:)**: Notifies your delegate that a drag session is about to begin.\n- **collectionView(_:draggingSession:endedAt:dragOperation:)**: Notifies your delegate that a drag session ended.\n- **collectionView(_:updateDraggingItemsForDrag:)**: Asks your delegate to update the dragging items during a drag operation.\n- **collectionView(_:validateDrop:proposedIndexPath:dropOperation:)**: Validates whether a drop operation is possible at the specified location.\n- **collectionView(_:acceptDrop:indexPath:dropOperation:)**: Incorporates the dropped content into the collection view.\n\n## Legacy Collection View Support\n\n- **collectionView(_:canDragItemsAt:with:)**: Returns a Boolean indicating whether the collection view can begin dragging the specified items.\n- **collectionView(_:pasteboardWriterForItemAt:)**: Provides the pasteboard writer for the item at the specified index\n- **collectionView(_:writeItemsAt:to:)**: Invoked after it has been determined that a drag should begin, but before the drag has been started.\n- **collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)**: Invoked to return an array of filenames that the receiver promises to create.\n- **collectionView(_:draggingImageForItemsAt:with:offset:)**: Creates and returns a drag image to represent the specified items during a drag.\n- **collectionView(_:draggingSession:willBeginAt:forItemsAt:)**: Notifies your delegate that a drag session is about to begin.\n- **collectionView(_:validateDrop:proposedIndex:dropOperation:)**: Validates the specified location to see if it is a valid drop target.\n- **collectionView(_:acceptDrop:index:dropOperation:)**: Invoked when the mouse is released over a collection view that previously allowed a drop.\n\n## Data\n\n- **NSCollectionViewDataSource**: A set of methods that a data source object implements to provide the information and view objects that a collection view requires to present content.\n- **NSCollectionViewDiffableDataSource**: The object you use to manage data and provide items for a collection view.\n- **NSDiffableDataSourceSnapshot**: A representation of the state of the data in a view at a specific point in time.\n\n## Inherits From\n\n- NSObjectProtocol\n\n## Inherited By\n\n- NSCollectionViewDelegateFlowLayout\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Asks the delegate to approve the pending selection of items.",
          "name" : "collectionView(_:shouldSelectItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:shouldSelectItemsAt:)"
        },
        {
          "description" : "Notifies the delegate object that one or more items were selected.",
          "name" : "collectionView(_:didSelectItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:didSelectItemsAt:)"
        },
        {
          "description" : "Asks the delegate object to approve the pending deselection of items.",
          "name" : "collectionView(_:shouldDeselectItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:shouldDeselectItemsAt:)"
        },
        {
          "description" : "Notifies the delegate object that one or more items were deselected.",
          "name" : "collectionView(_:didDeselectItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:didDeselectItemsAt:)"
        }
      ],
      "title" : "Managing the Selection"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Asks the delegate to approve the pending highlighting of the specified items.",
          "name" : "collectionView(_:shouldChangeItemsAt:to:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:shouldChangeItemsAt:to:)"
        },
        {
          "description" : "Notifies the delegate that the highlight state of the specified items changed.",
          "name" : "collectionView(_:didChangeItemsAt:to:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:didChangeItemsAt:to:)"
        }
      ],
      "title" : "Managing Item Highlighting"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Notifies the delegate that the specified item is about to be displayed by the collection view.",
          "name" : "collectionView(_:willDisplay:forRepresentedObjectAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:willDisplay:forRepresentedObjectAt:)"
        },
        {
          "description" : "Notifies the delegate that the specified item was removed from the collection view.",
          "name" : "collectionView(_:didEndDisplaying:forRepresentedObjectAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:didEndDisplaying:forRepresentedObjectAt:)"
        },
        {
          "description" : "Notifies the delegate that the specified supplementary view is about to be displayed by the collection view.",
          "name" : "collectionView(_:willDisplaySupplementaryView:forElementKind:at:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:willDisplaySupplementaryView:forElementKind:at:)"
        },
        {
          "description" : "Notifies the delegate that the specified supplementary view was removed from the collection view.",
          "name" : "collectionView(_:didEndDisplayingSupplementaryView:forElementOfKind:at:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:didEndDisplayingSupplementaryView:forElementOfKind:at:)"
        }
      ],
      "title" : "Tracking the Addition and Removal of Items"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns the transition layout object to use when performing an animated change between different layouts.",
          "name" : "collectionView(_:transitionLayoutForOldLayout:newLayout:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:transitionLayoutForOldLayout:newLayout:)"
        }
      ],
      "title" : "Handling Layout Changes"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Share data between macOS apps during drag and drop by using an item provider.",
          "name" : "Supporting Collection View Drag and Drop Through File Promises",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/supporting-collection-view-drag-and-drop-through-file-promises"
        },
        {
          "description" : "Returns a Boolean indicating whether a drag operation involving the specified items can begin.",
          "name" : "collectionView(_:canDragItemsAt:with:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:canDragItemsAt:with:)-49wix"
        },
        {
          "description" : "Provides the pasteboard writer for the item at the specified index path.",
          "name" : "collectionView(_:pasteboardWriterForItemAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:pasteboardWriterForItemAt:)-5eyyl"
        },
        {
          "description" : "Places the data for the drag operation on the pasteboard.",
          "name" : "collectionView(_:writeItemsAt:to:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:writeItemsAt:to:)-23ozm"
        },
        {
          "description" : "Returns the names of the promised files that you created for a drag operation.",
          "name" : "collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)-6yag4"
        },
        {
          "description" : "Creates and returns a drag image to represent the specified items during a drag.",
          "name" : "collectionView(_:draggingImageForItemsAt:with:offset:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingImageForItemsAt:with:offset:)-898js"
        },
        {
          "description" : "Notifies your delegate that a drag session is about to begin.",
          "name" : "collectionView(_:draggingSession:willBeginAt:forItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingSession:willBeginAt:forItemsAt:)-68x2y"
        },
        {
          "description" : "Notifies your delegate that a drag session ended.",
          "name" : "collectionView(_:draggingSession:endedAt:dragOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingSession:endedAt:dragOperation:)"
        },
        {
          "description" : "Asks your delegate to update the dragging items during a drag operation.",
          "name" : "collectionView(_:updateDraggingItemsForDrag:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:updateDraggingItemsForDrag:)"
        },
        {
          "description" : "Validates whether a drop operation is possible at the specified location.",
          "name" : "collectionView(_:validateDrop:proposedIndexPath:dropOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:validateDrop:proposedIndexPath:dropOperation:)"
        },
        {
          "description" : "Incorporates the dropped content into the collection view.",
          "name" : "collectionView(_:acceptDrop:indexPath:dropOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:acceptDrop:indexPath:dropOperation:)"
        }
      ],
      "title" : "Drag and Drop Support"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns a Boolean indicating whether the collection view can begin dragging the specified items.",
          "name" : "collectionView(_:canDragItemsAt:with:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:canDragItemsAt:with:)-39rjh"
        },
        {
          "description" : "Provides the pasteboard writer for the item at the specified index",
          "name" : "collectionView(_:pasteboardWriterForItemAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:pasteboardWriterForItemAt:)-7ldvs"
        },
        {
          "description" : "Invoked after it has been determined that a drag should begin, but before the drag has been started.",
          "name" : "collectionView(_:writeItemsAt:to:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:writeItemsAt:to:)-a1lk"
        },
        {
          "description" : "Invoked to return an array of filenames that the receiver promises to create.",
          "name" : "collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:namesOfPromisedFilesDroppedAtDestination:forDraggedItemsAt:)-wwec"
        },
        {
          "description" : "Creates and returns a drag image to represent the specified items during a drag.",
          "name" : "collectionView(_:draggingImageForItemsAt:with:offset:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingImageForItemsAt:with:offset:)-4yvk5"
        },
        {
          "description" : "Notifies your delegate that a drag session is about to begin.",
          "name" : "collectionView(_:draggingSession:willBeginAt:forItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:draggingSession:willBeginAt:forItemsAt:)-cpuq"
        },
        {
          "description" : "Validates the specified location to see if it is a valid drop target.",
          "name" : "collectionView(_:validateDrop:proposedIndex:dropOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:validateDrop:proposedIndex:dropOperation:)"
        },
        {
          "description" : "Invoked when the mouse is released over a collection view that previously allowed a drop.",
          "name" : "collectionView(_:acceptDrop:index:dropOperation:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate\/collectionView(_:acceptDrop:index:dropOperation:)"
        }
      ],
      "title" : "Legacy Collection View Support"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A set of methods that a data source object implements to provide the information and view objects that a collection view requires to present content.",
          "name" : "NSCollectionViewDataSource",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDataSource"
        },
        {
          "description" : "The object you use to manage data and provide items for a collection view.",
          "name" : "NSCollectionViewDiffableDataSource",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDiffableDataSource-axww"
        },
        {
          "description" : "A representation of the state of the data in a view at a specific point in time.",
          "name" : "NSDiffableDataSourceSnapshot",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSDiffableDataSourceSnapshot-swift.struct"
        }
      ],
      "title" : "Data"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NSObjectProtocol"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "NSCollectionViewDelegate",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSCollectionViewDelegate"
}