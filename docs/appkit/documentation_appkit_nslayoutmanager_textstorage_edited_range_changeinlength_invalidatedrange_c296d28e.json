{
  "abstract" : "Invalidates glyph and layout information for a portion of the text in the given text storage object.",
  "codeExamples" : [

  ],
  "contentHash" : "498c917aa18f00018207ade90d91dded1039fb4f9ee42f892e885e7da8fa42ec",
  "crawledAt" : "2025-12-05T13:47:13Z",
  "declaration" : {
    "code" : "func textStorage(_ str: NSTextStorage, edited editedMask: Int = [], range newCharRange: NSRange, changeInLength delta: Int, invalidatedRange invalidatedCharRange: NSRange)",
    "language" : "swift"
  },
  "id" : "AE26791D-1A90-4DFB-9111-6A4595AE44C5",
  "kind" : "method",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Discussion\n\nThis message is sent from the `NSTextStorage`object’s [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/processEditing()] method to indicate that its characters or attributes have changed. This method invalidates glyphs and layout for the affected characters.\n\nFor example, after replacing “The” with “Several” to produce the string “Several files couldn’t be saved”, `newCharRange` is {0, 7} and `delta` is 4. The receiver uses this information to update its character-to-glyph mapping and to update the selection range based on the change.\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/textStorage(_:edited:range:changeInLength:invalidatedRange:)] messages are sent in a series to each `NSLayoutManager` object associated with the text storage object, so the layout managers receiving them shouldn’t edit `aTextStorage` while this method is executing. If one of them does, the `newCharRange`, `delta`, and `invalidatedCharRange` arguments are incorrect for all following layout managers that receive the message.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/textStorage(_:edited:range:changeInLength:invalidatedRange:)\ncrawled: 2025-12-05T13:47:13Z\n---\n\n# textStorage(_:edited:range:changeInLength:invalidatedRange:)\n\n**Instance Method**\n\nInvalidates glyph and layout information for a portion of the text in the given text storage object.\n\n## Declaration\n\n```swift\nfunc textStorage(_ str: NSTextStorage, edited editedMask: Int = [], range newCharRange: NSRange, changeInLength delta: Int, invalidatedRange invalidatedCharRange: NSRange)\n```\n\n## Parameters\n\n- **str**: The text storage whose information is invalidated.\n- **editedMask**: Specifies the nature of the changes. Its value is made by combining with the C bitwise OR operator the constants described in “Change notifications” in [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] ([doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorageEditActions\/editedAttributes] and [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorageEditActions\/editedCharacters]).\n- **newCharRange**: Indicates the extent of characters resulting from the edits.\n- **delta**: If the `NSTextStorageEditedCharacters` bit of `mask` is set, gives the number of characters added to or removed from the original range (otherwise its value is irrelevant).\n- **invalidatedCharRange**: Represents the range of characters affected after attributes have been fixed. Is either equal to `newCharRange` or larger. For example, deleting a paragraph separator character invalidates the layout information for all characters in the paragraphs that precede and follow the separator.\n\n## Discussion\n\nThis message is sent from the `NSTextStorage`object’s [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/processEditing()] method to indicate that its characters or attributes have changed. This method invalidates glyphs and layout for the affected characters.\n\nFor example, after replacing “The” with “Several” to produce the string “Several files couldn’t be saved”, `newCharRange` is {0, 7} and `delta` is 4. The receiver uses this information to update its character-to-glyph mapping and to update the selection range based on the change.\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/textStorage(_:edited:range:changeInLength:invalidatedRange:)] messages are sent in a series to each `NSLayoutManager` object associated with the text storage object, so the layout managers receiving them shouldn’t edit `aTextStorage` while this method is executing. If one of them does, the `newCharRange`, `delta`, and `invalidatedCharRange` arguments are incorrect for all following layout managers that receive the message.\n\n## Methods\n\n- **showCGGlyphs(_:positions:count:font:matrix:attributes:in:)**: Renders the glyphs at the specified positions, using the specified attributes.\n- **invalidateGlyphs(onLayoutInvalidationForGlyphRange:)**: Specifies explicitly when portions of the glyph stream depend on layout.\n- **invalidateLayout(forCharacterRange:isSoft:actualCharacterRange:)**: Invalidates the layout information for the glyphs mapped to the given range of characters.\n- **insertGlyph(_:atGlyphIndex:characterIndex:)**: Inserts a single glyph into the glyph stream at the given index and maps it to the character at the given character index.\n- **insertGlyphs(_:length:forStartingGlyphAt:characterIndex:)**: Inserts the given glyphs into the glyph cache at the given index and maps them to characters beginning at the given character index.\n- **glyph(at:)**: Returns the glyph at the specified index.\n- **glyph(at:isValidIndex:)**: Returns the glyph at a specified index, and optionally returns a flag indicating whether the requested index is valid.\n- **replaceGlyph(at:withGlyph:)**: Replaces the glyph at the given index with a new glyph.\n- **getGlyphs(_:range:)**: Fills the passed-in buffer with a sequence of glyphs.\n- **getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:)**: Returns the glyphs and information needed to perform layout for the given glyph range.\n- **getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:bidiLevels:)**: Returns the glyphs and information needed to perform layout for the given glyph range.\n- **deleteGlyphs(in:)**: Deletes the glyphs in the given range from the receiver’s glyph store.\n- **setCharacterIndex(_:forGlyphAt:)**: Sets the index of the character corresponding to the glyph at the given glyph index.\n- **intAttribute(_:forGlyphAt:)**: Returns the value of the attribute identified by the given attribute tag for the glyph at the given index.\n- **setIntAttribute(_:value:forGlyphAt:)**: Sets a custom attribute value for a given glyph.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Renders the glyphs at the specified positions, using the specified attributes.",
          "name" : "showCGGlyphs(_:positions:count:font:matrix:attributes:in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/showCGGlyphs(_:positions:count:font:matrix:attributes:in:)"
        },
        {
          "description" : "Specifies explicitly when portions of the glyph stream depend on layout.",
          "name" : "invalidateGlyphs(onLayoutInvalidationForGlyphRange:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/invalidateGlyphs(onLayoutInvalidationForGlyphRange:)"
        },
        {
          "description" : "Invalidates the layout information for the glyphs mapped to the given range of characters.",
          "name" : "invalidateLayout(forCharacterRange:isSoft:actualCharacterRange:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/invalidateLayout(forCharacterRange:isSoft:actualCharacterRange:)"
        },
        {
          "description" : "Inserts a single glyph into the glyph stream at the given index and maps it to the character at the given character index.",
          "name" : "insertGlyph(_:atGlyphIndex:characterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/insertGlyph(_:atGlyphIndex:characterIndex:)"
        },
        {
          "description" : "Inserts the given glyphs into the glyph cache at the given index and maps them to characters beginning at the given character index.",
          "name" : "insertGlyphs(_:length:forStartingGlyphAt:characterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/insertGlyphs(_:length:forStartingGlyphAt:characterIndex:)"
        },
        {
          "description" : "Returns the glyph at the specified index.",
          "name" : "glyph(at:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/glyph(at:)"
        },
        {
          "description" : "Returns the glyph at a specified index, and optionally returns a flag indicating whether the requested index is valid.",
          "name" : "glyph(at:isValidIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/glyph(at:isValidIndex:)"
        },
        {
          "description" : "Replaces the glyph at the given index with a new glyph.",
          "name" : "replaceGlyph(at:withGlyph:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/replaceGlyph(at:withGlyph:)"
        },
        {
          "description" : "Fills the passed-in buffer with a sequence of glyphs.",
          "name" : "getGlyphs(_:range:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/getGlyphs(_:range:)"
        },
        {
          "description" : "Returns the glyphs and information needed to perform layout for the given glyph range.",
          "name" : "getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:)"
        },
        {
          "description" : "Returns the glyphs and information needed to perform layout for the given glyph range.",
          "name" : "getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:bidiLevels:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:bidiLevels:)"
        },
        {
          "description" : "Deletes the glyphs in the given range from the receiver’s glyph store.",
          "name" : "deleteGlyphs(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/deleteGlyphs(in:)"
        },
        {
          "description" : "Sets the index of the character corresponding to the glyph at the given glyph index.",
          "name" : "setCharacterIndex(_:forGlyphAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/setCharacterIndex(_:forGlyphAt:)"
        },
        {
          "description" : "Returns the value of the attribute identified by the given attribute tag for the glyph at the given index.",
          "name" : "intAttribute(_:forGlyphAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/intAttribute(_:forGlyphAt:)"
        },
        {
          "description" : "Sets a custom attribute value for a given glyph.",
          "name" : "setIntAttribute(_:value:forGlyphAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/setIntAttribute(_:value:forGlyphAt:)"
        }
      ],
      "title" : "Methods"
    }
  ],
  "source" : "appleJSON",
  "title" : "textStorage(_:edited:range:changeInLength:invalidatedRange:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/textStorage(_:edited:range:changeInLength:invalidatedRange:)"
}