{
  "abstract" : "Returns an array of rectangles and, by reference, the number of such rectangles, that define the region in the given container enclosing the given character range.",
  "codeExamples" : [

  ],
  "contentHash" : "9fe5ba271799da8845630ac4926331986e7b5aec40068bdd9415237c5832417c",
  "crawledAt" : "2025-12-05T12:17:13Z",
  "declaration" : {
    "code" : "func rectArray(forCharacterRange charRange: NSRange, withinSelectedCharacterRange selCharRange: NSRange, in container: NSTextContainer, rectCount: UnsafeMutablePointer<Int>) -> NSRectArray?",
    "language" : "swift"
  },
  "id" : "00ABAC75-EDA6-4DB1-9E6F-8C3637C66756",
  "kind" : "method",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Return Value\n\nThe array of rectangles enclosing the given range.\n\n## Discussion\n\nThese rectangles can be used to draw the text background or highlight for the given range of characters. If a selected range is given in `selCharRange`, the rectangles returned are correct for drawing the selection.  Selection rectangles are generally more complicated than enclosing rectangles and supplying a selected range is the clue this method uses to determine whether to go to the trouble of doing this special work.\n\nThis method will do the minimum amount of work required to answer the question.  The resulting array is owned by the layout manager and will be reused when this method, [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/rectArray(forGlyphRange:withinSelectedGlyphRange:in:rectCount:)], or [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/boundingRect(forGlyphRange:in:)] is called.  One of these methods may be called indirectly. If you aren’t going to use the rectangles right away, you should copy them to another location. These rectangles are always in container coordinates.\n\nThe number of rectangles returned isn’t necessarily the number of lines enclosing the specified range. Contiguous lines can share an enclosing rectangle, and lines broken into several fragments have a separate enclosing rectangle for each fragment.\n\nThese rectangles don’t necessarily enclose glyphs that draw outside their line fragment rectangles; use [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/boundingRect(forGlyphRange:in:)] to determine the area that contains all drawing performed for a range of glyphs.\n\nPerforms glyph generation and layout if needed.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/rectArray(forCharacterRange:withinSelectedCharacterRange:in:rectCount:)\ncrawled: 2025-12-05T12:17:13Z\n---\n\n# rectArray(forCharacterRange:withinSelectedCharacterRange:in:rectCount:)\n\n**Instance Method**\n\nReturns an array of rectangles and, by reference, the number of such rectangles, that define the region in the given container enclosing the given character range.\n\n## Declaration\n\n```swift\nfunc rectArray(forCharacterRange charRange: NSRange, withinSelectedCharacterRange selCharRange: NSRange, in container: NSTextContainer, rectCount: UnsafeMutablePointer<Int>) -> NSRectArray?\n```\n\n## Parameters\n\n- **charRange**: The character range for which to return rectangles.\n- **selCharRange**: Selected characters within `charRange`, which can affect the size of the rectangles; it must be equal to or contain `charRange`. If the caller is interested in this more from an enclosing point of view rather than a selection point of view, pass `{NSNotFound, 0}` as the selected range.\n- **container**: The text container in which the text is laid out.\n- **rectCount**: The number of rectangles returned.\n\n## Return Value\n\nThe array of rectangles enclosing the given range.\n\n## Discussion\n\nThese rectangles can be used to draw the text background or highlight for the given range of characters. If a selected range is given in `selCharRange`, the rectangles returned are correct for drawing the selection.  Selection rectangles are generally more complicated than enclosing rectangles and supplying a selected range is the clue this method uses to determine whether to go to the trouble of doing this special work.\n\nThis method will do the minimum amount of work required to answer the question.  The resulting array is owned by the layout manager and will be reused when this method, [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/rectArray(forGlyphRange:withinSelectedGlyphRange:in:rectCount:)], or [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/boundingRect(forGlyphRange:in:)] is called.  One of these methods may be called indirectly. If you aren’t going to use the rectangles right away, you should copy them to another location. These rectangles are always in container coordinates.\n\nThe number of rectangles returned isn’t necessarily the number of lines enclosing the specified range. Contiguous lines can share an enclosing rectangle, and lines broken into several fragments have a separate enclosing rectangle for each fragment.\n\nThese rectangles don’t necessarily enclose glyphs that draw outside their line fragment rectangles; use [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager\/boundingRect(forGlyphRange:in:)] to determine the area that contains all drawing performed for a range of glyphs.\n\nPerforms glyph generation and layout if needed.\n\n## Methods\n\n- **showCGGlyphs(_:positions:count:font:matrix:attributes:in:)**: Renders the glyphs at the specified positions, using the specified attributes.\n- **invalidateGlyphs(onLayoutInvalidationForGlyphRange:)**: Specifies explicitly when portions of the glyph stream depend on layout.\n- **invalidateLayout(forCharacterRange:isSoft:actualCharacterRange:)**: Invalidates the layout information for the glyphs mapped to the given range of characters.\n- **textStorage(_:edited:range:changeInLength:invalidatedRange:)**: Invalidates glyph and layout information for a portion of the text in the given text storage object.\n- **insertGlyph(_:atGlyphIndex:characterIndex:)**: Inserts a single glyph into the glyph stream at the given index and maps it to the character at the given character index.\n- **insertGlyphs(_:length:forStartingGlyphAt:characterIndex:)**: Inserts the given glyphs into the glyph cache at the given index and maps them to characters beginning at the given character index.\n- **glyph(at:)**: Returns the glyph at the specified index.\n- **glyph(at:isValidIndex:)**: Returns the glyph at a specified index, and optionally returns a flag indicating whether the requested index is valid.\n- **replaceGlyph(at:withGlyph:)**: Replaces the glyph at the given index with a new glyph.\n- **getGlyphs(_:range:)**: Fills the passed-in buffer with a sequence of glyphs.\n- **getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:)**: Returns the glyphs and information needed to perform layout for the given glyph range.\n- **getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:bidiLevels:)**: Returns the glyphs and information needed to perform layout for the given glyph range.\n- **deleteGlyphs(in:)**: Deletes the glyphs in the given range from the receiver’s glyph store.\n- **setCharacterIndex(_:forGlyphAt:)**: Sets the index of the character corresponding to the glyph at the given glyph index.\n- **intAttribute(_:forGlyphAt:)**: Returns the value of the attribute identified by the given attribute tag for the glyph at the given index.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Renders the glyphs at the specified positions, using the specified attributes.",
          "name" : "showCGGlyphs(_:positions:count:font:matrix:attributes:in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/showCGGlyphs(_:positions:count:font:matrix:attributes:in:)"
        },
        {
          "description" : "Specifies explicitly when portions of the glyph stream depend on layout.",
          "name" : "invalidateGlyphs(onLayoutInvalidationForGlyphRange:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/invalidateGlyphs(onLayoutInvalidationForGlyphRange:)"
        },
        {
          "description" : "Invalidates the layout information for the glyphs mapped to the given range of characters.",
          "name" : "invalidateLayout(forCharacterRange:isSoft:actualCharacterRange:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/invalidateLayout(forCharacterRange:isSoft:actualCharacterRange:)"
        },
        {
          "description" : "Invalidates glyph and layout information for a portion of the text in the given text storage object.",
          "name" : "textStorage(_:edited:range:changeInLength:invalidatedRange:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/textStorage(_:edited:range:changeInLength:invalidatedRange:)"
        },
        {
          "description" : "Inserts a single glyph into the glyph stream at the given index and maps it to the character at the given character index.",
          "name" : "insertGlyph(_:atGlyphIndex:characterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/insertGlyph(_:atGlyphIndex:characterIndex:)"
        },
        {
          "description" : "Inserts the given glyphs into the glyph cache at the given index and maps them to characters beginning at the given character index.",
          "name" : "insertGlyphs(_:length:forStartingGlyphAt:characterIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/insertGlyphs(_:length:forStartingGlyphAt:characterIndex:)"
        },
        {
          "description" : "Returns the glyph at the specified index.",
          "name" : "glyph(at:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/glyph(at:)"
        },
        {
          "description" : "Returns the glyph at a specified index, and optionally returns a flag indicating whether the requested index is valid.",
          "name" : "glyph(at:isValidIndex:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/glyph(at:isValidIndex:)"
        },
        {
          "description" : "Replaces the glyph at the given index with a new glyph.",
          "name" : "replaceGlyph(at:withGlyph:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/replaceGlyph(at:withGlyph:)"
        },
        {
          "description" : "Fills the passed-in buffer with a sequence of glyphs.",
          "name" : "getGlyphs(_:range:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/getGlyphs(_:range:)"
        },
        {
          "description" : "Returns the glyphs and information needed to perform layout for the given glyph range.",
          "name" : "getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:)"
        },
        {
          "description" : "Returns the glyphs and information needed to perform layout for the given glyph range.",
          "name" : "getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:bidiLevels:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/getGlyphs(in:glyphs:characterIndexes:glyphInscriptions:elasticBits:bidiLevels:)"
        },
        {
          "description" : "Deletes the glyphs in the given range from the receiver’s glyph store.",
          "name" : "deleteGlyphs(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/deleteGlyphs(in:)"
        },
        {
          "description" : "Sets the index of the character corresponding to the glyph at the given glyph index.",
          "name" : "setCharacterIndex(_:forGlyphAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/setCharacterIndex(_:forGlyphAt:)"
        },
        {
          "description" : "Returns the value of the attribute identified by the given attribute tag for the glyph at the given index.",
          "name" : "intAttribute(_:forGlyphAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/intAttribute(_:forGlyphAt:)"
        }
      ],
      "title" : "Methods"
    }
  ],
  "source" : "appleJSON",
  "title" : "rectArray(forCharacterRange:withinSelectedCharacterRange:in:rectCount:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager\/rectArray(forCharacterRange:withinSelectedCharacterRange:in:rectCount:)"
}