{
  "abstract" : "The fundamental storage mechanism of TextKit that contains the text managed by the system.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSCoding",
    "NSCopying",
    "NSMutableCopying",
    "NSObjectProtocol",
    "NSPasteboardReading",
    "NSPasteboardWriting",
    "NSSecureCoding",
    "Sendable",
    "SendableMetatype"
  ],
  "contentHash" : "ace5d5613965cfa698cccc3333b1117c4e6a1531448cbccbb026673dd794be54",
  "crawledAt" : "2025-12-01T09:23:26Z",
  "declaration" : {
    "code" : "class NSTextStorage",
    "language" : "swift"
  },
  "id" : "02536DE8-5792-445B-9463-006398D40E1F",
  "kind" : "class",
  "module" : "AppKit",
  "overview" : "## Overview\n\n[doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] is a semi-concrete subclass of [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString] that adds behavior for managing a set of client [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager] objects. A text storage object notifies its layout managers of changes to its characters or attributes, which lets the layout managers redisplay the text as needed.\n\nYou can access a text storage object from any thread of your app, but your app must guarantee access from only one thread at a time.\n\nIn macOS, this class also defines properties for getting and setting scriptable attributes of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] objects. Unless you’re dealing with scriptability, you shouldn’t access these properties directly. In particular, using the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/characters], [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/words], or [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/paragraphs] properties is an inefficient way to manipulate the text storage, since accessing these properties involves the creation of many objects. Instead, use the text access methods defined by [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString], [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString], [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableString], and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSString] to perform character-level manipulation.\n\n### Subclassing Notes\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] class implements change management through the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString\/beginEditing()] and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString\/endEditing()] methods, as well as verification of attributes, delegate handling, and layout management notification. The one aspect it doesn’t implement is managing the actual attributed string storage, which subclasses manage by overriding the two [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString] primitives:\n\nSubclasses must also override two [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString] primitives:\n\nThese primitives should perform the change, then call [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/edited(_:range:changeInLength:)] to let the parent class know there are changes.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\ncrawled: 2025-12-01T09:23:26Z\n---\n\n# NSTextStorage\n\n**Class**\n\nThe fundamental storage mechanism of TextKit that contains the text managed by the system.\n\n## Declaration\n\n```swift\nclass NSTextStorage\n```\n\n## Overview\n\n[doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] is a semi-concrete subclass of [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString] that adds behavior for managing a set of client [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSLayoutManager] objects. A text storage object notifies its layout managers of changes to its characters or attributes, which lets the layout managers redisplay the text as needed.\n\nYou can access a text storage object from any thread of your app, but your app must guarantee access from only one thread at a time.\n\nIn macOS, this class also defines properties for getting and setting scriptable attributes of [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] objects. Unless you’re dealing with scriptability, you shouldn’t access these properties directly. In particular, using the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/characters], [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/words], or [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/paragraphs] properties is an inefficient way to manipulate the text storage, since accessing these properties involves the creation of many objects. Instead, use the text access methods defined by [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString], [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString], [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableString], and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSString] to perform character-level manipulation.\n\n### Subclassing Notes\n\nThe [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage] class implements change management through the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString\/beginEditing()] and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString\/endEditing()] methods, as well as verification of attributes, delegate handling, and layout management notification. The one aspect it doesn’t implement is managing the actual attributed string storage, which subclasses manage by overriding the two [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString] primitives:\n\n- [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString\/string]\n- [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString\/attributes(at:effectiveRange:)]\n\nSubclasses must also override two [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString] primitives:\n\n- [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString\/replaceCharacters(in:with:)-6oq9r]\n- [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableAttributedString\/setAttributes(_:range:)]\n\nThese primitives should perform the change, then call [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextStorage\/edited(_:range:changeInLength:)] to let the parent class know there are changes.\n\n## Processing the editing actions\n\n- **delegate**: The delegate for the text storage object.\n- **NSTextStorageDelegate**: The optional methods that delegates of text storage objects implement to handle text-edit processing.\n\n## Accessing the layout managers\n\n- **layoutManagers**: The layout managers for the text storage object.\n- **addLayoutManager(_:)**: Adds a layout manager to the text storage object’s set of layout managers.\n- **removeLayoutManager(_:)**: Removes a layout manager from the text storage object’s set of layout managers.\n\n## Managing edits\n\n- **edited(_:range:changeInLength:)**: Tracks changes made to the text storage object, allowing the text storage to record the full extent of changes.\n- **processEditing()**: Cleans up changes to the text storage object and notifies its delegate and layout managers of changes.\n\n## Fixing the string attributes\n\n- **invalidateAttributes(in:)**: Invalidates attributes in the specified range.\n- **ensureAttributesAreFixed(in:)**: Ensures that attribute fixing occurs in the specified range.\n- **fixesAttributesLazily**: A Boolean value that indicates whether the text storage object fixes attributes lazily.\n\n## Determining the nature of changes\n\n- **editedMask**: A mask that describes the kinds of edits pending for the text storage object.\n- **editedRange**: The range of text that contains changes.\n- **changeInLength**: The difference between the current length of the edited range and its length before editing.\n\n## Accessing scriptable properties\n\n- **attributeRuns**: The text storage contents as an array of attribute runs.\n- **paragraphs**: The text storage contents as an array of paragraphs.\n- **words**: The text storage contents as an array of words.\n- **characters**: The text storage contents as an array of characters.\n- **font**: The font for the text storage.\n- **foregroundColor**: The color for the text.\n\n## Constants\n\n- **NSTextStorageEditActions**: Constants that indicate the types of changes.\n\n## Notifications\n\n- **willProcessEditingNotification**: A notification that posts before a text storage begins processing edits.\n- **didProcessEditingNotification**: A notification that posts after a text storage finishes processing edits.\n\n## Accessing the storage controller\n\n- **textStorageObserver**: The observer for the text storage object.\n- **NSTextStorageObserving**: Optional methods that delegates implement to handle editing and transaction processing.\n\n## TextKit 1\n\n- **NSLayoutManager**: An object that coordinates the layout and display of text characters.\n- **NSATSTypesetter**: A concrete typesetter object that places glyphs during the text layout process.\n- **NSTypesetter**: An abstract class that performs various type layout tasks.\n\n## Inherits From\n\n- NSMutableAttributedString\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSCoding\n- NSCopying\n- NSMutableCopying\n- NSObjectProtocol\n- NSPasteboardReading\n- NSPasteboardWriting\n- NSSecureCoding\n- Sendable\n- SendableMetatype\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The delegate for the text storage object.",
          "name" : "delegate",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/delegate"
        },
        {
          "description" : "The optional methods that delegates of text storage objects implement to handle text-edit processing.",
          "name" : "NSTextStorageDelegate",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorageDelegate"
        }
      ],
      "title" : "Processing the editing actions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The layout managers for the text storage object.",
          "name" : "layoutManagers",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/layoutManagers"
        },
        {
          "description" : "Adds a layout manager to the text storage object’s set of layout managers.",
          "name" : "addLayoutManager(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/addLayoutManager(_:)"
        },
        {
          "description" : "Removes a layout manager from the text storage object’s set of layout managers.",
          "name" : "removeLayoutManager(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/removeLayoutManager(_:)"
        }
      ],
      "title" : "Accessing the layout managers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Tracks changes made to the text storage object, allowing the text storage to record the full extent of changes.",
          "name" : "edited(_:range:changeInLength:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/edited(_:range:changeInLength:)"
        },
        {
          "description" : "Cleans up changes to the text storage object and notifies its delegate and layout managers of changes.",
          "name" : "processEditing()",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/processEditing()"
        }
      ],
      "title" : "Managing edits"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Invalidates attributes in the specified range.",
          "name" : "invalidateAttributes(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/invalidateAttributes(in:)"
        },
        {
          "description" : "Ensures that attribute fixing occurs in the specified range.",
          "name" : "ensureAttributesAreFixed(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/ensureAttributesAreFixed(in:)"
        },
        {
          "description" : "A Boolean value that indicates whether the text storage object fixes attributes lazily.",
          "name" : "fixesAttributesLazily",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/fixesAttributesLazily"
        }
      ],
      "title" : "Fixing the string attributes"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A mask that describes the kinds of edits pending for the text storage object.",
          "name" : "editedMask",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/editedMask"
        },
        {
          "description" : "The range of text that contains changes.",
          "name" : "editedRange",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/editedRange"
        },
        {
          "description" : "The difference between the current length of the edited range and its length before editing.",
          "name" : "changeInLength",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/changeInLength"
        }
      ],
      "title" : "Determining the nature of changes"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The text storage contents as an array of attribute runs.",
          "name" : "attributeRuns",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/attributeRuns"
        },
        {
          "description" : "The text storage contents as an array of paragraphs.",
          "name" : "paragraphs",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/paragraphs"
        },
        {
          "description" : "The text storage contents as an array of words.",
          "name" : "words",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/words"
        },
        {
          "description" : "The text storage contents as an array of characters.",
          "name" : "characters",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/characters"
        },
        {
          "description" : "The font for the text storage.",
          "name" : "font",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/font"
        },
        {
          "description" : "The color for the text.",
          "name" : "foregroundColor",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/foregroundColor"
        }
      ],
      "title" : "Accessing scriptable properties"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Constants that indicate the types of changes.",
          "name" : "NSTextStorageEditActions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorageEditActions"
        }
      ],
      "title" : "Constants"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A notification that posts before a text storage begins processing edits.",
          "name" : "willProcessEditingNotification",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/willProcessEditingNotification"
        },
        {
          "description" : "A notification that posts after a text storage finishes processing edits.",
          "name" : "didProcessEditingNotification",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/didProcessEditingNotification"
        }
      ],
      "title" : "Notifications"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The observer for the text storage object.",
          "name" : "textStorageObserver",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage\/textStorageObserver"
        },
        {
          "description" : "Optional methods that delegates implement to handle editing and transaction processing.",
          "name" : "NSTextStorageObserving",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorageObserving"
        }
      ],
      "title" : "Accessing the storage controller"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that coordinates the layout and display of text characters.",
          "name" : "NSLayoutManager",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSLayoutManager"
        },
        {
          "description" : "A concrete typesetter object that places glyphs during the text layout process.",
          "name" : "NSATSTypesetter",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSATSTypesetter"
        },
        {
          "description" : "An abstract class that performs various type layout tasks.",
          "name" : "NSTypesetter",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTypesetter"
        }
      ],
      "title" : "TextKit 1"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NSMutableAttributedString"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "NSTextStorage",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSTextStorage"
}