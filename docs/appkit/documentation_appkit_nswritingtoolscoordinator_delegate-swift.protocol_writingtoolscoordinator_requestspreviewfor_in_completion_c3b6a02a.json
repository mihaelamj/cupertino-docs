{
  "abstract" : "Asks the delegate for a preview image and layout information for the specified text.",
  "codeExamples" : [

  ],
  "contentHash" : "d01c49b2a44186cbfe0013eb6339fbeea6c2f20f9d00e9385043cacb9a004f51",
  "crawledAt" : "2025-12-02T18:02:42Z",
  "declaration" : {
    "code" : "func writingToolsCoordinator(_ writingToolsCoordinator: NSWritingToolsCoordinator, requestsPreviewFor rect: NSRect, in context: NSWritingToolsCoordinator.Context, completion: @escaping (NSTextPreview?) -> Void)",
    "language" : "swift"
  },
  "id" : "97E27A27-A80C-40E9-B667-8181CA15705C",
  "kind" : "method",
  "language" : "swift",
  "module" : "AppKit",
  "overview" : "## Discussion\n\nDuring an interactive evaluation of your view’s text, Writing Tools creates different animations to provide feedback on what’s happening. As part of the preparation for those animations, Writing Tools asks you to provide a preview of the affected content in your view. Writing Tools uses this preview to build and execute the animations in the view stored in the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/effectContainerView] property of the coordinator object.\n\nTo build a preview of your content in macOS, render the requested portion of your view into an image with a transparent background and use that image to create your [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview] object directly. Set the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview\/presentationFrame] property to the specified rectangle. Set the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview\/candidateRects] property to the selection rectangles for the associated text, which you get from your view’s layout manager. Writing Tools uses this information to place your image directly above the text in your view.\n\nFor a single animation type, the system calls the `writingToolsCoordinator(_:prepareFor:range:context:completion:)` method, followed sequentially by this method and then the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:finish:for:in:completion:)] method. Each method executes asynchronously, but the system calls the next method in the sequence only after you call the completion handler of the previous method. However, multiple animations can run simultaneously, so check the `textAnimation` parameter to differentiate sequences.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsPreviewFor:in:completion:)\ncrawled: 2025-12-02T18:02:42Z\n---\n\n# writingToolsCoordinator(_:requestsPreviewFor:in:completion:)\n\n**Instance Method**\n\nAsks the delegate for a preview image and layout information for the specified text.\n\n## Declaration\n\n```swift\nfunc writingToolsCoordinator(_ writingToolsCoordinator: NSWritingToolsCoordinator, requestsPreviewFor rect: NSRect, in context: NSWritingToolsCoordinator.Context, completion: @escaping (NSTextPreview?) -> Void)\n```\n\n```swift\nfunc writingToolsCoordinator(_ writingToolsCoordinator: NSWritingToolsCoordinator, previewFor rect: NSRect, context: NSWritingToolsCoordinator.Context) async -> NSTextPreview?\n```\n\n## Parameters\n\n- **writingToolsCoordinator**: The coordinator object notifying you that animations are about to begin.\n- **rect**: The portion of your view that contains the requested text. This rectangle is in the view’s coordinate system.\n- **context**: The context object that contains the original text. Use this object to fetch the current text, and to match that text to your underlying text storage.\n- **completion**: A completion handler to execute when you are done. The handler has no return value and takes an [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview] object as a parameter. You must call this handler at some point during your implementation.\n\n## Discussion\n\nDuring an interactive evaluation of your view’s text, Writing Tools creates different animations to provide feedback on what’s happening. As part of the preparation for those animations, Writing Tools asks you to provide a preview of the affected content in your view. Writing Tools uses this preview to build and execute the animations in the view stored in the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/effectContainerView] property of the coordinator object.\n\nTo build a preview of your content in macOS, render the requested portion of your view into an image with a transparent background and use that image to create your [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview] object directly. Set the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview\/presentationFrame] property to the specified rectangle. Set the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSTextPreview\/candidateRects] property to the selection rectangles for the associated text, which you get from your view’s layout manager. Writing Tools uses this information to place your image directly above the text in your view.\n\nFor a single animation type, the system calls the `writingToolsCoordinator(_:prepareFor:range:context:completion:)` method, followed sequentially by this method and then the [doc:\/\/com.apple.appkit\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:finish:for:in:completion:)] method. Each method executes asynchronously, but the system calls the next method in the sequence only after you call the completion handler of the previous method. However, multiple animations can run simultaneously, so check the `textAnimation` parameter to differentiate sequences.\n\n## Animating inline text changes\n\n- **writingToolsCoordinator(_:requestsPreviewFor:of:in:completion:)**: Asks the delegate for a preview image and layout information for the specified text.\n- **writingToolsCoordinator(_:prepareFor:for:in:completion:)**: Prepare for animations for the content that Writing Tools is evaluating.\n- **writingToolsCoordinator(_:finish:for:in:completion:)**: Asks the delegate to clean up any state related to the specified Writing Tools animation.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Asks the delegate for a preview image and layout information for the specified text.",
          "name" : "writingToolsCoordinator(_:requestsPreviewFor:of:in:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsPreviewFor:of:in:completion:)"
        },
        {
          "description" : "Prepare for animations for the content that Writing Tools is evaluating.",
          "name" : "writingToolsCoordinator(_:prepareFor:for:in:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:prepareFor:for:in:completion:)"
        },
        {
          "description" : "Asks the delegate to clean up any state related to the specified Writing Tools animation.",
          "name" : "writingToolsCoordinator(_:finish:for:in:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:finish:for:in:completion:)"
        }
      ],
      "title" : "Animating inline text changes"
    }
  ],
  "source" : "appleJSON",
  "title" : "writingToolsCoordinator(_:requestsPreviewFor:in:completion:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/AppKit\/NSWritingToolsCoordinator\/Delegate-swift.protocol\/writingToolsCoordinator(_:requestsPreviewFor:in:completion:)"
}