{
  "abstract" : "Restore the symmetric key you use to verify payment data.",
  "codeExamples" : [

  ],
  "contentHash" : "72fab8f7c37519ccf77703ded2cde10169d8c287c19573f67e6c907dc0f51527",
  "crawledAt" : "2025-12-03T04:43:43Z",
  "id" : "F9892D9E-EF3D-4502-9154-774BB1793EF1",
  "kind" : "article",
  "language" : "swift",
  "module" : "PassKit (Apple Pay and Wallet)",
  "overview" : "## Overview\n\nThe value of the `version` key in the payment token structure indicates whether the Apple Pay servers encrypted the payment token using Elliptic Curve Cryptography (ECC) or Rivest–Shamir–Adleman (RSA). Follow the instructions for restoring an ECC key or an RSA key according to the value of the `version` key.\n\nFor instructions on using the symmetric key, see [doc:\/\/com.apple.documentation\/documentation\/PassKit\/payment-token-format-reference].\n\n### Restore a symmetric key for ECC\n\nTo restore the key for ECC (`EC_v1)`, follow these steps:\n\n### Restore a symmetric key for RSA\n\nA merchant’s public key encrypts the symmetric key for RSA (`RSA_v1)` by using the RSA\/ECB\/OAEPWithSHA256AndMGF1Padding algorithm. Use your RSA private key to decrypt the cipher text in the `wrappedKey` value. After you decrypt it, the plaintext is the symmetric key material that you use to decrypt the payment token.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/PassKit\/restoring-the-symmetric-key\ncrawled: 2025-12-03T04:43:43Z\n---\n\n# Restoring the symmetric key\n\n**Article**\n\nRestore the symmetric key you use to verify payment data.\n\n## Overview\n\nThe value of the `version` key in the payment token structure indicates whether the Apple Pay servers encrypted the payment token using Elliptic Curve Cryptography (ECC) or Rivest–Shamir–Adleman (RSA). Follow the instructions for restoring an ECC key or an RSA key according to the value of the `version` key.\n\nFor instructions on using the symmetric key, see [doc:\/\/com.apple.documentation\/documentation\/PassKit\/payment-token-format-reference].\n\n### Restore a symmetric key for ECC\n\nTo restore the key for ECC (`EC_v1)`, follow these steps:\n\n1. Use the merchant private key and the ephemeral public key to generate the shared secret using Elliptic Curve Diffie-Hellman (id-ecDH 1.3.132.1.12).\n2. Use the merchant identifier field (OID 1.2.840.113635.100.6.32) of the public key certificate and the shared secret to derive the symmetric key using the key derivation function described in NIST SP 800-56A, section 5.8.1, with the input values shown in the following table:\n\n\n\n### Restore a symmetric key for RSA\n\nA merchant’s public key encrypts the symmetric key for RSA (`RSA_v1)` by using the RSA\/ECB\/OAEPWithSHA256AndMGF1Padding algorithm. Use your RSA private key to decrypt the cipher text in the `wrappedKey` value. After you decrypt it, the plaintext is the symmetric key material that you use to decrypt the payment token.\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "Restoring the symmetric key",
  "url" : "https:\/\/developer.apple.com\/documentation\/PassKit\/restoring-the-symmetric-key"
}