{
  "abstract" : "Train a simple neural network digit classifier.",
  "codeExamples" : [

  ],
  "contentHash" : "e30e779682c8926ae3b2210fe0a10bfdf3fdc4c30d2c3c2dda1b65fa2b5791ed",
  "crawledAt" : "2025-12-02T15:49:45Z",
  "id" : "B6017C44-F1E8-4E3E-977D-5CB820011857",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "Metal Performance Shaders Graph",
  "overview" : "## Overview\n\nThe sample code describes how to write a neural network using [doc:\/\/com.apple.documentation\/documentation\/MetalPerformanceShadersGraph\/MPSGraph] and how to train the network to recognize a digit in an image. The sample trains a network for 300 iterations on a batch size of 40 images. You’ll see how to set up training of weights and biases using data sources, including how to initialize and update weights. You’ll also see how to validate the network using a test dataset.\n\nYou can use any dataset of your choice to train this model.  The following dataset works well for this purpose:\n\n[http:\/\/yann.lecun.com\/exdb\/mnist\/]\n\nPlease note that Apple doesn’t own the copyright to this dataset nor makes any representations about the applicable terms of use for this dataset.\n\nIf you choose to use this dataset, the sample includes a script that downloads the dataset from that location and pass it as input to the model.\n\n### Configure the sample code project\n\nThis sample requires the following system and software configuration:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/MetalPerformanceShadersGraph\/training-a-neural-network-using-mps-graph\ncrawled: 2025-12-02T15:49:45Z\n---\n\n# Training a neural network using MPSGraph\n\n**Sample Code**\n\nTrain a simple neural network digit classifier.\n\n## Overview\n\nThe sample code describes how to write a neural network using [doc:\/\/com.apple.documentation\/documentation\/MetalPerformanceShadersGraph\/MPSGraph] and how to train the network to recognize a digit in an image. The sample trains a network for 300 iterations on a batch size of 40 images. You’ll see how to set up training of weights and biases using data sources, including how to initialize and update weights. You’ll also see how to validate the network using a test dataset.\n\n\n\nYou can use any dataset of your choice to train this model.  The following dataset works well for this purpose:\n\n[http:\/\/yann.lecun.com\/exdb\/mnist\/]\n\nPlease note that Apple doesn’t own the copyright to this dataset nor makes any representations about the applicable terms of use for this dataset.\n\nIf you choose to use this dataset, the sample includes a script that downloads the dataset from that location and pass it as input to the model.\n\n### Configure the sample code project\n\nThis sample requires the following system and software configuration:\n\n- macOS 11 or later\n- iOS 14 or later\n- Xcode 12 or later\n\n## Essentials\n\n- **Adding custom functions to a shader graph**: Run your own graph functions on the GPU by building the function programmatically.\n- **Filtering images with MPSGraph FFT operations**: Filter an image with MPSGraph fast Fourier transforms using the convolutional theorem.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Run your own graph functions on the GPU by building the function programmatically.",
          "name" : "Adding custom functions to a shader graph",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShadersGraph\/adding-custom-functions-to-a-shader-graph"
        },
        {
          "description" : "Filter an image with MPSGraph fast Fourier transforms using the convolutional theorem.",
          "name" : "Filtering images with MPSGraph FFT operations",
          "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShadersGraph\/filtering-images-with-mpsgraph-fft-operations"
        }
      ],
      "title" : "Essentials"
    }
  ],
  "source" : "appleJSON",
  "title" : "Training a neural network using MPSGraph",
  "url" : "https:\/\/developer.apple.com\/documentation\/MetalPerformanceShadersGraph\/training-a-neural-network-using-mps-graph"
}