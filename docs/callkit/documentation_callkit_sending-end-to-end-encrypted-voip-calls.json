{
  "abstract" : "Initiate VoIP calls when your server can’t determine whether an outgoing notification is a request for a VoIP call due to metadata encryption.",
  "codeExamples" : [

  ],
  "contentHash" : "d1b815ebe2dcd03560bf1a2de3701ad70969d15cfbb01bdb260eb55d6cbad3c0",
  "crawledAt" : "2025-12-04T19:20:38Z",
  "id" : "674A10E2-9914-400E-BF95-8025F1249F9E",
  "kind" : "article",
  "language" : "swift",
  "module" : "CallKit",
  "overview" : "## Overview\n\nIf your app can send multiple types of end-to-end encrypted (E2EE) data—for example both text messages and voice over IP (VoIP) calls—send the encrypted content as a remote notification. Then, on the receiving device, use a notification service extension to decrypt the incoming content. If the content represents a VoIP call, pass the call information to [doc:\/\/com.apple.callkit\/documentation\/CallKit] by calling the [doc:\/\/com.apple.callkit\/documentation\/CallKit\/CXProvider\/reportNewIncomingVoIPPushPayload(_:completion:)] method. The system launches your app before passing the message on to [doc:\/\/com.apple.callkit\/documentation\/CallKit]. [doc:\/\/com.apple.callkit\/documentation\/CallKit] then displays the call to the user. It uses the same interface as the Phone app, giving your app a more native look and feel. It also responds appropriately to system-level behaviors such as Do Not Disturb.\n\n### Configure your App to Process Multiple Types of E2EE Data\n\nThe workflow for receiving, decrypting, and processing multiple types of E2EE data involves several different components working together. To set up these systems:\n\n### Send the VoIP Request\n\nTo send an E2EE VoIP message:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CallKit\/sending-end-to-end-encrypted-voip-calls\ncrawled: 2025-12-04T19:20:38Z\n---\n\n# Sending End-to-End Encrypted VoIP Calls\n\n**Article**\n\nInitiate VoIP calls when your server can’t determine whether an outgoing notification is a request for a VoIP call due to metadata encryption.\n\n## Overview\n\nIf your app can send multiple types of end-to-end encrypted (E2EE) data—for example both text messages and voice over IP (VoIP) calls—send the encrypted content as a remote notification. Then, on the receiving device, use a notification service extension to decrypt the incoming content. If the content represents a VoIP call, pass the call information to [doc:\/\/com.apple.callkit\/documentation\/CallKit] by calling the [doc:\/\/com.apple.callkit\/documentation\/CallKit\/CXProvider\/reportNewIncomingVoIPPushPayload(_:completion:)] method. The system launches your app before passing the message on to [doc:\/\/com.apple.callkit\/documentation\/CallKit]. [doc:\/\/com.apple.callkit\/documentation\/CallKit] then displays the call to the user. It uses the same interface as the Phone app, giving your app a more native look and feel. It also responds appropriately to system-level behaviors such as Do Not Disturb.\n\n\n\n### Configure your App to Process Multiple Types of E2EE Data\n\nThe workflow for receiving, decrypting, and processing multiple types of E2EE data involves several different components working together. To set up these systems:\n\n- Request permission to receive remote notifications through the [doc:\/\/com.apple.documentation\/documentation\/UserNotifications] framework. See [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/asking-permission-to-use-notifications].\n- Register for VoIP calls using [doc:\/\/com.apple.documentation\/documentation\/PushKit]. See [doc:\/\/com.apple.documentation\/documentation\/PushKit\/supporting-pushkit-notifications-in-your-app].\n- Add a Notification Service Extension target to your app. See [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/modifying-content-in-newly-delivered-notifications].\n- Add the `com.apple.developer.usernotifications.filtering` entitlement to the Notification Service Extension target’s entitlements file. To apply for this entitlement, see [https:\/\/developer.apple.com\/contact\/request\/notification-service].\n\n### Send the VoIP Request\n\nTo send an E2EE VoIP message:\n\n1. A user initiates a VoIP call on their app. Their app then sends an encrypted VoIP call request to your server.\n2. Your server sends the encrypted data to the receiver’s device using a regular remote notification. Be sure to set the `apns-push-type` header field to `alert`. For more information, see [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-notification-requests-to-apns].\n3. On the receiver’s device, the notification service extension processes the incoming notification and decrypts it. If it’s an incoming VoIP call, the extension calls [doc:\/\/com.apple.callkit\/documentation\/CallKit\/CXProvider\/reportNewIncomingVoIPPushPayload(_:completion:)] to initiate the call. It then silences the push notification (see [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.usernotifications.filtering]).\n4. Finally, the system launches the extension’s containing app and calls the [doc:\/\/com.apple.documentation\/documentation\/PushKit\/PKPushRegistryDelegate\/pushRegistry(_:didReceiveIncomingPushWith:for:completion:)] method. From this point, the app handles the call just like any incoming VoIP call. Specifically, your [doc:\/\/com.apple.documentation\/documentation\/PushKit\/PKPushRegistryDelegate\/pushRegistry(_:didReceiveIncomingPushWith:for:completion:)] implementation must call the [doc:\/\/com.apple.callkit\/documentation\/CallKit\/CXProvider\/reportNewIncomingCall(with:update:completion:)] method to report the call. [doc:\/\/com.apple.callkit\/documentation\/CallKit] then presents the incoming call to the user.\n\n## Outgoing calls\n\n- **CXCallController**: A programmatic interface for interacting with and observing calls.\n- **CXTransaction**: An object that contains zero or more action objects for a call controller to perform.\n- **CXStartCallAction**: An encapsulation of the act of initiating an outgoing call.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A programmatic interface for interacting with and observing calls.",
          "name" : "CXCallController",
          "url" : "https:\/\/developer.apple.com\/documentation\/CallKit\/CXCallController"
        },
        {
          "description" : "An object that contains zero or more action objects for a call controller to perform.",
          "name" : "CXTransaction",
          "url" : "https:\/\/developer.apple.com\/documentation\/CallKit\/CXTransaction"
        },
        {
          "description" : "An encapsulation of the act of initiating an outgoing call.",
          "name" : "CXStartCallAction",
          "url" : "https:\/\/developer.apple.com\/documentation\/CallKit\/CXStartCallAction"
        }
      ],
      "title" : "Outgoing calls"
    }
  ],
  "source" : "appleJSON",
  "title" : "Sending End-to-End Encrypted VoIP Calls",
  "url" : "https:\/\/developer.apple.com\/documentation\/CallKit\/sending-end-to-end-encrypted-voip-calls"
}