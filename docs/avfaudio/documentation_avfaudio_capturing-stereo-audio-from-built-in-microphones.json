{
  "abstract" : "Configure an iOS device’s built-in microphones to add stereo recording capabilities to your app.",
  "codeExamples" : [
    {
      "code" : "func setupAudioSession() {\n    do {\n        let session = AVAudioSession.sharedInstance()\n        try session.setCategory(.playAndRecord, options: [.defaultToSpeaker, .allowBluetooth])\n        try session.setActive(true)\n    } catch {\n        fatalError(\"Failed to configure and activate session.\")\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "private func enableBuiltInMic() {\n    \/\/ Get the shared audio session.\n    let session = AVAudioSession.sharedInstance()\n    \n    \/\/ Find the built-in microphone input.\n    guard let availableInputs = session.availableInputs,\n          let builtInMicInput = availableInputs.first(where: { $0.portType == .builtInMic }) else {\n        print(\"The device must have a built-in microphone.\")\n        return\n    }\n    \n    \/\/ Make the built-in microphone input the preferred input.\n    do {\n        try session.setPreferredInput(builtInMicInput)\n    } catch {\n        print(\"Unable to set the built-in mic as the preferred input.\")\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "func selectRecordingOption(_ option: RecordingOption, orientation: Orientation, completion: (StereoLayout) -> Void) {\n    \n    \/\/ Get the shared audio session.\n    let session = AVAudioSession.sharedInstance()\n    \n    \/\/ Find the built-in microphone input's data sources,\n    \/\/ and select the one that matches the specified name.\n    guard let preferredInput = session.preferredInput,\n          let dataSources = preferredInput.dataSources,\n          let newDataSource = dataSources.first(where: { $0.dataSourceName == option.dataSourceName }),\n          let supportedPolarPatterns = newDataSource.supportedPolarPatterns else {\n        completion(.none)\n        return\n    }\n    \n    do {\n        isStereoSupported = supportedPolarPatterns.contains(.stereo)\n        \/\/ If the data source supports stereo, set it as the preferred polar pattern.\n        if isStereoSupported {\n            \/\/ Set the preferred polar pattern to stereo.\n            try newDataSource.setPreferredPolarPattern(.stereo)\n        }\n\n        \/\/ Set the preferred data source and polar pattern.\n        try preferredInput.setPreferredDataSource(newDataSource)\n        \n        \/\/ Update the input orientation to match the current user interface orientation.\n        try session.setPreferredInputOrientation(orientation.inputOrientation)\n\n    } catch {\n        fatalError(\"Unable to select the \\(option.dataSourceName) data source.\")\n    }\n    \n    \/\/ Call the completion handler with the updated stereo layout.\n    completion(StereoLayout(orientation: newDataSource.orientation!,\n                            stereoOrientation: session.inputOrientation))\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "22ccb58616660c22818eecadf112dedf154cea28f4d257226f010155b574a5d4",
  "crawledAt" : "2025-12-03T09:55:16Z",
  "id" : "C588B606-698E-4262-A66B-DCCAFD101925",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "AVFAudio",
  "overview" : "## Overview\n\nStereo audio uses two channels to create the illusion of multidirectional sound, adding greater depth and dimension to your audio and resulting in an immersive listening experience. iOS provides a number of ways to record audio from the built-in microphones, but until now it’s been limited to mono audio only. Starting in iOS 14 and iPadOS 14, you can now capture stereo audio using the built-in microphones on supported devices.\n\nBecause a user can hold an iOS device in a variety of ways, you need to specify the orientation of the right and left channels in the stereo field. Set the built-in microphone’s directionality by configuring:\n\nThis sample app shows how to configure your app to record stereo audio, and helps you visualize changes to the input orientation and data-source selection.\n\n### Configure the Audio Session Category\n\nRecording stereo audio requires the app’s audio session to use either the [doc:\/\/com.apple.documentation\/documentation\/AVFAudio\/AVAudioSession\/Category-swift.struct\/record] or [doc:\/\/com.apple.documentation\/documentation\/AVFAudio\/AVAudioSession\/Category-swift.struct\/playAndRecord] category. The sample uses the `playAndRecord` category so it can do both. It also passes the `defaultToSpeaker` and `allowBluetooth` options to route the audio to the speaker instead of the receiver, and to Bluetooth headphones.\n\n### Select and Configure a Built-In Microphone\n\nAn iOS device’s built-in microphone input consists of an array of physical microphones and beamformers, each represented as an instance of `AVAudioSessionDataSourceDescription`. The sample app finds the built-in microphone input by querying the available inputs for the one where the port type equals the built-in microphone, and sets it as the preferred input.\n\n### Configure the Microphone Input’s Directionality\n\nTo configure the microphone input’s directionality, the sample sets its data source’s preferred polar pattern and the session’s input orientation. It performs this configuration in its `selectRecordingOption(_:orientation)`  method, which it calls whenever the user rotates the device or changes the recording option selection.\n\nThis method finds the data source with the selected name, sets its preferred polar pattern to stereo, and then sets it as the input’s preferred data source. Finally, it sets the preferred input orientation to match the device’s user interface orientation.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/avfaudio\/capturing-stereo-audio-from-built-in-microphones\ncrawled: 2025-12-03T09:55:16Z\n---\n\n# Capturing stereo audio from built-In microphones\n\n**Sample Code**\n\nConfigure an iOS device’s built-in microphones to add stereo recording capabilities to your app.\n\n## Overview\n\nStereo audio uses two channels to create the illusion of multidirectional sound, adding greater depth and dimension to your audio and resulting in an immersive listening experience. iOS provides a number of ways to record audio from the built-in microphones, but until now it’s been limited to mono audio only. Starting in iOS 14 and iPadOS 14, you can now capture stereo audio using the built-in microphones on supported devices.\n\nBecause a user can hold an iOS device in a variety of ways, you need to specify the orientation of the right and left channels in the stereo field. Set the built-in microphone’s directionality by configuring:\n\n- Polar pattern. The system represents the individual device microphones, and beamformers that use multiple microphones, as data sources. Select the front or back data source and set its polar pattern to stereo.\n- Input orientation. When recording video, set the input orientation to match the video orientation. When recording audio only, set the input orientation to match the user interface orientation. In both cases, don’t change the orientation during recording.\n\nThis sample app shows how to configure your app to record stereo audio, and helps you visualize changes to the input orientation and data-source selection.\n\n\n\n### Configure the Audio Session Category\n\nRecording stereo audio requires the app’s audio session to use either the [doc:\/\/com.apple.documentation\/documentation\/AVFAudio\/AVAudioSession\/Category-swift.struct\/record] or [doc:\/\/com.apple.documentation\/documentation\/AVFAudio\/AVAudioSession\/Category-swift.struct\/playAndRecord] category. The sample uses the `playAndRecord` category so it can do both. It also passes the `defaultToSpeaker` and `allowBluetooth` options to route the audio to the speaker instead of the receiver, and to Bluetooth headphones.\n\n```swift\nfunc setupAudioSession() {\n    do {\n        let session = AVAudioSession.sharedInstance()\n        try session.setCategory(.playAndRecord, options: [.defaultToSpeaker, .allowBluetooth])\n        try session.setActive(true)\n    } catch {\n        fatalError(\"Failed to configure and activate session.\")\n    }\n}\n```\n\n### Select and Configure a Built-In Microphone\n\nAn iOS device’s built-in microphone input consists of an array of physical microphones and beamformers, each represented as an instance of `AVAudioSessionDataSourceDescription`. The sample app finds the built-in microphone input by querying the available inputs for the one where the port type equals the built-in microphone, and sets it as the preferred input.\n\n```swift\nprivate func enableBuiltInMic() {\n    \/\/ Get the shared audio session.\n    let session = AVAudioSession.sharedInstance()\n    \n    \/\/ Find the built-in microphone input.\n    guard let availableInputs = session.availableInputs,\n          let builtInMicInput = availableInputs.first(where: { $0.portType == .builtInMic }) else {\n        print(\"The device must have a built-in microphone.\")\n        return\n    }\n    \n    \/\/ Make the built-in microphone input the preferred input.\n    do {\n        try session.setPreferredInput(builtInMicInput)\n    } catch {\n        print(\"Unable to set the built-in mic as the preferred input.\")\n    }\n}\n```\n\n### Configure the Microphone Input’s Directionality\n\nTo configure the microphone input’s directionality, the sample sets its data source’s preferred polar pattern and the session’s input orientation. It performs this configuration in its `selectRecordingOption(_:orientation)`  method, which it calls whenever the user rotates the device or changes the recording option selection.\n\n```swift\nfunc selectRecordingOption(_ option: RecordingOption, orientation: Orientation, completion: (StereoLayout) -> Void) {\n    \n    \/\/ Get the shared audio session.\n    let session = AVAudioSession.sharedInstance()\n    \n    \/\/ Find the built-in microphone input's data sources,\n    \/\/ and select the one that matches the specified name.\n    guard let preferredInput = session.preferredInput,\n          let dataSources = preferredInput.dataSources,\n          let newDataSource = dataSources.first(where: { $0.dataSourceName == option.dataSourceName }),\n          let supportedPolarPatterns = newDataSource.supportedPolarPatterns else {\n        completion(.none)\n        return\n    }\n    \n    do {\n        isStereoSupported = supportedPolarPatterns.contains(.stereo)\n        \/\/ If the data source supports stereo, set it as the preferred polar pattern.\n        if isStereoSupported {\n            \/\/ Set the preferred polar pattern to stereo.\n            try newDataSource.setPreferredPolarPattern(.stereo)\n        }\n\n        \/\/ Set the preferred data source and polar pattern.\n        try preferredInput.setPreferredDataSource(newDataSource)\n        \n        \/\/ Update the input orientation to match the current user interface orientation.\n        try session.setPreferredInputOrientation(orientation.inputOrientation)\n\n    } catch {\n        fatalError(\"Unable to select the \\(option.dataSourceName) data source.\")\n    }\n    \n    \/\/ Call the completion handler with the updated stereo layout.\n    completion(StereoLayout(orientation: newDataSource.orientation!,\n                            stereoOrientation: session.inputOrientation))\n}\n```\n\nThis method finds the data source with the selected name, sets its preferred polar pattern to stereo, and then sets it as the input’s preferred data source. Finally, it sets the preferred input orientation to match the device’s user interface orientation.\n\n## System audio\n\n- **Handling audio interruptions**: Observe audio session notifications to ensure that your app responds appropriately to interruptions.\n- **Responding to audio route changes**: Observe audio session notifications to ensure that your app responds appropriately to route changes.\n- **Routing audio to specific devices in multidevice sessions**: Map audio channels to specific devices in multiroute sessions for recording and playback.\n- **Adding synthesized speech to calls**: Provide a more accessible experience by adding your app’s audio to a call.\n- **AVAudioSession**: An object that communicates to the system how you intend to use audio in your app.\n- **AVAudioApplication**: An object that manages one or more audio sessions that belong to an app.\n- **AVAudioRoutingArbiter**: An object for configuring macOS apps to participate in AirPods Automatic Switching.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Observe audio session notifications to ensure that your app responds appropriately to interruptions.",
          "name" : "Handling audio interruptions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/handling-audio-interruptions"
        },
        {
          "description" : "Observe audio session notifications to ensure that your app responds appropriately to route changes.",
          "name" : "Responding to audio route changes",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/responding-to-audio-route-changes"
        },
        {
          "description" : "Map audio channels to specific devices in multiroute sessions for recording and playback.",
          "name" : "Routing audio to specific devices in multidevice sessions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/routing-audio-to-specific-devices-in-multidevice-sessions"
        },
        {
          "description" : "Provide a more accessible experience by adding your app’s audio to a call.",
          "name" : "Adding synthesized speech to calls",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/Adding-synthesized-speech-to-calls"
        },
        {
          "description" : "An object that communicates to the system how you intend to use audio in your app.",
          "name" : "AVAudioSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/AVAudioSession"
        },
        {
          "description" : "An object that manages one or more audio sessions that belong to an app.",
          "name" : "AVAudioApplication",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/AVAudioApplication"
        },
        {
          "description" : "An object for configuring macOS apps to participate in AirPods Automatic Switching.",
          "name" : "AVAudioRoutingArbiter",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/AVAudioRoutingArbiter"
        }
      ],
      "title" : "System audio"
    }
  ],
  "source" : "appleJSON",
  "title" : "Capturing stereo audio from built-In microphones",
  "url" : "https:\/\/developer.apple.com\/documentation\/avfaudio\/capturing-stereo-audio-from-built-in-microphones"
}