{
  "abstract" : "Observe audio session notifications to ensure that your app responds appropriately to route changes.",
  "codeExamples" : [
    {
      "code" : "func setupNotifications() {\n    \/\/ Get the default notification center instance.\n    let nc = NotificationCenter.default\n    nc.addObserver(self,\n                   selector: #selector(handleRouteChange),\n                   name: AVAudioSession.routeChangeNotification,\n                   object: nil)\n}\n\n@objc func handleRouteChange(notification: Notification) {\n    \/\/ To be implemented.\n}",
      "language" : "swift"
    },
    {
      "code" : "@objc func handleRouteChange(notification: Notification) {\n    guard let userInfo = notification.userInfo,\n        let reasonValue = userInfo[AVAudioSessionRouteChangeReasonKey] as? UInt,\n        let reason = AVAudioSession.RouteChangeReason(rawValue: reasonValue) else {\n            return\n    }\n    \n    \/\/ Switch over the route change reason.\n    switch reason {\n\n    case .newDeviceAvailable: \/\/ New device found.\n        let session = AVAudioSession.sharedInstance()\n        headphonesConnected = hasHeadphones(in: session.currentRoute)\n    \n    case .oldDeviceUnavailable: \/\/ Old device removed.\n        if let previousRoute =\n            userInfo[AVAudioSessionRouteChangePreviousRouteKey] as? AVAudioSessionRouteDescription {\n            headphonesConnected = hasHeadphones(in: previousRoute)\n        }\n    \n    default: ()\n    }\n}\n\nfunc hasHeadphones(in routeDescription: AVAudioSessionRouteDescription) -> Bool {\n    \/\/ Filter the outputs to only those with a port type of headphones.\n    return !routeDescription.outputs.filter({$0.portType == .headphones}).isEmpty\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "08f65c3914d872d94e83e978d64c4d6b8798a3a6d541c9810c178724e6d98ea1",
  "crawledAt" : "2025-12-03T09:55:14Z",
  "id" : "2A62631C-FED6-4056-879B-895B846762A6",
  "kind" : "article",
  "language" : "swift",
  "module" : "AVFAudio",
  "overview" : "## Overview\n\nAn important responsibility of [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession] is managing audio route changes. A route change occurs when the system adds or removes an audio input or output. Route changes occur for several reasons, including a user plugging in a pair of headphones, connecting a Bluetooth LE headset, or unplugging a USB audio interface. When these changes occur, the audio session reroutes audio signals accordingly and broadcasts a notification containing the details of the change to any registered observers.\n\nAn important behavior related to route changes occurs when a user plugs in or removes a pair of headphones (see Playing audio in [doc:\/\/com.apple.documentation\/design\/human-interface-guidelines]). When users connect a pair of wired or wireless headphones, they’re implicitly indicating that audio playback should continue, but privately. They expect an app that’s currently playing media to continue playing without pause. However, when users *disconnect* their headphones, they don’t want to automatically share what they’re listening to with others. Applications should respect this implicit privacy request and automatically pause playback when users disconnect their headphones.\n\n### Observe route changes\n\nYou can directly observe route change notifications posted by the audio session. This might be useful if you want the system to notify you when a user connects headphones so you can present an icon or message in the player interface.\n\nTo observe audio route changes, begin by registering to observe notifications of type [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/routeChangeNotification].\n\n### Respond to route changes\n\nThe posted [doc:\/\/com.apple.documentation\/documentation\/Foundation\/Notification] object contains a populated user-information dictionary providing the details of the route change. Determine the reason for this change by retrieving the [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/RouteChangeReason] value from the dictionary. When a user connects a new device, the reason is [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/RouteChangeReason\/newDeviceAvailable], and when a user removes a device, the reason is [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/RouteChangeReason\/oldDeviceUnavailable].\n\nWhen a new device becomes available, you ask the audio session for its [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/currentRoute] to determine where the audio output is currently routed. This query returns an [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSessionRouteDescription] object that lists all of the audio session’s inputs and outputs. When the user removes a device, you retrieve the route description for the previous route from the user-information dictionary. In both cases, you query the route description for its outputs, which returns an array of port description objects providing the details of the audio output routes.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/avfaudio\/responding-to-audio-route-changes\ncrawled: 2025-12-03T09:55:14Z\n---\n\n# Responding to audio route changes\n\n**Article**\n\nObserve audio session notifications to ensure that your app responds appropriately to route changes.\n\n## Overview\n\nAn important responsibility of [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession] is managing audio route changes. A route change occurs when the system adds or removes an audio input or output. Route changes occur for several reasons, including a user plugging in a pair of headphones, connecting a Bluetooth LE headset, or unplugging a USB audio interface. When these changes occur, the audio session reroutes audio signals accordingly and broadcasts a notification containing the details of the change to any registered observers.\n\nAn important behavior related to route changes occurs when a user plugs in or removes a pair of headphones (see Playing audio in [doc:\/\/com.apple.documentation\/design\/human-interface-guidelines]). When users connect a pair of wired or wireless headphones, they’re implicitly indicating that audio playback should continue, but privately. They expect an app that’s currently playing media to continue playing without pause. However, when users *disconnect* their headphones, they don’t want to automatically share what they’re listening to with others. Applications should respect this implicit privacy request and automatically pause playback when users disconnect their headphones.\n\n\n\n### Observe route changes\n\nYou can directly observe route change notifications posted by the audio session. This might be useful if you want the system to notify you when a user connects headphones so you can present an icon or message in the player interface.\n\nTo observe audio route changes, begin by registering to observe notifications of type [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/routeChangeNotification].\n\n```swift\nfunc setupNotifications() {\n    \/\/ Get the default notification center instance.\n    let nc = NotificationCenter.default\n    nc.addObserver(self,\n                   selector: #selector(handleRouteChange),\n                   name: AVAudioSession.routeChangeNotification,\n                   object: nil)\n}\n\n@objc func handleRouteChange(notification: Notification) {\n    \/\/ To be implemented.\n}\n```\n\n### Respond to route changes\n\nThe posted [doc:\/\/com.apple.documentation\/documentation\/Foundation\/Notification] object contains a populated user-information dictionary providing the details of the route change. Determine the reason for this change by retrieving the [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/RouteChangeReason] value from the dictionary. When a user connects a new device, the reason is [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/RouteChangeReason\/newDeviceAvailable], and when a user removes a device, the reason is [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/RouteChangeReason\/oldDeviceUnavailable].\n\nWhen a new device becomes available, you ask the audio session for its [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSession\/currentRoute] to determine where the audio output is currently routed. This query returns an [doc:\/\/com.apple.avfaudio\/documentation\/AVFAudio\/AVAudioSessionRouteDescription] object that lists all of the audio session’s inputs and outputs. When the user removes a device, you retrieve the route description for the previous route from the user-information dictionary. In both cases, you query the route description for its outputs, which returns an array of port description objects providing the details of the audio output routes.\n\n```swift\n@objc func handleRouteChange(notification: Notification) {\n    guard let userInfo = notification.userInfo,\n        let reasonValue = userInfo[AVAudioSessionRouteChangeReasonKey] as? UInt,\n        let reason = AVAudioSession.RouteChangeReason(rawValue: reasonValue) else {\n            return\n    }\n    \n    \/\/ Switch over the route change reason.\n    switch reason {\n\n    case .newDeviceAvailable: \/\/ New device found.\n        let session = AVAudioSession.sharedInstance()\n        headphonesConnected = hasHeadphones(in: session.currentRoute)\n    \n    case .oldDeviceUnavailable: \/\/ Old device removed.\n        if let previousRoute =\n            userInfo[AVAudioSessionRouteChangePreviousRouteKey] as? AVAudioSessionRouteDescription {\n            headphonesConnected = hasHeadphones(in: previousRoute)\n        }\n    \n    default: ()\n    }\n}\n\nfunc hasHeadphones(in routeDescription: AVAudioSessionRouteDescription) -> Bool {\n    \/\/ Filter the outputs to only those with a port type of headphones.\n    return !routeDescription.outputs.filter({$0.portType == .headphones}).isEmpty\n}\n```\n\n## System audio\n\n- **Handling audio interruptions**: Observe audio session notifications to ensure that your app responds appropriately to interruptions.\n- **Routing audio to specific devices in multidevice sessions**: Map audio channels to specific devices in multiroute sessions for recording and playback.\n- **Adding synthesized speech to calls**: Provide a more accessible experience by adding your app’s audio to a call.\n- **Capturing stereo audio from built-In microphones**: Configure an iOS device’s built-in microphones to add stereo recording capabilities to your app.\n- **AVAudioSession**: An object that communicates to the system how you intend to use audio in your app.\n- **AVAudioApplication**: An object that manages one or more audio sessions that belong to an app.\n- **AVAudioRoutingArbiter**: An object for configuring macOS apps to participate in AirPods Automatic Switching.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Observe audio session notifications to ensure that your app responds appropriately to interruptions.",
          "name" : "Handling audio interruptions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/handling-audio-interruptions"
        },
        {
          "description" : "Map audio channels to specific devices in multiroute sessions for recording and playback.",
          "name" : "Routing audio to specific devices in multidevice sessions",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/routing-audio-to-specific-devices-in-multidevice-sessions"
        },
        {
          "description" : "Provide a more accessible experience by adding your app’s audio to a call.",
          "name" : "Adding synthesized speech to calls",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/Adding-synthesized-speech-to-calls"
        },
        {
          "description" : "Configure an iOS device’s built-in microphones to add stereo recording capabilities to your app.",
          "name" : "Capturing stereo audio from built-In microphones",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/capturing-stereo-audio-from-built-in-microphones"
        },
        {
          "description" : "An object that communicates to the system how you intend to use audio in your app.",
          "name" : "AVAudioSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/AVAudioSession"
        },
        {
          "description" : "An object that manages one or more audio sessions that belong to an app.",
          "name" : "AVAudioApplication",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/AVAudioApplication"
        },
        {
          "description" : "An object for configuring macOS apps to participate in AirPods Automatic Switching.",
          "name" : "AVAudioRoutingArbiter",
          "url" : "https:\/\/developer.apple.com\/documentation\/AVFAudio\/AVAudioRoutingArbiter"
        }
      ],
      "title" : "System audio"
    }
  ],
  "source" : "appleJSON",
  "title" : "Responding to audio route changes",
  "url" : "https:\/\/developer.apple.com\/documentation\/avfaudio\/responding-to-audio-route-changes"
}