{
  "abstract" : "Catch potential performance issues while your app runs using the Metal heads-up display.",
  "codeExamples" : [
    {
      "code" : "export MTL_HUD_INSIGHTS_ENABLED=1"
    }
  ],
  "contentHash" : "43e4b2288e940e3cd6e812145cfaf6950dbb59ce946e1c23dfa41cd3b558ccb6",
  "crawledAt" : "2025-12-02T19:54:34Z",
  "id" : "4EFED171-9838-4B1E-BDF9-4ED46975D55C",
  "kind" : "article",
  "language" : "swift",
  "overview" : "## Overview\n\nTo help you optimize performance, the Metal Performance HUD analyzes your app’s Metal API call patterns and automatically flags potential issues. This analysis is available for both native apps and Windows games running through the evaluation environment. Each insight offers links to documentation detailing the issue and outlining methods for resolution.\n\nYou can also generate a performance report covering a specific duration to gain deeper insight into your app’s performance during that timeframe. For more information, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Generating-performance-reports-with-metal-performance-hud]\n\nTurn on performance insights by setting the `MTL_HUD_INSIGHTS_ENABLED` environment variable to `1`, or through the configuration panel on macOS. See [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Customizing-metal-performance-hud] for more details.\n\n\n\n### Analyze and interpret performance insights\n\nWhen performance insights are active, the Metal Performance HUD collects Metal API statistics for every frame. If a pattern suggesting a potential performance issue on Apple GPUs occurs in at least half the frames over a set duration (the default time is 5 seconds), an insight overlay appears alongside the main overlay.\n\n\n\nThe HUD identifies four major issue types for native apps and specific D3D12 API usage issues from the Game Porting Toolkit, discussed below.\n\nAn excessive number of encoders per frame can be a performance bottleneck on Apple GPUs. The Metal Performance HUD assists in optimizing performance by examining sequential render command encoders to find those with similar color attachments. These encoders are prime candidates for merging by adopting the color attachment mapping feature in Metal 4. Color attachment mapping allows you to define the relationship between logical and physical color attachments for draw operations, thereby allowing a single encoder to utilize a diverse set of color attachments. To learn more, see [doc:\/\/com.apple.documentation\/documentation\/Metal\/understanding-the-metal-4-core-api].\n\nWhen the HUD detects this insight, it includes a complete encoding table in the performance report to help you locate these specific encoders. To learn more, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Generating-performance-reports-with-metal-performance-hud].\n\n\n\nFrequent encoder switching due to resource copies with blit command encoders is another area for potential optimization. This pattern splits the current render or compute encoder into multiple encoders. You can mitigate this overhead by batching resource updates or by adopting Metal 4 command encoding, where blit commands are part of compute command encoders.\n\nSerial, blocking shader compilation during runtime often causes stutters. Metal 4 mitigates this with new shader compilation methods that allow for finer-grained control and increased parallelization.\n\nWhen the app spends most of the frame interval encoding GPU work, there can be a CPU bottleneck. With Metal 4, you can have more explicit control of command encoding and improve the CPU performance when encoding. See [doc:\/\/com.apple.documentation\/documentation\/Metal\/understanding-the-metal-4-core-api] for more information.\n\nIn D3D12, resource barriers are often too coarse, which can lead to oversynchronization when running applications through the Game Porting Toolkit evaluation environment. When porting to Metal, you can use more fine-grained synchronization primitives such as [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLFence] and [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLEvent] to improve performance.\n\nApple GPU doesn’t support tessellation and geometry stages directly and needs to be emulated. You can adopt mesh shaders as an alternative to improve performance.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Xcode\/Gaining-performance-insights-with-metal-performance-hud\ncrawled: 2025-12-02T19:54:34Z\n---\n\n# Gaining performance insights with the Metal Performance HUD\n\n**Article**\n\nCatch potential performance issues while your app runs using the Metal heads-up display.\n\n## Overview\n\nTo help you optimize performance, the Metal Performance HUD analyzes your app’s Metal API call patterns and automatically flags potential issues. This analysis is available for both native apps and Windows games running through the evaluation environment. Each insight offers links to documentation detailing the issue and outlining methods for resolution.\n\nYou can also generate a performance report covering a specific duration to gain deeper insight into your app’s performance during that timeframe. For more information, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Generating-performance-reports-with-metal-performance-hud]\n\nTurn on performance insights by setting the `MTL_HUD_INSIGHTS_ENABLED` environment variable to `1`, or through the configuration panel on macOS. See [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Customizing-metal-performance-hud] for more details.\n\n```\nexport MTL_HUD_INSIGHTS_ENABLED=1\n```\n\n\n\n### Analyze and interpret performance insights\n\nWhen performance insights are active, the Metal Performance HUD collects Metal API statistics for every frame. If a pattern suggesting a potential performance issue on Apple GPUs occurs in at least half the frames over a set duration (the default time is 5 seconds), an insight overlay appears alongside the main overlay.\n\n\n\nThe HUD identifies four major issue types for native apps and specific D3D12 API usage issues from the Game Porting Toolkit, discussed below.\n\nAn excessive number of encoders per frame can be a performance bottleneck on Apple GPUs. The Metal Performance HUD assists in optimizing performance by examining sequential render command encoders to find those with similar color attachments. These encoders are prime candidates for merging by adopting the color attachment mapping feature in Metal 4. Color attachment mapping allows you to define the relationship between logical and physical color attachments for draw operations, thereby allowing a single encoder to utilize a diverse set of color attachments. To learn more, see [doc:\/\/com.apple.documentation\/documentation\/Metal\/understanding-the-metal-4-core-api].\n\nWhen the HUD detects this insight, it includes a complete encoding table in the performance report to help you locate these specific encoders. To learn more, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Generating-performance-reports-with-metal-performance-hud].\n\n\n\nFrequent encoder switching due to resource copies with blit command encoders is another area for potential optimization. This pattern splits the current render or compute encoder into multiple encoders. You can mitigate this overhead by batching resource updates or by adopting Metal 4 command encoding, where blit commands are part of compute command encoders.\n\nSerial, blocking shader compilation during runtime often causes stutters. Metal 4 mitigates this with new shader compilation methods that allow for finer-grained control and increased parallelization.\n\nWhen the app spends most of the frame interval encoding GPU work, there can be a CPU bottleneck. With Metal 4, you can have more explicit control of command encoding and improve the CPU performance when encoding. See [doc:\/\/com.apple.documentation\/documentation\/Metal\/understanding-the-metal-4-core-api] for more information.\n\n\n\nIn D3D12, resource barriers are often too coarse, which can lead to oversynchronization when running applications through the Game Porting Toolkit evaluation environment. When porting to Metal, you can use more fine-grained synchronization primitives such as [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLFence] and [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLEvent] to improve performance.\n\nApple GPU doesn’t support tessellation and geometry stages directly and needs to be emulated. You can adopt mesh shaders as an alternative to improve performance.\n\n## Runtime diagnostics\n\n- **Inspecting live resources at runtime**: Validate your resources by viewing the contents of your textures and buffers while debugging your Metal app.\n- **Validating your app’s Metal API usage**: Catch runtime issues in your Metal app using API Validation.\n- **Validating your app’s Metal shader usage**: Catch common shader runtime issues using Shader Validation while your app is running.\n- **Monitoring your Metal app’s graphics performance**: Catch performance issues using the Metal Performance HUD while your app runs.\n- **Customizing the Metal Performance HUD**: Modify the appearance of your Metal heads-up display to monitor your graphics performance.\n- **Understanding the Metal Performance HUD metrics**: Learn what each of the metrics reported by the heads-up display indicates.\n- **Generating performance reports with the Metal Performance HUD**: Record your app’s performance using the heads-up display.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Validate your resources by viewing the contents of your textures and buffers while debugging your Metal app.",
          "name" : "Inspecting live resources at runtime",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Inspecting-live-resources-at-runtime"
        },
        {
          "description" : "Catch runtime issues in your Metal app using API Validation.",
          "name" : "Validating your app’s Metal API usage",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Validating-your-apps-Metal-API-usage"
        },
        {
          "description" : "Catch common shader runtime issues using Shader Validation while your app is running.",
          "name" : "Validating your app’s Metal shader usage",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Validating-your-apps-Metal-shader-usage"
        },
        {
          "description" : "Catch performance issues using the Metal Performance HUD while your app runs.",
          "name" : "Monitoring your Metal app’s graphics performance",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Monitoring-your-Metal-apps-graphics-performance"
        },
        {
          "description" : "Modify the appearance of your Metal heads-up display to monitor your graphics performance.",
          "name" : "Customizing the Metal Performance HUD",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Customizing-metal-performance-hud"
        },
        {
          "description" : "Learn what each of the metrics reported by the heads-up display indicates.",
          "name" : "Understanding the Metal Performance HUD metrics",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Understanding-metal-performance-hud-metrics"
        },
        {
          "description" : "Record your app’s performance using the heads-up display.",
          "name" : "Generating performance reports with the Metal Performance HUD",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Generating-performance-reports-with-metal-performance-hud"
        }
      ],
      "title" : "Runtime diagnostics"
    }
  ],
  "source" : "appleJSON",
  "title" : "Gaining performance insights with the Metal Performance HUD",
  "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Gaining-performance-insights-with-metal-performance-hud"
}