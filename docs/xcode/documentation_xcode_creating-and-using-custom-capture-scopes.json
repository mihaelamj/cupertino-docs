{
  "abstract" : "Capture specific GPU commands by using custom capture scopes.",
  "codeExamples" : [
    {
      "code" : "\/\/ Create myCaptureScope outside of your rendering loop.\nmyCaptureScope.begin()\n\nif let commandBuffer = commandQueue.makeCommandBuffer() {\n    \/\/ Do Metal work.\n    commandBuffer.commit()\n}\n\nmyCaptureScope.end()",
      "language" : "swift"
    },
    {
      "code" : "myCaptureScope.label = \"My Capture Scope\"",
      "language" : "swift"
    },
    {
      "code" : "MTLCaptureManager.shared().defaultCaptureScope = myCaptureScope",
      "language" : "swift"
    }
  ],
  "contentHash" : "20e525adc4f589750d360f8d8d7df2b9d20b76b950233c5260c0f6ea1a259c35",
  "crawledAt" : "2025-12-02T19:54:28Z",
  "id" : "FB6EE121-5ECD-4395-B25E-222F69A42269",
  "kind" : "article",
  "language" : "swift",
  "overview" : "## Overview\n\nWhen you capture a frame using the default capture scope by clicking the Metal Capture button in Xcode’s debug bar, the resulting capture contains all of the data for a single frame. In some cases, you may want to debug a partial frame rather than an entire frame. You can accomplish this by setting up and using a custom capture scope that lets you choose exactly which Metal commands to record.\n\n### Define capture boundaries\n\nCall [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureScope\/begin()] on your capture scope to instruct the Metal debugger to record your app’s subsequent Metal activity. To stop recording a frame and to present the Metal debugger, call [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureScope\/end()].\n\n### Label your capture scope\n\nTo identify your custom capture scope when capturing a trace from the Metal Capture popover, set your capture scope’s label property.\n\nWhen you’re ready to capture a frame, click the Metal Capture button in the debug bar. There, you can find your custom capture scope with the matching label available in the list for capturing.\n\nKeep a strong reference to the capture scope in your code for as long as you want the option to be visible in Xcode.\n\n### Make a custom capture scope the default\n\nWhen you perform a capture from Xcode, it defaults to the capture scope that [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureManager\/defaultCaptureScope] specifies. If the value of this property is `nil`, Xcode defines the default capture scope using drawable presentation boundaries; for example, using your calls to the methods [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCommandBuffer\/present(_:)] or [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLDrawable\/present()].\n\nTo change the default scope, create an [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureScope] instance and assign it to [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureManager\/defaultCaptureScope].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Xcode\/Creating-and-using-custom-capture-scopes\ncrawled: 2025-12-02T19:54:28Z\n---\n\n# Creating and using custom capture scopes\n\n**Article**\n\nCapture specific GPU commands by using custom capture scopes.\n\n## Overview\n\nWhen you capture a frame using the default capture scope by clicking the Metal Capture button in Xcode’s debug bar, the resulting capture contains all of the data for a single frame. In some cases, you may want to debug a partial frame rather than an entire frame. You can accomplish this by setting up and using a custom capture scope that lets you choose exactly which Metal commands to record.\n\n\n\n### Define capture boundaries\n\nCall [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureScope\/begin()] on your capture scope to instruct the Metal debugger to record your app’s subsequent Metal activity. To stop recording a frame and to present the Metal debugger, call [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureScope\/end()].\n\n```swift\n\/\/ Create myCaptureScope outside of your rendering loop.\nmyCaptureScope.begin()\n\nif let commandBuffer = commandQueue.makeCommandBuffer() {\n    \/\/ Do Metal work.\n    commandBuffer.commit()\n}\n\nmyCaptureScope.end()\n```\n\n\n\n### Label your capture scope\n\nTo identify your custom capture scope when capturing a trace from the Metal Capture popover, set your capture scope’s label property.\n\n```swift\nmyCaptureScope.label = \"My Capture Scope\"\n```\n\nWhen you’re ready to capture a frame, click the Metal Capture button in the debug bar. There, you can find your custom capture scope with the matching label available in the list for capturing.\n\nKeep a strong reference to the capture scope in your code for as long as you want the option to be visible in Xcode.\n\n### Make a custom capture scope the default\n\nWhen you perform a capture from Xcode, it defaults to the capture scope that [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureManager\/defaultCaptureScope] specifies. If the value of this property is `nil`, Xcode defines the default capture scope using drawable presentation boundaries; for example, using your calls to the methods [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCommandBuffer\/present(_:)] or [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLDrawable\/present()].\n\nTo change the default scope, create an [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureScope] instance and assign it to [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCaptureManager\/defaultCaptureScope].\n\n```swift\nMTLCaptureManager.shared().defaultCaptureScope = myCaptureScope\n```\n\n## Project preparation for debugging\n\n- **Building your project with embedded shader sources**: Prepare to debug your project’s shaders by including source code in the build.\n- **Naming resources and commands**: Enhance the debugging of your Metal app using labels and grouping.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Prepare to debug your project’s shaders by including source code in the build.",
          "name" : "Building your project with embedded shader sources",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Building-your-project-with-embedded-shader-sources"
        },
        {
          "description" : "Enhance the debugging of your Metal app using labels and grouping.",
          "name" : "Naming resources and commands",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Naming-resources-and-commands"
        }
      ],
      "title" : "Project preparation for debugging"
    }
  ],
  "source" : "appleJSON",
  "title" : "Creating and using custom capture scopes",
  "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Creating-and-using-custom-capture-scopes"
}