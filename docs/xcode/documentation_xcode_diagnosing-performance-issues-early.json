{
  "abstract" : "Diagnose potential performance issues in your app during development and testing with the Thread Performance Checker tool in Xcode.",
  "codeExamples" : [
    {
      "code" : "func initiateBackgroundWork() {\n    let dispatchSemaphore = DispatchSemaphore(value: 0)\n    let backgroundQueue = DispatchQueue(label: \"background_queue\", \n                                        qos: .background)\n    \n    backgroundQueue.async {\n        \/\/ Perform work on a separate thread using the quality-of-service level \n        \/\/ for background maintenance or cleanup tasks and signal when the work completes.\n       doBackgroundWorkAsync {\n           dispatchSemaphore.signal()\n       }\n       \n       _ = dispatchSemaphore.wait(timeout: DispatchTime.distantFuture)\n       \n       DispatchQueue.main.async { [weak self] in\n           self?.label.text = \"Background work completed\"\n       }\n    })\n}",
      "language" : "swift"
    },
    {
      "code" : "class:UIActivityViewController\nclass:NSThread\nmethod:-[UIViewController view]\nmethod:readv",
      "language" : "other"
    }
  ],
  "contentHash" : "4e11ca14abff98993990b332677c68e5689db9227cdc2d209b5ca7bf1ab16790",
  "crawledAt" : "2025-12-03T04:11:03Z",
  "id" : "7F5FBD11-3EC6-43B0-B02C-AE4A8AF361FE",
  "kind" : "article",
  "language" : "swift",
  "overview" : "## Overview\n\nIdentifying potential performance issues during development saves testing time later. Resolving performance issues, such as priority inversions and non-UI work on the main thread, makes your app responsive. Priority inversions occur when a low-priority thread blocks a higher-priority thread, which can lead to an unresponsive app. Similarly, non-UI work, such as synchronous networking or I\/O on the main thread, can block the main thread for hundreds of milliseconds, which prevents people from interacting with your app.\n\nThe Thread Performance Checker tool detects priority inversions and non-UI work on the main thread. It doesn’t require any recompilation. Use the Thread Performance Checker tool to detect, diagnose, and resolve performance issues.\n\n### Understand the detected issues\n\nThe Thread Performance Checker tool surfaces issues in the Issue navigator and the source editor. Read the diagnostic message carefully.\n\n\n\nTo understand the issue in depth, expand the backtrace of the issue in the Issue navigator.\n\n\n\nClick Generate in the description of an issue to generate a fix using intelligence in Xcode. For more information, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/writing-code-with-intelligence-in-xcode].\n\nThe issues surfaced point to code in your project that can cause hangs. Hangs occur when your app is unresponsive for hundreds of milliseconds. To learn more about hangs, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/improving-app-responsiveness] and the WWDC session video [https:\/\/developer.apple.com\/videos\/play\/wwdc2021\/10258\/].\n\n### Diagnose and resolve priority inversions\n\nIf you use concurrency primitives, such as [doc:\/\/com.apple.documentation\/documentation\/dispatch\/1453087-dispatch_semaphore_wait] and [doc:\/\/com.apple.documentation\/documentation\/dispatch\/1452794-dispatch_group_wait], in your code or invoke APIs that use them, your app is susceptible to priority inversions if there is a mismatch in the quality-of-service (QoS) class of the dispatch queues your app uses. When you use these primitives, the system can’t automatically propagate priority from the higher-priority thread to the lower-priority thread. You can take these precautions to avoid priority inversions in your code:\n\nThe code in `initiateBackgroundWork` below explicitly creates a dispatch queue with background QoS. `doBackgroundWorkAsync` signals the completion of the background work it does asynchronously at background QoS. After the background work completes, it updates the UI label on the main thread at [doc:\/\/com.apple.documentation\/documentation\/Dispatch\/DispatchQoS\/userInteractive] QoS.\n\nTo learn more about priority inversions and QoS, see [https:\/\/developer.apple.com\/videos\/play\/wwdc2017\/706\/] and [https:\/\/developer.apple.com\/library\/archive\/documentation\/Performance\/Conceptual\/EnergyGuide-iOS\/PrioritizeWorkWithQoS.html].\n\n### Diagnose and eliminate non-UI work on the main thread\n\nLong-running synchronous I\/O and networking on the main thread can make your app unresponsive. For example, to perform real-time capture, you instantiate an [doc:\/\/com.apple.documentation\/documentation\/AVFoundation\/AVCaptureSession] object and add appropriate inputs and outputs. Invoking the [doc:\/\/com.apple.documentation\/documentation\/AVFoundation\/AVCaptureSession\/startRunning()] method of an `AVCaptureSession` object on the main thread of your app can lead to hangs. You can take these precautions to avoid non-UI work on the main thread:\n\n### Detect runtime issues in tests\n\nXcode detects runtime issues in tests you write using [doc:\/\/com.apple.documentation\/documentation\/Testing] or [doc:\/\/com.apple.documentation\/documentation\/XCTest], including UI tests that use [doc:\/\/com.apple.documentation\/documentation\/XCUIAutomation] to automatically control your app’s UI.\n\nBy default, Xcode reports runtime issues in your tests as warnings. To fail tests when runtime issues occur, follow these steps:\n\n\n\nTo turn runtime issues back into warnings, change the configuration values to On (as Warnings). For more information on configuring test plans, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/organizing-tests-to-improve-feedback].\n\nIf you configure Xcode to report runtime issues in tests as warnings, Xcode shows the issues in a Runtime Warnings section in the Test Report, in the Test navigator, and in the Issues navigator.\n\n\n\n### Disable the Thread Performance Checker tool\n\nThe Thread Performance Checker tool is enabled by default for schemes that build an app in your project. To disable it, choose Product > Scheme > Edit Scheme to display the scheme editor. Select the Run schemes, navigate to the Diagnostics section, and unselect the Thread Performance Checker tool checkbox.\n\n\n\nIn addition to the Thread Performance Checker tool, always test your code using a comprehensive set of performance tests. For more information about testing your code, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/testing].\n\nResolution of certain performance issues may require significant code refactoring or redesign of the underlying logic. To suppress the warning for issues you intend to address at a later time, set the `PERFC_SUPPRESSION_FILE` environment variable to provide a list of classes and methods in a suppression file. The Thread Performance Checker tool only shows issues that don’t involve those classes and methods. Use the following format for your suppression file:\n\nTo disable runtime issues in tests, edit the test plan and set the Runtime API Checking configuration values to Off.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Xcode\/diagnosing-performance-issues-early\ncrawled: 2025-12-03T04:11:03Z\n---\n\n# Diagnosing performance issues early\n\n**Article**\n\nDiagnose potential performance issues in your app during development and testing with the Thread Performance Checker tool in Xcode.\n\n## Overview\n\nIdentifying potential performance issues during development saves testing time later. Resolving performance issues, such as priority inversions and non-UI work on the main thread, makes your app responsive. Priority inversions occur when a low-priority thread blocks a higher-priority thread, which can lead to an unresponsive app. Similarly, non-UI work, such as synchronous networking or I\/O on the main thread, can block the main thread for hundreds of milliseconds, which prevents people from interacting with your app.\n\nThe Thread Performance Checker tool detects priority inversions and non-UI work on the main thread. It doesn’t require any recompilation. Use the Thread Performance Checker tool to detect, diagnose, and resolve performance issues.\n\n### Understand the detected issues\n\nThe Thread Performance Checker tool surfaces issues in the Issue navigator and the source editor. Read the diagnostic message carefully.\n\n\n\nTo understand the issue in depth, expand the backtrace of the issue in the Issue navigator.\n\n\n\nClick Generate in the description of an issue to generate a fix using intelligence in Xcode. For more information, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/writing-code-with-intelligence-in-xcode].\n\nThe issues surfaced point to code in your project that can cause hangs. Hangs occur when your app is unresponsive for hundreds of milliseconds. To learn more about hangs, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/improving-app-responsiveness] and the WWDC session video [https:\/\/developer.apple.com\/videos\/play\/wwdc2021\/10258\/].\n\n### Diagnose and resolve priority inversions\n\nIf you use concurrency primitives, such as [doc:\/\/com.apple.documentation\/documentation\/dispatch\/1453087-dispatch_semaphore_wait] and [doc:\/\/com.apple.documentation\/documentation\/dispatch\/1452794-dispatch_group_wait], in your code or invoke APIs that use them, your app is susceptible to priority inversions if there is a mismatch in the quality-of-service (QoS) class of the dispatch queues your app uses. When you use these primitives, the system can’t automatically propagate priority from the higher-priority thread to the lower-priority thread. You can take these precautions to avoid priority inversions in your code:\n\n- Don’t use `dispatch_semaphore_wait` and `dispatch_group_wait` to emulate synchronous behavior when calling an asynchronous internal method or API. Remove the code if the underlying functionality is unnecessary.\n- Ensure that the QoS of the waiting thread is the same as or lower than the QoS of the signaling thread when a synchronous variant isn’t available. Explicitly classify the QoS of the work when you create a [doc:\/\/com.apple.documentation\/documentation\/Dispatch\/dispatch-queue] or an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/OperationQueue].\n\nThe code in `initiateBackgroundWork` below explicitly creates a dispatch queue with background QoS. `doBackgroundWorkAsync` signals the completion of the background work it does asynchronously at background QoS. After the background work completes, it updates the UI label on the main thread at [doc:\/\/com.apple.documentation\/documentation\/Dispatch\/DispatchQoS\/userInteractive] QoS.\n\n```swift\nfunc initiateBackgroundWork() {\n    let dispatchSemaphore = DispatchSemaphore(value: 0)\n    let backgroundQueue = DispatchQueue(label: \"background_queue\", \n                                        qos: .background)\n    \n    backgroundQueue.async {\n        \/\/ Perform work on a separate thread using the quality-of-service level \n        \/\/ for background maintenance or cleanup tasks and signal when the work completes.\n       doBackgroundWorkAsync {\n           dispatchSemaphore.signal()\n       }\n       \n       _ = dispatchSemaphore.wait(timeout: DispatchTime.distantFuture)\n       \n       DispatchQueue.main.async { [weak self] in\n           self?.label.text = \"Background work completed\"\n       }\n    })\n}\n```\n\nTo learn more about priority inversions and QoS, see [https:\/\/developer.apple.com\/videos\/play\/wwdc2017\/706\/] and [https:\/\/developer.apple.com\/library\/archive\/documentation\/Performance\/Conceptual\/EnergyGuide-iOS\/PrioritizeWorkWithQoS.html].\n\n### Diagnose and eliminate non-UI work on the main thread\n\nLong-running synchronous I\/O and networking on the main thread can make your app unresponsive. For example, to perform real-time capture, you instantiate an [doc:\/\/com.apple.documentation\/documentation\/AVFoundation\/AVCaptureSession] object and add appropriate inputs and outputs. Invoking the [doc:\/\/com.apple.documentation\/documentation\/AVFoundation\/AVCaptureSession\/startRunning()] method of an `AVCaptureSession` object on the main thread of your app can lead to hangs. You can take these precautions to avoid non-UI work on the main thread:\n\n- Don’t synchronously read from or write to files and I\/O devices on the main thread. Instead, do the work on a separate serial dispatch queue, and notify the completion of I\/O by enqueuing a block onto the main queue.\n- Use the asynchronous variant of an API that performs I\/O to do that work off the main thread.\n- Don’t perform synchronous networking on the main thread of your app. Instead, use an asynchronous networking API, such as [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession].\n\n### Detect runtime issues in tests\n\nXcode detects runtime issues in tests you write using [doc:\/\/com.apple.documentation\/documentation\/Testing] or [doc:\/\/com.apple.documentation\/documentation\/XCTest], including UI tests that use [doc:\/\/com.apple.documentation\/documentation\/XCUIAutomation] to automatically control your app’s UI.\n\nBy default, Xcode reports runtime issues in your tests as warnings. To fail tests when runtime issues occur, follow these steps:\n\n1. Choose Product > Test Plan > Edit Test Plan. Follow any prompts that Xcode displays.\n2. Switch to the Configurations pane in the Test Plan editor.\n3. Change the configuration values in the Runtime API Checking section to On (as Failure). You can set each value separately, for example, to report main thread issues as failures so you can work on resolving those without also causing failures from other runtime issues.\n\n\n\nTo turn runtime issues back into warnings, change the configuration values to On (as Warnings). For more information on configuring test plans, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/organizing-tests-to-improve-feedback].\n\nIf you configure Xcode to report runtime issues in tests as warnings, Xcode shows the issues in a Runtime Warnings section in the Test Report, in the Test navigator, and in the Issues navigator.\n\n\n\n### Disable the Thread Performance Checker tool\n\nThe Thread Performance Checker tool is enabled by default for schemes that build an app in your project. To disable it, choose Product > Scheme > Edit Scheme to display the scheme editor. Select the Run schemes, navigate to the Diagnostics section, and unselect the Thread Performance Checker tool checkbox.\n\n\n\nIn addition to the Thread Performance Checker tool, always test your code using a comprehensive set of performance tests. For more information about testing your code, see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/testing].\n\n\n\nResolution of certain performance issues may require significant code refactoring or redesign of the underlying logic. To suppress the warning for issues you intend to address at a later time, set the `PERFC_SUPPRESSION_FILE` environment variable to provide a list of classes and methods in a suppression file. The Thread Performance Checker tool only shows issues that don’t involve those classes and methods. Use the following format for your suppression file:\n\n```other\nclass:UIActivityViewController\nclass:NSThread\nmethod:-[UIViewController view]\nmethod:readv\n```\n\nTo disable runtime issues in tests, edit the test plan and set the Runtime API Checking configuration values to Off.\n\n## Related Documentation\n\n- **Addressing watchdog terminations**: Identify the signature of an unresponsive app terminated by the watchdog, and address the issue.\n- **Improving app responsiveness**: Create a user experience that feels responsive by removing hangs and hitches from your app.\n\n## Responsiveness\n\n- **Analyzing responsiveness issues in your shipping app**: Identify responsiveness issues your users encounter, and use the hang and hitch data in Xcode Organizer to determine which issues are most important to fix.\n- **Improving app responsiveness**: Create a user experience that feels responsive by removing hangs and hitches from your app.\n- **Understanding user interface responsiveness**: Make your app more responsive by examining the event-handling and rendering loop.\n- **Understanding and improving SwiftUI performance**: Identify and address long-running view updates, and reduce the frequency of updates.\n- **Understanding hangs in your app**: Determine the cause for delays in user interactions by examining the main thread and the main run loop.\n- **Understanding hitches in your app**: Determine the cause of interruptions in motion by examining the render loop.\n- **Reducing your app’s launch time**: Create a more responsive experience with your app by minimizing time spent in startup.\n- **Reducing terminations in your app**: Minimize how frequently the system stops your app by addressing common termination reasons.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Identify the signature of an unresponsive app terminated by the watchdog, and address the issue.",
          "name" : "Addressing watchdog terminations",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/addressing-watchdog-terminations"
        },
        {
          "description" : "Create a user experience that feels responsive by removing hangs and hitches from your app.",
          "name" : "Improving app responsiveness",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/improving-app-responsiveness"
        }
      ],
      "title" : "Related Documentation"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Identify responsiveness issues your users encounter, and use the hang and hitch data in Xcode Organizer to determine which issues are most important to fix.",
          "name" : "Analyzing responsiveness issues in your shipping app",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/analyzing-responsiveness-issues-in-your-shipping-app"
        },
        {
          "description" : "Create a user experience that feels responsive by removing hangs and hitches from your app.",
          "name" : "Improving app responsiveness",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/improving-app-responsiveness"
        },
        {
          "description" : "Make your app more responsive by examining the event-handling and rendering loop.",
          "name" : "Understanding user interface responsiveness",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/understanding-user-interface-responsiveness"
        },
        {
          "description" : "Identify and address long-running view updates, and reduce the frequency of updates.",
          "name" : "Understanding and improving SwiftUI performance",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/understanding-and-improving-swiftui-performance"
        },
        {
          "description" : "Determine the cause for delays in user interactions by examining the main thread and the main run loop.",
          "name" : "Understanding hangs in your app",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/understanding-hangs-in-your-app"
        },
        {
          "description" : "Determine the cause of interruptions in motion by examining the render loop.",
          "name" : "Understanding hitches in your app",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/understanding-hitches-in-your-app"
        },
        {
          "description" : "Create a more responsive experience with your app by minimizing time spent in startup.",
          "name" : "Reducing your app’s launch time",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/reducing-your-app-s-launch-time"
        },
        {
          "description" : "Minimize how frequently the system stops your app by addressing common termination reasons.",
          "name" : "Reducing terminations in your app",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/reduce-terminations-in-your-app"
        }
      ],
      "title" : "Responsiveness"
    }
  ],
  "source" : "appleJSON",
  "title" : "Diagnosing performance issues early",
  "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/diagnosing-performance-issues-early"
}