{
  "abstract" : "Catch common shader runtime issues using Shader Validation while your app is running.",
  "codeExamples" : [
    {
      "code" : "> export MTL_SHADER_VALIDATION=1\n> export MTL_SHADER_VALIDATION_DEFAULT_STATE=all\n> export MTL_SHADER_VALIDATION_DISABLE_PIPELINES=\"foo\"\n...\n\n> .\/<application>",
      "language" : "zsh"
    },
    {
      "code" : "> export MTL_SHADER_VALIDATION=1\n> export MTL_SHADER_VALIDATION_DEFAULT_STATE=none\n> ...\n\n> .\/<application>",
      "language" : "zsh"
    }
  ],
  "contentHash" : "0521f2e643eb5ccd63157db9266d7d9fb9f4ed7636ea5711353fbbd4fe62aaab",
  "crawledAt" : "2025-12-02T19:35:58Z",
  "id" : "5423335B-F51E-4DDE-8C69-47FE1F9A3C38",
  "kind" : "article",
  "language" : "swift",
  "overview" : "## Overview\n\nThe Shader Validation layer detects errors only discoverable during shader execution, like out-of-bounds memory accesses, attempts to access `nil` textures, and others. It’s similar to Address Sanitizer for general runtime issues (see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/diagnosing-memory-thread-and-crash-issues-early]). You can enable Shader Validation using the runtime diagnostics options in Xcode, or by using environment variables.\n\nTo ensure you see the most up-to-date debug information, set your app’s deployment target to the matching OS version, even if temporarily. You can change the deployment target in the Xcode project settings. If you change the deployment target temporarily, remember to change it back before deploying your app.\n\nFor more information, see the WWDC20 video [https:\/\/developer.apple.com\/videos\/play\/wwdc2020\/10616\/] and the WWDC21 video [https:\/\/developer.apple.com\/videos\/play\/wwdc2021\/10157?time=770].\n\n### Enable Shader Validation in Xcode\n\nFollow these steps to enable Shader Validation using the runtime diagnostics options in the Scheme settings:\n\nNow the system enables Shader Validation each time you run your scheme.\n\nIn addition, you can create breakpoints for shader errors by clicking the arrow next to the Shader Validation checkbox.\n\n\n\n### Selectively enable Shader Validation\n\nWhen enabling Shader Validation, you can also choose to only enable (or disable) Shader Validation for specific pipelines. This advanced control can be particularly useful when you want to focus your debugging on a range of pipelines you preliminarily identified. It can also greatly improve the performance of the apps you debug, thanks to the reduced amount of instrumented pipelines.\n\nShader Validation instruments all pipelines by default (`MTL_SHADER_VALIDATION_DEFAULT_STATE=all`). To change this behavior, you can set `MTL_SHADER_VALIDATION_DEFAULT_STATE=none`.\n\nNext, you can set `MTL_SHADER_VALIDATION_ENABLE_PIPELINES` and `MTL_SHADER_VALIDATION_DISABLE_PIPELINES` to selectively enable and disable instrumentation for given pipelines. You can use the pipeline labels and Shader Validation unique identifiers (UIDs) as entries (see [#Print-pipeline-UIDs]). Multiple entries need to be comma-separated, without spaces (see `man MetalValidation` for more information). In the following example, the pipelines with the label `foo` are the only pipelines not instrumented by Shader Validation.\n\nAlternatively, you can programmatically set your pipeline descriptor property [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPipelineDescriptor\/shaderValidation] to either [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLShaderValidation\/enabled] or [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLShaderValidation\/disabled].\n\nIn the following example, `pipelineState` is the only pipeline instrumented by Shader Validation.\n\nFinally, you can query the Shader Validation state of a pipeline through the [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPipelineState\/shaderValidation] property of pipeline state objects.\n\n### Print pipeline UIDs\n\nShader Validation generates UIDs for all pipelines you process, which you can use as an entry to `MTL_SHADER_VALIDATION_ENABLE_PIPELINES` and `MTL_SHADER_VALIDATION_DISABLE_PIPELINES`. This is useful in the absence of pipeline labels in the application you want to debug.\n\nTo print the UIDs to Console or a `log stream` instance, set `MTL_SHADER_VALIDATION_DUMP_PIPELINES=1` in your terminal or Xcode Environment Variables Scheme settings.\n\n\n\n### View Shader Validation errors\n\nAfter enabling Shader Validation, if Metal encounters errors while executing the commands in a command buffer, the details shown here appear in Xcode:\n\n\n\nYou can find the breakpoint in the Breakpoint navigator if you want to modify or remove it in the future. For more information, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/setting-breakpoints-to-pause-your-running-app].\n\n\n\nIf you discover an error in your shader, consider taking a capture and investigating with the shader debugger (see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Investigating-visual-artifacts]).\n\n### Enable Shader Validation with environment variables\n\nYou can also enable Shader Validation by setting the following environment variables on your Metal app:\n\nFor a complete list of settings, run `man MetalValidation` in Terminal.\n\nIf you discover an error in your shader, consider taking a capture (see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Capturing-a-Metal-workload-programmatically]) and investigating with the Metal debugger (see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Debugging-the-shaders-within-a-draw-command-or-compute-dispatch]).",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Xcode\/Validating-your-apps-Metal-shader-usage\ncrawled: 2025-12-02T19:35:58Z\n---\n\n# Validating your app’s Metal shader usage\n\n**Article**\n\nCatch common shader runtime issues using Shader Validation while your app is running.\n\n## Overview\n\nThe Shader Validation layer detects errors only discoverable during shader execution, like out-of-bounds memory accesses, attempts to access `nil` textures, and others. It’s similar to Address Sanitizer for general runtime issues (see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/diagnosing-memory-thread-and-crash-issues-early]). You can enable Shader Validation using the runtime diagnostics options in Xcode, or by using environment variables.\n\nTo ensure you see the most up-to-date debug information, set your app’s deployment target to the matching OS version, even if temporarily. You can change the deployment target in the Xcode project settings. If you change the deployment target temporarily, remember to change it back before deploying your app.\n\n\n\nFor more information, see the WWDC20 video [https:\/\/developer.apple.com\/videos\/play\/wwdc2020\/10616\/] and the WWDC21 video [https:\/\/developer.apple.com\/videos\/play\/wwdc2021\/10157?time=770].\n\n### Enable Shader Validation in Xcode\n\nFollow these steps to enable Shader Validation using the runtime diagnostics options in the Scheme settings:\n\n1. In the Xcode toolbar, choose Edit Scheme from the Scheme menu. Alternatively, choose Product > Scheme > Edit Scheme.\n2. In the Edit Scheme panel, select Run.\n3. In the setting tab, click Diagnostics.\n4. Select Shader Validation to enable it, and click Close.\n\nNow the system enables Shader Validation each time you run your scheme.\n\nIn addition, you can create breakpoints for shader errors by clicking the arrow next to the Shader Validation checkbox.\n\n\n\n### Selectively enable Shader Validation\n\nWhen enabling Shader Validation, you can also choose to only enable (or disable) Shader Validation for specific pipelines. This advanced control can be particularly useful when you want to focus your debugging on a range of pipelines you preliminarily identified. It can also greatly improve the performance of the apps you debug, thanks to the reduced amount of instrumented pipelines.\n\nShader Validation instruments all pipelines by default (`MTL_SHADER_VALIDATION_DEFAULT_STATE=all`). To change this behavior, you can set `MTL_SHADER_VALIDATION_DEFAULT_STATE=none`.\n\nNext, you can set `MTL_SHADER_VALIDATION_ENABLE_PIPELINES` and `MTL_SHADER_VALIDATION_DISABLE_PIPELINES` to selectively enable and disable instrumentation for given pipelines. You can use the pipeline labels and Shader Validation unique identifiers (UIDs) as entries (see [#Print-pipeline-UIDs]). Multiple entries need to be comma-separated, without spaces (see `man MetalValidation` for more information). In the following example, the pipelines with the label `foo` are the only pipelines not instrumented by Shader Validation.\n\n\n\n```zsh\n> export MTL_SHADER_VALIDATION=1\n> export MTL_SHADER_VALIDATION_DEFAULT_STATE=all\n> export MTL_SHADER_VALIDATION_DISABLE_PIPELINES=\"foo\"\n...\n\n> .\/<application>\n```\n\nAlternatively, you can programmatically set your pipeline descriptor property [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPipelineDescriptor\/shaderValidation] to either [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLShaderValidation\/enabled] or [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLShaderValidation\/disabled].\n\nIn the following example, `pipelineState` is the only pipeline instrumented by Shader Validation.\n\n\n\n```zsh\n> export MTL_SHADER_VALIDATION=1\n> export MTL_SHADER_VALIDATION_DEFAULT_STATE=none\n> ...\n\n> .\/<application>\n```\n\nFinally, you can query the Shader Validation state of a pipeline through the [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPipelineState\/shaderValidation] property of pipeline state objects.\n\n### Print pipeline UIDs\n\nShader Validation generates UIDs for all pipelines you process, which you can use as an entry to `MTL_SHADER_VALIDATION_ENABLE_PIPELINES` and `MTL_SHADER_VALIDATION_DISABLE_PIPELINES`. This is useful in the absence of pipeline labels in the application you want to debug.\n\nTo print the UIDs to Console or a `log stream` instance, set `MTL_SHADER_VALIDATION_DUMP_PIPELINES=1` in your terminal or Xcode Environment Variables Scheme settings.\n\n\n\n\n\n### View Shader Validation errors\n\nAfter enabling Shader Validation, if Metal encounters errors while executing the commands in a command buffer, the details shown here appear in Xcode:\n\n\n\nYou can find the breakpoint in the Breakpoint navigator if you want to modify or remove it in the future. For more information, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/setting-breakpoints-to-pause-your-running-app].\n\n\n\nIf you discover an error in your shader, consider taking a capture and investigating with the shader debugger (see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Investigating-visual-artifacts]).\n\n### Enable Shader Validation with environment variables\n\nYou can also enable Shader Validation by setting the following environment variables on your Metal app:\n\n\n\nFor a complete list of settings, run `man MetalValidation` in Terminal.\n\nIf you discover an error in your shader, consider taking a capture (see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Capturing-a-Metal-workload-programmatically]) and investigating with the Metal debugger (see [doc:\/\/com.apple.Xcode\/documentation\/Xcode\/Debugging-the-shaders-within-a-draw-command-or-compute-dispatch]).\n\n## Runtime diagnostics\n\n- **Inspecting live resources at runtime**: Validate your resources by viewing the contents of your textures and buffers while debugging your Metal app.\n- **Validating your app’s Metal API usage**: Catch runtime issues in your Metal app using API Validation.\n- **Monitoring your Metal app’s graphics performance**: Catch performance issues using the Metal Performance HUD while your app runs.\n- **Customizing the Metal Performance HUD**: Modify the appearance of your Metal heads-up display to monitor your graphics performance.\n- **Understanding the Metal Performance HUD metrics**: Learn what each of the metrics reported by the heads-up display indicates.\n- **Gaining performance insights with the Metal Performance HUD**: Catch potential performance issues while your app runs using the Metal heads-up display.\n- **Generating performance reports with the Metal Performance HUD**: Record your app’s performance using the heads-up display.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Validate your resources by viewing the contents of your textures and buffers while debugging your Metal app.",
          "name" : "Inspecting live resources at runtime",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Inspecting-live-resources-at-runtime"
        },
        {
          "description" : "Catch runtime issues in your Metal app using API Validation.",
          "name" : "Validating your app’s Metal API usage",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Validating-your-apps-Metal-API-usage"
        },
        {
          "description" : "Catch performance issues using the Metal Performance HUD while your app runs.",
          "name" : "Monitoring your Metal app’s graphics performance",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Monitoring-your-Metal-apps-graphics-performance"
        },
        {
          "description" : "Modify the appearance of your Metal heads-up display to monitor your graphics performance.",
          "name" : "Customizing the Metal Performance HUD",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Customizing-metal-performance-hud"
        },
        {
          "description" : "Learn what each of the metrics reported by the heads-up display indicates.",
          "name" : "Understanding the Metal Performance HUD metrics",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Understanding-metal-performance-hud-metrics"
        },
        {
          "description" : "Catch potential performance issues while your app runs using the Metal heads-up display.",
          "name" : "Gaining performance insights with the Metal Performance HUD",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Gaining-performance-insights-with-metal-performance-hud"
        },
        {
          "description" : "Record your app’s performance using the heads-up display.",
          "name" : "Generating performance reports with the Metal Performance HUD",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Generating-performance-reports-with-metal-performance-hud"
        }
      ],
      "title" : "Runtime diagnostics"
    }
  ],
  "source" : "appleJSON",
  "title" : "Validating your app’s Metal shader usage",
  "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Validating-your-apps-Metal-shader-usage"
}