{
  "abstract" : "Gain insights to SIMD group performance by inspecting source code execution.",
  "codeExamples" : [

  ],
  "contentHash" : "82d05b38ed69a894b9e183dee68a03c8aa9a7fcaf2c64d874410fbd39f7c83e8",
  "crawledAt" : "2025-12-02T19:54:16Z",
  "id" : "B39B4088-404C-4367-A38D-7F71A2169B5D",
  "kind" : "article",
  "language" : "swift",
  "overview" : "## Overview\n\nMetal organizes the threads of your shader into single-instruction, multiple-data (SIMD) groups. The performance heat maps feature provides a way to quickly find SIMD groups that are expensive or divergent. You can graphically inspect how Apple GPUs execute the shader source code in those groups, and gain insights of potential performance bottlenecks.\n\n### View the performance heat maps\n\nTo open the performance heat maps, click the Performance button in the Metal debugger’s Debug navigator, and then click the Heat Map tab above the Performance timeline.\n\n\n\nWhen you select an encoder, pipeline state, or GPU command in the Timeline navigator, the heat maps for the corresponding work appear on the right.\n\nIn addition, performance heat maps are available for the following shader types:\n\n### Switch between shader types\n\nBy default, selecting a render command encoder, a render pipeline state, or a draw command shows the fragment shader heat maps. Selecting a compute dispatch command shows the compute shader heat maps.\n\nYou can switch between different shader types using the Vertex and Fragment tabs above the heat maps.\n\n### Display more types of performance heat maps\n\nBy default, the Shader Execution Cost heat map and the Attachments display for render command encoders, pipeline states, and draws.\n\nClick the Add button (+) in the heat map control bar to open a popover of all available performance heat maps. You can customize which heat maps to display by selecting the checkboxes.\n\n\n\nAvailable performance heat map options include the following:\n\nThe color intensity in the heat maps represents the significance of the values. For example, red means *more expensive* in the Shader Execution Cost heat map, and *more divergent* in the Thread Divergence heat map.\n\n### View and adjust the value range of performance heat maps\n\nYou can filter and tone-map a performance heat map by clicking the Histogram button in the title bar.\n\n\n\nThe histogram popover shows the value range of the heat map. You can drag the handles to adjust the range to filter smaller and larger values. This can be useful in situations when you want a certain value range, such as showing pixels in a render pass that executes more than 100 instructions.\n\n### Inspect the execution history for a SIMD group\n\nSelecting a pixel in the heat map allows you to inspect the underlying SIMD group.\n\nIf more than one SIMD group touches the pixel in a render pass, a list of SIMD groups in order of cost percentile appears so you can select the one to inspect. When you select a SIMD group in the list, its execution history appears below the heat maps.\n\n\n\nThe Execution History timeline shows the progress of the selected SIMD group from left to right, and lists the full shader call stack at each point of execution from top to bottom.\n\nThe Metal debugger also helps you better understand shader execution by detecting and visualizing loops in the shader instruction stream. You can select a node in the timeline, and the source editor jumps to the file and the line that contain the executed instructions of that node.\n\n### Understand the number of instructions per line\n\nThe number of executed instructions appears next to the lines of code, in the gutter of the shader source code. This number is the total assembly code executions over the lifetime of the entire SIMD group for that line of code.\n\nFor example, if there’s a loop with 10 iterations, the number of instructions for the source lines within the loop is 10 times more than the source lines outside the loop, given the same amount of assembly code.\n\n### Switch between per-line statistics modes\n\nIn the shader source code control bar, you can choose different modes for the per-line shader profiling statistics in the gutter. Options include the following:\n\nYou may find thread divergence to be 50% if there’s a conditional branch that only half of the threads enter within the selected SIMD group.\n\nFor more information about the Metal profiling tools for M3 and A17 Pro, see [https:\/\/developer.apple.com\/videos\/play\/tech-talks\/111374\/].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-Apple-GPU-performance-using-performance-heatmaps-a17-m3\ncrawled: 2025-12-02T19:54:16Z\n---\n\n# Analyzing Apple GPU performance with performance heat maps\n\n**Article**\n\nGain insights to SIMD group performance by inspecting source code execution.\n\n## Overview\n\nMetal organizes the threads of your shader into single-instruction, multiple-data (SIMD) groups. The performance heat maps feature provides a way to quickly find SIMD groups that are expensive or divergent. You can graphically inspect how Apple GPUs execute the shader source code in those groups, and gain insights of potential performance bottlenecks.\n\n\n\n### View the performance heat maps\n\nTo open the performance heat maps, click the Performance button in the Metal debugger’s Debug navigator, and then click the Heat Map tab above the Performance timeline.\n\n\n\nWhen you select an encoder, pipeline state, or GPU command in the Timeline navigator, the heat maps for the corresponding work appear on the right.\n\n\n\nIn addition, performance heat maps are available for the following shader types:\n\n\n\n\n\n### Switch between shader types\n\nBy default, selecting a render command encoder, a render pipeline state, or a draw command shows the fragment shader heat maps. Selecting a compute dispatch command shows the compute shader heat maps.\n\nYou can switch between different shader types using the Vertex and Fragment tabs above the heat maps.\n\n### Display more types of performance heat maps\n\nBy default, the Shader Execution Cost heat map and the Attachments display for render command encoders, pipeline states, and draws.\n\nClick the Add button (+) in the heat map control bar to open a popover of all available performance heat maps. You can customize which heat maps to display by selecting the checkboxes.\n\n\n\nAvailable performance heat map options include the following:\n\n\n\nThe color intensity in the heat maps represents the significance of the values. For example, red means *more expensive* in the Shader Execution Cost heat map, and *more divergent* in the Thread Divergence heat map.\n\n### View and adjust the value range of performance heat maps\n\nYou can filter and tone-map a performance heat map by clicking the Histogram button in the title bar.\n\n\n\nThe histogram popover shows the value range of the heat map. You can drag the handles to adjust the range to filter smaller and larger values. This can be useful in situations when you want a certain value range, such as showing pixels in a render pass that executes more than 100 instructions.\n\n### Inspect the execution history for a SIMD group\n\nSelecting a pixel in the heat map allows you to inspect the underlying SIMD group.\n\nIf more than one SIMD group touches the pixel in a render pass, a list of SIMD groups in order of cost percentile appears so you can select the one to inspect. When you select a SIMD group in the list, its execution history appears below the heat maps.\n\n\n\nThe Execution History timeline shows the progress of the selected SIMD group from left to right, and lists the full shader call stack at each point of execution from top to bottom.\n\nThe Metal debugger also helps you better understand shader execution by detecting and visualizing loops in the shader instruction stream. You can select a node in the timeline, and the source editor jumps to the file and the line that contain the executed instructions of that node.\n\n### Understand the number of instructions per line\n\nThe number of executed instructions appears next to the lines of code, in the gutter of the shader source code. This number is the total assembly code executions over the lifetime of the entire SIMD group for that line of code.\n\nFor example, if there’s a loop with 10 iterations, the number of instructions for the source lines within the loop is 10 times more than the source lines outside the loop, given the same amount of assembly code.\n\n### Switch between per-line statistics modes\n\nIn the shader source code control bar, you can choose different modes for the per-line shader profiling statistics in the gutter. Options include the following:\n\n\n\nYou may find thread divergence to be 50% if there’s a conditional branch that only half of the threads enter within the selected SIMD group.\n\nFor more information about the Metal profiling tools for M3 and A17 Pro, see [https:\/\/developer.apple.com\/videos\/play\/tech-talks\/111374\/].\n\n## Metal workload analysis\n\n- **Analyzing your Metal workload**: Investigate your app’s workload, dependencies, performance, and memory impact using the Metal debugger.\n- **Analyzing resource dependencies**: Avoid unnecessary work in your Metal app by understanding the relationships between resources.\n- **Analyzing memory usage**: Manage your Metal app’s memory usage by inspecting its resources.\n- **Analyzing Apple GPU performance using a visual timeline**: Locate performance issues using the Performance timeline.\n- **Analyzing Apple GPU performance using counter statistics**: Optimize performance by examining counters for individual passes and commands.\n- **Analyzing Apple GPU performance using the shader cost graph**: Discover potential shader performance issues by examining pipeline states.\n- **Analyzing non-Apple GPU performance using counter statistics**: Optimize performance by examining counters for individual passes and commands.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Investigate your app’s workload, dependencies, performance, and memory impact using the Metal debugger.",
          "name" : "Analyzing your Metal workload",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-your-Metal-workload"
        },
        {
          "description" : "Avoid unnecessary work in your Metal app by understanding the relationships between resources.",
          "name" : "Analyzing resource dependencies",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-resource-dependencies"
        },
        {
          "description" : "Manage your Metal app’s memory usage by inspecting its resources.",
          "name" : "Analyzing memory usage",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-memory-usage"
        },
        {
          "description" : "Locate performance issues using the Performance timeline.",
          "name" : "Analyzing Apple GPU performance using a visual timeline",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-Apple-GPU-performance-using-a-visual-timeline"
        },
        {
          "description" : "Optimize performance by examining counters for individual passes and commands.",
          "name" : "Analyzing Apple GPU performance using counter statistics",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-Apple-GPU-performance-using-counter-statistics"
        },
        {
          "description" : "Discover potential shader performance issues by examining pipeline states.",
          "name" : "Analyzing Apple GPU performance using the shader cost graph",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-Apple-GPU-performance-using-shader-cost-graph-a17-m3"
        },
        {
          "description" : "Optimize performance by examining counters for individual passes and commands.",
          "name" : "Analyzing non-Apple GPU performance using counter statistics",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-non-Apple-GPU-performance-using-counter-statistics"
        }
      ],
      "title" : "Metal workload analysis"
    }
  ],
  "source" : "appleJSON",
  "title" : "Analyzing Apple GPU performance with performance heat maps",
  "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Analyzing-Apple-GPU-performance-using-performance-heatmaps-a17-m3"
}