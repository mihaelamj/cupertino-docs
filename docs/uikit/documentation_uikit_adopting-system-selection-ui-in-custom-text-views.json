{
  "abstract" : "Incorporate the system text-selection experience into your custom text UI in UIKit.",
  "codeExamples" : [
    {
      "code" : "\/\/ Set up the interaction.\nlet selectionDisplayInteraction = UITextSelectionDisplayInteraction(textInput: documentView,\n                                                     delegate: self)\ndocumentView.addInteraction(selectionDisplayInteraction)",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Activate the interaction when the text view becomes active.\nfunc didBecomeActive() {\n    selectionDisplayInteraction.isActivated = true\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Notify the interaction when the text selection changes.\nfunc didChangeSelection() {\n    selectionDisplayInteraction.setNeedsSelectionUpdate()\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Show a loupe with a pan gesture.\nvar loupeSession: UITextLoupeSession?\n\nfunc didRecognizePanGesture(_ gesture: UIPanGestureRecognizer) {\n    let location = gesture.location(in: view)\n    let cursorView = selectionDisplayInteraction.cursorView\n    switch gesture.state {\n    case .began:\n        loupeSession = UITextLoupeSession.begin(at: location,\n                                                fromSelectionWidgetView: cursorView,\n                                                in: view)\n    case .changed:\n        loupeSession?.move(to: location, withCaretRect: cursorView.frame,\n                           trackingCaret: true)\n    case .ended, .cancelled, .failed:\n        loupeSession?.invalidate()\n        loupeSession = nil\n    default:\n        break\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Deactivate the interaction when the text view becomes inactive.\nfunc didBecomeInactive() {\n    selectionDisplayInteraction.isActivated = false\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "eff63d181ce287b9bfdb920ea592ae5c6a3515268edeb737fa08dac6313fe3c0",
  "crawledAt" : "2025-12-03T05:49:02Z",
  "id" : "721265C2-7F7A-4984-8BBD-7DE51E11AFB1",
  "kind" : "article",
  "language" : "swift",
  "module" : "UIKit",
  "overview" : "## Overview\n\nPeople can enter text into your app in a variety of ways, such as typing, copy and paste, or dictation. iOS 17 introduces changes to the system UI for inserting and selecting text to provide a more seamless text experience.\n\nIf your app handles text input through standard UIKit views such as [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextView] or [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextField], your app automatically uses the system UI for inserting and selecting text. This system selection UI includes the following elements:\n\nIf you have a highly customized UI for displaying text, you can adopt this system selection UI in your UIKit app. In most cases involving text selection display and interaction, use [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextInteraction], which includes the system selection UI and standard gesture recognizers to let people modify the selection state in your custom text view. If you want to implement the selection gestures yourself, but still want to indicate text selection using the standard system UI, use [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction] instead. This article describes the steps for adopting [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction].\n\n### Add the system selection UI to a custom text view\n\nIf your app handles text input through a custom text view that builds on [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextInput], you can display the system selection UI manually. Create a [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction] interaction and add it to your custom text view that adopts [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextInput].\n\nWhen your custom text view becomes active or becomes first responder, activate the interaction.\n\n### Update the text selection\n\nWhen a person interacts with text in your custom text view, notify the interaction as the state of the text selection changes.\n\nAfter you call [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/setNeedsSelectionUpdate()], the interaction retrieves the latest information about the current text selection from [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/textInput] so it can redraw the selection UI.\n\n### Customize the system selection UI elements\n\nYou might want further customization to the system selection UI to match your custom text view’s style and behavior. You can customize various properties on [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction].\n\n### Enhance text-cursor placement with the text loupe\n\nYour custom text view can also display the system UI for the loupe, which people use for placing the text cursor in large bodies of text. When a person interacts with your custom text view in a way that you want to display the loupe, such as a pan gesture, call [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession\/begin(at:fromSelectionWidgetView:in:)] on a [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession] object. The system animates the presentation and placement of the loupe according to the starting point you provide. Call [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession\/move(to:withCaretRect:trackingCaret:)] to track the movement of the loupe as a person moves the text cursor, and [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession\/invalidate()] to hide the loupe and end the session.\n\nThe following code shows how to show the loupe using a pan gesture recognizer.\n\n### Hide the system selection UI\n\nWhen your custom text view becomes inactive or resigns first responder status, make sure to deactivate the interaction.\n\nIf you implement custom text UI in an AppKit app, see [doc:\/\/com.apple.documentation\/documentation\/AppKit\/adopting-the-system-text-cursor-in-custom-text-views].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/UIKit\/adopting-system-selection-ui-in-custom-text-views\ncrawled: 2025-12-03T05:49:02Z\n---\n\n# Adopting system selection UI in custom text views\n\n**Article**\n\nIncorporate the system text-selection experience into your custom text UI in UIKit.\n\n## Overview\n\nPeople can enter text into your app in a variety of ways, such as typing, copy and paste, or dictation. iOS 17 introduces changes to the system UI for inserting and selecting text to provide a more seamless text experience.\n\nIf your app handles text input through standard UIKit views such as [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextView] or [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextField], your app automatically uses the system UI for inserting and selecting text. This system selection UI includes the following elements:\n\n- The text cursor that indicates the insertion point of the text\n- The highlight behind the selected text\n- Selection handles for selecting ranges of text\n- The loupe for placing the text cursor in large bodies of text\n\nIf you have a highly customized UI for displaying text, you can adopt this system selection UI in your UIKit app. In most cases involving text selection display and interaction, use [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextInteraction], which includes the system selection UI and standard gesture recognizers to let people modify the selection state in your custom text view. If you want to implement the selection gestures yourself, but still want to indicate text selection using the standard system UI, use [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction] instead. This article describes the steps for adopting [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction].\n\n### Add the system selection UI to a custom text view\n\nIf your app handles text input through a custom text view that builds on [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextInput], you can display the system selection UI manually. Create a [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction] interaction and add it to your custom text view that adopts [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextInput].\n\n```swift\n\/\/ Set up the interaction.\nlet selectionDisplayInteraction = UITextSelectionDisplayInteraction(textInput: documentView,\n                                                     delegate: self)\ndocumentView.addInteraction(selectionDisplayInteraction)\n```\n\nWhen your custom text view becomes active or becomes first responder, activate the interaction.\n\n```swift\n\/\/ Activate the interaction when the text view becomes active.\nfunc didBecomeActive() {\n    selectionDisplayInteraction.isActivated = true\n}\n```\n\n### Update the text selection\n\nWhen a person interacts with text in your custom text view, notify the interaction as the state of the text selection changes.\n\n```swift\n\/\/ Notify the interaction when the text selection changes.\nfunc didChangeSelection() {\n    selectionDisplayInteraction.setNeedsSelectionUpdate()\n}\n```\n\nAfter you call [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/setNeedsSelectionUpdate()], the interaction retrieves the latest information about the current text selection from [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/textInput] so it can redraw the selection UI.\n\n### Customize the system selection UI elements\n\nYou might want further customization to the system selection UI to match your custom text view’s style and behavior. You can customize various properties on [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction].\n\n- The [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/cursorView] property represents the text cursor. You can customize the state of the text cursor’s blinking animation.\n- The [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/highlightView] property represents the highlight behind the selected text. You can customize the shape of the selection to draw a custom highlight.\n- The [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextSelectionDisplayInteraction\/handleViews] property represents the selection handles for selecting ranges of text. You can customize the appearance of the handles by defining a custom shape or specifying the orientation of the handles.\n\n### Enhance text-cursor placement with the text loupe\n\nYour custom text view can also display the system UI for the loupe, which people use for placing the text cursor in large bodies of text. When a person interacts with your custom text view in a way that you want to display the loupe, such as a pan gesture, call [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession\/begin(at:fromSelectionWidgetView:in:)] on a [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession] object. The system animates the presentation and placement of the loupe according to the starting point you provide. Call [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession\/move(to:withCaretRect:trackingCaret:)] to track the movement of the loupe as a person moves the text cursor, and [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UITextLoupeSession\/invalidate()] to hide the loupe and end the session.\n\nThe following code shows how to show the loupe using a pan gesture recognizer.\n\n```swift\n\/\/ Show a loupe with a pan gesture.\nvar loupeSession: UITextLoupeSession?\n\nfunc didRecognizePanGesture(_ gesture: UIPanGestureRecognizer) {\n    let location = gesture.location(in: view)\n    let cursorView = selectionDisplayInteraction.cursorView\n    switch gesture.state {\n    case .began:\n        loupeSession = UITextLoupeSession.begin(at: location,\n                                                fromSelectionWidgetView: cursorView,\n                                                in: view)\n    case .changed:\n        loupeSession?.move(to: location, withCaretRect: cursorView.frame,\n                           trackingCaret: true)\n    case .ended, .cancelled, .failed:\n        loupeSession?.invalidate()\n        loupeSession = nil\n    default:\n        break\n    }\n}\n```\n\n### Hide the system selection UI\n\nWhen your custom text view becomes inactive or resigns first responder status, make sure to deactivate the interaction.\n\n```swift\n\/\/ Deactivate the interaction when the text view becomes inactive.\nfunc didBecomeInactive() {\n    selectionDisplayInteraction.isActivated = false\n}\n```\n\nIf you implement custom text UI in an AppKit app, see [doc:\/\/com.apple.documentation\/documentation\/AppKit\/adopting-the-system-text-cursor-in-custom-text-views].\n\n\n\n## Custom text selection\n\n- **UITextSelectionDisplayInteraction**: An object that provides the system UI for displaying text selection.\n- **UITextSelectionHighlightView**: An interface you use to provide a custom highlight UI behind the selected text.\n- **UITextSelectionHandleView**: An interface you use to draw custom the selection handles for ranges of text.\n- **UITextCursorView**: An interface you use to draw the insertion point in a piece of text.\n- **UIStandardTextCursorView**: A view that draws the standard system insertion point in a piece of text.\n- **UITextCursorDropPositionAnimator**\n- **UITextLoupeSession**: An object that manages the presentation of the system magnifier at the location you specify.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that provides the system UI for displaying text selection.",
          "name" : "UITextSelectionDisplayInteraction",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UITextSelectionDisplayInteraction"
        },
        {
          "description" : "An interface you use to provide a custom highlight UI behind the selected text.",
          "name" : "UITextSelectionHighlightView",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UITextSelectionHighlightView"
        },
        {
          "description" : "An interface you use to draw custom the selection handles for ranges of text.",
          "name" : "UITextSelectionHandleView",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UITextSelectionHandleView"
        },
        {
          "description" : "An interface you use to draw the insertion point in a piece of text.",
          "name" : "UITextCursorView",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UITextCursorView"
        },
        {
          "description" : "A view that draws the standard system insertion point in a piece of text.",
          "name" : "UIStandardTextCursorView",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UIStandardTextCursorView"
        },
        {
          "description" : "",
          "name" : "UITextCursorDropPositionAnimator",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UITextCursorDropPositionAnimator"
        },
        {
          "description" : "An object that manages the presentation of the system magnifier at the location you specify.",
          "name" : "UITextLoupeSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UITextLoupeSession"
        }
      ],
      "title" : "Custom text selection"
    }
  ],
  "source" : "appleJSON",
  "title" : "Adopting system selection UI in custom text views",
  "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/adopting-system-selection-ui-in-custom-text-views"
}