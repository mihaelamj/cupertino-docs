{
  "abstract" : "Load data for collection view cells before they display.",
  "codeExamples" : [
    {
      "code" : "class CustomDataSource: NSObject, UICollectionViewDataSource, UICollectionViewDataSourcePrefetching {",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Set the collection view's data source.\ncollectionView.dataSource = dataSource\n\n\/\/ Set the collection view's prefetching data source.\ncollectionView.prefetchDataSource = dataSource",
      "language" : "swift"
    },
    {
      "code" : "func collectionView(_ collectionView: UICollectionView, prefetchItemsAt indexPaths: [IndexPath]) {\n    \/\/ Begin asynchronously fetching data for the requested index paths.\n    for indexPath in indexPaths {\n        let model = models[indexPath.row]\n        asyncFetcher.fetchAsync(model.identifier)\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/**\n Configures the cell for display based on the model.\n \n - Parameters:\n     - data: An optional `DisplayData` object to display.\n \n - Tag: Cell_Config\n*\/\nfunc configure(with data: DisplayData?) {\n    backgroundColor = data?.color\n}",
      "language" : "swift"
    },
    {
      "code" : "func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {\n    guard let cell = collectionView.dequeueReusableCell(withReuseIdentifier: Cell.reuseIdentifier, for: indexPath) as? Cell else {\n        fatalError(\"Expected `\\(Cell.self)` type for reuseIdentifier \\(Cell.reuseIdentifier). Check the configuration in Main.storyboard.\")\n    }\n    \n    let model = models[indexPath.row]\n    let identifier = model.identifier\n    cell.representedIdentifier = identifier\n    \n    \/\/ Check if the `asyncFetcher` has already fetched data for the specified identifier.\n    if let fetchedData = asyncFetcher.fetchedData(for: identifier) {\n        \/\/ The system has fetched and cached the data; use it to configure the cell.\n        cell.configure(with: fetchedData)\n    } else {\n        \/\/ There is no data available; clear the cell until the fetched data arrives.\n        cell.configure(with: nil)\n\n        \/\/ Ask the `asyncFetcher` to fetch data for the specified identifier.\n        asyncFetcher.fetchAsync(identifier) { fetchedData in\n            DispatchQueue.main.async {\n                \/*\n                 The `asyncFetcher` has fetched data for the identifier. Before\n                 updating the cell, check whether the collection view has recycled it to represent other data.\n                 *\/\n                guard cell.representedIdentifier == identifier else { return }\n                \n                \/\/ Configure the cell with the fetched image.\n                cell.configure(with: fetchedData)\n            }\n        }\n    }\n\n    return cell\n}",
      "language" : "swift"
    },
    {
      "code" : "func collectionView(_ collectionView: UICollectionView, cancelPrefetchingForItemsAt indexPaths: [IndexPath]) {\n    \/\/ Cancel any in-flight requests for data for the specified index paths.\n    for indexPath in indexPaths {\n        let model = models[indexPath.row]\n        asyncFetcher.cancelFetch(model.identifier)\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "817225e3b9f9f1a6a9c3fcebcfb5b5522e80ab85449b49b6acace32238d4a142",
  "crawledAt" : "2025-12-02T15:52:25Z",
  "id" : "854A9B8D-69A1-4B70-B602-4BE92D4BC7A9",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "UIKit",
  "overview" : "## Overview\n\nA collection view displays an ordered collection of cells in customizable layouts. The [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching] protocol helps provide a smoother user experience by prefetching the data necessary for upcoming collection view cells. When you enable prefetching, the collection view requests the data before it needs to display the cell. When it’s time to display the cell, the data is already locally cached.\n\nThe image below shows cells outside the bounds of the collection view that have been prefetched:\n\n\n\n### Enable prefetching\n\nThe root view controller uses an instance of the `CustomDataSource` class to provide data to its [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionView] instance. The `CustomDataSource` class implements the `UICollectionViewDataSourcePrefetching` protocol to begin fetching the data required to populate cells.\n\nIn addition to assigning the `CustomDataSource` instance to the collection view’s [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionView\/dataSource] property, the sample code project also assigns it to the [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionView\/prefetchDataSource] property.\n\n### Load data asynchronously\n\nPrefetching data is a tool to use when loading data is a slow or expensive process — for example, when fetching data over the network. In these circumstances, it’s best to perform data loading asynchronously. In this sample, the `AsyncFetcher` class fetches data asynchronously, simulating a network request.\n\nFirst, the sample implements the [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching] prefetch method, invoking the appropriate method on the asynchronous fetcher.\n\nWhen prefetching is complete, the sample adds the cell’s data to the `AsyncFetcher`‘s cache, so it’s ready to use when the cell displays. The cell’s background color changes from white to red when data is available for that cell.\n\n### Populate cells for display\n\nBefore populating a cell, the `CustomDataSource` checks for any prefetched data that it can use. If none is available, the `CustomDataSource` makes a fetch request and the cell updates in the fetch request’s completion handler.\n\n### Cancel unnecessary fetches\n\nThe sample implements the [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching\/collectionView(_:cancelPrefetchingForItemsAt:)] delegate method to cancel any in-progress data fetches that are no longer required.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/UIKit\/prefetching-collection-view-data\ncrawled: 2025-12-02T15:52:25Z\n---\n\n# Prefetching collection view data\n\n**Sample Code**\n\nLoad data for collection view cells before they display.\n\n## Overview\n\nA collection view displays an ordered collection of cells in customizable layouts. The [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching] protocol helps provide a smoother user experience by prefetching the data necessary for upcoming collection view cells. When you enable prefetching, the collection view requests the data before it needs to display the cell. When it’s time to display the cell, the data is already locally cached.\n\nThe image below shows cells outside the bounds of the collection view that have been prefetched:\n\n\n\n\n\n### Enable prefetching\n\nThe root view controller uses an instance of the `CustomDataSource` class to provide data to its [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionView] instance. The `CustomDataSource` class implements the `UICollectionViewDataSourcePrefetching` protocol to begin fetching the data required to populate cells.\n\n```swift\nclass CustomDataSource: NSObject, UICollectionViewDataSource, UICollectionViewDataSourcePrefetching {\n```\n\nIn addition to assigning the `CustomDataSource` instance to the collection view’s [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionView\/dataSource] property, the sample code project also assigns it to the [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionView\/prefetchDataSource] property.\n\n```swift\n\/\/ Set the collection view's data source.\ncollectionView.dataSource = dataSource\n\n\/\/ Set the collection view's prefetching data source.\ncollectionView.prefetchDataSource = dataSource\n```\n\n### Load data asynchronously\n\nPrefetching data is a tool to use when loading data is a slow or expensive process — for example, when fetching data over the network. In these circumstances, it’s best to perform data loading asynchronously. In this sample, the `AsyncFetcher` class fetches data asynchronously, simulating a network request.\n\nFirst, the sample implements the [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching] prefetch method, invoking the appropriate method on the asynchronous fetcher.\n\n```swift\nfunc collectionView(_ collectionView: UICollectionView, prefetchItemsAt indexPaths: [IndexPath]) {\n    \/\/ Begin asynchronously fetching data for the requested index paths.\n    for indexPath in indexPaths {\n        let model = models[indexPath.row]\n        asyncFetcher.fetchAsync(model.identifier)\n    }\n}\n```\n\n\n\nWhen prefetching is complete, the sample adds the cell’s data to the `AsyncFetcher`‘s cache, so it’s ready to use when the cell displays. The cell’s background color changes from white to red when data is available for that cell.\n\n```swift\n\/**\n Configures the cell for display based on the model.\n \n - Parameters:\n     - data: An optional `DisplayData` object to display.\n \n - Tag: Cell_Config\n*\/\nfunc configure(with data: DisplayData?) {\n    backgroundColor = data?.color\n}\n```\n\n### Populate cells for display\n\nBefore populating a cell, the `CustomDataSource` checks for any prefetched data that it can use. If none is available, the `CustomDataSource` makes a fetch request and the cell updates in the fetch request’s completion handler.\n\n```swift\nfunc collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {\n    guard let cell = collectionView.dequeueReusableCell(withReuseIdentifier: Cell.reuseIdentifier, for: indexPath) as? Cell else {\n        fatalError(\"Expected `\\(Cell.self)` type for reuseIdentifier \\(Cell.reuseIdentifier). Check the configuration in Main.storyboard.\")\n    }\n    \n    let model = models[indexPath.row]\n    let identifier = model.identifier\n    cell.representedIdentifier = identifier\n    \n    \/\/ Check if the `asyncFetcher` has already fetched data for the specified identifier.\n    if let fetchedData = asyncFetcher.fetchedData(for: identifier) {\n        \/\/ The system has fetched and cached the data; use it to configure the cell.\n        cell.configure(with: fetchedData)\n    } else {\n        \/\/ There is no data available; clear the cell until the fetched data arrives.\n        cell.configure(with: nil)\n\n        \/\/ Ask the `asyncFetcher` to fetch data for the specified identifier.\n        asyncFetcher.fetchAsync(identifier) { fetchedData in\n            DispatchQueue.main.async {\n                \/*\n                 The `asyncFetcher` has fetched data for the identifier. Before\n                 updating the cell, check whether the collection view has recycled it to represent other data.\n                 *\/\n                guard cell.representedIdentifier == identifier else { return }\n                \n                \/\/ Configure the cell with the fetched image.\n                cell.configure(with: fetchedData)\n            }\n        }\n    }\n\n    return cell\n}\n```\n\n### Cancel unnecessary fetches\n\nThe sample implements the [doc:\/\/com.apple.uikit\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching\/collectionView(_:cancelPrefetchingForItemsAt:)] delegate method to cancel any in-progress data fetches that are no longer required.\n\n```swift\nfunc collectionView(_ collectionView: UICollectionView, cancelPrefetchingForItemsAt indexPaths: [IndexPath]) {\n    \/\/ Cancel any in-flight requests for data for the specified index paths.\n    for indexPath in indexPaths {\n        let model = models[indexPath.row]\n        asyncFetcher.cancelFetch(model.identifier)\n    }\n}\n```\n\n## Managing data prefetching\n\n- **collectionView(_:prefetchItemsAt:)**: Tells your prefetch data source object to begin preparing data for the cells at the supplied index paths.\n- **collectionView(_:cancelPrefetchingForItemsAt:)**: Cancels a previously triggered data prefetch request.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Tells your prefetch data source object to begin preparing data for the cells at the supplied index paths.",
          "name" : "collectionView(_:prefetchItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching\/collectionView(_:prefetchItemsAt:)"
        },
        {
          "description" : "Cancels a previously triggered data prefetch request.",
          "name" : "collectionView(_:cancelPrefetchingForItemsAt:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/UICollectionViewDataSourcePrefetching\/collectionView(_:cancelPrefetchingForItemsAt:)"
        }
      ],
      "title" : "Managing data prefetching"
    }
  ],
  "source" : "appleJSON",
  "title" : "Prefetching collection view data",
  "url" : "https:\/\/developer.apple.com\/documentation\/UIKit\/prefetching-collection-view-data"
}