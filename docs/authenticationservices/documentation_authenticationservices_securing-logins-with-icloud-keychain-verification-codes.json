{
  "abstract" : "Use time-based codes generated on-device for a secure authentication experience.",
  "codeExamples" : [

  ],
  "contentHash" : "3e86912ca05d9b0001ccf9377ad3a73b89dc41febcad05fa09f3811d81ccce86",
  "crawledAt" : "2025-12-04T21:48:18Z",
  "id" : "63584AB4-AABD-469E-A448-36C684F495FA",
  "kind" : "article",
  "language" : "swift",
  "module" : "Authentication Services",
  "overview" : "## Overview\n\nApps and services often use verification codes in a two-factor authentication scheme. When used properly, they strengthen account security over just using passwords alone. During sign in, a service asks for a code to verify the user’s identity. These codes are often sent over SMS. The user then confirms their identity by entering the code they receive. Delivering codes over SMS entails a number of risks. For example, SMS-based verification codes can be snooped on carrier networks, or redirected to an attacker through SIM swapping attacks.\n\nWith iCloud Keychain verification codes, iPhones, iPads, and Macs generate verification codes entirely offline, reducing the risk associated with sending them online. iCloud Keychain synchronizes codes across all of the user’s devices.\n\n### Set Up the Verification Code\n\nBoth iOS and macOS handle a special URL based on the industry standard [https:\/\/github.com\/google\/google-authenticator\/wiki\/Key-Uri-Format]. The Apple-specific version of this URL is identical to the standard, but uses the `apple-otpauth:` scheme. Embed this URL in your webpages and apps to allow your users to set up new code generators directly in the iCloud Keychain password manager with minimal effort. On the web, use an `<a>` tag to create a link. In apps, create an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString] with a [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString\/Key\/link] attribute, or open the URL in response to a button tap. When the user taps on the URL, the system prompts them to choose a credential. A new verification code is set up for that credential using the parameters specified in the URL.\n\nThe host portion of the URL must be `totp`, and the path should be the proper name of your service, followed by a colon and the user name or email of the account. The `otpauth:` specification defines a number of query parameters. The following are the most important:\n\nHere’s an example of the URL for an app called Example for the user meichen3@icloud.com:\n\n`apple-otpauth:\/\/totp\/Example:meichen3@icloud.com?secret=HAZDGMBWGE4DOMZYGEYTOMJTG43TMOJRGE4DANJQGE3DGOBRGI4TOOJZGEYTENJTGIYTEMJRHEZDA&digits=6&period=30&issuer=example.com`\n\n### Prepare the Text Input Field\n\nAutoFill on iOS and macOS offer to fill verification codes automatically in text fields where you set the content type of the field to a one-time code type. In SwiftUI, set the content type to [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UITextContentType\/oneTimeCode] with the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/View\/textContentType(_:)-ufdv] view modifier. In UIKit, set [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UITextInputTraits\/textContentType] to [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UITextContentType\/oneTimeCode]. In AppKit, set [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextContent\/contentType] to [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextContentType\/oneTimeCode]. For web-based text fields, set the HTML attribute on the input element to `autocomplete=one-time-code`.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/securing-logins-with-icloud-keychain-verification-codes\ncrawled: 2025-12-04T21:48:18Z\n---\n\n# Securing Logins with iCloud Keychain Verification Codes\n\n**Article**\n\nUse time-based codes generated on-device for a secure authentication experience.\n\n## Overview\n\nApps and services often use verification codes in a two-factor authentication scheme. When used properly, they strengthen account security over just using passwords alone. During sign in, a service asks for a code to verify the user’s identity. These codes are often sent over SMS. The user then confirms their identity by entering the code they receive. Delivering codes over SMS entails a number of risks. For example, SMS-based verification codes can be snooped on carrier networks, or redirected to an attacker through SIM swapping attacks.\n\nWith iCloud Keychain verification codes, iPhones, iPads, and Macs generate verification codes entirely offline, reducing the risk associated with sending them online. iCloud Keychain synchronizes codes across all of the user’s devices.\n\n### Set Up the Verification Code\n\nBoth iOS and macOS handle a special URL based on the industry standard [https:\/\/github.com\/google\/google-authenticator\/wiki\/Key-Uri-Format]. The Apple-specific version of this URL is identical to the standard, but uses the `apple-otpauth:` scheme. Embed this URL in your webpages and apps to allow your users to set up new code generators directly in the iCloud Keychain password manager with minimal effort. On the web, use an `<a>` tag to create a link. In apps, create an [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString] with a [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSAttributedString\/Key\/link] attribute, or open the URL in response to a button tap. When the user taps on the URL, the system prompts them to choose a credential. A new verification code is set up for that credential using the parameters specified in the URL.\n\nThe host portion of the URL must be `totp`, and the path should be the proper name of your service, followed by a colon and the user name or email of the account. The `otpauth:` specification defines a number of query parameters. The following are the most important:\n\n\n\nHere’s an example of the URL for an app called Example for the user meichen3@icloud.com:\n\n`apple-otpauth:\/\/totp\/Example:meichen3@icloud.com?secret=HAZDGMBWGE4DOMZYGEYTOMJTG43TMOJRGE4DANJQGE3DGOBRGI4TOOJZGEYTENJTGIYTEMJRHEZDA&digits=6&period=30&issuer=example.com`\n\n### Prepare the Text Input Field\n\nAutoFill on iOS and macOS offer to fill verification codes automatically in text fields where you set the content type of the field to a one-time code type. In SwiftUI, set the content type to [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UITextContentType\/oneTimeCode] with the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/View\/textContentType(_:)-ufdv] view modifier. In UIKit, set [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UITextInputTraits\/textContentType] to [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UITextContentType\/oneTimeCode]. In AppKit, set [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextContent\/contentType] to [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextContentType\/oneTimeCode]. For web-based text fields, set the HTML attribute on the input element to `autocomplete=one-time-code`.\n\n## Web authentication sessions\n\n- **Authenticating a User Through a Web Service**: Use a web authentication session to authenticate a user in your app.\n- **ASWebAuthenticationSession**: A session that an app uses to authenticate a user through a web service.\n- **WebAuthenticationSession**: A SwiftUI environment value that views use to authenticate someone using a web service.\n- **Supporting Single Sign-On in a Web Browser App**: Extend your web browser app to handle web authentication requests from other apps.\n- **ASWebAuthenticationSessionWebBrowserSessionManager**: A session manager that mediates sharing data between an app and a web browser.\n- **ASWebAuthenticationSessionWebBrowserSupportCapabilities**: A collection of keys that a browser app uses to declare its ability to handle authentication requests from other apps.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Use a web authentication session to authenticate a user in your app.",
          "name" : "Authenticating a User Through a Web Service",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/authenticating-a-user-through-a-web-service"
        },
        {
          "description" : "A session that an app uses to authenticate a user through a web service.",
          "name" : "ASWebAuthenticationSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASWebAuthenticationSession"
        },
        {
          "description" : "A SwiftUI environment value that views use to authenticate someone using a web service.",
          "name" : "WebAuthenticationSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/WebAuthenticationSession"
        },
        {
          "description" : "Extend your web browser app to handle web authentication requests from other apps.",
          "name" : "Supporting Single Sign-On in a Web Browser App",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/supporting-single-sign-on-in-a-web-browser-app"
        },
        {
          "description" : "A session manager that mediates sharing data between an app and a web browser.",
          "name" : "ASWebAuthenticationSessionWebBrowserSessionManager",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASWebAuthenticationSessionWebBrowserSessionManager"
        },
        {
          "description" : "A collection of keys that a browser app uses to declare its ability to handle authentication requests from other apps.",
          "name" : "ASWebAuthenticationSessionWebBrowserSupportCapabilities",
          "url" : "https:\/\/developer.apple.com\/documentation\/BundleResources\/Information-Property-List\/ASWebAuthenticationSessionWebBrowserSupportCapabilities"
        }
      ],
      "title" : "Web authentication sessions"
    }
  ],
  "source" : "appleJSON",
  "title" : "Securing Logins with iCloud Keychain Verification Codes",
  "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/securing-logins-with-icloud-keychain-verification-codes"
}