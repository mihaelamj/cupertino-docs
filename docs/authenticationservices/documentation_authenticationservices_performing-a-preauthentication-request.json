{
  "abstract" : "Request and process a preauthentication for dynamic WS-Trust authentication.",
  "codeExamples" : [
    {
      "code" : "GET \/oauth2\/discovery?user=foo@example.com HTTP\/1.1\nHost: auth.example.com\nAccept: application\/json\nclient-request-id: DCAB01D3-B1FE-4E1C-802F-B3EBDCDF9E67",
      "language" : "http"
    }
  ],
  "contentHash" : "04ef7ace794cae39f1f0bd1c3a931b812a197ca169d459502dc4149b72c13731",
  "crawledAt" : "2025-12-09T17:22:09Z",
  "id" : "9BCB76FD-F8A0-4AD2-BC96-7CD014F6A03C",
  "kind" : "article",
  "language" : "swift",
  "module" : "Authentication Services",
  "overview" : "## Overview\n\nFederation enables authentication between security domains, such as from a local identity provider (IdP) to a cloud IdP. Platform SSO supports federated authentication with WS-Trust and dynamic WS-Trust. Use dynamic WS-Trust when the federation for a user can change.\n\nThe system sends a preauthentication request when the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationType-swift.property] is [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/FederationType-swift.enum\/dynamicWSTrust]. It uses this request to determine whether the user is federated and to receive the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationMEXURL] for the metadata exchange data (MEX) request. For more information, see [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/performing-a-ws-trust-metadata-exchange-data-mex-request].\n\nIf the user isn’t federated, the login proceeds as a normal password authentication to the IdP.\n\n### Create the preauthentication network request\n\nThe following table specifies the query string parameters that the system uses to create a preauthentication network request:\n\nThe request is an HTTP GET to the login configuration [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationUserPreauthenticationURL], as shown here:\n\n### Receive the preauthentication network response\n\nIf the http status is `200`, the response body loads as JSON. If the body is valid JSON, then the system evaluates the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationPredicate] to determine whether the user is federated.\n\nIf the user is federated, the system uses the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationMEXURLKeypath] to select the URL to use for federation. If the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationMEXURLKeypath] isn’t specified, the system uses the default value `federation_metadata_url`. The system sends the MEX request to this URL to determine the WS-Trust version to use.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/authenticationservices\/performing-a-preauthentication-request\ncrawled: 2025-12-09T17:22:09Z\n---\n\n# Performing a preauthentication request\n\n**Article**\n\nRequest and process a preauthentication for dynamic WS-Trust authentication.\n\n## Overview\n\nFederation enables authentication between security domains, such as from a local identity provider (IdP) to a cloud IdP. Platform SSO supports federated authentication with WS-Trust and dynamic WS-Trust. Use dynamic WS-Trust when the federation for a user can change.\n\nThe system sends a preauthentication request when the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationType-swift.property] is [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/FederationType-swift.enum\/dynamicWSTrust]. It uses this request to determine whether the user is federated and to receive the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationMEXURL] for the metadata exchange data (MEX) request. For more information, see [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/performing-a-ws-trust-metadata-exchange-data-mex-request].\n\nIf the user isn’t federated, the login proceeds as a normal password authentication to the IdP.\n\n### Create the preauthentication network request\n\nThe following table specifies the query string parameters that the system uses to create a preauthentication network request:\n\n\n\nThe request is an HTTP GET to the login configuration [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationUserPreauthenticationURL], as shown here:\n\n```http\nGET \/oauth2\/discovery?user=foo@example.com HTTP\/1.1\nHost: auth.example.com\nAccept: application\/json\nclient-request-id: DCAB01D3-B1FE-4E1C-802F-B3EBDCDF9E67\n```\n\n### Receive the preauthentication network response\n\nIf the http status is `200`, the response body loads as JSON. If the body is valid JSON, then the system evaluates the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationPredicate] to determine whether the user is federated.\n\nIf the user is federated, the system uses the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationMEXURLKeypath] to select the URL to use for federation. If the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/federationMEXURLKeypath] isn’t specified, the system uses the default value `federation_metadata_url`. The system sends the MEX request to this URL to determine the WS-Trust version to use.\n\n## Pre-login\n\n- **Obtaining a server nonce**: Request and process a server nonce to verify communication and detect replays.\n- **Performing a WS-Trust metadata exchange data (MEX) request**: Send and process a WS-Trust MEX request to determine the version and URLs for authentication.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Request and process a server nonce to verify communication and detect replays.",
          "name" : "Obtaining a server nonce",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/obtaining-a-server-nonce"
        },
        {
          "description" : "Send and process a WS-Trust MEX request to determine the version and URLs for authentication.",
          "name" : "Performing a WS-Trust metadata exchange data (MEX) request",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/performing-a-ws-trust-metadata-exchange-data-mex-request"
        }
      ],
      "title" : "Pre-login"
    }
  ],
  "source" : "appleJSON",
  "title" : "Performing a preauthentication request",
  "url" : "https:\/\/developer.apple.com\/documentation\/authenticationservices\/performing-a-preauthentication-request"
}