{
  "abstract" : "Automatically and transparently convert accounts to Sign in with Apple or to use strong passwords for improved security.",
  "codeExamples" : [
    {
      "code" : "class AccountAuthenticationModificationViewController: ASAccountAuthenticationModificationViewController {\n    override func changePasswordWithoutUserInteraction(\n        for serviceIdentifier: ASCredentialServiceIdentifier,\n        existingCredential: ASPasswordCredential,\n        newPassword: String,\n        userInfo: [AnyHashable : Any]?)\n    {\n        \/\/ Verify with your server that the user is authorized to\n        \/\/ update the password.\n\n        \/\/ Once confirmed, send the user data to your server.\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "let newCredential = ASPasswordCredential(\n    user: existingCredential.user,\n    password: newPassword\n)\nself.extensionContext.completeChangePasswordRequest(updatedCredential: newCredential)",
      "language" : "swift"
    },
    {
      "code" : "let error = ASExtensionError(.failed)\nself.extensionContext.cancelRequest(withError: error)",
      "language" : "swift"
    },
    {
      "code" : "let error = ASExtensionError(.failed, userInfo: [\n    ASExtensionLocalizedFailureReasonErrorKey: \"Authentication failed.\"\n])\nself.extensionContext.cancelRequest(withError: error)",
      "language" : "swift"
    },
    {
      "code" : "let myState: String = ...\nlet myNonce: String = ...\n\nself.extensionContext.getSignInWithAppleUpgradeAuthorization(\n    state: myState,\n    nonce: myNonce\n) { appleIDCredential, error in\n    guard let appleIDCredential = appleIDCredential else {\n        self.extensionContext.cancelRequest(\n            withError: ASExtensionError(.failed)\n        )\n        return\n    }\n\n    \/\/ Verify with your server that the user is authorized to\n    \/\/ convert the account to Sign in with Apple.\n\n    let userIdentifier = appleIDCredential.user\n    let fullName = appleIDCredential.fullName\n    let email = appleIDCredential.email\n    \/\/ Once confirmed, send the user data to your server.\n\n    self.extensionContext.completeUpgradeToSignInWithApple()\n}\n",
      "language" : "swift"
    },
    {
      "code" : "let error = ASExtensionError(.userInteractionRequired)\nself.extensionContext.cancelRequest(withError: error)",
      "language" : "swift"
    },
    {
      "code" : "let username = \"jappleseed\"\nlet serviceIdentifier = ASCredentialServiceIdentifier(\n    identifier: \"myservice.example.com\",\n    type: .domain\n)\n\nlet userInfo = [\"com.example.authTokenKey\": authToken]\nlet upgradeRequest = ASAccountAuthenticationModificationUpgradePasswordToStrongPasswordRequest(\n    user: username,\n    serviceIdentifier: serviceIdentifier,\n    userInfo: userInfo\n)\n\nlet requestController = ASAccountAuthenticationModificationController()\nrequestController.delegate = self\nrequestController.presentationContextProvider = self\nrequestController.perform(upgradeRequest)",
      "language" : "swift"
    },
    {
      "code" : "let upgradeRequest = ASAccountAuthenticationModificationReplacePasswordWithSignInWithAppleRequest(\n    user: username,\n    serviceIdentifier: serviceIdentifier,\n    userInfo: userInfo\n)",
      "language" : "swift"
    }
  ],
  "contentHash" : "4ea1059962ad3bff30859d07f7addd3500f2a54604b0f9e7e49bf91f96118d5f",
  "crawledAt" : "2025-12-04T21:48:32Z",
  "id" : "AE83D28F-1F63-4CFE-86FF-B339716F7318",
  "kind" : "article",
  "language" : "swift",
  "module" : "Authentication Services",
  "overview" : "## Overview\n\nWhen accounts have weak, easily guessed passwords, or if an account is breached, the iOS Security Recommendations help users update account passwords. Adding an Account Authentication Modification Extension to your app lets users easily switch to a strong, complex password, or upgrade to Sign in with Apple. The experience for users is simple and painless, often only requiring the tap of a button.\n\nYou configure your extension to support upgrading to strong passwords, upgrading to Sign in with Apple, or both. Users initiate upgrades from the following places:\n\nIf your account security policy requires additional steps, such as two-factor authentication, your extension can include these steps in the upgrade process.\n\n### Configure an Associated Domain\n\nTo upgrade user accounts stored in the iOS password manager, you must first establish an association between your app and the domains that to which your account belongs. To make this association, add an associated domain file to your website that includes a `webcredential` entry, and configure a matching [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.associated-domains]. For more information about how to configure associated domains, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/supporting-associated-domains].\n\n### Add an Account Authentication Modification Extension to Your App\n\nXcode provides a starting point to create your extension. To add the Account Authentication Modification extension to your project:\n\n\n\n### Declare Supported Upgrade Types\n\nYour extension’s `Info.plist` file specifies the types of upgrades your app supports. To support upgrading weak passwords to strong passwords, set the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationSupportsStrongPasswordChange] key to `YES`. To support upgrading accounts from using passwords to using Sign in with Apple, set the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationSupportsUpgradeToSignInWithApple] to `YES`.\n\nWhen the system begins a strong password upgrade, it generates a new strong password. If the system-generated password doesn’t meet your needs, optionally add the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationPasswordGenerationRequirements] key with a string value that describes your requirements. For details about the format of this string, see [doc:\/\/com.apple.documentation\/documentation\/Security\/customizing-password-autofill-rules]. Use the [https:\/\/developer.apple.com\/password-rules\/] to verify the passwords the system generates with your requirements.\n\n### Support Automatic Strong Password Upgrades\n\nWhen the user initiates a strong password upgrade, the system invokes your extension to perform the upgrade. To perform a one-tap automatic upgrade to strong passwords, the system loads your extension and instantiates a subclass of [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController]. The system calls the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/changePasswordWithoutUserInteraction(for:existingCredential:newPassword:userInfo:)] method you implement in the view controller.\n\nThis method receives the following parameters:\n\nTo perform the automatic upgrade, the extension communicates with your server to authorize and perform the upgrade. Use the current password, existing token, or credential information from your app to confirm with your server that the user is authorized to perform the password upgrade. Once the server confirms the user authorization, send the new password to your server to perform the upgrade. If the system-generated password doesn’t satisfy your server’s requirements, you can use a different password than the one the system provides.\n\nAfter completing the password change on your server, call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/completeChangePasswordRequest(updatedCredential:userInfo:)] on the view controller’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/extensionContext], passing the new credential for the service. The system stores the new credential in the Keychain, and removes the old credential.\n\nIf the user isn’t authorized to perform the upgrade, or the update fails, cancel the request as follows:\n\nTo display a custom error message to the user, initialize an `ASExtensionError` with [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASExtensionError\/Code\/failed] and specify an error string, as follows:\n\n### Support Automatic Upgrades to Sign in with Apple\n\nThe steps to implement automatic upgrades to Sign in with Apple are very similar to the ones to upgrade to a strong password. To support upgrading to Sign in with Apple, your app must support Sign in with Apple. For more information, see [https:\/\/developer.apple.com\/sign-in-with-apple\/] and [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/implementing-user-authentication-with-sign-in-with-apple].\n\nWhen the user initiates an upgrade to Sign in with Apple, the system loads your extension, and invokes the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/convertAccountToSignInWithAppleWithoutUserInteraction(for:existingCredential:userInfo:)] method of your view controller.\n\nThis method receives the following parameters:\n\nUse the current password to authorize with your server that the user can perform the upgrade. If not, fail the request as described above.\n\nTo perform the upgrade, request the Sign in with Apple credentials from the extensionContext by calling [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/getSignInWithAppleUpgradeAuthorization(state:nonce:completionHandler:)]. If the system provides a Sign in with Apple credential, send the credential information to your server, and then complete the request by calling [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/completeUpgradeToSignInWithApple(userInfo:)]. Once complete, the system removes the old password from the Keychain.\n\nTo create the Sign in with Apple credential, the system prompts the user and communicates with Apple. If the user cancels the request, the system calls the completion handler with an error that specifies a [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASExtensionError\/Code\/userCanceled] code. In that case, cancel the request using the same error code and no failure reason, and don’t show any additional user interface. If the device can’t communicate with Apple’s servers, the completion handler may be passed [doc:\/\/com.apple.documentation\/documentation\/ObjectiveC\/nil-227m0] credentials. In this case, cancel the request with an error that specifies [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASExtensionError\/Code\/failed] as the error code.\n\n### Perform Upgrades With Additional Security Requirements\n\nIf the user initiates an account authentication upgrade but you require additional security steps, such as using two-factor authentication, fail the initial automatic request with an error that specifies user interaction is required.\n\nThe system initiates a new request that includes presenting the view controller’s view by calling either [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/prepareInterfaceToChangePassword(for:existingCredential:newPassword:userInfo:)] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/prepareInterfaceToConvertAccountToSignInWithApple(for:existingCredential:userInfo:)], depending on the type of the original request. Configure your view controller’s view appropriately for the request and return from the method.\n\nAfter your method returns, the system presents your view controller’s view with a system-provided navigation bar, including a cancel button. Once the system presents the view, guide the user through performing the additional steps. When the user completes the steps, continue the upgrade process. For a strong password upgrade, commit the new strong password, provided in the original request, to your server. For an upgrade to Sign in with Apple, call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/getSignInWithAppleUpgradeAuthorization(state:nonce:completionHandler:)] to request a new Sign in with Apple credential as described earlier.\n\nIf the user fails to complete the additional steps, or the upgrade fails for any other reason, call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/cancelRequest(withError:)] to cancel the request as described in earlier examples. The system dismisses the view controller’s view.\n\nIf the user taps the system-provided cancel button, the system dismisses the interface and calls your view controller’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/cancelRequest()] method. If you need to perform any cleanup work, override this method and call the superclass [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/cancelRequest()] method to complete the process.\n\n### Initiate Security Upgrades From Within Your App\n\nTo initiate upgrades to strong passwords or to use Sign in with Apple from within your app, use the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationController] class.\n\nWhen your app initiates an upgrade request, the work your extension does is the same as the previous sections describe. To configure the request, instantiate either an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationUpgradePasswordToStrongPasswordRequest] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationReplacePasswordWithSignInWithAppleRequest] object, passing the following parameters:\n\nUnlike the system-initiated upgrades, your extension doesn’t receive an existing password in the calls to [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/changePasswordWithoutUserInteraction(for:existingCredential:newPassword:userInfo:)] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/convertAccountToSignInWithAppleWithoutUserInteraction(for:existingCredential:userInfo:)]. If your extension needs existing password or authentication information to perform the authorization with your server, include it in the user info dictionary.\n\nTo perform the request:\n\nThe following example shows how to configure and initiate a request to upgrade to a strong password:\n\nFor upgrading to Sign in with Apple, the process is the same, except you instantiate an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationReplacePasswordWithSignInWithAppleRequest] object instead:\n\nWhen the request completes, the controller calls either [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationControllerDelegate\/accountAuthenticationModificationController(_:didSuccessfullyComplete:userInfo:)] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationControllerDelegate\/accountAuthenticationModificationController(_:didFail:error:)], depending on result of the upgrade. Inform the user of the results accordingly.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/upgrading-account-security-with-an-account-authentication-modification-extension\ncrawled: 2025-12-04T21:48:32Z\n---\n\n# Upgrading Account Security With an Account Authentication Modification Extension\n\n**Article**\n\nAutomatically and transparently convert accounts to Sign in with Apple or to use strong passwords for improved security.\n\n## Overview\n\nWhen accounts have weak, easily guessed passwords, or if an account is breached, the iOS Security Recommendations help users update account passwords. Adding an Account Authentication Modification Extension to your app lets users easily switch to a strong, complex password, or upgrade to Sign in with Apple. The experience for users is simple and painless, often only requiring the tap of a button.\n\nYou configure your extension to support upgrading to strong passwords, upgrading to Sign in with Apple, or both. Users initiate upgrades from the following places:\n\n- In Settings > Passwords, when viewing a security recommendation.\n- In your app, when the user signs in to their account using a weak or breached password.\n- In your app, using a dedicated interface you implement.\n\nIf your account security policy requires additional steps, such as two-factor authentication, your extension can include these steps in the upgrade process.\n\n### Configure an Associated Domain\n\nTo upgrade user accounts stored in the iOS password manager, you must first establish an association between your app and the domains that to which your account belongs. To make this association, add an associated domain file to your website that includes a `webcredential` entry, and configure a matching [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.associated-domains]. For more information about how to configure associated domains, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/supporting-associated-domains].\n\n### Add an Account Authentication Modification Extension to Your App\n\nXcode provides a starting point to create your extension. To add the Account Authentication Modification extension to your project:\n\n1. Open your app project in Xcode and choose File > New > Target.\n2. From the Application Extension group, select Account Authentication, and then click Next.\n3. Enter the name of your extension.\n4. Click Finish.\n\n\n\n### Declare Supported Upgrade Types\n\nYour extension’s `Info.plist` file specifies the types of upgrades your app supports. To support upgrading weak passwords to strong passwords, set the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationSupportsStrongPasswordChange] key to `YES`. To support upgrading accounts from using passwords to using Sign in with Apple, set the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationSupportsUpgradeToSignInWithApple] to `YES`.\n\nWhen the system begins a strong password upgrade, it generates a new strong password. If the system-generated password doesn’t meet your needs, optionally add the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationPasswordGenerationRequirements] key with a string value that describes your requirements. For details about the format of this string, see [doc:\/\/com.apple.documentation\/documentation\/Security\/customizing-password-autofill-rules]. Use the [https:\/\/developer.apple.com\/password-rules\/] to verify the passwords the system generates with your requirements.\n\n### Support Automatic Strong Password Upgrades\n\nWhen the user initiates a strong password upgrade, the system invokes your extension to perform the upgrade. To perform a one-tap automatic upgrade to strong passwords, the system loads your extension and instantiates a subclass of [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController]. The system calls the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/changePasswordWithoutUserInteraction(for:existingCredential:newPassword:userInfo:)] method you implement in the view controller.\n\n```swift\nclass AccountAuthenticationModificationViewController: ASAccountAuthenticationModificationViewController {\n    override func changePasswordWithoutUserInteraction(\n        for serviceIdentifier: ASCredentialServiceIdentifier,\n        existingCredential: ASPasswordCredential,\n        newPassword: String,\n        userInfo: [AnyHashable : Any]?)\n    {\n        \/\/ Verify with your server that the user is authorized to\n        \/\/ update the password.\n\n        \/\/ Once confirmed, send the user data to your server.\n    }\n}\n```\n\nThis method receives the following parameters:\n\n- An [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASCredentialServiceIdentifier] to identify the service to update, for example a website account.\n- The service’s current password.\n- A system-generated strong password, conforming to [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/ASAccountAuthenticationModificationPasswordGenerationRequirements], if specified.\n- A user-info dictionary that contains app-specific information, if your app initiates the request.\n\nTo perform the automatic upgrade, the extension communicates with your server to authorize and perform the upgrade. Use the current password, existing token, or credential information from your app to confirm with your server that the user is authorized to perform the password upgrade. Once the server confirms the user authorization, send the new password to your server to perform the upgrade. If the system-generated password doesn’t satisfy your server’s requirements, you can use a different password than the one the system provides.\n\nAfter completing the password change on your server, call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/completeChangePasswordRequest(updatedCredential:userInfo:)] on the view controller’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/extensionContext], passing the new credential for the service. The system stores the new credential in the Keychain, and removes the old credential.\n\n```swift\nlet newCredential = ASPasswordCredential(\n    user: existingCredential.user,\n    password: newPassword\n)\nself.extensionContext.completeChangePasswordRequest(updatedCredential: newCredential)\n```\n\nIf the user isn’t authorized to perform the upgrade, or the update fails, cancel the request as follows:\n\n```swift\nlet error = ASExtensionError(.failed)\nself.extensionContext.cancelRequest(withError: error)\n```\n\nTo display a custom error message to the user, initialize an `ASExtensionError` with [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASExtensionError\/Code\/failed] and specify an error string, as follows:\n\n```swift\nlet error = ASExtensionError(.failed, userInfo: [\n    ASExtensionLocalizedFailureReasonErrorKey: \"Authentication failed.\"\n])\nself.extensionContext.cancelRequest(withError: error)\n```\n\n### Support Automatic Upgrades to Sign in with Apple\n\nThe steps to implement automatic upgrades to Sign in with Apple are very similar to the ones to upgrade to a strong password. To support upgrading to Sign in with Apple, your app must support Sign in with Apple. For more information, see [https:\/\/developer.apple.com\/sign-in-with-apple\/] and [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/implementing-user-authentication-with-sign-in-with-apple].\n\nWhen the user initiates an upgrade to Sign in with Apple, the system loads your extension, and invokes the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/convertAccountToSignInWithAppleWithoutUserInteraction(for:existingCredential:userInfo:)] method of your view controller.\n\nThis method receives the following parameters:\n\n- An [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASCredentialServiceIdentifier] that identifies the service to update, for example a website account.\n- The service’s current password.\n- A user-info dictionary that contains app-specific information, if your app initiates the request.\n\nUse the current password to authorize with your server that the user can perform the upgrade. If not, fail the request as described above.\n\nTo perform the upgrade, request the Sign in with Apple credentials from the extensionContext by calling [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/getSignInWithAppleUpgradeAuthorization(state:nonce:completionHandler:)]. If the system provides a Sign in with Apple credential, send the credential information to your server, and then complete the request by calling [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/completeUpgradeToSignInWithApple(userInfo:)]. Once complete, the system removes the old password from the Keychain.\n\n```swift\nlet myState: String = ...\nlet myNonce: String = ...\n\nself.extensionContext.getSignInWithAppleUpgradeAuthorization(\n    state: myState,\n    nonce: myNonce\n) { appleIDCredential, error in\n    guard let appleIDCredential = appleIDCredential else {\n        self.extensionContext.cancelRequest(\n            withError: ASExtensionError(.failed)\n        )\n        return\n    }\n\n    \/\/ Verify with your server that the user is authorized to\n    \/\/ convert the account to Sign in with Apple.\n\n    let userIdentifier = appleIDCredential.user\n    let fullName = appleIDCredential.fullName\n    let email = appleIDCredential.email\n    \/\/ Once confirmed, send the user data to your server.\n\n    self.extensionContext.completeUpgradeToSignInWithApple()\n}\n\n```\n\nTo create the Sign in with Apple credential, the system prompts the user and communicates with Apple. If the user cancels the request, the system calls the completion handler with an error that specifies a [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASExtensionError\/Code\/userCanceled] code. In that case, cancel the request using the same error code and no failure reason, and don’t show any additional user interface. If the device can’t communicate with Apple’s servers, the completion handler may be passed [doc:\/\/com.apple.documentation\/documentation\/ObjectiveC\/nil-227m0] credentials. In this case, cancel the request with an error that specifies [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASExtensionError\/Code\/failed] as the error code.\n\n### Perform Upgrades With Additional Security Requirements\n\nIf the user initiates an account authentication upgrade but you require additional security steps, such as using two-factor authentication, fail the initial automatic request with an error that specifies user interaction is required.\n\n```swift\nlet error = ASExtensionError(.userInteractionRequired)\nself.extensionContext.cancelRequest(withError: error)\n```\n\nThe system initiates a new request that includes presenting the view controller’s view by calling either [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/prepareInterfaceToChangePassword(for:existingCredential:newPassword:userInfo:)] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/prepareInterfaceToConvertAccountToSignInWithApple(for:existingCredential:userInfo:)], depending on the type of the original request. Configure your view controller’s view appropriately for the request and return from the method.\n\nAfter your method returns, the system presents your view controller’s view with a system-provided navigation bar, including a cancel button. Once the system presents the view, guide the user through performing the additional steps. When the user completes the steps, continue the upgrade process. For a strong password upgrade, commit the new strong password, provided in the original request, to your server. For an upgrade to Sign in with Apple, call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/getSignInWithAppleUpgradeAuthorization(state:nonce:completionHandler:)] to request a new Sign in with Apple credential as described earlier.\n\nIf the user fails to complete the additional steps, or the upgrade fails for any other reason, call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext\/cancelRequest(withError:)] to cancel the request as described in earlier examples. The system dismisses the view controller’s view.\n\nIf the user taps the system-provided cancel button, the system dismisses the interface and calls your view controller’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/cancelRequest()] method. If you need to perform any cleanup work, override this method and call the superclass [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/cancelRequest()] method to complete the process.\n\n### Initiate Security Upgrades From Within Your App\n\nTo initiate upgrades to strong passwords or to use Sign in with Apple from within your app, use the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationController] class.\n\nWhen your app initiates an upgrade request, the work your extension does is the same as the previous sections describe. To configure the request, instantiate either an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationUpgradePasswordToStrongPasswordRequest] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationReplacePasswordWithSignInWithAppleRequest] object, passing the following parameters:\n\n- The user name for the user’s account.\n- An [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASCredentialServiceIdentifier] to identify the service to update, for example a website account.\n- A user info dictionary that contains any authentication information the extension needs.\n\nUnlike the system-initiated upgrades, your extension doesn’t receive an existing password in the calls to [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/changePasswordWithoutUserInteraction(for:existingCredential:newPassword:userInfo:)] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController\/convertAccountToSignInWithAppleWithoutUserInteraction(for:existingCredential:userInfo:)]. If your extension needs existing password or authentication information to perform the authorization with your server, include it in the user info dictionary.\n\nTo perform the request:\n\n1. Instantiate an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationController] object.\n2. Set the controller’s delegate property to an object that conforms to the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationControllerDelegate] protocol.\n3. Set the controller’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationController\/presentationContextProvider] property to an object that conforms to the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationControllerPresentationContextProviding] protocol.\n4. Call [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationController\/perform(_:)] on the controller to initiate the request.\n\nThe following example shows how to configure and initiate a request to upgrade to a strong password:\n\n```swift\nlet username = \"jappleseed\"\nlet serviceIdentifier = ASCredentialServiceIdentifier(\n    identifier: \"myservice.example.com\",\n    type: .domain\n)\n\nlet userInfo = [\"com.example.authTokenKey\": authToken]\nlet upgradeRequest = ASAccountAuthenticationModificationUpgradePasswordToStrongPasswordRequest(\n    user: username,\n    serviceIdentifier: serviceIdentifier,\n    userInfo: userInfo\n)\n\nlet requestController = ASAccountAuthenticationModificationController()\nrequestController.delegate = self\nrequestController.presentationContextProvider = self\nrequestController.perform(upgradeRequest)\n```\n\nFor upgrading to Sign in with Apple, the process is the same, except you instantiate an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationReplacePasswordWithSignInWithAppleRequest] object instead:\n\n```swift\nlet upgradeRequest = ASAccountAuthenticationModificationReplacePasswordWithSignInWithAppleRequest(\n    user: username,\n    serviceIdentifier: serviceIdentifier,\n    userInfo: userInfo\n)\n```\n\nWhen the request completes, the controller calls either [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationControllerDelegate\/accountAuthenticationModificationController(_:didSuccessfullyComplete:userInfo:)] or [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationControllerDelegate\/accountAuthenticationModificationController(_:didFail:error:)], depending on result of the upgrade. Inform the user of the results accordingly.\n\n## Automatic security upgrades\n\n- **ASAccountAuthenticationModificationController**: An object that performs a request to modify an account’s authentication properties.\n- **ASAccountAuthenticationModificationViewController**: A view controller that can upgrade user passwords to strong passwords, or convert accounts to use Sign in with Apple.\n- **ASAccountAuthenticationModificationExtensionContext**: An object that you interact with to change an account’s password or to upgrade to Sign in with Apple.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that performs a request to modify an account’s authentication properties.",
          "name" : "ASAccountAuthenticationModificationController",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationController"
        },
        {
          "description" : "A view controller that can upgrade user passwords to strong passwords, or convert accounts to use Sign in with Apple.",
          "name" : "ASAccountAuthenticationModificationViewController",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationViewController"
        },
        {
          "description" : "An object that you interact with to change an account’s password or to upgrade to Sign in with Apple.",
          "name" : "ASAccountAuthenticationModificationExtensionContext",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASAccountAuthenticationModificationExtensionContext"
        }
      ],
      "title" : "Automatic security upgrades"
    }
  ],
  "source" : "appleJSON",
  "title" : "Upgrading Account Security With an Account Authentication Modification Extension",
  "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/upgrading-account-security-with-an-account-authentication-modification-extension"
}