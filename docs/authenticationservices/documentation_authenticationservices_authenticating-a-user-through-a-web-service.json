{
  "abstract" : "Use a web authentication session to authenticate a user in your app.",
  "codeExamples" : [
    {
      "code" : "\/\/ Use the URL and callback scheme specified by the authorization provider.\nguard let authURL = URL(string: \"https:\/\/example.com\/auth\") else { return }\nlet scheme = \"exampleauth\"\n\n\/\/ Initialize the session.\nlet session = ASWebAuthenticationSession(url: authURL, callbackURLScheme: scheme)\n{ callbackURL, error in\n    \/\/ Handle the callback.\n}",
      "language" : "swift"
    },
    {
      "code" : "extension ViewController: ASWebAuthenticationPresentationContextProviding {\n    func presentationAnchor(for session: ASWebAuthenticationSession) -> ASPresentationAnchor {\n        return view.window!\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "session.presentationContextProvider = viewController",
      "language" : "swift"
    },
    {
      "code" : "session.prefersEphemeralWebBrowserSession = true",
      "language" : "swift"
    },
    {
      "code" : "session.start()",
      "language" : "swift"
    },
    {
      "code" : "session.cancel()",
      "language" : "swift"
    },
    {
      "code" : "guard error == nil, let callbackURL = callbackURL else { return }\n\n\/\/ The callback URL format depends on the provider. For this example:\n\/\/   exampleauth:\/\/auth?token=1234\nlet queryItems = URLComponents(string: callbackURL.absoluteString)?.queryItems\nlet token = queryItems?.filter({ $0.name == \"token\" }).first?.value",
      "language" : "swift"
    }
  ],
  "contentHash" : "7f22a9f30ee34514e3c0a1a8081a2e70fa60100a2631dd659bed648e12aaaf7c",
  "crawledAt" : "2025-12-04T21:48:17Z",
  "id" : "91217D81-D18E-466A-A8A0-E9EA89F61002",
  "kind" : "article",
  "language" : "swift",
  "module" : "Authentication Services",
  "overview" : "## Overview\n\nSome websites provide, as a service, a secure mechanism for authenticating users. When the user navigates to the site’s authentication URL, the site presents the user with a form to collect credentials. After validating the credentials, the site redirects the user’s browser, typically using a custom scheme, to a URL that indicates the outcome of the authentication attempt.\n\n### Create a Web Authentication Session\n\nYou can make use of a web authentication service in your app by initializing an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession] instance with a URL that points to the authentication webpage. The page can be one that you maintain, or one operated by a third party. During initialization, indicate the callback scheme that the page uses to return the authentication outcome:\n\nUse the initializer’s trailing closure to tell the session how to handle the callback after authentication completes, as described below in [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/authenticating-a-user-through-a-web-service#Handle-the-Callback].\n\nIn macOS, or if you have a deployment target of iOS 13 or later, the session keeps a strong reference to itself until the authentication process completes to prevent the system from deallocating the closure. For earlier iOS deployment targets, your app needs to keep a strong reference to the session until authentication completes.\n\n### Provide a Presentation Context\n\nYour app indicates the window that should act as a presentation anchor for the session by adopting the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationPresentationContextProviding] protocol. From the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationPresentationContextProviding\/presentationAnchor(for:)] method, which is the protocol’s one required method, return the window that should act as the anchor:\n\nAfter creating the session, set an appropriate context provider instance as the session’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/presentationContextProvider] delegate:\n\n### Optionally Request Ephemeral Browsing\n\nYou can configure the session to request ephemeral browsing by setting the session’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/prefersEphemeralWebBrowserSession] property to `true`:\n\nThis setting asks the browser to avoid using any existing browsing data, like cookies, during the authentication process. It also asks that the browser avoid retaining any data collected during the authentication attempt beyond the lifetime of the attempt, or sharing it with any other session. An ephemeral session may improve security but prevents reusing the result of a previously successful authentication, potentially forcing the user to reenter credentials. As a result, it’s typically best to let the user choose whether to request ephemeral browsing.\n\nSafari always respects the request. In macOS, the user can choose a different default browser that might or might not respect the request.\n\n### Start the Authentication Flow\n\nAfter configuring the session, call its [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/start()] method:\n\nIn iOS, the session loads the authentication web page that you indicated during initialization in an embedded browser view. In macOS, the session sends the page load request to the user’s default browser if it handles authentication sessions, or to Safari otherwise. In any case, the browser presents the user with the authentication page, which is typically a form for entering a username and password.\n\nYou can cancel the authentication attempt from your app before the user finishes by calling the session’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/cancel()] method:\n\nWhen you cancel, the session automatically dismisses the corresponding browser view.\n\n### Handle the Callback\n\nAfter the user authenticates, the authentication provider redirects the browser to a URL that uses the callback scheme. The browser detects the redirect, dismisses itself, and passes the complete URL to your app by calling the closure you specified during initialization.\n\nWhen you receive this callback, first check for errors. For example, you receive the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSessionError\/canceledLogin] error if the user aborts the flow by dismissing the browser window. If the error is `nil`, inspect the callback URL to determine the outcome of the authentication:\n\nThe above example looks for a token stored as a query parameter. The specific parsing that you have to do depends on how the authentication provider structures the callback URL.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/authenticating-a-user-through-a-web-service\ncrawled: 2025-12-04T21:48:17Z\n---\n\n# Authenticating a User Through a Web Service\n\n**Article**\n\nUse a web authentication session to authenticate a user in your app.\n\n## Overview\n\nSome websites provide, as a service, a secure mechanism for authenticating users. When the user navigates to the site’s authentication URL, the site presents the user with a form to collect credentials. After validating the credentials, the site redirects the user’s browser, typically using a custom scheme, to a URL that indicates the outcome of the authentication attempt.\n\n### Create a Web Authentication Session\n\nYou can make use of a web authentication service in your app by initializing an [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession] instance with a URL that points to the authentication webpage. The page can be one that you maintain, or one operated by a third party. During initialization, indicate the callback scheme that the page uses to return the authentication outcome:\n\n```swift\n\/\/ Use the URL and callback scheme specified by the authorization provider.\nguard let authURL = URL(string: \"https:\/\/example.com\/auth\") else { return }\nlet scheme = \"exampleauth\"\n\n\/\/ Initialize the session.\nlet session = ASWebAuthenticationSession(url: authURL, callbackURLScheme: scheme)\n{ callbackURL, error in\n    \/\/ Handle the callback.\n}\n```\n\nUse the initializer’s trailing closure to tell the session how to handle the callback after authentication completes, as described below in [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/authenticating-a-user-through-a-web-service#Handle-the-Callback].\n\nIn macOS, or if you have a deployment target of iOS 13 or later, the session keeps a strong reference to itself until the authentication process completes to prevent the system from deallocating the closure. For earlier iOS deployment targets, your app needs to keep a strong reference to the session until authentication completes.\n\n### Provide a Presentation Context\n\nYour app indicates the window that should act as a presentation anchor for the session by adopting the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationPresentationContextProviding] protocol. From the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationPresentationContextProviding\/presentationAnchor(for:)] method, which is the protocol’s one required method, return the window that should act as the anchor:\n\n```swift\nextension ViewController: ASWebAuthenticationPresentationContextProviding {\n    func presentationAnchor(for session: ASWebAuthenticationSession) -> ASPresentationAnchor {\n        return view.window!\n    }\n}\n```\n\nAfter creating the session, set an appropriate context provider instance as the session’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/presentationContextProvider] delegate:\n\n```swift\nsession.presentationContextProvider = viewController\n```\n\n### Optionally Request Ephemeral Browsing\n\nYou can configure the session to request ephemeral browsing by setting the session’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/prefersEphemeralWebBrowserSession] property to `true`:\n\n```swift\nsession.prefersEphemeralWebBrowserSession = true\n```\n\nThis setting asks the browser to avoid using any existing browsing data, like cookies, during the authentication process. It also asks that the browser avoid retaining any data collected during the authentication attempt beyond the lifetime of the attempt, or sharing it with any other session. An ephemeral session may improve security but prevents reusing the result of a previously successful authentication, potentially forcing the user to reenter credentials. As a result, it’s typically best to let the user choose whether to request ephemeral browsing.\n\nSafari always respects the request. In macOS, the user can choose a different default browser that might or might not respect the request.\n\n\n\n### Start the Authentication Flow\n\nAfter configuring the session, call its [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/start()] method:\n\n```swift\nsession.start()\n```\n\nIn iOS, the session loads the authentication web page that you indicated during initialization in an embedded browser view. In macOS, the session sends the page load request to the user’s default browser if it handles authentication sessions, or to Safari otherwise. In any case, the browser presents the user with the authentication page, which is typically a form for entering a username and password.\n\nYou can cancel the authentication attempt from your app before the user finishes by calling the session’s [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSession\/cancel()] method:\n\n```swift\nsession.cancel()\n```\n\nWhen you cancel, the session automatically dismisses the corresponding browser view.\n\n### Handle the Callback\n\nAfter the user authenticates, the authentication provider redirects the browser to a URL that uses the callback scheme. The browser detects the redirect, dismisses itself, and passes the complete URL to your app by calling the closure you specified during initialization.\n\nWhen you receive this callback, first check for errors. For example, you receive the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASWebAuthenticationSessionError\/canceledLogin] error if the user aborts the flow by dismissing the browser window. If the error is `nil`, inspect the callback URL to determine the outcome of the authentication:\n\n```swift\nguard error == nil, let callbackURL = callbackURL else { return }\n\n\/\/ The callback URL format depends on the provider. For this example:\n\/\/   exampleauth:\/\/auth?token=1234\nlet queryItems = URLComponents(string: callbackURL.absoluteString)?.queryItems\nlet token = queryItems?.filter({ $0.name == \"token\" }).first?.value\n```\n\nThe above example looks for a token stored as a query parameter. The specific parsing that you have to do depends on how the authentication provider structures the callback URL.\n\n## Web authentication sessions\n\n- **Securing Logins with iCloud Keychain Verification Codes**: Use time-based codes generated on-device for a secure authentication experience.\n- **ASWebAuthenticationSession**: A session that an app uses to authenticate a user through a web service.\n- **WebAuthenticationSession**: A SwiftUI environment value that views use to authenticate someone using a web service.\n- **Supporting Single Sign-On in a Web Browser App**: Extend your web browser app to handle web authentication requests from other apps.\n- **ASWebAuthenticationSessionWebBrowserSessionManager**: A session manager that mediates sharing data between an app and a web browser.\n- **ASWebAuthenticationSessionWebBrowserSupportCapabilities**: A collection of keys that a browser app uses to declare its ability to handle authentication requests from other apps.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Use time-based codes generated on-device for a secure authentication experience.",
          "name" : "Securing Logins with iCloud Keychain Verification Codes",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/securing-logins-with-icloud-keychain-verification-codes"
        },
        {
          "description" : "A session that an app uses to authenticate a user through a web service.",
          "name" : "ASWebAuthenticationSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASWebAuthenticationSession"
        },
        {
          "description" : "A SwiftUI environment value that views use to authenticate someone using a web service.",
          "name" : "WebAuthenticationSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/WebAuthenticationSession"
        },
        {
          "description" : "Extend your web browser app to handle web authentication requests from other apps.",
          "name" : "Supporting Single Sign-On in a Web Browser App",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/supporting-single-sign-on-in-a-web-browser-app"
        },
        {
          "description" : "A session manager that mediates sharing data between an app and a web browser.",
          "name" : "ASWebAuthenticationSessionWebBrowserSessionManager",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/ASWebAuthenticationSessionWebBrowserSessionManager"
        },
        {
          "description" : "A collection of keys that a browser app uses to declare its ability to handle authentication requests from other apps.",
          "name" : "ASWebAuthenticationSessionWebBrowserSupportCapabilities",
          "url" : "https:\/\/developer.apple.com\/documentation\/BundleResources\/Information-Property-List\/ASWebAuthenticationSessionWebBrowserSupportCapabilities"
        }
      ],
      "title" : "Web authentication sessions"
    }
  ],
  "source" : "appleJSON",
  "title" : "Authenticating a User Through a Web Service",
  "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/authenticating-a-user-through-a-web-service"
}