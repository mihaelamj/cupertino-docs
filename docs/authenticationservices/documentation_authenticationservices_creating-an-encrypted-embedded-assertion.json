{
  "abstract" : "Request an encrypted embedded assertion for login types that require password encryption.",
  "codeExamples" : [
    {
      "code" : "{\n  \"enc\" : \"A256GCM\",\n  \"apv\" : \"AAAADUFQUExFRU1CRURERUQAAABBBCX87eqonWyNUNz2JeH2wG68_WiPfQlJw6AiDvHSD08n5Hdn1oDUBxhL_TRarvhUUGDYsnBRk2HRH_ZoXGtpUncAAABuQXdBQkFBQUFBQUFEQU96X0JBRHZfeHRndV9TTTFNdm9xMDJQWXpfWWZYeHg1RkFnY0xITE5pa0g2Z2pyQld3Y3FuUldfaGF4cU85SkNpUGF0NUtma1RpbHkwNFM4RUgzQVF3VnNXQ3hIWVFnQUE\",\n  \"alg\" : \"ECDH-ES\",\n  \"epk\" : {\n    \"y\" : \"1wfUpcnhOq7SPl77UBfkanXdQObiBXDIDLx0n1_zlJI\",\n    \"x\" : \"NUnMKzz81Fl0SilEVYgWWjL_4lTAaXHeJ4uJGQ19AAk\",\n    \"kty\" : \"EC\",\n    \"crv\" : \"P-256\"\n  },\n  \"kid\" : \"7y1xXc4I6iAyldmVkIeGtQxo8NRq2FgKFb++Or13jxU=\",\n  \"apu\" : \"AAAABUFQUExFAAAAQQQ1ScwrPPzUWXRKKURViBZaMv_iVMBpcd4ni4kZDX0ACdcH1KXJ4Tqu0j5e-1AX5Gp13UDm4gVwyAy8dJ9f85SS\",\n  \"typ\" : \"platformsso-encrypted-login-assertion+jwt\"\n}.{\n  \"iat\" : 1685732130,\n  \"password\" : \"bar\",\n  \"iss\" : \"foo\",\n  \"request_nonce\" : \"AwABAAAAAAADAOz_BADv_xtgu_SM1Mvoq02PYz_YfXxx5FAgcLHLNikH6gjrBWwcqnRW_haxqO9JCiPat5KfkTily04S8EH3AQwVsWCxHYQgAA\",\n  \"sub\" : \"foo\",\n  \"scope\" : \"openid offline_access urn:apple:platformsso\",\n  \"exp\" : 1685732430,\n  \"aud\" : \"060798FF-814E-4C38-97F8-28C954B7E058\",\n  \"nonce\" : \"D1DEE607-0F44-43F5-8B3E-042E91F425A7\"\n}.[Signature]\n",
      "language" : "javascript"
    }
  ],
  "contentHash" : "69de19df68ad57c0a25368b16d52a3ef4e138d4eec76758aa0bbdcccc01d4061",
  "crawledAt" : "2025-12-09T17:22:08Z",
  "id" : "CED7F2EF-14DC-4EC1-B9FD-0C16F8772CE7",
  "kind" : "article",
  "language" : "swift",
  "module" : "Authentication Services",
  "overview" : "## Overview\n\nDuring authentication, if the SSO extension requests password encryption by setting the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/loginRequestEncryptionPublicKey] in the login configuration, the system doesn’t send the password in the login request. Instead, it creates an encrypted embedded assertion instead, that contains the password. The assertion is a JSON Web Encryption (JWE) object that’s encrypted according to RFC 7516 Section 5.1 with JWE Compact Serialization. The supported key agreement algorithm is `ECDH-ES` per RFC 7518 Section 4.6. This algorithm is `ECIES`, a proven-secure algorithm with the public keys included. See the Configure concatenation key derivation function (Concat KDF) section below for input values. Key agreement uses the public key for the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/loginRequestEncryptionPublicKey] that’s supplied during registration. The supported encryption algorithm is `A256GCM` per RFC 7518 Section 5.3.\n\nThe following table specifies the header parameters that the system uses to create an encrypted embedded assertion:\n\nThe following table specifies the body parameters that the system uses to create an encrypted embedded assertion:\n\n### Configure concatenation key derivation function (Concat KDF)\n\nConfiguration of Concat KDF for platform SSO is per RFC 7518 Section 4.6.2 and NIST.800-56A sections 5.8.1 and 6.2.2.2. See the input definitions in the table below. The system concatenates these values per NIST.800-56A sections 5.8.1 and then it computes a SHA-256 hash to create the key. Then, it sends the `PartyUInfo` and `PartyVInfo` values to the server in the header.\n\nThe following code sample provides an example of an encrypted embedded assertion request:\n\nFor more information, see [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/authentication-process].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/authenticationservices\/creating-an-encrypted-embedded-assertion\ncrawled: 2025-12-09T17:22:08Z\n---\n\n# Creating an encrypted embedded assertion\n\n**Article**\n\nRequest an encrypted embedded assertion for login types that require password encryption.\n\n## Overview\n\nDuring authentication, if the SSO extension requests password encryption by setting the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/loginRequestEncryptionPublicKey] in the login configuration, the system doesn’t send the password in the login request. Instead, it creates an encrypted embedded assertion instead, that contains the password. The assertion is a JSON Web Encryption (JWE) object that’s encrypted according to RFC 7516 Section 5.1 with JWE Compact Serialization. The supported key agreement algorithm is `ECDH-ES` per RFC 7518 Section 4.6. This algorithm is `ECIES`, a proven-secure algorithm with the public keys included. See the Configure concatenation key derivation function (Concat KDF) section below for input values. Key agreement uses the public key for the [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/ASAuthorizationProviderExtensionLoginConfiguration\/loginRequestEncryptionPublicKey] that’s supplied during registration. The supported encryption algorithm is `A256GCM` per RFC 7518 Section 5.3.\n\nThe following table specifies the header parameters that the system uses to create an encrypted embedded assertion:\n\n\n\nThe following table specifies the body parameters that the system uses to create an encrypted embedded assertion:\n\n\n\n### Configure concatenation key derivation function (Concat KDF)\n\nConfiguration of Concat KDF for platform SSO is per RFC 7518 Section 4.6.2 and NIST.800-56A sections 5.8.1 and 6.2.2.2. See the input definitions in the table below. The system concatenates these values per NIST.800-56A sections 5.8.1 and then it computes a SHA-256 hash to create the key. Then, it sends the `PartyUInfo` and `PartyVInfo` values to the server in the header.\n\n\n\nThe following code sample provides an example of an encrypted embedded assertion request:\n\n```javascript\n{\n  \"enc\" : \"A256GCM\",\n  \"apv\" : \"AAAADUFQUExFRU1CRURERUQAAABBBCX87eqonWyNUNz2JeH2wG68_WiPfQlJw6AiDvHSD08n5Hdn1oDUBxhL_TRarvhUUGDYsnBRk2HRH_ZoXGtpUncAAABuQXdBQkFBQUFBQUFEQU96X0JBRHZfeHRndV9TTTFNdm9xMDJQWXpfWWZYeHg1RkFnY0xITE5pa0g2Z2pyQld3Y3FuUldfaGF4cU85SkNpUGF0NUtma1RpbHkwNFM4RUgzQVF3VnNXQ3hIWVFnQUE\",\n  \"alg\" : \"ECDH-ES\",\n  \"epk\" : {\n    \"y\" : \"1wfUpcnhOq7SPl77UBfkanXdQObiBXDIDLx0n1_zlJI\",\n    \"x\" : \"NUnMKzz81Fl0SilEVYgWWjL_4lTAaXHeJ4uJGQ19AAk\",\n    \"kty\" : \"EC\",\n    \"crv\" : \"P-256\"\n  },\n  \"kid\" : \"7y1xXc4I6iAyldmVkIeGtQxo8NRq2FgKFb++Or13jxU=\",\n  \"apu\" : \"AAAABUFQUExFAAAAQQQ1ScwrPPzUWXRKKURViBZaMv_iVMBpcd4ni4kZDX0ACdcH1KXJ4Tqu0j5e-1AX5Gp13UDm4gVwyAy8dJ9f85SS\",\n  \"typ\" : \"platformsso-encrypted-login-assertion+jwt\"\n}.{\n  \"iat\" : 1685732130,\n  \"password\" : \"bar\",\n  \"iss\" : \"foo\",\n  \"request_nonce\" : \"AwABAAAAAAADAOz_BADv_xtgu_SM1Mvoq02PYz_YfXxx5FAgcLHLNikH6gjrBWwcqnRW_haxqO9JCiPat5KfkTily04S8EH3AQwVsWCxHYQgAA\",\n  \"sub\" : \"foo\",\n  \"scope\" : \"openid offline_access urn:apple:platformsso\",\n  \"exp\" : 1685732430,\n  \"aud\" : \"060798FF-814E-4C38-97F8-28C954B7E058\",\n  \"nonce\" : \"D1DEE607-0F44-43F5-8B3E-042E91F425A7\"\n}.[Signature]\n\n```\n\nFor more information, see [doc:\/\/com.apple.authenticationservices\/documentation\/AuthenticationServices\/authentication-process].\n\n## Login request\n\n- **Performing a WS-Trust login request**: Create a WS-Trust login request using the metadata exchange data (MEX) response.\n- **Creating an embedded assertion**: Request an embedded assertion for login types that require a digital signature for authentication.\n- **Creating and validating a login request**: Create a signed JOSE login request.\n- **Creating a refresh request**: Refresh a non-expired token instead of sending a new login request.\n- **Supporting key requests and key exchange requests**: Support the platform SSO 2.0 protocol for encryption and decryption operations.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Create a WS-Trust login request using the metadata exchange data (MEX) response.",
          "name" : "Performing a WS-Trust login request",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/performing-a-ws-trust-login-request"
        },
        {
          "description" : "Request an embedded assertion for login types that require a digital signature for authentication.",
          "name" : "Creating an embedded assertion",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/creating-an-embedded-assertion"
        },
        {
          "description" : "Create a signed JOSE login request.",
          "name" : "Creating and validating a login request",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/creating-and-validating-a-login-request"
        },
        {
          "description" : "Refresh a non-expired token instead of sending a new login request.",
          "name" : "Creating a refresh request",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/creating-a-refresh-request"
        },
        {
          "description" : "Support the platform SSO 2.0 protocol for encryption and decryption operations.",
          "name" : "Supporting key requests and key exchange requests",
          "url" : "https:\/\/developer.apple.com\/documentation\/AuthenticationServices\/supporting-key-requests-and-key-exchange-requests"
        }
      ],
      "title" : "Login request"
    }
  ],
  "source" : "appleJSON",
  "title" : "Creating an encrypted embedded assertion",
  "url" : "https:\/\/developer.apple.com\/documentation\/authenticationservices\/creating-an-encrypted-embedded-assertion"
}