{
  "abstract" : "Create a schema to store your app’s objects as records in iCloud using CloudKit.",
  "codeExamples" : [
    {
      "code" : "let record = CKRecord(recordType: \"ToDoItem\")",
      "language" : "swift"
    },
    {
      "code" : "record.setValuesForKeys([\n    \"title\": \"Get apples\",\n    \"dueDate\": DateComponents(\n        calendar: Calendar.current,\n        year: 2019,\n        month: 10,\n        day: 28).date!,\n    \"isCompleted\": false \/\/ Stored as Int(64)\n])",
      "language" : "swift"
    },
    {
      "code" : "let container = CKContainer.default()\nlet database = container.privateCloudDatabase",
      "language" : "swift"
    },
    {
      "code" : "database.save(record) { record, error in\n    if let error = error {\n        \/\/ Handle error.\n        return\n    }\n    \/\/ Record saved successfully.\n}",
      "language" : "swift"
    },
    {
      "code" : "CKContainer.default().accountStatus { accountStatus, error in\n    if accountStatus == .noAccount {\n        DispatchQueue.main.async {\n            let message = \n                \"\"\"\n                Sign in to your iCloud account to write records.\n                On the Home screen, launch Settings, tap Sign in to your\n                iPhone\/iPad, and enter your Apple ID. Turn iCloud Drive on.\n                \"\"\"\n            let alert = UIAlertController(\n                title: \"Sign in to iCloud\",\n                message: message,\n                preferredStyle: .alert)\n            alert.addAction(UIAlertAction(title: \"OK\", style: .cancel))\n            self.present(alert, animated: true)\n        }\n    }\n    else {\n        \/\/ Save your record here.\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "db5105a466dcf61591b1c6b0dcb9773cfc621aeb11b1698d47e152bcd6134921",
  "crawledAt" : "2025-12-03T10:02:01Z",
  "id" : "7DB5596B-360E-4164-AEFF-2FE90172300F",
  "kind" : "article",
  "language" : "swift",
  "module" : "CloudKit",
  "overview" : "## Overview\n\nAfter you enable CloudKit in your app, you create a *schema* for your container that describes how to store your objects. A schema defines *record types* and the possible relationships between them. A record type is a template for the allowed keys and values of a record. This relationship is analogous to how a class (record type) defines the properties an instance (record) can have.\n\n### Design your objects as records\n\nCloudKit allows you to store your data as [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] objects, and relationships between those objects as [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord\/Reference] associations. Separate your data into record types by grouping objects of the same type together. If you’ve already separated your model data into classes, these classes might have the same record type in iCloud. Choose which objects and which of their properties and relationships you want to persist to iCloud.\n\nEach object property that you persist maps to a key-value pair, known as a *field*, within a [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord]. [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] supports value types for your fields, such as [doc:\/\/com.apple.documentation\/documentation\/Swift\/String], or more complex types, such as [doc:\/\/com.apple.documentation\/documentation\/Foundation\/Data].\n\nFor example, a “to-do item” might have the following record type:\n\nFor information on additional supported value types, see [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord].\n\n### Create records programmatically\n\nCreate a [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] object with a string representing the type of record you want to store, using [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord\/initWithRecordType:]. Every record type must have a unique string name.\n\nThen set the record’s fields. Because [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] is key-value coding compliant, you can use [doc:\/\/com.apple.documentation\/documentation\/ObjectiveC\/NSObject-swift.class\/setValuesForKeys(_:)]. The values you set could be from a details sheet that the user fills out.\n\n### Save initial records to iCloud\n\nYou can create a schema using CloudKit Dashboard, or you can create a *just-in-time schema* by writing records programmatically.\n\nTo save a record to your container, you must pick a database to save the record to. Each container has a single *public* database accessible to all app users, and *private* databases for each user of your app. Also, a user may have a *shared* database if that user is accessing another user’s shared private data. Note that every database within your app’s container shares the same schema.\n\nAlthough an app can have multiple containers or can share a container, each app has one default container. You access the default container using [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKContainer\/default()] on [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKContainer]. The following example uses the current user’s private database within the app’s default container and exists in an action handler for a Save button.\n\nSave the record to the user’s private database in the app’s container.\n\nWhen you run your app, it adds that record type to the schema and saves the record. If the record type already exists in the schema, iCloud uses the existing type. Saving a record works only if the user has signed into their iCloud account on their device.\n\nIf saving the record to iCloud succeeds, `error` is `nil`. (If `error` is non-`nil`, see [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKError] for possible values of `error.)`\n\n### Handle or prevent errors gracefully\n\nWhen designing your app, consider how to handle or prevent error conditions. For example, an error occurs if your app attempts to save a record to a user’s private database and the user hasn’t yet signed in to iCloud. You might handle this scenario by checking whether the user has signed in before the app saves the record. If the user hasn’t signed in, present an alert. If they’re signed in, save the record.\n\nThe following example demonstrates preventing the error condition in this manner.\n\n### Run your app\n\nIn Xcode, run your app to execute the code that saves records and creates the schema in the database. To verify success, see [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/inspecting-and-editing-an-icloud-container-s-schema].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/cloudkit\/designing-and-creating-a-cloudkit-database\ncrawled: 2025-12-03T10:02:01Z\n---\n\n# Designing and Creating a CloudKit Database\n\n**Article**\n\nCreate a schema to store your app’s objects as records in iCloud using CloudKit.\n\n## Overview\n\nAfter you enable CloudKit in your app, you create a *schema* for your container that describes how to store your objects. A schema defines *record types* and the possible relationships between them. A record type is a template for the allowed keys and values of a record. This relationship is analogous to how a class (record type) defines the properties an instance (record) can have.\n\n### Design your objects as records\n\nCloudKit allows you to store your data as [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] objects, and relationships between those objects as [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord\/Reference] associations. Separate your data into record types by grouping objects of the same type together. If you’ve already separated your model data into classes, these classes might have the same record type in iCloud. Choose which objects and which of their properties and relationships you want to persist to iCloud.\n\nEach object property that you persist maps to a key-value pair, known as a *field*, within a [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord]. [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] supports value types for your fields, such as [doc:\/\/com.apple.documentation\/documentation\/Swift\/String], or more complex types, such as [doc:\/\/com.apple.documentation\/documentation\/Foundation\/Data].\n\nFor example, a “to-do item” might have the following record type:\n\n\n\nFor information on additional supported value types, see [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord].\n\n### Create records programmatically\n\nCreate a [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] object with a string representing the type of record you want to store, using [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord\/initWithRecordType:]. Every record type must have a unique string name.\n\n```swift\nlet record = CKRecord(recordType: \"ToDoItem\")\n```\n\nThen set the record’s fields. Because [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKRecord] is key-value coding compliant, you can use [doc:\/\/com.apple.documentation\/documentation\/ObjectiveC\/NSObject-swift.class\/setValuesForKeys(_:)]. The values you set could be from a details sheet that the user fills out.\n\n```swift\nrecord.setValuesForKeys([\n    \"title\": \"Get apples\",\n    \"dueDate\": DateComponents(\n        calendar: Calendar.current,\n        year: 2019,\n        month: 10,\n        day: 28).date!,\n    \"isCompleted\": false \/\/ Stored as Int(64)\n])\n```\n\n### Save initial records to iCloud\n\nYou can create a schema using CloudKit Dashboard, or you can create a *just-in-time schema* by writing records programmatically.\n\nTo save a record to your container, you must pick a database to save the record to. Each container has a single *public* database accessible to all app users, and *private* databases for each user of your app. Also, a user may have a *shared* database if that user is accessing another user’s shared private data. Note that every database within your app’s container shares the same schema.\n\nAlthough an app can have multiple containers or can share a container, each app has one default container. You access the default container using [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKContainer\/default()] on [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKContainer]. The following example uses the current user’s private database within the app’s default container and exists in an action handler for a Save button.\n\n```swift\nlet container = CKContainer.default()\nlet database = container.privateCloudDatabase\n```\n\nSave the record to the user’s private database in the app’s container.\n\n```swift\ndatabase.save(record) { record, error in\n    if let error = error {\n        \/\/ Handle error.\n        return\n    }\n    \/\/ Record saved successfully.\n}\n```\n\nWhen you run your app, it adds that record type to the schema and saves the record. If the record type already exists in the schema, iCloud uses the existing type. Saving a record works only if the user has signed into their iCloud account on their device.\n\nIf saving the record to iCloud succeeds, `error` is `nil`. (If `error` is non-`nil`, see [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/CKError] for possible values of `error.)`\n\n\n\n### Handle or prevent errors gracefully\n\nWhen designing your app, consider how to handle or prevent error conditions. For example, an error occurs if your app attempts to save a record to a user’s private database and the user hasn’t yet signed in to iCloud. You might handle this scenario by checking whether the user has signed in before the app saves the record. If the user hasn’t signed in, present an alert. If they’re signed in, save the record.\n\nThe following example demonstrates preventing the error condition in this manner.\n\n```swift\nCKContainer.default().accountStatus { accountStatus, error in\n    if accountStatus == .noAccount {\n        DispatchQueue.main.async {\n            let message = \n                \"\"\"\n                Sign in to your iCloud account to write records.\n                On the Home screen, launch Settings, tap Sign in to your\n                iPhone\/iPad, and enter your Apple ID. Turn iCloud Drive on.\n                \"\"\"\n            let alert = UIAlertController(\n                title: \"Sign in to iCloud\",\n                message: message,\n                preferredStyle: .alert)\n            alert.addAction(UIAlertAction(title: \"OK\", style: .cancel))\n            self.present(alert, animated: true)\n        }\n    }\n    else {\n        \/\/ Save your record here.\n    }\n}\n```\n\n### Run your app\n\nIn Xcode, run your app to execute the code that saves records and creates the schema in the database. To verify success, see [doc:\/\/com.apple.cloudkit\/documentation\/CloudKit\/inspecting-and-editing-an-icloud-container-s-schema].\n\n## Schemas\n\n- **Managing iCloud Containers with CloudKit Database App**: Inspect and modify the schema and data for your app’s iCloud container.\n- **CKRecordZone**: A database partition that contains related records.\n- **CKRecord**: A collection of key-value pairs that store your app’s data.\n- **CKRecord.Reference**: A relationship between two records in a record zone.\n- **CKAsset**: An external file that belongs to a record.\n- **Integrating a Text-Based Schema into Your Workflow**: Define and update your schema with the CloudKit Schema Language.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Inspect and modify the schema and data for your app’s iCloud container.",
          "name" : "Managing iCloud Containers with CloudKit Database App",
          "url" : "https:\/\/developer.apple.com\/documentation\/CloudKit\/managing-icloud-containers-with-cloudkit-database-app"
        },
        {
          "description" : "A database partition that contains related records.",
          "name" : "CKRecordZone",
          "url" : "https:\/\/developer.apple.com\/documentation\/CloudKit\/CKRecordZone"
        },
        {
          "description" : "A collection of key-value pairs that store your app’s data.",
          "name" : "CKRecord",
          "url" : "https:\/\/developer.apple.com\/documentation\/CloudKit\/CKRecord"
        },
        {
          "description" : "A relationship between two records in a record zone.",
          "name" : "CKRecord.Reference",
          "url" : "https:\/\/developer.apple.com\/documentation\/CloudKit\/CKRecord\/Reference"
        },
        {
          "description" : "An external file that belongs to a record.",
          "name" : "CKAsset",
          "url" : "https:\/\/developer.apple.com\/documentation\/CloudKit\/CKAsset"
        },
        {
          "description" : "Define and update your schema with the CloudKit Schema Language.",
          "name" : "Integrating a Text-Based Schema into Your Workflow",
          "url" : "https:\/\/developer.apple.com\/documentation\/CloudKit\/integrating-a-text-based-schema-into-your-workflow"
        }
      ],
      "title" : "Schemas"
    }
  ],
  "source" : "appleJSON",
  "title" : "Designing and Creating a CloudKit Database",
  "url" : "https:\/\/developer.apple.com\/documentation\/cloudkit\/designing-and-creating-a-cloudkit-database"
}