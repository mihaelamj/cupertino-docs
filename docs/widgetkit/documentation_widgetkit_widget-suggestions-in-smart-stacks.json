{
  "abstract" : "Provide contextual information and donate intents to the system to make sure your widget appears prominently in Smart Stacks.",
  "codeExamples" : [
    {
      "code" : "    func timeline(for configuration: EmojiRangerSelection, in context: Context) async -> Timeline<SimpleEntry> {\n        let selectedCharacter = hero(for: configuration)\n        let endDate = selectedCharacter.fullHealthDate\n        let oneMinute: TimeInterval = 60\n        var currentDate = Date()\n        var entries: [SimpleEntry] = []\n        \n        while currentDate < endDate {\n            let relevance = TimelineEntryRelevance(score: Float(selectedCharacter.healthLevel))\n            let entry = SimpleEntry(date: currentDate, relevance: relevance, hero: selectedCharacter)\n            currentDate += oneMinute\n            entries.append(entry)\n        }\n        \n        return Timeline(entries: entries, policy: .atEnd)\n    }",
      "language" : "swift"
    },
    {
      "code" : "import SwiftUI\nimport WidgetKit\nimport AppIntents\n\nstruct AppIntentProvider: AppIntentTimelineProvider {\n    \n    typealias Entry = SimpleEntry\n    \n    typealias Intent = EmojiRangerSelection\n    \n    func placeholder(in context: Context) -> SimpleEntry {\n        \/\/ Code that returns a placeholder entry.\n    }\n    \n    func snapshot(for configuration: EmojiRangerSelection, in context: Context) async -> SimpleEntry {\n        \/\/ Code that returns a snapshot entry.\n    }\n    \n    func timeline(for configuration: EmojiRangerSelection, in context: Context) async -> Timeline<SimpleEntry> {\n        \/\/ Code that creates timeline entries.\n        \/\/ ...\n        \n        \/\/ Update relevant intents with each timeline refresh.\n        await updateRangerRelevantIntents()\n        \n        \/\/ Code that returns a timeline.\n    }\n    \n    func recommendations() -> [AppIntentRecommendation<EmojiRangerSelection>] {\n        [] \/\/ Returns an empty array that makes the widget configurable.       \n    }\n    \n    \/\/ Provide contextual clues that inform the system about contexts in which\n    \/\/ your widget is especially important to a person. \n    func relevance() async -> WidgetRelevance<Self.Intent> {\n        let relevances = EmojiRanger.allHeros.map { hero in\n            let rangerIntent = EmojiRangerSelection()\n            rangerIntent.hero = hero\n            let relevantRangerContext = RelevantContext.date(from: hero.injuryDate, to: hero.fullHealthDate)\n            return WidgetRelevanceAttribute(configuration: rangerIntent, context: relevantRangerContext)\n        }\n        return WidgetRelevance(relevances)\n    }\n    \n    \/\/ A function that updates your relevant intents.\n    func updateRangerRelevantIntents() async {\n        var relevantIntents: [RelevantIntent] = []\n        \n        \/\/ Create relevant intents.\n        \/\/ The code below is intentionally simple to make it easy to understand.\n        for hero in EmojiRanger.allHeros {\n            let configuredRangerIntent = EmojiRangerSelection()\n            configuredRangerIntent.hero = hero\n            let relevantRangerContext = RelevantContext.date(from: hero.injuryDate, to: hero.fullHealthDate)\n        \n            let relevantIntent = RelevantIntent(\n                configuredRangerIntent,\n                widgetKind: EmojiRanger.EmojiRangerWidgetKind,\n                relevance: relevantRangerContext\n            )\n            relevantIntents.append(relevantIntent)\n        }\n\n        do {\n            try await RelevantIntentManager.shared.updateRelevantIntents(relevantIntents)\n        } catch {\n            \/\/ Handle error cases.\n        }\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Create the widget with a relevance configuration.\n@available(watchOS 12, *)\nstruct EmojiRangerWidget: Widget {    \n    var body: some WidgetConfiguration {\n        RelevanceConfiguration(\n            kind: EmojiRanger.EmojiRangerWidgetKind,\n            provider: EmojiRangerRelevanceProvider()\n        ) { entry in\n            EmojiRangerWidgetView(entry: entry)\n        }\n        .configurationDisplayName(\"Emoji Ranger\")\n        .description(\"Healing status\")\n    }\n}\n\n\/\/ Implement the relevance provider and its requirements.\n@available(watchOS 12, *)\nstruct EmojiRangerRelevanceProvider: RelevanceEntriesProvider {\n    \/\/ Provide all contextual clues.\n    func relevance() async -> WidgetRelevance<EmojiRangertConfigurationIntent> {\n        let healingUpdates = ... \/\/ Code to retrieve healing update information\n        let attributes = healingUpdates.map { update in\n            \/\/ Create relevant contexts objects.\n            let context = RelevantContext.date(\n                interval: update.date,\n                kind: .scheduled\n            )\n            WidgetRelevanceAttribute(\n                configuration: EmojiRangertConfigurationIntent(update: update),\n                context: context\n            )\n        }\n        return WidgetRelevance(attributes)\n    }\n\n    \/\/ Provide all data entries for the widget.\n    func entry(\n        configuration: Configuration,\n        context: Context\n    ) async throws -> EmojiRangersRelevanceEntry {\n        if context.isPreview {\n            return EmojiRangersRelevanceEntry.previewEntry\n        }\n        return EmojiRangersRelevanceEntry(\n            hero: configuration.update?.hero,\n            update: configuration.update\n        )\n    }\n\n    func placeholder(context: Context) -> EmojiRangersRelevanceEntry {\n        EmojiRangersRelevanceEntry.placeholderEntry\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "76c823d171b5168792a51eecf6af654fe9c179ceb2ffbbac8dd19823e3b50547",
  "crawledAt" : "2025-12-02T17:02:53Z",
  "id" : "42D51109-C999-40CB-AB8C-83C3D32F59D2",
  "kind" : "article",
  "language" : "swift",
  "module" : "WidgetKit",
  "overview" : "## Overview\n\nSmart Stacks efficiently organize multiple widgets to show useful content at just the right time. With input from your app and on-device intelligence, the system can identify patterns and determine a widget’s relevance to a person, making sure a Smart Stack shows your widget at the right moment. Context helps the system increase your widget’s visibility and gives people an quick, intelligent way to view content or perform an action. For example, if a person checks the daily weather forecast every morning or their calendar on the commute to work every morning, the system can suggest the corresponding widgets at the right moments.\n\nOn iPhone and iPad, people create Smart Stacks on their Home Screen with options for surfacing widgets in a Smart Stack:\n\nOn Apple Watch, people rely more on the Smart Stack to intelligently display widgets that best fit their personal context. Additionally, they can configure their favorite widgets to appear in the Smart Stack and pin them to a fixed position.\n\nTo make sure the system can accurately determine your widget’s importance to someone, provide contextual and behavioral clues in your timeline provider with [doc:\/\/com.apple.documentation\/documentation\/RelevanceKit] and [doc:\/\/com.apple.documentation\/documentation\/AppIntents].\n\n### Provide relevance and contextual clues for each platform\n\nTo determine which widget is most relevant to a person in a particular context, the system’s on-device intelligence processes information it gathers automatically. For example, it considers when and how often a person uses your app.\n\nHowever, the system can’t access in-app context — actions a person performs or content they view in your app. Only you can determine which in-app actions make your widget more important across Smart Stacks and only you can know when your widget’s content is important. As a result, the system relies on additional clues from your app or widget extension to show your widget at the right time and increase its visibility.\n\nDepending on the platform, provide the following clues to the system:\n\n### Add a relevance score and duration to your timeline entries\n\nOn iPhone and iPad, one of the different clues on-device intelligence uses to determine the widget’s position in the Smart Stack is the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntry\/relevance] property of the entries your [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineProvider] or [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/AppIntentTimelineProvider] generates. The property’s [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntryRelevance] type contains a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntryRelevance\/score] and a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntryRelevance\/duration]. The score is a value you choose that indicates the relevance of the widget, relative to entries across timelines that the provider creates. When the date of an entry arrives, and for the duration you specify, WidgetKit may rotate your widget to the top of the Smart Stack, making it visible.\n\nFor example, the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/emoji-rangers-supporting-live-activities-interactivity-and-animations] sample code project sets an increased relevance if a configured hero hasn’t recovered its full health:\n\nTo determine a score for an individual entry, it’s preferable to decide on an absolute scale from least relevant to most relevant. The range of the scale is up to you; for instance, 1 to 100, 50 to 5000, or any other range of positive numbers that’s meaningful to you. WidgetKit calculates the relative difference of scores between entries; the absolute values don’t matter.\n\nBecause WidgetKit maintains relevance information across timelines, use a consistent scale for all of them. For simplicity, you might use an enumeration with specific values for `low`, `medium`, and `high` relevance. Alternatively, if your score calculations have a continuous variation, you might use floating-point precision in your scale, with consistent minimum and maximum values.\n\nA score of zero (`0`) or lower indicates that a widget isn’t relevant, and WidgetKit won’t consider rotating it to the top of the stack.\n\n### Donate app intents for increased visibility on iPhone and iPad\n\nTo help the system determine your widget’s relevance, donate app intents to provide the system with *behavioral clues* about a person’s current in-app actions. When you donate app intents, the system learns how and when people interact with your app and compares your donated app intents with app intents of configured widgets in the Smart Stack. If it finds a widget with a matching app intent, it can automatically rotate to it when a person typically looks for that information. If someone hasn’t configured a matching widget in a Smart Stack, the system can automatically suggest your widget with the configuration that matches your donated app intent. This process increases the visibility of your widget.\n\nFor example, a tour guide app displays information for cities around the world, such as popular tourist attractions, restaurants, and upcoming festivals throughout the year. The app offers several configurable widgets that display these details. To offer configurable widgets, the app’s widget configurations make use of custom intents, such as `CityInfoAppIntent`, `AttractionAppIntent`, `RestaurantAppIntent`, and `FestivalAppIntent`. As people interact with the app, the app donates these app intents to inform Smart Rotate and Widget Suggestions in Smart Stacks.\n\nTo enable Smart Stacks to suggest your widget or show it more prominently:\n\nContinuing the example with the tour guide app, a person frequently uses the app on the weekend to plan a trip to France. Using the app, they look for festivals in various cities they may visit. Each time they search for or view the details of a festival, the app donates a `FestivalAppIntent`. If the `FestivalAppIntent` contains `location` and `type` parameters, the system can learn that the person frequently searches for art events in Paris. Based on this learned information, Smart Stacks can automatically rotate to the widget that shows information about the art festival in Paris when the person typically looks for that information. If Smart Stacks don’t contain a matching widget, the system can automatically add the configured widget as a Widget Suggestion, giving the app more visibility and the person instant access to the information.\n\n### Choose how to provide relevance clues on Apple Watch\n\nOn Apple Watch, widgets automatically appear in the Smart Stack based on *contextual clues* it requests from your widget — as opposed to behavioral cues your app provides that inform the Smart Stack on iPhone and iPad. When a person’s context matches one of your widget’s contextual clues, such as their location or bedtime, or an inferred  location such as their workplace, the Smart Stack may show your widget more prominently.\n\nIn watchOS, you can choose between two options to provide relevance information:\n\nProvide relevance clues in your timeline provider if your widget’s data changes on a relatively predicable schedule and always has timely data to display. Provide relevance clues using a relevance entries provider if your widget should automatically show information for one of the available [doc:\/\/com.apple.documentation\/documentation\/RelevanceKit\/RelevantContext] clues. Additionally, choose a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider] if your widget should appear automatically in the Smart Stack several times or if it shouldn’t appear in the Smart Stack unless it matches a person’s context. For example, a widget might only be relevant at a person’s inferred work location and not at their inferred home location.\n\nDepending on your app’s functionality, you might want to support both or only one of the options:\n\n### Add watchOS relevance clues to your timeline provider\n\nIf your widget uses a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineProvider], [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/AppIntentTimelineProvider], or [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/IntentTimelineProvider], watchOS queries your widget extension periodically using the timeline provider’s `relevance()` requirement to gather contextual clues.\n\nTo provide the system with contextual clues using a timeline provider:\n\nThe following example shows how a gaming app might allow people to track the health of their hero and provide contextual clues to the system:\n\n### Create a watchOS widget that uses a relevance configuration\n\nOn Apple Watch, enable the system to display relevant widgets in the Smart Stack based on relevance information you provide with a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider]:\n\nThe following code snippet shows how a gaming app that allows people to track the health level of their heroes initializes a watchOS widget with a `RelevanceConfiguration` and provides relevance information with a `RelevanceEntriesProvider`:\n\nIf you offer timeline-based and widgets that uses relevance clues, a person could pin the timeline widget to the Smart Stack. When several instances of the relevance-based widget become relevant, the Smart Stack could run out of space. To ensure that the Smart Stack can display the most relevant widgets, tell the system that your relevance-based widget can replace the timeline-based widget using the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/WidgetConfiguration\/associatedKind(_:)] modifier.\n\n### Test widgets in Smart Stacks\n\nWhen a widget is in a Smart Stack, WidgetKit normally limits the number of times it rotates the widget to the top of the stack or when it inserts the widget as a suggestion. To bypass this limit during development, enable the WidgetKit Developer Mode switch in Settings > Developer.\n\nFor additional tips about debugging widgets, refer to [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/Debugging-Widgets] and [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/Previewing-widgets-and-live-activities-in-xcode].\n\n### Provide backward compatibility\n\nIn iOS 16, macOS 13, watchOS 9 and earlier, configurable widgets use [doc:\/\/com.apple.documentation\/documentation\/SiriKit] and the system determines your widget’s relevance based on donations of SiriKit intents. For details about supporting older operating system versions, refer to [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/Migrating-from-SiriKit-Intents-to-App-Intents].\n\nDonating SiriKit Intents is very similar to donating app intents. Instead of using [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/IntentDonationManager], you use [doc:\/\/com.apple.documentation\/documentation\/Intents\/INInteraction] to donate an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INIntent]. For more information about donating SiriKit Intents, refer to [doc:\/\/com.apple.documentation\/documentation\/SiriKit\/donating-shortcuts] and [doc:\/\/com.apple.documentation\/documentation\/SiriKit\/watch-and-widget-support].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/WidgetKit\/Widget-Suggestions-In-Smart-Stacks\ncrawled: 2025-12-02T17:02:53Z\n---\n\n# Increasing the visibility of widgets in Smart Stacks\n\n**Article**\n\nProvide contextual information and donate intents to the system to make sure your widget appears prominently in Smart Stacks.\n\n## Overview\n\nSmart Stacks efficiently organize multiple widgets to show useful content at just the right time. With input from your app and on-device intelligence, the system can identify patterns and determine a widget’s relevance to a person, making sure a Smart Stack shows your widget at the right moment. Context helps the system increase your widget’s visibility and gives people an quick, intelligent way to view content or perform an action. For example, if a person checks the daily weather forecast every morning or their calendar on the commute to work every morning, the system can suggest the corresponding widgets at the right moments.\n\nOn iPhone and iPad, people create Smart Stacks on their Home Screen with options for surfacing widgets in a Smart Stack:\n\n\n\nOn Apple Watch, people rely more on the Smart Stack to intelligently display widgets that best fit their personal context. Additionally, they can configure their favorite widgets to appear in the Smart Stack and pin them to a fixed position.\n\nTo make sure the system can accurately determine your widget’s importance to someone, provide contextual and behavioral clues in your timeline provider with [doc:\/\/com.apple.documentation\/documentation\/RelevanceKit] and [doc:\/\/com.apple.documentation\/documentation\/AppIntents].\n\n### Provide relevance and contextual clues for each platform\n\nTo determine which widget is most relevant to a person in a particular context, the system’s on-device intelligence processes information it gathers automatically. For example, it considers when and how often a person uses your app.\n\nHowever, the system can’t access in-app context — actions a person performs or content they view in your app. Only you can determine which in-app actions make your widget more important across Smart Stacks and only you can know when your widget’s content is important. As a result, the system relies on additional clues from your app or widget extension to show your widget at the right time and increase its visibility.\n\nDepending on the platform, provide the following clues to the system:\n\n\n\n\n\n### Add a relevance score and duration to your timeline entries\n\nOn iPhone and iPad, one of the different clues on-device intelligence uses to determine the widget’s position in the Smart Stack is the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntry\/relevance] property of the entries your [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineProvider] or [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/AppIntentTimelineProvider] generates. The property’s [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntryRelevance] type contains a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntryRelevance\/score] and a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntryRelevance\/duration]. The score is a value you choose that indicates the relevance of the widget, relative to entries across timelines that the provider creates. When the date of an entry arrives, and for the duration you specify, WidgetKit may rotate your widget to the top of the Smart Stack, making it visible.\n\nFor example, the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/emoji-rangers-supporting-live-activities-interactivity-and-animations] sample code project sets an increased relevance if a configured hero hasn’t recovered its full health:\n\n```swift\n    func timeline(for configuration: EmojiRangerSelection, in context: Context) async -> Timeline<SimpleEntry> {\n        let selectedCharacter = hero(for: configuration)\n        let endDate = selectedCharacter.fullHealthDate\n        let oneMinute: TimeInterval = 60\n        var currentDate = Date()\n        var entries: [SimpleEntry] = []\n        \n        while currentDate < endDate {\n            let relevance = TimelineEntryRelevance(score: Float(selectedCharacter.healthLevel))\n            let entry = SimpleEntry(date: currentDate, relevance: relevance, hero: selectedCharacter)\n            currentDate += oneMinute\n            entries.append(entry)\n        }\n        \n        return Timeline(entries: entries, policy: .atEnd)\n    }\n```\n\nTo determine a score for an individual entry, it’s preferable to decide on an absolute scale from least relevant to most relevant. The range of the scale is up to you; for instance, 1 to 100, 50 to 5000, or any other range of positive numbers that’s meaningful to you. WidgetKit calculates the relative difference of scores between entries; the absolute values don’t matter.\n\nBecause WidgetKit maintains relevance information across timelines, use a consistent scale for all of them. For simplicity, you might use an enumeration with specific values for `low`, `medium`, and `high` relevance. Alternatively, if your score calculations have a continuous variation, you might use floating-point precision in your scale, with consistent minimum and maximum values.\n\nA score of zero (`0`) or lower indicates that a widget isn’t relevant, and WidgetKit won’t consider rotating it to the top of the stack.\n\n### Donate app intents for increased visibility on iPhone and iPad\n\nTo help the system determine your widget’s relevance, donate app intents to provide the system with *behavioral clues* about a person’s current in-app actions. When you donate app intents, the system learns how and when people interact with your app and compares your donated app intents with app intents of configured widgets in the Smart Stack. If it finds a widget with a matching app intent, it can automatically rotate to it when a person typically looks for that information. If someone hasn’t configured a matching widget in a Smart Stack, the system can automatically suggest your widget with the configuration that matches your donated app intent. This process increases the visibility of your widget.\n\nFor example, a tour guide app displays information for cities around the world, such as popular tourist attractions, restaurants, and upcoming festivals throughout the year. The app offers several configurable widgets that display these details. To offer configurable widgets, the app’s widget configurations make use of custom intents, such as `CityInfoAppIntent`, `AttractionAppIntent`, `RestaurantAppIntent`, and `FestivalAppIntent`. As people interact with the app, the app donates these app intents to inform Smart Rotate and Widget Suggestions in Smart Stacks.\n\n\n\nTo enable Smart Stacks to suggest your widget or show it more prominently:\n\n1. Describe an app action as a custom app intent that conforms to [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/PredictableIntent].\n2. If your widget is configurable, make sure the predictable intent contains a [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/PredictableIntent\/predictionConfiguration] that matches the intent’s values to the configurable parameters of your widget. If your widget isn’t configurable, don’t provide a parameter matching.\n3. Donate the app intent to the system using [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/IntentDonationManager] or the intent’s [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/AppIntent\/donate()-1e60c] functionality.\n\nContinuing the example with the tour guide app, a person frequently uses the app on the weekend to plan a trip to France. Using the app, they look for festivals in various cities they may visit. Each time they search for or view the details of a festival, the app donates a `FestivalAppIntent`. If the `FestivalAppIntent` contains `location` and `type` parameters, the system can learn that the person frequently searches for art events in Paris. Based on this learned information, Smart Stacks can automatically rotate to the widget that shows information about the art festival in Paris when the person typically looks for that information. If Smart Stacks don’t contain a matching widget, the system can automatically add the configured widget as a Widget Suggestion, giving the app more visibility and the person instant access to the information.\n\n\n\n### Choose how to provide relevance clues on Apple Watch\n\nOn Apple Watch, widgets automatically appear in the Smart Stack based on *contextual clues* it requests from your widget — as opposed to behavioral cues your app provides that inform the Smart Stack on iPhone and iPad. When a person’s context matches one of your widget’s contextual clues, such as their location or bedtime, or an inferred  location such as their workplace, the Smart Stack may show your widget more prominently.\n\nIn watchOS, you can choose between two options to provide relevance information:\n\n\n\nProvide relevance clues in your timeline provider if your widget’s data changes on a relatively predicable schedule and always has timely data to display. Provide relevance clues using a relevance entries provider if your widget should automatically show information for one of the available [doc:\/\/com.apple.documentation\/documentation\/RelevanceKit\/RelevantContext] clues. Additionally, choose a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider] if your widget should appear automatically in the Smart Stack several times or if it shouldn’t appear in the Smart Stack unless it matches a person’s context. For example, a widget might only be relevant at a person’s inferred work location and not at their inferred home location.\n\nDepending on your app’s functionality, you might want to support both or only one of the options:\n\n- If your existing app is only available on Apple Watch and you want to offer an additional widget that can appear several times in the Smart Stack, create separate widgets for each option.\n- If you create a new app that’s only available in watchOS, create separate widgets for each option.\n- If your app supports iOS and watchOS, use a timeline provider to provide relevance clues to share code across platforms and consider adding a watchOS widget that uses a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceConfiguration].\n\n\n\n### Add watchOS relevance clues to your timeline provider\n\nIf your widget uses a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineProvider], [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/AppIntentTimelineProvider], or [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/IntentTimelineProvider], watchOS queries your widget extension periodically using the timeline provider’s `relevance()` requirement to gather contextual clues.\n\nTo provide the system with contextual clues using a timeline provider:\n\n1. Create app intents that conform to [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/RelevantIntent] and include a [doc:\/\/com.apple.documentation\/documentation\/RelevanceKit\/RelevantContext] that describes conditions such as time, location, workouts, sleep schedule, and more.\n2. Return the relevant intents in the  `relevance()` callback of your widget’s [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineProvider] or [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/AppIntentTimelineProvider]  implementation.\n3. When you create or update your widget’s timeline, set each timeline entry’s [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/TimelineEntry\/relevance] property and create or update your relevant intents  using the [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/RelevantIntentManager\/updateRelevantIntents(_:)] function of the [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/RelevantIntentManager].\n4. Call [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/RelevantIntentManager\/updateRelevantIntents(_:)] to update relevance information every time it changes for your app; for example, when you receive updated data.\n\nThe following example shows how a gaming app might allow people to track the health of their hero and provide contextual clues to the system:\n\n```swift\nimport SwiftUI\nimport WidgetKit\nimport AppIntents\n\nstruct AppIntentProvider: AppIntentTimelineProvider {\n    \n    typealias Entry = SimpleEntry\n    \n    typealias Intent = EmojiRangerSelection\n    \n    func placeholder(in context: Context) -> SimpleEntry {\n        \/\/ Code that returns a placeholder entry.\n    }\n    \n    func snapshot(for configuration: EmojiRangerSelection, in context: Context) async -> SimpleEntry {\n        \/\/ Code that returns a snapshot entry.\n    }\n    \n    func timeline(for configuration: EmojiRangerSelection, in context: Context) async -> Timeline<SimpleEntry> {\n        \/\/ Code that creates timeline entries.\n        \/\/ ...\n        \n        \/\/ Update relevant intents with each timeline refresh.\n        await updateRangerRelevantIntents()\n        \n        \/\/ Code that returns a timeline.\n    }\n    \n    func recommendations() -> [AppIntentRecommendation<EmojiRangerSelection>] {\n        [] \/\/ Returns an empty array that makes the widget configurable.       \n    }\n    \n    \/\/ Provide contextual clues that inform the system about contexts in which\n    \/\/ your widget is especially important to a person. \n    func relevance() async -> WidgetRelevance<Self.Intent> {\n        let relevances = EmojiRanger.allHeros.map { hero in\n            let rangerIntent = EmojiRangerSelection()\n            rangerIntent.hero = hero\n            let relevantRangerContext = RelevantContext.date(from: hero.injuryDate, to: hero.fullHealthDate)\n            return WidgetRelevanceAttribute(configuration: rangerIntent, context: relevantRangerContext)\n        }\n        return WidgetRelevance(relevances)\n    }\n    \n    \/\/ A function that updates your relevant intents.\n    func updateRangerRelevantIntents() async {\n        var relevantIntents: [RelevantIntent] = []\n        \n        \/\/ Create relevant intents.\n        \/\/ The code below is intentionally simple to make it easy to understand.\n        for hero in EmojiRanger.allHeros {\n            let configuredRangerIntent = EmojiRangerSelection()\n            configuredRangerIntent.hero = hero\n            let relevantRangerContext = RelevantContext.date(from: hero.injuryDate, to: hero.fullHealthDate)\n        \n            let relevantIntent = RelevantIntent(\n                configuredRangerIntent,\n                widgetKind: EmojiRanger.EmojiRangerWidgetKind,\n                relevance: relevantRangerContext\n            )\n            relevantIntents.append(relevantIntent)\n        }\n\n        do {\n            try await RelevantIntentManager.shared.updateRelevantIntents(relevantIntents)\n        } catch {\n            \/\/ Handle error cases.\n        }\n    }\n}\n```\n\n### Create a watchOS widget that uses a relevance configuration\n\nOn Apple Watch, enable the system to display relevant widgets in the Smart Stack based on relevance information you provide with a [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider]:\n\n1. Configure your watchOS widget using [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceConfiguration].\n2. Adopt [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider] and implement its [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider\/entry(configuration:context:)], [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider\/placeholder(context:)], and [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntriesProvider\/relevance()] requirements.\n3. Make sure you return each [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/RelevanceEntry]. If you don’t provide entries, the widget won’t appear in the Smart Stack.\n\nThe following code snippet shows how a gaming app that allows people to track the health level of their heroes initializes a watchOS widget with a `RelevanceConfiguration` and provides relevance information with a `RelevanceEntriesProvider`:\n\n```swift\n\/\/ Create the widget with a relevance configuration.\n@available(watchOS 12, *)\nstruct EmojiRangerWidget: Widget {    \n    var body: some WidgetConfiguration {\n        RelevanceConfiguration(\n            kind: EmojiRanger.EmojiRangerWidgetKind,\n            provider: EmojiRangerRelevanceProvider()\n        ) { entry in\n            EmojiRangerWidgetView(entry: entry)\n        }\n        .configurationDisplayName(\"Emoji Ranger\")\n        .description(\"Healing status\")\n    }\n}\n\n\/\/ Implement the relevance provider and its requirements.\n@available(watchOS 12, *)\nstruct EmojiRangerRelevanceProvider: RelevanceEntriesProvider {\n    \/\/ Provide all contextual clues.\n    func relevance() async -> WidgetRelevance<EmojiRangertConfigurationIntent> {\n        let healingUpdates = ... \/\/ Code to retrieve healing update information\n        let attributes = healingUpdates.map { update in\n            \/\/ Create relevant contexts objects.\n            let context = RelevantContext.date(\n                interval: update.date,\n                kind: .scheduled\n            )\n            WidgetRelevanceAttribute(\n                configuration: EmojiRangertConfigurationIntent(update: update),\n                context: context\n            )\n        }\n        return WidgetRelevance(attributes)\n    }\n\n    \/\/ Provide all data entries for the widget.\n    func entry(\n        configuration: Configuration,\n        context: Context\n    ) async throws -> EmojiRangersRelevanceEntry {\n        if context.isPreview {\n            return EmojiRangersRelevanceEntry.previewEntry\n        }\n        return EmojiRangersRelevanceEntry(\n            hero: configuration.update?.hero,\n            update: configuration.update\n        )\n    }\n\n    func placeholder(context: Context) -> EmojiRangersRelevanceEntry {\n        EmojiRangersRelevanceEntry.placeholderEntry\n    }\n}\n```\n\nIf you offer timeline-based and widgets that uses relevance clues, a person could pin the timeline widget to the Smart Stack. When several instances of the relevance-based widget become relevant, the Smart Stack could run out of space. To ensure that the Smart Stack can display the most relevant widgets, tell the system that your relevance-based widget can replace the timeline-based widget using the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/WidgetConfiguration\/associatedKind(_:)] modifier.\n\n### Test widgets in Smart Stacks\n\nWhen a widget is in a Smart Stack, WidgetKit normally limits the number of times it rotates the widget to the top of the stack or when it inserts the widget as a suggestion. To bypass this limit during development, enable the WidgetKit Developer Mode switch in Settings > Developer.\n\nFor additional tips about debugging widgets, refer to [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/Debugging-Widgets] and [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/Previewing-widgets-and-live-activities-in-xcode].\n\n### Provide backward compatibility\n\nIn iOS 16, macOS 13, watchOS 9 and earlier, configurable widgets use [doc:\/\/com.apple.documentation\/documentation\/SiriKit] and the system determines your widget’s relevance based on donations of SiriKit intents. For details about supporting older operating system versions, refer to [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/Migrating-from-SiriKit-Intents-to-App-Intents].\n\nDonating SiriKit Intents is very similar to donating app intents. Instead of using [doc:\/\/com.apple.documentation\/documentation\/AppIntents\/IntentDonationManager], you use [doc:\/\/com.apple.documentation\/documentation\/Intents\/INInteraction] to donate an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INIntent]. For more information about donating SiriKit Intents, refer to [doc:\/\/com.apple.documentation\/documentation\/SiriKit\/donating-shortcuts] and [doc:\/\/com.apple.documentation\/documentation\/SiriKit\/watch-and-widget-support].\n\n## Smart Stacks\n\n- **TimelineEntryRelevance**: An object that describes the relative importance of a timeline entry compared to other entries in the current and past timelines.\n- **RelevanceConfiguration**: A type that describes the content of a widget that uses relevance clues.\n- **RelevanceEntriesProvider**: A type that provides the content for a widget that uses relevance clues to display information in the Smart Stack.\n- **RelevanceEntry**: A type that specifies the information to render a widget at a specific relevance configuration.\n- **WidgetRelevance**: A type collecting the relevances for a widget kind.\n- **WidgetRelevanceAttribute**: A type that describes when a specific widget could be relevant.\n- **WidgetRelevanceGroup**: A type for configuring widget behavior in the watchOS Smart Stack.\n- **AppIntentRecommendation**: An object that describes a recommended intent configuration for a user-customizable widget.\n- **IntentConfiguration**: An object describing the content of a widget that uses a custom intent definition to provide user-configurable options.\n- **IntentRecommendation**: An object that describes a recommended intent configuration for a user-customizable widget.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that describes the relative importance of a timeline entry compared to other entries in the current and past timelines.",
          "name" : "TimelineEntryRelevance",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/TimelineEntryRelevance"
        },
        {
          "description" : "A type that describes the content of a widget that uses relevance clues.",
          "name" : "RelevanceConfiguration",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/RelevanceConfiguration"
        },
        {
          "description" : "A type that provides the content for a widget that uses relevance clues to display information in the Smart Stack.",
          "name" : "RelevanceEntriesProvider",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/RelevanceEntriesProvider"
        },
        {
          "description" : "A type that specifies the information to render a widget at a specific relevance configuration.",
          "name" : "RelevanceEntry",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/RelevanceEntry"
        },
        {
          "description" : "A type collecting the relevances for a widget kind.",
          "name" : "WidgetRelevance",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/WidgetRelevance"
        },
        {
          "description" : "A type that describes when a specific widget could be relevant.",
          "name" : "WidgetRelevanceAttribute",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/WidgetRelevanceAttribute"
        },
        {
          "description" : "A type for configuring widget behavior in the watchOS Smart Stack.",
          "name" : "WidgetRelevanceGroup",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/WidgetRelevanceGroup"
        },
        {
          "description" : "An object that describes a recommended intent configuration for a user-customizable widget.",
          "name" : "AppIntentRecommendation",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/AppIntentRecommendation"
        },
        {
          "description" : "An object describing the content of a widget that uses a custom intent definition to provide user-configurable options.",
          "name" : "IntentConfiguration",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/IntentConfiguration"
        },
        {
          "description" : "An object that describes a recommended intent configuration for a user-customizable widget.",
          "name" : "IntentRecommendation",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/IntentRecommendation"
        }
      ],
      "title" : "Smart Stacks"
    }
  ],
  "source" : "appleJSON",
  "title" : "Increasing the visibility of widgets in Smart Stacks",
  "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/Widget-Suggestions-In-Smart-Stacks"
}