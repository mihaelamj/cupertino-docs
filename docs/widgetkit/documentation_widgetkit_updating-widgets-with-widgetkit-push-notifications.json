{
  "abstract" : "Use WidgetKit to receive push tokens and reload your widgets with remote push notifications.",
  "codeExamples" : [
    {
      "code" : "\/\/ Handle push token and widget configuration changes.\nstruct CaffeineTrackerPushHandler: WidgetPushHandler {\n    func pushTokenDidChange(_ pushInfo: WidgetPushInfo, widgets: [WidgetInfo]) {\n        \/\/ Send the push token and subscription info\n        \/\/ to your remote notification server.\n        \/\/ ...\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Add the pushHandler to the WidgetConfiguration.\nstruct CaffeineTrackerWidget: Widget {\n    var body: some WidgetConfiguration {\n        StaticConfiguration(\n            kind: Constants.widgetKind,\n            provider: Provider()\n        ) { entry in\n            CaffeineTrackerWidgetView(entry: entry)\n        }\n        .configurationDisplayName(\"Caffeine Tracker\")\n        .pushHandler(CaffeineTrackerPushHandler.self)\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : ":method = POST\n:scheme = https\n:path = \/3\/device\/<DEVICE_TOKEN>\n\n\/\/ Request headers\nhost = api.sandbox.push.apple.com\napns-push-type = widgets\napns-topic = com.example.CaffeineTracker.push-type.widgets\n\n\/\/ Request body\n{\n    \"aps\": {\n        \"content-changed\": true,     \n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "846ec1f0fa6c07dbd621107bb00b79da8fa05559c4ef383b4e9e99f5165a3695",
  "crawledAt" : "2025-12-03T04:06:06Z",
  "id" : "9897405F-6F50-413E-9762-056FB9730C20",
  "kind" : "article",
  "language" : "swift",
  "module" : "WidgetKit",
  "overview" : "## Overview\n\nIn addition to requesting a widget timeline refresh from your app, widgets can receive a push notification to refresh their data that compliments timeline updates. If data for your widget changes on your server, your widgets can receive a WidgetKit push notifications you send using the Apple Push Notification service (APNs). Use WidgetKit push notification updates in addition to timeline updates.\n\nTo update your widget with WidgetKit push notifications:\n\n### Add the Push Notifications capability and create a remote notification server\n\nIn your Xcode project, start by adding the Push Notifications capability to your app in Xcode as described in [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/registering-your-app-with-apns]. Note that you can’t use the User Notifications framework to register your widget for push notifications. Instead, you use WidgetKit to obtain a push token as described below.\n\n### Manage push tokens and send them to your server\n\nTo update your widgets with push notifications, your app needs to receive and manage push tokens, send them to your remote notification server, and configure the widget to receive push updates.\n\nFirst, create an object that conforms to the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetPushHandler] protocol and that handles:\n\nIn your widget push handler, implement the  [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetPushHandler\/pushTokenDidChange(_:widgets:)] requirement, access the updated push token using the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetPushInfo] object, and the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetInfo] objects, and send updated information to your remote notification server as needed.\n\nThe following example shows a template for the `pushTokenDidChange(_:widgets:)` requirement:\n\n### Configure your widget to receive push updates\n\nWhen you implement the push handler, tell WidgetKit which widget you want to update with remote push notifications by adding the handler to your [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/WidgetConfiguration] using the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/WidgetConfiguration\/pushHandler(_:)] API:\n\n### Send the WidgetKit notification payload that updates your widget\n\nSending a remote push notification to your widget works the same as other remote push notifications, as described in [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-notification-requests-to-apns]. To send WidgetKit push notification updates, make sure your remote notification server constructs a JSON payload that conforms to the following requirements:\n\nThe following sample shows what a POST request for a widget update might look like:\n\nFor information about testing push notifications, refer to [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-push-notifications-using-command-line-tools] and [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/testing-notifications-using-the-push-notification-console].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/WidgetKit\/Updating-widgets-with-widgetkit-push-notifications\ncrawled: 2025-12-03T04:06:06Z\n---\n\n# Updating widgets with WidgetKit push notifications\n\n**Article**\n\nUse WidgetKit to receive push tokens and reload your widgets with remote push notifications.\n\n## Overview\n\nIn addition to requesting a widget timeline refresh from your app, widgets can receive a push notification to refresh their data that compliments timeline updates. If data for your widget changes on your server, your widgets can receive a WidgetKit push notifications you send using the Apple Push Notification service (APNs). Use WidgetKit push notification updates in addition to timeline updates.\n\nTo update your widget with WidgetKit push notifications:\n\n1. Add the capability to use remote push notifications to your widget extension target in Xcode.\n2. Set up a remote notification server or make changes to your existing server to support WidgetKit push notifications. If you’re new to using remote push notifications, plan to spend time implementing your remote notification server. For more information, refer to [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/registering-your-app-with-apns].\n3. Update your app to obtain push tokens, handle token updates, update or invalidate them on your remote push notification server, and use the tokens to establish a token-based connection to APNs, as described in [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/establishing-a-token-based-connection-to-apns].\n4. Send WidgetKit push notifications from your remote notification server with APNs using the push tokens, HTTP header fields, and JSON payload to update your widget.\n5. When WidgetKit receives a push notification, it reloads your timelines, similar to when you call [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetCenter\/reloadAllTimelines()].\n\n\n\n### Add the Push Notifications capability and create a remote notification server\n\nIn your Xcode project, start by adding the Push Notifications capability to your app in Xcode as described in [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/registering-your-app-with-apns]. Note that you can’t use the User Notifications framework to register your widget for push notifications. Instead, you use WidgetKit to obtain a push token as described below.\n\n\n\n### Manage push tokens and send them to your server\n\nTo update your widgets with push notifications, your app needs to receive and manage push tokens, send them to your remote notification server, and configure the widget to receive push updates.\n\nFirst, create an object that conforms to the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetPushHandler] protocol and that handles:\n\n- Updates to the push tokens that allow your remote notification server to send notifications to the widget using APNs\n- Changes to a person’s configured widgets; for example, when they add or remove a widget\n\nIn your widget push handler, implement the  [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetPushHandler\/pushTokenDidChange(_:widgets:)] requirement, access the updated push token using the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetPushInfo] object, and the [doc:\/\/com.apple.WidgetKit\/documentation\/WidgetKit\/WidgetInfo] objects, and send updated information to your remote notification server as needed.\n\n\n\nThe following example shows a template for the `pushTokenDidChange(_:widgets:)` requirement:\n\n```swift\n\/\/ Handle push token and widget configuration changes.\nstruct CaffeineTrackerPushHandler: WidgetPushHandler {\n    func pushTokenDidChange(_ pushInfo: WidgetPushInfo, widgets: [WidgetInfo]) {\n        \/\/ Send the push token and subscription info\n        \/\/ to your remote notification server.\n        \/\/ ...\n    }\n}\n```\n\n### Configure your widget to receive push updates\n\nWhen you implement the push handler, tell WidgetKit which widget you want to update with remote push notifications by adding the handler to your [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/WidgetConfiguration] using the [doc:\/\/com.apple.documentation\/documentation\/SwiftUI\/WidgetConfiguration\/pushHandler(_:)] API:\n\n```swift\n\/\/ Add the pushHandler to the WidgetConfiguration.\nstruct CaffeineTrackerWidget: Widget {\n    var body: some WidgetConfiguration {\n        StaticConfiguration(\n            kind: Constants.widgetKind,\n            provider: Provider()\n        ) { entry in\n            CaffeineTrackerWidgetView(entry: entry)\n        }\n        .configurationDisplayName(\"Caffeine Tracker\")\n        .pushHandler(CaffeineTrackerPushHandler.self)\n    }\n}\n```\n\n### Send the WidgetKit notification payload that updates your widget\n\nSending a remote push notification to your widget works the same as other remote push notifications, as described in [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-notification-requests-to-apns]. To send WidgetKit push notification updates, make sure your remote notification server constructs a JSON payload that conforms to the following requirements:\n\n- Set the value for the `apns-push-type` header field to `widgets`.\n- Set the value for the `apns-topic` header field to `<your bundleID>.push-type.widgets`.\n- In your request’s `apn` dictionary, set the `content-changed` property to `true`.\n\nThe following sample shows what a POST request for a widget update might look like:\n\n```swift\n:method = POST\n:scheme = https\n:path = \/3\/device\/<DEVICE_TOKEN>\n\n\/\/ Request headers\nhost = api.sandbox.push.apple.com\napns-push-type = widgets\napns-topic = com.example.CaffeineTracker.push-type.widgets\n\n\/\/ Request body\n{\n    \"aps\": {\n        \"content-changed\": true,     \n    }\n}\n```\n\nFor information about testing push notifications, refer to [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/sending-push-notifications-using-command-line-tools] and [doc:\/\/com.apple.documentation\/documentation\/UserNotifications\/testing-notifications-using-the-push-notification-console].\n\n## Push notification updates\n\n- **WidgetPushHandler**: A type that can receive push information about widget refreshes and relevance refreshes.\n- **WidgetPushInfo**: A structure that contains information about the push token for updating widgets and widget relevances.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A type that can receive push information about widget refreshes and relevance refreshes.",
          "name" : "WidgetPushHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/WidgetPushHandler"
        },
        {
          "description" : "A structure that contains information about the push token for updating widgets and widget relevances.",
          "name" : "WidgetPushInfo",
          "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/WidgetPushInfo"
        }
      ],
      "title" : "Push notification updates"
    }
  ],
  "source" : "appleJSON",
  "title" : "Updating widgets with WidgetKit push notifications",
  "url" : "https:\/\/developer.apple.com\/documentation\/WidgetKit\/Updating-widgets-with-widgetkit-push-notifications"
}