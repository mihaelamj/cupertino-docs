{
  "abstract" : "Add your app as an option for mobile document web presentment.",
  "codeExamples" : [
    {
      "code" : "let store = IdentityDocumentProviderRegistrationStore()\n\ndo {\n  let storedDocument = \/* Document from your app's storage *\/\n  let registration = MobileDocumentRegistration(\n    mobileDocumentType: \"org.iso.18013.5.1.mDL\",\n    supportedAuthorityKeyIdentifiers: [Data([0x01, 0x02, 0x03])],\n    documentIdentifier: storedDocument.identifier,\n    invalidationDate: storedDocument.invalidationDate\n  )\n\n  try await store.addRegistration(registration)\n} catch {\n  \/\/ Handle the error.\n}",
      "language" : "swift"
    },
    {
      "code" : "let store = IdentityDocumentProviderRegistrationStore()\n\ndo {\n    let storedRegistrations = try await store.registrations\n    \n    let matchingRegistration = storedRegistrations.first { storedRegistration in\n        \/\/ Your app logic to determine which registration to remove.\n    }\n    \n    guard let documentIdentifier = matchingRegistration?.documentIdentifier else {\n        \/\/ Throw an error.\n    }\n    \n    try await registrationStore.removeRegistration(forDocumentIdentifier: documentIdentifier)\n} catch {\n    \/\/ Handle the error.\n}",
      "language" : "swift"
    },
    {
      "code" : "\n@main\nstruct DocumentProviderExtension: IdentityDocumentProvider {\n\n    var body: some IdentityDocumentRequestScene {\n        ISO18013MobileDocumentRequestScene { context in\n            \/\/ SwiftUI view goes here.\n            Text(\"Hello, world!\")\n        }\n    }\n\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ The context received from the request scene.\nlet context: ISO18013MobileDocumentRequestContext\n\ntry await context.sendResponse { rawRequest in\n    \/\/ Your app now has access to the raw request.\n}",
      "language" : "swift"
    },
    {
      "code" : "    try await context.sendResponse { rawRequest in\n        \/\/ App specific logic to validate the two requests.\n        try await validateConsistency(request: context.request, rawRequest: rawRequest)\n\n        \/\/ Validate the signatures of the incoming request.\n        try await validateRawRequest(rawRequest: rawRequest)\n\n        \/\/ App specific logic to build and encrypt the response.\n        let responseData = try await buildAndEncryptResponse(rawRequest: rawRequest)\n\n        return ISO18013MobileDocumentResponse(responseData: responseData)\n    }",
      "language" : "swift"
    },
    {
      "code" : "@main\nstruct DocumentProviderExtension: IdentityDocumentProvider {\n\n    func performRegistrationUpdates() async {\n        let store = IdentityDocumentProviderRegistrationStore()\n        \n        do {\n            let storedRegistrations = try await store.registrations\n            \n            \/\/ Determine which documents in your app haven't yet been registered.\n            \n            \/\/ Register each document through the `addRegistration` API.\n        } catch {\n            \/\/ Handle the error.\n        }\n    }\n\n}",
      "language" : "swift"
    },
    {
      "code" : "let store = IdentityDocumentProviderRegistrationStore()\nlet status = await store.status",
      "language" : "swift"
    }
  ],
  "contentHash" : "6006f6a0985cd57a37344f766240120fe60c10865ef79769fd4a5360f62c7c33",
  "crawledAt" : "2025-12-02T17:01:38Z",
  "id" : "1E010085-71C5-494E-9018-DB75F287BC23",
  "kind" : "article",
  "language" : "swift",
  "module" : "IdentityDocumentServices",
  "overview" : "## Overview\n\nThe Identity Document Provider APIs in `IdentityDocumentServices` and `IdentityDocumentServicesUI` enable your app to participate in web presentment activated through the Digital Credentials API. By implementing the identity document provider APIs into your app, your app appears as an option for the user to select during a presentment. If the user selects your app, then an authorization UI that you provide appears for them to review.\n\nIntegrating the identity document provider requires two steps: registering your available documents with iOS and adding the Identity Document Provider app extension to your app to build the authorization UI you show to the user.\n\n## Add the entitlement\n\nBefore your app can provide identity documents, you must add the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.identity-document-services.document-provider.mobile-document-types] entitlement to your app.\n\nThe API enables you to provide mobile documents (mdocs), defined in the ISO\/IEC 18013-5 standard. Your app must specify which types of mobile documents it intends to provide in the entitlement. To maximize interoperability, your app needs to follow the appropriate standard that defines the namespaces and elements for a given mobile document type.\n\n## Registering your document\n\nIn order for iOS to know when to surface your app, register information about the documents your app contains. For a consistent user experience, register your documents as soon as the system creates a document within your app.\n\n### Add a registration\n\nIdentity document registrations happen through the [doc:\/\/com.apple.identitydocumentservices\/documentation\/IdentityDocumentServices\/IdentityDocumentProviderRegistrationStore] type. The registration store supports registering mdocs as defined in ISO\/IEC 18013-5.\n\nThe following code shows an example of how to register a mobile driver’s license (mDL):\n\nWhen registering an mdoc, you provide the following information:\n\n### Remove a registration\n\nWhen a document in your app is no longer available for use, it’s important to remove its registration from the iOS. This helps enable the best user experience. Use the appropriate document identifier to remove the registration.\n\nIf you provide a document identifier, then you can determine the correct identifier based on your app’s logic. If don’t provide a document identifier, you can query your app’s stored registrations to determine the document identifier. Here’s an example:\n\n## Create your authorization UI\n\nAdd the Identity Document Provider app extension to create your app UI. You can use the template available in Xcode.\n\nThe generated template gives you a place to fill in SwiftUI code:\n\nThe `ISO18013MobileDocumentRequestContext` provided in `IdentityDocumentServicesUI` contains the information needed to build your UI:\n\n## Handling the parsed and raw request\n\nThe incoming request your app needs to handle is the request defined in ISO\/IEC 18013-7 Annex C and ISO\/IEC 18013-5. These request types contain complex structures, as well as signatures to help your document provider app authenticate the requesting website.\n\nDue to the complex nature of this request and the fact that the website is potentially untrusted, the browser can’t provide the full request to the system components, such as your app, until the user performs an interaction. However, components of the request are necessary in order to build the authorization UI.\n\nTo provide the best user experience while protecting your app’s security, the `ISO18013MobileDocumentRequestScene` provides two requests to your app. When your app receives the first  request, a system sandbox validates the signatures of the incoming request, and parses out the information necessary to build a UI. This is the `ISO18013MobileDocumentRequest` type that is available on the `ISO18013MobileDocumentRequestContext` received by your app.\n\nAfter the user approves the presentment within your app’s authorization UI, then they perform a user interaction. This means that the raw ISO\/IEC 18013-7 Annex C request is ready for release to your app. This raw request releases within a closure when your app calls the send response function:\n\nNow that your app has access to both requests, perform the following procedure:\n\nThe following code illustrates the steps your app performs:\n\n## Responding to user authorization\n\nYour app becomes eligible to register documents after the user authorizes your app to provide documents during a web presentment.\n\nThe first time your app calls the `addRegistration` API on `IdentityDocumentProviderRegistrationStore`, the system shows the user a display prompt. The user can choose to approve your app in the prompt, and then your app’s document registration continues.\n\nIf the user doesn’t approve your app, then the `addRegistration` call throws an error. The user can later enable your app again in your app’s page in `Settings`. After the user approves, the system notifies your app through the `performRegistrationUpdates` function on your app extension.\n\nWhen you call this function, your app needs to ensure that all documents stored in your app are registered with iOS:\n\nYour app can also query the current user’s authorization status through the status API on `IdentityDocumentProviderRegistrationStore`:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/IdentityDocumentServices\/Implenting-as-an-identity-document-provider\ncrawled: 2025-12-02T17:01:38Z\n---\n\n# Implementing as an identity document provider\n\n**Article**\n\nAdd your app as an option for mobile document web presentment.\n\n## Overview\n\nThe Identity Document Provider APIs in `IdentityDocumentServices` and `IdentityDocumentServicesUI` enable your app to participate in web presentment activated through the Digital Credentials API. By implementing the identity document provider APIs into your app, your app appears as an option for the user to select during a presentment. If the user selects your app, then an authorization UI that you provide appears for them to review.\n\nIntegrating the identity document provider requires two steps: registering your available documents with iOS and adding the Identity Document Provider app extension to your app to build the authorization UI you show to the user.\n\n## Add the entitlement\n\nBefore your app can provide identity documents, you must add the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Entitlements\/com.apple.developer.identity-document-services.document-provider.mobile-document-types] entitlement to your app.\n\nThe API enables you to provide mobile documents (mdocs), defined in the ISO\/IEC 18013-5 standard. Your app must specify which types of mobile documents it intends to provide in the entitlement. To maximize interoperability, your app needs to follow the appropriate standard that defines the namespaces and elements for a given mobile document type.\n\n## Registering your document\n\nIn order for iOS to know when to surface your app, register information about the documents your app contains. For a consistent user experience, register your documents as soon as the system creates a document within your app.\n\n### Add a registration\n\nIdentity document registrations happen through the [doc:\/\/com.apple.identitydocumentservices\/documentation\/IdentityDocumentServices\/IdentityDocumentProviderRegistrationStore] type. The registration store supports registering mdocs as defined in ISO\/IEC 18013-5.\n\nThe following code shows an example of how to register a mobile driver’s license (mDL):\n\n```swift\nlet store = IdentityDocumentProviderRegistrationStore()\n\ndo {\n  let storedDocument = \/* Document from your app's storage *\/\n  let registration = MobileDocumentRegistration(\n    mobileDocumentType: \"org.iso.18013.5.1.mDL\",\n    supportedAuthorityKeyIdentifiers: [Data([0x01, 0x02, 0x03])],\n    documentIdentifier: storedDocument.identifier,\n    invalidationDate: storedDocument.invalidationDate\n  )\n\n  try await store.addRegistration(registration)\n} catch {\n  \/\/ Handle the error.\n}\n```\n\nWhen registering an mdoc, you provide the following information:\n\n\n\n### Remove a registration\n\nWhen a document in your app is no longer available for use, it’s important to remove its registration from the iOS. This helps enable the best user experience. Use the appropriate document identifier to remove the registration.\n\nIf you provide a document identifier, then you can determine the correct identifier based on your app’s logic. If don’t provide a document identifier, you can query your app’s stored registrations to determine the document identifier. Here’s an example:\n\n```swift\nlet store = IdentityDocumentProviderRegistrationStore()\n\ndo {\n    let storedRegistrations = try await store.registrations\n    \n    let matchingRegistration = storedRegistrations.first { storedRegistration in\n        \/\/ Your app logic to determine which registration to remove.\n    }\n    \n    guard let documentIdentifier = matchingRegistration?.documentIdentifier else {\n        \/\/ Throw an error.\n    }\n    \n    try await registrationStore.removeRegistration(forDocumentIdentifier: documentIdentifier)\n} catch {\n    \/\/ Handle the error.\n}\n```\n\n## Create your authorization UI\n\nAdd the Identity Document Provider app extension to create your app UI. You can use the template available in Xcode.\n\nThe generated template gives you a place to fill in SwiftUI code:\n\n```swift\n\n@main\nstruct DocumentProviderExtension: IdentityDocumentProvider {\n\n    var body: some IdentityDocumentRequestScene {\n        ISO18013MobileDocumentRequestScene { context in\n            \/\/ SwiftUI view goes here.\n            Text(\"Hello, world!\")\n        }\n    }\n\n}\n```\n\nThe `ISO18013MobileDocumentRequestContext` provided in `IdentityDocumentServicesUI` contains the information needed to build your UI:\n\n\n\n## Handling the parsed and raw request\n\nThe incoming request your app needs to handle is the request defined in ISO\/IEC 18013-7 Annex C and ISO\/IEC 18013-5. These request types contain complex structures, as well as signatures to help your document provider app authenticate the requesting website.\n\nDue to the complex nature of this request and the fact that the website is potentially untrusted, the browser can’t provide the full request to the system components, such as your app, until the user performs an interaction. However, components of the request are necessary in order to build the authorization UI.\n\nTo provide the best user experience while protecting your app’s security, the `ISO18013MobileDocumentRequestScene` provides two requests to your app. When your app receives the first  request, a system sandbox validates the signatures of the incoming request, and parses out the information necessary to build a UI. This is the `ISO18013MobileDocumentRequest` type that is available on the `ISO18013MobileDocumentRequestContext` received by your app.\n\nAfter the user approves the presentment within your app’s authorization UI, then they perform a user interaction. This means that the raw ISO\/IEC 18013-7 Annex C request is ready for release to your app. This raw request releases within a closure when your app calls the send response function:\n\n```swift\n\/\/ The context received from the request scene.\nlet context: ISO18013MobileDocumentRequestContext\n\ntry await context.sendResponse { rawRequest in\n    \/\/ Your app now has access to the raw request.\n}\n```\n\nNow that your app has access to both requests, perform the following procedure:\n\n1. Compare the consistency of the parsed request on `ISO18013MobileDocumentRequestContext` against the received `rawRequest`.\n2. Validate the signatures in the raw request to confirm that it originated from a source that your app trusts. Your app needs to also confirm that the request is signed by a certificate that your app trusts. Even though the sandboxed system process checks these signatures, it’s important that your app checks them before releasing its document.\n3. If both checks passed, then build and encrypt your document response according to ISO\/IEC 18013-7 Annex C and ISO\/IEC 18013-5.\n4. Return your document response from the closure.\n\nThe following code illustrates the steps your app performs:\n\n```swift\n    try await context.sendResponse { rawRequest in\n        \/\/ App specific logic to validate the two requests.\n        try await validateConsistency(request: context.request, rawRequest: rawRequest)\n\n        \/\/ Validate the signatures of the incoming request.\n        try await validateRawRequest(rawRequest: rawRequest)\n\n        \/\/ App specific logic to build and encrypt the response.\n        let responseData = try await buildAndEncryptResponse(rawRequest: rawRequest)\n\n        return ISO18013MobileDocumentResponse(responseData: responseData)\n    }\n```\n\n## Responding to user authorization\n\nYour app becomes eligible to register documents after the user authorizes your app to provide documents during a web presentment.\n\nThe first time your app calls the `addRegistration` API on `IdentityDocumentProviderRegistrationStore`, the system shows the user a display prompt. The user can choose to approve your app in the prompt, and then your app’s document registration continues.\n\nIf the user doesn’t approve your app, then the `addRegistration` call throws an error. The user can later enable your app again in your app’s page in `Settings`. After the user approves, the system notifies your app through the `performRegistrationUpdates` function on your app extension.\n\nWhen you call this function, your app needs to ensure that all documents stored in your app are registered with iOS:\n\n```swift\n@main\nstruct DocumentProviderExtension: IdentityDocumentProvider {\n\n    func performRegistrationUpdates() async {\n        let store = IdentityDocumentProviderRegistrationStore()\n        \n        do {\n            let storedRegistrations = try await store.registrations\n            \n            \/\/ Determine which documents in your app haven't yet been registered.\n            \n            \/\/ Register each document through the `addRegistration` API.\n        } catch {\n            \/\/ Handle the error.\n        }\n    }\n\n}\n```\n\nYour app can also query the current user’s authorization status through the status API on `IdentityDocumentProviderRegistrationStore`:\n\n```swift\nlet store = IdentityDocumentProviderRegistrationStore()\nlet status = await store.status\n```\n\n## Essentials\n\n- **Requesting a mobile document on the web**: Send a request for mobile document information for apps installed on a device.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Send a request for mobile document information for apps installed on a device.",
          "name" : "Requesting a mobile document on the web",
          "url" : "https:\/\/developer.apple.com\/documentation\/IdentityDocumentServices\/Requesting-a-mobile-document-on-the-web"
        }
      ],
      "title" : "Essentials"
    }
  ],
  "source" : "appleJSON",
  "title" : "Implementing as an identity document provider",
  "url" : "https:\/\/developer.apple.com\/documentation\/IdentityDocumentServices\/Implenting-as-an-identity-document-provider"
}