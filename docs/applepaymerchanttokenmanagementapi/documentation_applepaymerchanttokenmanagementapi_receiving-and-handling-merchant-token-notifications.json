{
  "abstract" : "Implement an endpoint to receive and handle merchant token life-cycle updates from Apple Pay.",
  "codeExamples" : [
    {
      "code" : "https:\/\/merchant.example.com\/your-endpoint-for-notification\/notification\/merchantToken\/{eventId}",
      "language" : "other"
    },
    {
      "code" : "https:\/\/merchant.example.com\/your-endpoint-for-notification",
      "language" : "other"
    }
  ],
  "contentHash" : "d19336defefa0907e5dc413daf4542ae410873112a97cd7861707c133f729fba",
  "crawledAt" : "2025-12-01T09:32:32Z",
  "id" : "5D4D33F8-C36B-4F86-B605-437754458B31",
  "kind" : "article",
  "module" : "Apple Pay Merchant Token Management API",
  "overview" : "## Overview\n\nA *merchant token* associates a payment card, merchant, and user. Apple Pay issues a merchant token when a customer initiates a purchase using Apple Pay in your app or on your website. When your app or website creates a payment request for a recurring payment or an automatic-reload payment, you pass your server’s notification URL in the `tokenNotificationURL` parameter. When a life-cycle event affects the token — for example, the card’s expiration date changes, or the user or issuer deletes the token — Apple Pay sends you a notification with a unique event identifier to that `tokenNotificationURL`.\n\nImplement the [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event] endpoint at the `tokenNotificationURL` you provide to receive and handle merchant token updates from Apple Pay.\n\n### Configure your server for Apple Pay’s requirements\n\nTo incorporate Apple Pay, your server needs to adhere to the following requirements.\n\nFor more information about meeting these requirements for your server, see [doc:\/\/com.apple.documentation\/documentation\/ApplePayontheWeb\/setting-up-your-server].\n\n### Create allow lists\n\nFor inbound merchant token notifications from Apple, allow the following IP addresses:\n\nFor merchant token event endpoints, allow the following URLs and IP addresses:\n\n### Enable your token notification endpoint\n\nAdd an endpoint that accepts a `GET` request in the following format:\n\nReplace `merchant.example.com` with your server’s domain and top level domain (TLD) and `your-endpoint-for-notification` with your server’s path to the endpoint. Apple Pay appends the path component `notification\/merchantToken`, and a unique event identifier as a path component after `notification\/merchantToken`.\n\nProvide the first part of the notification URL to payment requests that accept a `tokenNotificationURL` parameter.\n\nFor more information about the endpoint, see [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event].\n\nFor more information about payment requests that accept `tokenNotificationURL` as a parameter, see [doc:\/\/com.apple.documentation\/documentation\/PassKit\/PKAutomaticReloadPaymentRequest], [doc:\/\/com.apple.documentation\/documentation\/PassKit\/PKRecurringPaymentRequest], [doc:\/\/com.apple.documentation\/documentation\/ApplePayontheWeb\/ApplePayAutomaticReloadPaymentRequest], and [doc:\/\/com.apple.documentation\/documentation\/ApplePayontheWeb\/ApplePayRecurringPaymentRequest].\n\n### Receive and handle notifications\n\nWhen a life-cycle event occurs to a card associated with a merchant token, Apple Pay sends a `GET` request to your [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event] endpoint. Use the unique event identifier that Apple Pay sends and your merchant identifier to fetch information about this notification’s event. For more information, see [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Merchant-Token-Event-Retrieval].\n\nProcess the event in your system with the appropriate action. Respond with `200` `OK` if your endpoint successfully receives the notification, even if your endpoint can’t find the related merchant token or event identifier. Respond with `500` `Internal` `Server` `Error` if your endpoint isn’t able to process the notification request. Apple Pay immediately retries the notification up to three times if the response isn’t `200`.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/ApplePayMerchantTokenManagementAPI\/receiving-and-handling-merchant-token-notifications\ncrawled: 2025-12-01T09:32:32Z\n---\n\n# Receiving and handling merchant token notifications\n\n**Article**\n\nImplement an endpoint to receive and handle merchant token life-cycle updates from Apple Pay.\n\n## Overview\n\nA *merchant token* associates a payment card, merchant, and user. Apple Pay issues a merchant token when a customer initiates a purchase using Apple Pay in your app or on your website. When your app or website creates a payment request for a recurring payment or an automatic-reload payment, you pass your server’s notification URL in the `tokenNotificationURL` parameter. When a life-cycle event affects the token — for example, the card’s expiration date changes, or the user or issuer deletes the token — Apple Pay sends you a notification with a unique event identifier to that `tokenNotificationURL`.\n\nImplement the [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event] endpoint at the `tokenNotificationURL` you provide to receive and handle merchant token updates from Apple Pay.\n\n### Configure your server for Apple Pay’s requirements\n\nTo incorporate Apple Pay, your server needs to adhere to the following requirements.\n\n- HTTPS support\n- A valid SSL certificate\n- Support for the Transport Layer Security (TLS) 1.2 protocol, and at least one of the required cipher suites\n- A strict allow list for Apple Pay IP addresses for merchant validation\n- A strict allow list for Apple IP addresses for domain verification\n\nFor more information about meeting these requirements for your server, see [doc:\/\/com.apple.documentation\/documentation\/ApplePayontheWeb\/setting-up-your-server].\n\n### Create allow lists\n\nFor inbound merchant token notifications from Apple, allow the following IP addresses:\n\n- `17.58.0.0\/18`\n- `17.58.192.0\/18`\n\nFor merchant token event endpoints, allow the following URLs and IP addresses:\n\n\n\n\n\n### Enable your token notification endpoint\n\nAdd an endpoint that accepts a `GET` request in the following format:\n\n```other\nhttps:\/\/merchant.example.com\/your-endpoint-for-notification\/notification\/merchantToken\/{eventId}\n```\n\nReplace `merchant.example.com` with your server’s domain and top level domain (TLD) and `your-endpoint-for-notification` with your server’s path to the endpoint. Apple Pay appends the path component `notification\/merchantToken`, and a unique event identifier as a path component after `notification\/merchantToken`.\n\nProvide the first part of the notification URL to payment requests that accept a `tokenNotificationURL` parameter.\n\n```other\nhttps:\/\/merchant.example.com\/your-endpoint-for-notification\n```\n\nFor more information about the endpoint, see [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event].\n\nFor more information about payment requests that accept `tokenNotificationURL` as a parameter, see [doc:\/\/com.apple.documentation\/documentation\/PassKit\/PKAutomaticReloadPaymentRequest], [doc:\/\/com.apple.documentation\/documentation\/PassKit\/PKRecurringPaymentRequest], [doc:\/\/com.apple.documentation\/documentation\/ApplePayontheWeb\/ApplePayAutomaticReloadPaymentRequest], and [doc:\/\/com.apple.documentation\/documentation\/ApplePayontheWeb\/ApplePayRecurringPaymentRequest].\n\n### Receive and handle notifications\n\nWhen a life-cycle event occurs to a card associated with a merchant token, Apple Pay sends a `GET` request to your [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event] endpoint. Use the unique event identifier that Apple Pay sends and your merchant identifier to fetch information about this notification’s event. For more information, see [doc:\/\/com.apple.applepaymerchanttokenmanagementapi\/documentation\/MerchantTokenNotificationServices\/Merchant-Token-Event-Retrieval].\n\nProcess the event in your system with the appropriate action. Respond with `200` `OK` if your endpoint successfully receives the notification, even if your endpoint can’t find the related merchant token or event identifier. Respond with `500` `Internal` `Server` `Error` if your endpoint isn’t able to process the notification request. Apple Pay immediately retries the notification up to three times if the response isn’t `200`.\n\n## Merchant token notification handling\n\n- **Send Merchant Token Event**: Receive and handle merchant token life-cycle updates from Apple Pay.\n- **Update Merchant Metadata**: Update the merchant token’s notification URL.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Receive and handle merchant token life-cycle updates from Apple Pay.",
          "name" : "Send Merchant Token Event",
          "url" : "https:\/\/developer.apple.com\/documentation\/MerchantTokenNotificationServices\/Send-Merchant-Token-Event"
        },
        {
          "description" : "Update the merchant token’s notification URL.",
          "name" : "Update Merchant Metadata",
          "url" : "https:\/\/developer.apple.com\/documentation\/MerchantTokenNotificationServices\/Update-Merchant-Metadata"
        }
      ],
      "title" : "Merchant token notification handling"
    }
  ],
  "source" : "appleJSON",
  "title" : "Receiving and handling merchant token notifications",
  "url" : "https:\/\/developer.apple.com\/documentation\/ApplePayMerchantTokenManagementAPI\/receiving-and-handling-merchant-token-notifications"
}