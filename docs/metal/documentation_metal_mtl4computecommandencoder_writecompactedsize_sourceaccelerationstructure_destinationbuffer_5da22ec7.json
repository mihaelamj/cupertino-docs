{
  "abstract" : "Encodes a command to compute the size an acceleration structure can compact into, writing the result into a buffer.",
  "codeExamples" : [

  ],
  "contentHash" : "7396439348cb4ab6e837dbd30c0f5893b6af2d6e652169a6cbba0fc544aa286f",
  "crawledAt" : "2025-12-05T11:51:31Z",
  "declaration" : {
    "code" : "func writeCompactedSize(sourceAccelerationStructure accelerationStructure: any MTLAccelerationStructure, destinationBuffer buffer: MTL4BufferRange)",
    "language" : "swift"
  },
  "id" : "16E1E25D-711D-4B11-BB3E-7A8452A9F5E1",
  "kind" : "method",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Discussion\n\nThis size is potentially smaller than the acceleration structure. To perform compaction, you typically read this size from the buffer once the command buffer completes. You then use it to allocate a new, potentially smaller acceleration structure. Finally, you call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)] method to perform the copy.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)\ncrawled: 2025-12-05T11:51:31Z\n---\n\n# writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)\n\n**Instance Method**\n\nEncodes a command to compute the size an acceleration structure can compact into, writing the result into a buffer.\n\n## Declaration\n\n```swift\nfunc writeCompactedSize(sourceAccelerationStructure accelerationStructure: any MTLAccelerationStructure, destinationBuffer buffer: MTL4BufferRange)\n```\n\n## Parameters\n\n- **accelerationStructure**: Source acceleration structure.\n- **buffer**: Destination size buffer. Metal writes the compacted size as a 64-bit unsigned integer value, representing the compacted size in bytes.\n\n## Discussion\n\nThis size is potentially smaller than the acceleration structure. To perform compaction, you typically read this size from the buffer once the command buffer completes. You then use it to allocate a new, potentially smaller acceleration structure. Finally, you call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)] method to perform the copy.\n\n## Encoding acceleration structure copy commands\n\n- **copy(sourceAccelerationStructure:destinationAccelerationStructure:)**: Encodes an acceleration structure copy operation into the command buffer.\n- **copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)**: Encodes a command to copy and compact an acceleration structure.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Encodes an acceleration structure copy operation into the command buffer.",
          "name" : "copy(sourceAccelerationStructure:destinationAccelerationStructure:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copy(sourceAccelerationStructure:destinationAccelerationStructure:)"
        },
        {
          "description" : "Encodes a command to copy and compact an acceleration structure.",
          "name" : "copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)"
        }
      ],
      "title" : "Encoding acceleration structure copy commands"
    }
  ],
  "source" : "appleJSON",
  "title" : "writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)"
}