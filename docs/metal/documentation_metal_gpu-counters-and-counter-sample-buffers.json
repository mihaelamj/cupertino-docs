{
  "abstract" : "Retrieve runtime data from a GPU device by sampling one or more of its counters.",
  "codeExamples" : [

  ],
  "contentHash" : "cbba14e35ef2a6de7a53b4f009f862e9e8dc0aabd40800ad3da704e287d1408a",
  "crawledAt" : "2025-12-02T16:12:49Z",
  "id" : "53F590FE-52C5-4003-ACBD-A789A524B9D4",
  "kind" : "collection",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nA GPU *counter* ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounter]) is typically a hardware feature that tracks a specific performance metric, such as timestamps before and after an important rendering stage. A *counter set* ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSet]) is a collection of related counters. A *counter sample buffer* ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer]) represents the memory where a GPU device stores the data for a specific counter set.\n\nYou can retrieve and inspect data from a GPU’s counter set with the following steps:\n\nIf you’re sampling data from a timestamp counter set ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommonCounterSet\/timestamp]), you may need to convert the timestamps from the GPU’s clock to the CPU’s clock. See [doc:\/\/com.apple.metal\/documentation\/Metal\/converting-gpu-timestamps-into-cpu-time] for more information.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/gpu-counters-and-counter-sample-buffers\ncrawled: 2025-12-02T16:12:49Z\n---\n\n# GPU counters and counter sample buffers\n\n**API Collection**\n\nRetrieve runtime data from a GPU device by sampling one or more of its counters.\n\n## Overview\n\nA GPU *counter* ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounter]) is typically a hardware feature that tracks a specific performance metric, such as timestamps before and after an important rendering stage. A *counter set* ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSet]) is a collection of related counters. A *counter sample buffer* ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer]) represents the memory where a GPU device stores the data for a specific counter set.\n\nYou can retrieve and inspect data from a GPU’s counter set with the following steps:\n\n1. Inspect which GPU counter sets a GPU device supports (see [doc:\/\/com.apple.metal\/documentation\/Metal\/confirming-which-counters-and-counter-sets-a-gpu-supports]).\n2. Make a counter sample buffer to store the data (see [doc:\/\/com.apple.metal\/documentation\/Metal\/creating-a-counter-sample-buffer-to-store-a-gpus-counter-data-during-a-pass]).\n3. Instruct the GPU to save the counter set data to the buffer during a pass or an immediate mode command (see [doc:\/\/com.apple.metal\/documentation\/Metal\/sampling-gpu-data-into-counter-sample-buffers]).\n4. Transform the counter set data into a standard type (see [doc:\/\/com.apple.metal\/documentation\/Metal\/converting-a-gpus-counter-data-into-a-readable-format]).\n\nIf you’re sampling data from a timestamp counter set ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommonCounterSet\/timestamp]), you may need to convert the timestamps from the GPU’s clock to the CPU’s clock. See [doc:\/\/com.apple.metal\/documentation\/Metal\/converting-gpu-timestamps-into-cpu-time] for more information.\n\n## Counters and counter sets\n\n- **Confirming which counters and counter sets a GPU supports**: Check whether a GPU produces the runtime performance data you want to sample.\n- **MTLCounterSet**: A collection of individual counters a GPU device supports for a counter set.\n- **MTLCommonCounterSet**: The name of a specific counter set that a GPU device can support.\n- **MTLCounter**: An individual counter a GPU device lists within one of its counter sets.\n- **MTLCommonCounter**: The name of a specific counter that can appear in a GPU device’s counter sets.\n\n## Counter sample buffers\n\n- **Creating a counter sample buffer to store a GPU’s counter data during a pass**: Make a buffer that provides a place for a GPU to save its runtime performance metrics as it runs a pass.\n- **MTLCounterSampleBufferDescriptor**: A group of properties that configures the counter sample buffers you create with it.\n- **MTLCounterSampleBuffer**: A specialized memory buffer that stores a GPU’s counter set data.\n- **Sampling GPU data into counter sample buffers**: Retrieve a GPU’s counter data at a time the GPU supports.\n- **MTLCounterDontSample**: A sentinel value that instructs an encoder to skip sampling a counter as the GPU runs the encoder’s pass.\n\n## Counter sample data output\n\n- **Converting a GPU’s counter data into a readable format**: Inspect and use the data within a GPU’s counter sample buffer by resolving it into a standard format.\n- **MTLCounterResultTimestamp**: The data structure for storing the data you resolve from a timestamp counter set.\n- **MTLCounterResultStatistic**: The data structure for storing the data you resolve from a statistic counter set.\n- **MTLCounterResultStageUtilization**: The data structure for storing the data you resolve from a stage-utilization counter set.\n- **MTLCounterErrorValue**: A sentinel value for an entry in a counter sample buffer that indicates the entry’s data is invalid.\n\n## Timestamp data\n\n- **Converting GPU timestamps into CPU time**: Correlate GPU events with CPU timelines by calculating the CPU time equivalents for GPU timestamps.\n- **MTLTimestamp**: The number of nanoseconds for a point in absolute time or Mach absolute time.\n\n## Counter sample buffer errors\n\n- **MTLCounterSampleBufferError**: The error codes that indicate why a GPU driver can’t create a counter sample buffer.\n\n## Developer tools\n\n- **Supporting Simulator in a Metal app**: Configure alternative render paths in your Metal app to enable running your app in Simulator.\n- **Capturing Metal commands programmatically**: Invoke a Metal frame capture from your app, then save the resulting GPU trace to a file or view it in Xcode.\n- **Logging shader debug messages**: Print debugging messages that a shader generates using shader logging.\n- **Developing Metal apps that run in Simulator**: Prototype and test your Metal apps in Simulator.\n- **Improving your game’s graphics performance and settings**: Fix performance glitches and develop default settings for smooth experiences on Apple platforms using the powerful suite of Metal development tools.\n- **Metal debugger**: Debug and profile your Metal workload with a GPU trace.\n- **Metal developer workflows**: Locate and fix issues related to your app’s use of the Metal API and GPU functions.\n- **Metal debugging types**: Create capture managers and capture scopes, and review a GPU device’s log after it runs a command buffer.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Check whether a GPU produces the runtime performance data you want to sample.",
          "name" : "Confirming which counters and counter sets a GPU supports",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/confirming-which-counters-and-counter-sets-a-gpu-supports"
        },
        {
          "description" : "A collection of individual counters a GPU device supports for a counter set.",
          "name" : "MTLCounterSet",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterSet"
        },
        {
          "description" : "The name of a specific counter set that a GPU device can support.",
          "name" : "MTLCommonCounterSet",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCommonCounterSet"
        },
        {
          "description" : "An individual counter a GPU device lists within one of its counter sets.",
          "name" : "MTLCounter",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounter"
        },
        {
          "description" : "The name of a specific counter that can appear in a GPU device’s counter sets.",
          "name" : "MTLCommonCounter",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCommonCounter"
        }
      ],
      "title" : "Counters and counter sets"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Make a buffer that provides a place for a GPU to save its runtime performance metrics as it runs a pass.",
          "name" : "Creating a counter sample buffer to store a GPU’s counter data during a pass",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/creating-a-counter-sample-buffer-to-store-a-gpus-counter-data-during-a-pass"
        },
        {
          "description" : "A group of properties that configures the counter sample buffers you create with it.",
          "name" : "MTLCounterSampleBufferDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterSampleBufferDescriptor"
        },
        {
          "description" : "A specialized memory buffer that stores a GPU’s counter set data.",
          "name" : "MTLCounterSampleBuffer",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterSampleBuffer"
        },
        {
          "description" : "Retrieve a GPU’s counter data at a time the GPU supports.",
          "name" : "Sampling GPU data into counter sample buffers",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/sampling-gpu-data-into-counter-sample-buffers"
        },
        {
          "description" : "A sentinel value that instructs an encoder to skip sampling a counter as the GPU runs the encoder’s pass.",
          "name" : "MTLCounterDontSample",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterDontSample"
        }
      ],
      "title" : "Counter sample buffers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Inspect and use the data within a GPU’s counter sample buffer by resolving it into a standard format.",
          "name" : "Converting a GPU’s counter data into a readable format",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/converting-a-gpus-counter-data-into-a-readable-format"
        },
        {
          "description" : "The data structure for storing the data you resolve from a timestamp counter set.",
          "name" : "MTLCounterResultTimestamp",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterResultTimestamp"
        },
        {
          "description" : "The data structure for storing the data you resolve from a statistic counter set.",
          "name" : "MTLCounterResultStatistic",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterResultStatistic"
        },
        {
          "description" : "The data structure for storing the data you resolve from a stage-utilization counter set.",
          "name" : "MTLCounterResultStageUtilization",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterResultStageUtilization"
        },
        {
          "description" : "A sentinel value for an entry in a counter sample buffer that indicates the entry’s data is invalid.",
          "name" : "MTLCounterErrorValue",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterErrorValue"
        }
      ],
      "title" : "Counter sample data output"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Correlate GPU events with CPU timelines by calculating the CPU time equivalents for GPU timestamps.",
          "name" : "Converting GPU timestamps into CPU time",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/converting-gpu-timestamps-into-cpu-time"
        },
        {
          "description" : "The number of nanoseconds for a point in absolute time or Mach absolute time.",
          "name" : "MTLTimestamp",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLTimestamp"
        }
      ],
      "title" : "Timestamp data"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The error codes that indicate why a GPU driver can’t create a counter sample buffer.",
          "name" : "MTLCounterSampleBufferError",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterSampleBufferError-swift.struct"
        }
      ],
      "title" : "Counter sample buffer errors"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Configure alternative render paths in your Metal app to enable running your app in Simulator.",
          "name" : "Supporting Simulator in a Metal app",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/supporting-simulator-in-a-metal-app"
        },
        {
          "description" : "Invoke a Metal frame capture from your app, then save the resulting GPU trace to a file or view it in Xcode.",
          "name" : "Capturing Metal commands programmatically",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/capturing-metal-commands-programmatically"
        },
        {
          "description" : "Print debugging messages that a shader generates using shader logging.",
          "name" : "Logging shader debug messages",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/logging-shader-debug-messages"
        },
        {
          "description" : "Prototype and test your Metal apps in Simulator.",
          "name" : "Developing Metal apps that run in Simulator",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/developing-metal-apps-that-run-in-simulator"
        },
        {
          "description" : "Fix performance glitches and develop default settings for smooth experiences on Apple platforms using the powerful suite of Metal development tools.",
          "name" : "Improving your game’s graphics performance and settings",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/improving-your-games-graphics-performance-and-settings"
        },
        {
          "description" : "Debug and profile your Metal workload with a GPU trace.",
          "name" : "Metal debugger",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Metal-debugger"
        },
        {
          "description" : "Locate and fix issues related to your app’s use of the Metal API and GPU functions.",
          "name" : "Metal developer workflows",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/Metal-developer-workflows"
        },
        {
          "description" : "Create capture managers and capture scopes, and review a GPU device’s log after it runs a command buffer.",
          "name" : "Metal debugging types",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/metal-debugging-types"
        }
      ],
      "title" : "Developer tools"
    }
  ],
  "source" : "appleJSON",
  "title" : "GPU counters and counter sample buffers",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/gpu-counters-and-counter-sample-buffers"
}