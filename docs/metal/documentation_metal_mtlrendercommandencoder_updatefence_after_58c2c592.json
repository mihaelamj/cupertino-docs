{
  "abstract" : "Encodes a command that instructs the GPU to update a fence after one or more stages, which can unblock other passes waiting for the fence.",
  "codeExamples" : [

  ],
  "contentHash" : "3a714e8dc49284b8c9e321529e5695386f55a14da4e1406f4b050ced84649b75",
  "crawledAt" : "2025-12-04T23:38:13Z",
  "declaration" : {
    "code" : "func updateFence(_ fence: any MTLFence, after stages: MTLRenderStages)",
    "language" : "swift"
  },
  "id" : "6483D169-2733-48A7-8A39-B4EC9462EBCE",
  "kind" : "method",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Discussion\n\nYou can synchronize memory operations of a render pass that access resources with an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLFence]. This method instructs the pass to update `fence` after the stages you pass to the `stages` run all their memory store operations to the resources it accesses. The fence indicates when other passes can access those resources without a race condition.\n\nFor more information about synchronization with fences, see:\n\n### Reuse a fence by waiting first and updating second\n\nWhen encoding a render pass that reuses a fence, wait for other passes to update the fence before repurposing that fence to notify subsequent passes with an update:\n\nThe GPU driver evaluates the fences that apply to the pass and the commands that depend on those fences when your app commits the enclosing [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer].\n\nTo synchronize different stages within a single pass, create an *intrapass barrier* because a fence can only synchronize memory operations between different passes. For more information, see [doc:\/\/com.apple.metal\/documentation\/Metal\/synchronizing-stages-within-a-pass].",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/MTLRenderCommandEncoder\/updateFence(_:after:)\ncrawled: 2025-12-04T23:38:13Z\n---\n\n# updateFence(_:after:)\n\n**Instance Method**\n\nEncodes a command that instructs the GPU to update a fence after one or more stages, which can unblock other passes waiting for the fence.\n\n## Declaration\n\n```swift\nfunc updateFence(_ fence: any MTLFence, after stages: MTLRenderStages)\n```\n\n## Parameters\n\n- **fence**: A fence the pass updates after the stages in `stages` complete.\n- **stages**: The render stages that need to complete before the pass updates `fence`.\n\n## Discussion\n\nYou can synchronize memory operations of a render pass that access resources with an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLFence]. This method instructs the pass to update `fence` after the stages you pass to the `stages` run all their memory store operations to the resources it accesses. The fence indicates when other passes can access those resources without a race condition.\n\nFor more information about synchronization with fences, see:\n\n- [doc:\/\/com.apple.metal\/documentation\/Metal\/resource-synchronization]\n- [doc:\/\/com.apple.metal\/documentation\/Metal\/synchronizing-passes-with-a-fence]\n\n### Reuse a fence by waiting first and updating second\n\nWhen encoding a render pass that reuses a fence, wait for other passes to update the fence before repurposing that fence to notify subsequent passes with an update:\n\n1. Call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRenderCommandEncoder\/waitForFence(_:before:)] method before encoding commands that need to wait for other passes.\n2. Call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRenderCommandEncoder\/updateFence(_:after:)] method after encoding commands that later passes depend on.\n\nThe GPU driver evaluates the fences that apply to the pass and the commands that depend on those fences when your app commits the enclosing [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer].\n\n\n\nTo synchronize different stages within a single pass, create an *intrapass barrier* because a fence can only synchronize memory operations between different passes. For more information, see [doc:\/\/com.apple.metal\/documentation\/Metal\/synchronizing-stages-within-a-pass].\n\n## Preventing resource access conflicts\n\n- **waitForFence(_:before:)**: Encodes a command that instructs the GPU to pause before starting one or more stages of the render pass until a pass updates a fence.\n- **memoryBarrier(resources:after:before:)**: Creates a memory barrier that enforces the order of write and read operations for specific resources.\n- **memoryBarrier(scope:after:before:)**: Creates a memory barrier that enforces the order of write and read operations for specific resource types.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Encodes a command that instructs the GPU to pause before starting one or more stages of the render pass until a pass updates a fence.",
          "name" : "waitForFence(_:before:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLRenderCommandEncoder\/waitForFence(_:before:)"
        },
        {
          "description" : "Creates a memory barrier that enforces the order of write and read operations for specific resources.",
          "name" : "memoryBarrier(resources:after:before:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLRenderCommandEncoder\/memoryBarrier(resources:after:before:)"
        },
        {
          "description" : "Creates a memory barrier that enforces the order of write and read operations for specific resource types.",
          "name" : "memoryBarrier(scope:after:before:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLRenderCommandEncoder\/memoryBarrier(scope:after:before:)"
        }
      ],
      "title" : "Preventing resource access conflicts"
    }
  ],
  "source" : "appleJSON",
  "title" : "updateFence(_:after:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLRenderCommandEncoder\/updateFence(_:after:)"
}