{
  "abstract" : "Use shareable events to synchronize your app’s work between a GPU and the CPU.",
  "codeExamples" : [

  ],
  "contentHash" : "2ea1b3d017f7c48554ee62551c38e45875bc471bbbcc6785838988ee29b27607",
  "crawledAt" : "2025-12-01T09:02:34Z",
  "id" : "22888F74-3B06-4546-B16A-98281B5AABEB",
  "kind" : "article",
  "module" : "Metal",
  "overview" : "## Overview\n\nA shared event has methods and properties that let your app execute code when the event is triggered, or update the event’s value.\n\nCall the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSharedEvent\/notify(_:atValue:block:)] method to register a notification handler that listens for changes to a shared event’s value. When some other action signals the event to give it a new value that is equal or larger than this value, such as when you signal the event from a command you sent to the GPU, the notification handler executes the block of code that you provided.\n\nSet the shared event’s  [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSharedEvent\/signaledValue] property to signal the event from the CPU. The value is only updated if you set a value larger than the current value stored in the event. Setting the value unblocks any commands waiting on a value equal to or smaller than the new value, and similarly triggers any CPU-based notifications.\n\nThe following figure and code show a shareable event that synchronizes GPU work and CPU work.\n\n\n\nThe setup code creates a shareable event and a listener object. Listener objects are used to dispatch notifications to the app when the event is signaled.\n\nThe work for this task is shared between the GPU and the CPU. As you can see in the figure above, the code needs to execute in the following order:\n\nThe `setupGPUCPUEvent` function uses signals to enforce this execution order. First, the function registers an event handler to be executed when the event is signaled. When called, this event handler executes the code for step 3 and then signals the event. That completes the CPU portion of the task.\n\nNext, the function encodes the work for the GPU. It encodes the work for part 1, signals the event, and then does the same for part 2, and signals the event again. Part 3 of the GPU code needs to run after the event handler finishes executing, so next the function encodes a command to wait for the CPU to signal the event. After this, the function encodes the commands for part 3 and commits the command buffer for execution.\n\nWhen the function commits the command buffer, the following actions occur:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/synchronizing-events-between-a-gpu-and-the-cpu\ncrawled: 2025-12-01T09:02:34Z\n---\n\n# Synchronizing events between a GPU and the CPU\n\n**Article**\n\nUse shareable events to synchronize your app’s work between a GPU and the CPU.\n\n## Overview\n\nA shared event has methods and properties that let your app execute code when the event is triggered, or update the event’s value.\n\nCall the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSharedEvent\/notify(_:atValue:block:)] method to register a notification handler that listens for changes to a shared event’s value. When some other action signals the event to give it a new value that is equal or larger than this value, such as when you signal the event from a command you sent to the GPU, the notification handler executes the block of code that you provided.\n\nSet the shared event’s  [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSharedEvent\/signaledValue] property to signal the event from the CPU. The value is only updated if you set a value larger than the current value stored in the event. Setting the value unblocks any commands waiting on a value equal to or smaller than the new value, and similarly triggers any CPU-based notifications.\n\nThe following figure and code show a shareable event that synchronizes GPU work and CPU work.\n\n\n\n\n\nThe setup code creates a shareable event and a listener object. Listener objects are used to dispatch notifications to the app when the event is signaled.\n\nThe work for this task is shared between the GPU and the CPU. As you can see in the figure above, the code needs to execute in the following order:\n\n1. GPU work part 1\n2. GPU work part 2\n3. CPU work\n4. GPU part 3\n\nThe `setupGPUCPUEvent` function uses signals to enforce this execution order. First, the function registers an event handler to be executed when the event is signaled. When called, this event handler executes the code for step 3 and then signals the event. That completes the CPU portion of the task.\n\nNext, the function encodes the work for the GPU. It encodes the work for part 1, signals the event, and then does the same for part 2, and signals the event again. Part 3 of the GPU code needs to run after the event handler finishes executing, so next the function encodes a command to wait for the CPU to signal the event. After this, the function encodes the commands for part 3 and commits the command buffer for execution.\n\nWhen the function commits the command buffer, the following actions occur:\n\n1. The GPU executes the first part of the task.\n2. The GPU signals the event to a new value of 1.\n3. The GPU executes the second part of the task.\n4. The GPU signals the event to a new value of 2.\n5. The CPU detects the signal value and runs the notification handler.\n6. The notification handler signals the event to a new value of 3.\n7. The GPU detects the signal value and executes the remaining commands.\n\n## Synchronizing with events\n\n- **Implementing a multistage image filter using heaps and events**: Use events to synchronize access to resources allocated on a heap.\n- **About synchronization events**: Synchronize access to resources in your app by signaling events.\n- **Synchronizing events within a single device**: Use nonshareable events to synchronize your app’s work within a single device.\n- **Synchronizing events across multiple devices or processes**: Use shareable events to synchronize your app’s work across multiple devices or processes.\n- **MTLEvent**: A type that synchronizes memory operations to one or more resources within a single Metal device.\n- **MTLSharedEvent**: A type that synchronizes memory operations to one or more resources across multiple CPUs, GPUs, and processes.\n- **MTLSharedEventHandle**: An instance you use to recreate a shareable event.\n- **MTLSharedEventListener**: A listener for shareable event notifications.\n- **MTLSharedEventNotificationBlock**: A block of code invoked after a shareable event’s signal value equals or exceeds a given value.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Use events to synchronize access to resources allocated on a heap.",
          "name" : "Implementing a multistage image filter using heaps and events",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/implementing-a-multistage-image-filter-using-heaps-and-events"
        },
        {
          "description" : "Synchronize access to resources in your app by signaling events.",
          "name" : "About synchronization events",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/about-synchronization-events"
        },
        {
          "description" : "Use nonshareable events to synchronize your app’s work within a single device.",
          "name" : "Synchronizing events within a single device",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/synchronizing-events-within-a-single-device"
        },
        {
          "description" : "Use shareable events to synchronize your app’s work across multiple devices or processes.",
          "name" : "Synchronizing events across multiple devices or processes",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/synchronizing-events-across-multiple-devices-or-processes"
        },
        {
          "description" : "A type that synchronizes memory operations to one or more resources within a single Metal device.",
          "name" : "MTLEvent",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLEvent"
        },
        {
          "description" : "A type that synchronizes memory operations to one or more resources across multiple CPUs, GPUs, and processes.",
          "name" : "MTLSharedEvent",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLSharedEvent"
        },
        {
          "description" : "An instance you use to recreate a shareable event.",
          "name" : "MTLSharedEventHandle",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLSharedEventHandle"
        },
        {
          "description" : "A listener for shareable event notifications.",
          "name" : "MTLSharedEventListener",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLSharedEventListener"
        },
        {
          "description" : "A block of code invoked after a shareable event’s signal value equals or exceeds a given value.",
          "name" : "MTLSharedEventNotificationBlock",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLSharedEventNotificationBlock"
        }
      ],
      "title" : "Synchronizing with events"
    }
  ],
  "source" : "appleJSON",
  "title" : "Synchronizing events between a GPU and the CPU",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/synchronizing-events-between-a-gpu-and-the-cpu"
}