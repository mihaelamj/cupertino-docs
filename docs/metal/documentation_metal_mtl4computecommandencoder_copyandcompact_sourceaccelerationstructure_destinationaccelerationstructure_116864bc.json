{
  "abstract" : "Encodes a command to copy and compact an acceleration structure.",
  "codeExamples" : [

  ],
  "contentHash" : "52a1278b3bab33bf1f5d1bcef78f6cd0df25e4603c187f157ba76583893c3f9c",
  "crawledAt" : "2025-12-05T11:51:30Z",
  "declaration" : {
    "code" : "func copyAndCompact(sourceAccelerationStructure: any MTLAccelerationStructure, destinationAccelerationStructure: any MTLAccelerationStructure)",
    "language" : "swift"
  },
  "id" : "1BC2B802-AABE-4E31-8E65-634AF850B1BE",
  "kind" : "method",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Discussion\n\nYou are responsible for ensuring that the source and destination acceleration structures don’t overlap in memory. If this is an instance acceleration structure, Metal preserves references to primitive acceleration structures it references.\n\nThis operation requires that the destination acceleration structure is at least as large as the compacted size of the source acceleration structure. You can compute this size by calling the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTL4ComputeCommandEncoder\/writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)] method.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)\ncrawled: 2025-12-05T11:51:30Z\n---\n\n# copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)\n\n**Instance Method**\n\nEncodes a command to copy and compact an acceleration structure.\n\n## Declaration\n\n```swift\nfunc copyAndCompact(sourceAccelerationStructure: any MTLAccelerationStructure, destinationAccelerationStructure: any MTLAccelerationStructure)\n```\n\n## Parameters\n\n- **sourceAccelerationStructure**: Acceleration structure to copy and compact.\n- **destinationAccelerationStructure**: Acceleration structure to copy to.\n\n## Discussion\n\nYou are responsible for ensuring that the source and destination acceleration structures don’t overlap in memory. If this is an instance acceleration structure, Metal preserves references to primitive acceleration structures it references.\n\nThis operation requires that the destination acceleration structure is at least as large as the compacted size of the source acceleration structure. You can compute this size by calling the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTL4ComputeCommandEncoder\/writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)] method.\n\n## Encoding acceleration structure copy commands\n\n- **copy(sourceAccelerationStructure:destinationAccelerationStructure:)**: Encodes an acceleration structure copy operation into the command buffer.\n- **writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)**: Encodes a command to compute the size an acceleration structure can compact into, writing the result into a buffer.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Encodes an acceleration structure copy operation into the command buffer.",
          "name" : "copy(sourceAccelerationStructure:destinationAccelerationStructure:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copy(sourceAccelerationStructure:destinationAccelerationStructure:)"
        },
        {
          "description" : "Encodes a command to compute the size an acceleration structure can compact into, writing the result into a buffer.",
          "name" : "writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/writeCompactedSize(sourceAccelerationStructure:destinationBuffer:)"
        }
      ],
      "title" : "Encoding acceleration structure copy commands"
    }
  ],
  "source" : "appleJSON",
  "title" : "copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4ComputeCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)"
}