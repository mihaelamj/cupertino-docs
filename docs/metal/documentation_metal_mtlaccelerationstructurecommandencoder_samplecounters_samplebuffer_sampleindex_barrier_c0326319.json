{
  "abstract" : "Encodes a command to sample hardware counters at this point in the acceleration structure pass and store the samples into a counter sample buffer.",
  "codeExamples" : [

  ],
  "contentHash" : "ef64323373c18e545ae21619b8a6c328df21bbd0f70bf1fda6f32e640633c6c7",
  "crawledAt" : "2025-12-05T10:25:52Z",
  "declaration" : {
    "code" : "func sampleCounters(sampleBuffer: any MTLCounterSampleBuffer, sampleIndex: Int, barrier: Bool)",
    "language" : "swift"
  },
  "id" : "A3D21A7D-237C-4DE0-B0F9-E12653457E57",
  "kind" : "method",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Discussion\n\nInserting a barrier ensures that any work you encoded with this encoder is complete before the GPU samples the hardware counters. If you don’t insert a barrier, the GPU can sample the counters concurrently with other commands encoded by this encoder. Using a barrier leads to more repeatable counter results but can negatively impact performance.\n\nRegardless of whether you set a barrier, the GPU doesn’t isolate the sampling from work encoded by other encoders.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/sampleCounters(sampleBuffer:sampleIndex:barrier:)\ncrawled: 2025-12-05T10:25:52Z\n---\n\n# sampleCounters(sampleBuffer:sampleIndex:barrier:)\n\n**Instance Method**\n\nEncodes a command to sample hardware counters at this point in the acceleration structure pass and store the samples into a counter sample buffer.\n\n## Declaration\n\n```swift\nfunc sampleCounters(sampleBuffer: any MTLCounterSampleBuffer, sampleIndex: Int, barrier: Bool)\n```\n\n## Parameters\n\n- **sampleBuffer**: The sample buffer to sample into.\n- **sampleIndex**: The index in the counter buffer to write the sample.\n- **barrier**: A Boolean value that states whether to insert a barrier before taking the sample.\n\n## Discussion\n\nInserting a barrier ensures that any work you encoded with this encoder is complete before the GPU samples the hardware counters. If you don’t insert a barrier, the GPU can sample the counters concurrently with other commands encoded by this encoder. Using a barrier leads to more repeatable counter results but can negatively impact performance.\n\nRegardless of whether you set a barrier, the GPU doesn’t isolate the sampling from work encoded by other encoders.\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "sampleCounters(sampleBuffer:sampleIndex:barrier:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/sampleCounters(sampleBuffer:sampleIndex:barrier:)"
}