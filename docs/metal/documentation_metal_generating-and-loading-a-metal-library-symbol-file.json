{
  "abstract" : "Debug your Metal shaders from your production apps by creating companion symbol files at compile time and loading them at debug time.",
  "codeExamples" : [
    {
      "code" : "% xcrun -sdk macosx metal -frecord-sources=flat Shadow.metal PointLights.metal DirectionalLight.metal",
      "language" : "shell"
    },
    {
      "code" : "% xcrun -sdk macosx metal -c -frecord-sources Shadow.metal\n% xcrun -sdk macosx metal -c -frecord-sources PointLights.metal\n% xcrun -sdk macosx metal -c -frecord-sources DirectionalLight.metal",
      "language" : "shell"
    },
    {
      "code" : "% xcrun -sdk macosx metal -frecord-sources -o LightsAndShadow.metallib Shadow.air PointLights.air DirectionalLight.air",
      "language" : "shell"
    },
    {
      "code" : "% xcrun -sdk macosx metal-dsymutil -flat -remove-source LightsAndShadow.metallib",
      "language" : "shell"
    }
  ],
  "contentHash" : "495185e72628868346313dc916afbd4845e629d4bd0d517b329ae1fdc438196b",
  "crawledAt" : "2025-12-03T14:49:45Z",
  "id" : "F91C2E45-45DC-4F33-B9B8-A499AC433D44",
  "kind" : "article",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nWith Xcode 13 or later, you can generate a separate symbol file for each Metal library built for a project. Each symbol file is a companion file that stores useful debugging information for the Metal library it represents. By separating each Metal library from its symbols, you can:\n\nSee [doc:\/\/com.apple.documentation\/documentation\/Xcode\/Debugging-the-shaders-within-a-draw-command-or-compute-dispatch] to learn how to debug your Metal shaders.\n\n### Generate a symbol file with a single command\n\nGenerate a Metal library’s symbol file in a single command by running the Metal compiler with the `-frecord-sources=flat` option.\n\nThe `-frecord-sources=flat` option, which replaces the deprecated `-MO=<value>` option, tells the Metal compiler to create two files:\n\n### Generate a symbol file with multiple commands\n\nYou can also generate a Metal library’s symbol file with multiple commands, which may be more appropriate for your workflow than the single-command technique. For those scenarios, you can generate each Metal library and its companion symbol file by following these steps:\n\nFirst, compile each Metal source file to a Metal IR file by passing the `-c` option to the compiler.\n\nThe `-frecord-sources` option tells the Metal compiler to embed the symbols in the IR output file for that command. However, this command doesn’t create a separate symbols file at this time, which is why the `-frecord-sources` option doesn’t include the `=flat` suffix.\n\nNext, generate a Metal library by linking the IR files.\n\nSeparate the sources from the library and create a companion symbol file by running the `metal-dsymutil` command.\n\nThe `-remove-source` option modifies the Metal library file by removing its embedded source information. At the same time, the command’s `-flat` option saves that source and other symbol information to a symbol file. After the command finishes execution, the directory contains both the modified Metal library and its new companion symbol file:\n\n### Load a symbol file in Xcode\n\nAs you debug a shader, Xcode automatically presents a prompt when it doesn’t have access to a shader library’s source code.\n\n\n\nClick the Import Sources button and select the shader’s companion symbol file.\n\n\n\nAdd your shader library’s companion symbol file by clicking the Add button (+) and locating the file. Select a directory to tell Xcode to find all companion symbol files that match any Metal libraries in the current Metal debugging capture. The dialog reflects each library’s symbol file in a list as you add them.\n\n\n\nClick Done when you finish adding your companion symbol files. Xcode imports the shader source and profiling information from each companion symbol file for the Metal library it represents.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/generating-and-loading-a-metal-library-symbol-file\ncrawled: 2025-12-03T14:49:45Z\n---\n\n# Generating and loading a Metal library symbol file\n\n**Article**\n\nDebug your Metal shaders from your production apps by creating companion symbol files at compile time and loading them at debug time.\n\n## Overview\n\nWith Xcode 13 or later, you can generate a separate symbol file for each Metal library built for a project. Each symbol file is a companion file that stores useful debugging information for the Metal library it represents. By separating each Metal library from its symbols, you can:\n\n- Build and deploy a Metal library without source code — a requirement for apps on the App Store.\n- Debug that same Metal library at a later time by loading its companion symbol file in Xcode.\n- Avoid building each library twice — once for release and then again for debugging.\n\nSee [doc:\/\/com.apple.documentation\/documentation\/Xcode\/Debugging-the-shaders-within-a-draw-command-or-compute-dispatch] to learn how to debug your Metal shaders.\n\n### Generate a symbol file with a single command\n\nGenerate a Metal library’s symbol file in a single command by running the Metal compiler with the `-frecord-sources=flat` option.\n\n```shell\n% xcrun -sdk macosx metal -frecord-sources=flat Shadow.metal PointLights.metal DirectionalLight.metal\n```\n\n\n\nThe `-frecord-sources=flat` option, which replaces the deprecated `-MO=<value>` option, tells the Metal compiler to create two files:\n\n- `default.metallib`, the compiled Metal library\n- `default.metallibsym`, the library’s companion symbol file\n\n### Generate a symbol file with multiple commands\n\nYou can also generate a Metal library’s symbol file with multiple commands, which may be more appropriate for your workflow than the single-command technique. For those scenarios, you can generate each Metal library and its companion symbol file by following these steps:\n\n1. Compile each Metal source file to a Metal IR (intermediate representation) file.\n2. Generate a Metal library with the source by linking its IR files.\n3. Separate the library’s source and save it as a companion symbol file.\n\nFirst, compile each Metal source file to a Metal IR file by passing the `-c` option to the compiler.\n\n```shell\n% xcrun -sdk macosx metal -c -frecord-sources Shadow.metal\n% xcrun -sdk macosx metal -c -frecord-sources PointLights.metal\n% xcrun -sdk macosx metal -c -frecord-sources DirectionalLight.metal\n```\n\nThe `-frecord-sources` option tells the Metal compiler to embed the symbols in the IR output file for that command. However, this command doesn’t create a separate symbols file at this time, which is why the `-frecord-sources` option doesn’t include the `=flat` suffix.\n\nNext, generate a Metal library by linking the IR files.\n\n```shell\n% xcrun -sdk macosx metal -frecord-sources -o LightsAndShadow.metallib Shadow.air PointLights.air DirectionalLight.air\n```\n\nSeparate the sources from the library and create a companion symbol file by running the `metal-dsymutil` command.\n\n```shell\n% xcrun -sdk macosx metal-dsymutil -flat -remove-source LightsAndShadow.metallib\n```\n\nThe `-remove-source` option modifies the Metal library file by removing its embedded source information. At the same time, the command’s `-flat` option saves that source and other symbol information to a symbol file. After the command finishes execution, the directory contains both the modified Metal library and its new companion symbol file:\n\n- `LightsAndShadow.metallib`\n- `LightsAndShadow.metallibsym`\n\n\n\n### Load a symbol file in Xcode\n\nAs you debug a shader, Xcode automatically presents a prompt when it doesn’t have access to a shader library’s source code.\n\n\n\nClick the Import Sources button and select the shader’s companion symbol file.\n\n\n\nAdd your shader library’s companion symbol file by clicking the Add button (+) and locating the file. Select a directory to tell Xcode to find all companion symbol files that match any Metal libraries in the current Metal debugging capture. The dialog reflects each library’s symbol file in a list as you add them.\n\n\n\nClick Done when you finish adding your companion symbol files. Xcode imports the shader source and profiling information from each companion symbol file for the Metal library it represents.\n\n\n\n## Working with Metal intermediate representation libraries\n\n- **Building a shader library by precompiling source files**: Create a shader library that you can add to an Xcode project with the Metal compiler tools in a command-line environment.\n- **Minimizing the binary size of a shader library**: Reduce the storage footprint of your shaders, and potentially reduce their compile time, by selecting the Metal compiler’s size optimization option.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Create a shader library that you can add to an Xcode project with the Metal compiler tools in a command-line environment.",
          "name" : "Building a shader library by precompiling source files",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/building-a-shader-library-by-precompiling-source-files"
        },
        {
          "description" : "Reduce the storage footprint of your shaders, and potentially reduce their compile time, by selecting the Metal compiler’s size optimization option.",
          "name" : "Minimizing the binary size of a shader library",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/minimizing-the-binary-size-of-a-shader-library"
        }
      ],
      "title" : "Working with Metal intermediate representation libraries"
    }
  ],
  "source" : "appleJSON",
  "title" : "Generating and loading a Metal library symbol file",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/generating-and-loading-a-metal-library-symbol-file"
}