{
  "abstract" : "Draw with Metal and OpenGL in the same view using an interoperable texture.",
  "codeExamples" : [
    {
      "code" : "for(int i = 0; i < AAPLNumInteropFormats; i++) {\n    if(pixelFormat == AAPLInteropFormatTable[i].mtlFormat) {\n        return &AAPLInteropFormatTable[i];\n    }\n}",
      "language" : "objective-c"
    },
    {
      "code" : "NSDictionary* cvBufferProperties = @{\n    (__bridge NSString*)kCVPixelBufferOpenGLCompatibilityKey : @YES,\n    (__bridge NSString*)kCVPixelBufferMetalCompatibilityKey : @YES,\n};\nCVReturn cvret = CVPixelBufferCreate(kCFAllocatorDefault,\n                        size.width, size.height,\n                        _formatInfo->cvPixelFormat,\n                        (__bridge CFDictionaryRef)cvBufferProperties,\n                        &_CVPixelBuffer);",
      "language" : "objective-c"
    },
    {
      "code" : "cvret  = CVOpenGLTextureCacheCreate(\n                kCFAllocatorDefault,\n                nil,\n                _openGLContext.CGLContextObj,\n                _CGLPixelFormat,\n                nil,\n                &_CVGLTextureCache);",
      "language" : "objective-c"
    },
    {
      "code" : "cvret = CVOpenGLTextureCacheCreateTextureFromImage(\n                kCFAllocatorDefault,\n                _CVGLTextureCache,\n                _CVPixelBuffer,\n                nil,\n                &_CVGLTexture);",
      "language" : "objective-c"
    },
    {
      "code" : "_openGLTexture = CVOpenGLTextureGetName(_CVGLTexture);",
      "language" : "objective-c"
    },
    {
      "code" : "cvret = CVOpenGLESTextureCacheCreate(kCFAllocatorDefault,\n                nil,\n                _openGLContext,\n                nil,\n                &_CVGLTextureCache);",
      "language" : "objective-c"
    },
    {
      "code" : "cvret = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault,\n                _CVGLTextureCache,\n                _CVPixelBuffer,\n                nil,\n                GL_TEXTURE_2D,\n                _formatInfo->glInternalFormat,\n                _size.width, _size.height,\n                _formatInfo->glFormat,\n                _formatInfo->glType,\n                0,\n                &_CVGLTexture);",
      "language" : "objective-c"
    },
    {
      "code" : "_openGLTexture = CVOpenGLESTextureGetName(_CVGLTexture);",
      "language" : "objective-c"
    },
    {
      "code" : "cvret = CVMetalTextureCacheCreate(\n                kCFAllocatorDefault,\n                nil,\n                _metalDevice,\n                nil,\n                &_CVMTLTextureCache);",
      "language" : "objective-c"
    },
    {
      "code" : "cvret = CVMetalTextureCacheCreateTextureFromImage(\n                kCFAllocatorDefault,\n                _CVMTLTextureCache,\n                _CVPixelBuffer, nil,\n                _formatInfo->mtlFormat,\n                _size.width, _size.height,\n                0,\n                &_CVMTLTexture);",
      "language" : "objective-c"
    },
    {
      "code" : "_metalTexture = CVMetalTextureGetTexture(_CVMTLTexture);",
      "language" : "objective-c"
    }
  ],
  "contentHash" : "29bf0a3e67c8459dc4b0840089cfb5ddcf2979a4b01bdceb6194d03c0d47358f",
  "crawledAt" : "2025-12-02T15:31:23Z",
  "id" : "6DC89529-5DB4-4CF8-941D-8F21DD0D34D7",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nIf you’re developing a new app and migrating legacy OpenGL code to Metal, interoperable textures make it easy for you to see the results live as you go.\n\nYou can render Metal or OpenGL content into either view by initializing a [doc:\/\/com.apple.documentation\/documentation\/CoreVideo\/cvpixelbuffer-q2e] that operates as an interoperable texture. When you enable the pixel buffer’s Metal and OpenGL compatibility flags, the textures are capable of being drawn to—and presented by—either rendering technology.\n\nIf you’re working with an app you’ve already deployed, the interoperable textures give you the option of incrementally releasing updates throughout the porting process.\n\n### Getting started\n\nInteroperating with Metal and OpenGL requires macOS 10.13 or greater or iOS 11 or greater.\n\n### Select a compatible pixel format\n\nTo create an interoperable texture, select a Core Video  pixel format, a Metal pixel format, and an OpenGL internal format that are compatible with each other. This sample provides you with a table preloaded with compatible options, and selects one based on the desired Metal pixel format:\n\n### Create an interoperable texture\n\nUse a `CVPixelBuffer` as an interoperable texture to get a shared memory backing that’s synchronized across both renderers. To create the `CVPixelBuffer`, provide your Core Video  pixel format and enable OpenGL and Metal compatibility:\n\n### Create an OpenGL texture from the pixel buffer in macOS\n\nStart by creating an OpenGL Core Video texture cache from the pixel buffer:\n\nThen, create a `CVPixelBuffer`-backed OpenGL texture image from the texture cache:\n\nFinally, get an OpenGL texture name from the `CVPixelBuffer`-backed OpenGL texture image:\n\n### Create an OpenGL ES texture from the pixel buffer in iOS\n\nStart by creating an OpenGL `ES` Core Video  texture cache from the pixel buffer:\n\nThen, create a `CVPixelBuffer`-backed OpenGL `ES` texture image from the texture cache:\n\nFinally, get an OpenGL `ES` texture name from the `CVPixelBuffer`-backed OpenGL `ES` texture image:\n\n### Create a Metal texture from the pixel buffer\n\nStart by instantiating a Metal texture cache as follows:\n\nThen, create a `CVPixelBuffer`-backed Metal texture image from the texture cache:\n\nFinally, get a Metal texture using the Core Video  Metal texture reference:\n\n### Draw Metal content in an OpenGL view\n\nWhen porting your app, statement by statement, begin by using Metal to render into an interoperable pixel buffer that OpenGL can draw. Each item in the following list describes the corresponding numbered area in the figure that follows:\n\n\n\n### Draw OpenGL content in a Metal view\n\nDraw OpenGL content into a Metal view when you’re ready to use Metal but have some legacy OpenGL code that you intend to port incrementally. Each item in the following list describes the corresponding numbered area in the figure that follows:\n\n",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/mixing-metal-and-opengl-rendering-in-a-view\ncrawled: 2025-12-02T15:31:23Z\n---\n\n# Mixing Metal and OpenGL rendering in a view\n\n**Sample Code**\n\nDraw with Metal and OpenGL in the same view using an interoperable texture.\n\n## Overview\n\nIf you’re developing a new app and migrating legacy OpenGL code to Metal, interoperable textures make it easy for you to see the results live as you go.\n\nYou can render Metal or OpenGL content into either view by initializing a [doc:\/\/com.apple.documentation\/documentation\/CoreVideo\/cvpixelbuffer-q2e] that operates as an interoperable texture. When you enable the pixel buffer’s Metal and OpenGL compatibility flags, the textures are capable of being drawn to—and presented by—either rendering technology.\n\nIf you’re working with an app you’ve already deployed, the interoperable textures give you the option of incrementally releasing updates throughout the porting process.\n\n### Getting started\n\nInteroperating with Metal and OpenGL requires macOS 10.13 or greater or iOS 11 or greater.\n\n### Select a compatible pixel format\n\nTo create an interoperable texture, select a Core Video  pixel format, a Metal pixel format, and an OpenGL internal format that are compatible with each other. This sample provides you with a table preloaded with compatible options, and selects one based on the desired Metal pixel format:\n\n```objective-c\nfor(int i = 0; i < AAPLNumInteropFormats; i++) {\n    if(pixelFormat == AAPLInteropFormatTable[i].mtlFormat) {\n        return &AAPLInteropFormatTable[i];\n    }\n}\n```\n\n### Create an interoperable texture\n\nUse a `CVPixelBuffer` as an interoperable texture to get a shared memory backing that’s synchronized across both renderers. To create the `CVPixelBuffer`, provide your Core Video  pixel format and enable OpenGL and Metal compatibility:\n\n```objective-c\nNSDictionary* cvBufferProperties = @{\n    (__bridge NSString*)kCVPixelBufferOpenGLCompatibilityKey : @YES,\n    (__bridge NSString*)kCVPixelBufferMetalCompatibilityKey : @YES,\n};\nCVReturn cvret = CVPixelBufferCreate(kCFAllocatorDefault,\n                        size.width, size.height,\n                        _formatInfo->cvPixelFormat,\n                        (__bridge CFDictionaryRef)cvBufferProperties,\n                        &_CVPixelBuffer);\n```\n\n### Create an OpenGL texture from the pixel buffer in macOS\n\nStart by creating an OpenGL Core Video texture cache from the pixel buffer:\n\n```objective-c\ncvret  = CVOpenGLTextureCacheCreate(\n                kCFAllocatorDefault,\n                nil,\n                _openGLContext.CGLContextObj,\n                _CGLPixelFormat,\n                nil,\n                &_CVGLTextureCache);\n```\n\nThen, create a `CVPixelBuffer`-backed OpenGL texture image from the texture cache:\n\n```objective-c\ncvret = CVOpenGLTextureCacheCreateTextureFromImage(\n                kCFAllocatorDefault,\n                _CVGLTextureCache,\n                _CVPixelBuffer,\n                nil,\n                &_CVGLTexture);\n```\n\nFinally, get an OpenGL texture name from the `CVPixelBuffer`-backed OpenGL texture image:\n\n```objective-c\n_openGLTexture = CVOpenGLTextureGetName(_CVGLTexture);\n```\n\n### Create an OpenGL ES texture from the pixel buffer in iOS\n\nStart by creating an OpenGL `ES` Core Video  texture cache from the pixel buffer:\n\n```objective-c\ncvret = CVOpenGLESTextureCacheCreate(kCFAllocatorDefault,\n                nil,\n                _openGLContext,\n                nil,\n                &_CVGLTextureCache);\n```\n\nThen, create a `CVPixelBuffer`-backed OpenGL `ES` texture image from the texture cache:\n\n```objective-c\ncvret = CVOpenGLESTextureCacheCreateTextureFromImage(kCFAllocatorDefault,\n                _CVGLTextureCache,\n                _CVPixelBuffer,\n                nil,\n                GL_TEXTURE_2D,\n                _formatInfo->glInternalFormat,\n                _size.width, _size.height,\n                _formatInfo->glFormat,\n                _formatInfo->glType,\n                0,\n                &_CVGLTexture);\n```\n\nFinally, get an OpenGL `ES` texture name from the `CVPixelBuffer`-backed OpenGL `ES` texture image:\n\n```objective-c\n_openGLTexture = CVOpenGLESTextureGetName(_CVGLTexture);\n```\n\n### Create a Metal texture from the pixel buffer\n\nStart by instantiating a Metal texture cache as follows:\n\n```objective-c\ncvret = CVMetalTextureCacheCreate(\n                kCFAllocatorDefault,\n                nil,\n                _metalDevice,\n                nil,\n                &_CVMTLTextureCache);\n```\n\nThen, create a `CVPixelBuffer`-backed Metal texture image from the texture cache:\n\n```objective-c\ncvret = CVMetalTextureCacheCreateTextureFromImage(\n                kCFAllocatorDefault,\n                _CVMTLTextureCache,\n                _CVPixelBuffer, nil,\n                _formatInfo->mtlFormat,\n                _size.width, _size.height,\n                0,\n                &_CVMTLTexture);\n```\n\nFinally, get a Metal texture using the Core Video  Metal texture reference:\n\n```objective-c\n_metalTexture = CVMetalTextureGetTexture(_CVMTLTexture);\n```\n\n### Draw Metal content in an OpenGL view\n\nWhen porting your app, statement by statement, begin by using Metal to render into an interoperable pixel buffer that OpenGL can draw. Each item in the following list describes the corresponding numbered area in the figure that follows:\n\n1. Metal clears the interoperable texture by applying a green color.\n2. Metal renders a quad with white text and color swatch onto the interoperable texture.\n3. OpenGL clears the background by applying a red color.\n4. OpenGL renders a quad with black text and the interoperable texture.\n\n\n\n### Draw OpenGL content in a Metal view\n\nDraw OpenGL content into a Metal view when you’re ready to use Metal but have some legacy OpenGL code that you intend to port incrementally. Each item in the following list describes the corresponding numbered area in the figure that follows:\n\n1. OpenGL clears the interoperable texture by applying a red color.\n2. OpenGL renders a quad with white text and color swatch onto the interoperable texture.\n3. Metal clears the background by applying a green color.\n4. Metal renders a quad with black text and the interoperable texture.\n\n\n\n## OpenGL\n\n- **Migrating OpenGL code to Metal**: Replace your app’s deprecated OpenGL code with Metal.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Replace your app’s deprecated OpenGL code with Metal.",
          "name" : "Migrating OpenGL code to Metal",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/migrating-opengl-code-to-metal"
        }
      ],
      "title" : "OpenGL"
    }
  ],
  "source" : "appleJSON",
  "title" : "Mixing Metal and OpenGL rendering in a view",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/mixing-metal-and-opengl-rendering-in-a-view"
}