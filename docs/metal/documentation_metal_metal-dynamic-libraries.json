{
  "abstract" : "Create a single Metal library containing reusable code to reduce library size and avoid repeated shader compilation at runtime.",
  "codeExamples" : [

  ],
  "contentHash" : "dadecd5882bb15e112ebe3e2ff44409cbacccdaa6f8d972f523cfcb6f70281af",
  "crawledAt" : "2025-12-02T20:03:31Z",
  "id" : "1E4D495A-5145-4EE4-ACBB-33EC0E0A2822",
  "kind" : "collection",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nAs shaders grow in size, complexity, and scope, they often end up sharing utility functions. Under the default compilation model in Metal, linking embeds libraries, similar to static linking with the LLVM linker. For Metal, embedding libraries in this manner has two consequences: an increase in binary size, and an increase in compilation time. As each library loads, it compiles its own version of any utility functions, meaning Metal compiles and duplicates your utility functions multiple times.\n\nTo avoid this problem, Metal offers dynamic libraries, similar to an LLVM dynamically shared library. Your app loads and compiles dynamic libraries for the device GPU once, the first time a shader requests them. Subsequent shader calls use these compiled utility functions instead of compiling a separate version of the same shader binary.\n\nTo support Metal dynamic libraries in your app, call [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice\/makeDynamicLibrary(library:)] with a dynamic library that you bundle as part of your app. Then add it to a pipeline descriptor’s dynamic library information through a property like [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLComputePipelineDescriptor\/preloadedLibraries].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/metal-dynamic-libraries\ncrawled: 2025-12-02T20:03:31Z\n---\n\n# Metal dynamic libraries\n\nCreate a single Metal library containing reusable code to reduce library size and avoid repeated shader compilation at runtime.\n\n## Overview\n\nAs shaders grow in size, complexity, and scope, they often end up sharing utility functions. Under the default compilation model in Metal, linking embeds libraries, similar to static linking with the LLVM linker. For Metal, embedding libraries in this manner has two consequences: an increase in binary size, and an increase in compilation time. As each library loads, it compiles its own version of any utility functions, meaning Metal compiles and duplicates your utility functions multiple times.\n\nTo avoid this problem, Metal offers dynamic libraries, similar to an LLVM dynamically shared library. Your app loads and compiles dynamic libraries for the device GPU once, the first time a shader requests them. Subsequent shader calls use these compiled utility functions instead of compiling a separate version of the same shader binary.\n\nTo support Metal dynamic libraries in your app, call [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice\/makeDynamicLibrary(library:)] with a dynamic library that you bundle as part of your app. Then add it to a pipeline descriptor’s dynamic library information through a property like [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLComputePipelineDescriptor\/preloadedLibraries].\n\n## Working with Metal dynamic libraries\n\n- **Compiling and linking Metal dynamic libraries**: Build a Metal dynamic library from the command line, allowing for runtime loading of shared shaders.\n- **Creating a Metal dynamic library**: Compile a library of shaders and write it to a file as a dynamically linked library.\n\n## Shader compilation\n\n- **Metal libraries**: Compile and manage Metal libraries from the command line.\n- **Metal binary archives**: Distribute precompiled GPU-specific binaries as part of your app to avoid runtime compilation of Metal shaders.\n- **MTL4Compiler**: A abstraction for a pipeline state and shader function compiler.\n- **MTL4CompilerDescriptor**: Groups together properties for creating a compiler context.\n- **MTL4CompilerTaskOptions**: The configuration options that control the behavior of a compilation task for a Metal 4 compiler instance.\n- **MTL4CompilerTaskStatus**: Represents the status of a compiler task.\n- **MTL4Archive**: A read-only container that stores pipeline states from a shader compiler.\n- **MTL4BinaryFunction**: Represents a binary function.\n- **MTL4BinaryFunctionDescriptor**: Base interface for other function-derived interfaces.\n- **MTL4BinaryFunctionOptions**: Options for configuring the creation of binary functions.\n- **MTL4PipelineStageDynamicLinkingDescriptor**: Groups together properties to drive the dynamic linking process of a pipeline stage.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Build a Metal dynamic library from the command line, allowing for runtime loading of shared shaders.",
          "name" : "Compiling and linking Metal dynamic libraries",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/compiling-and-linking-metal-dynamic-libraries"
        },
        {
          "description" : "Compile a library of shaders and write it to a file as a dynamically linked library.",
          "name" : "Creating a Metal dynamic library",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/creating-a-metal-dynamic-library"
        }
      ],
      "title" : "Working with Metal dynamic libraries"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Compile and manage Metal libraries from the command line.",
          "name" : "Metal libraries",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/metal-libraries"
        },
        {
          "description" : "Distribute precompiled GPU-specific binaries as part of your app to avoid runtime compilation of Metal shaders.",
          "name" : "Metal binary archives",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/metal-binary-archives"
        },
        {
          "description" : "A abstraction for a pipeline state and shader function compiler.",
          "name" : "MTL4Compiler",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4Compiler"
        },
        {
          "description" : "Groups together properties for creating a compiler context.",
          "name" : "MTL4CompilerDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4CompilerDescriptor"
        },
        {
          "description" : "The configuration options that control the behavior of a compilation task for a Metal 4 compiler instance.",
          "name" : "MTL4CompilerTaskOptions",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4CompilerTaskOptions"
        },
        {
          "description" : "Represents the status of a compiler task.",
          "name" : "MTL4CompilerTaskStatus",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4CompilerTaskStatus"
        },
        {
          "description" : "A read-only container that stores pipeline states from a shader compiler.",
          "name" : "MTL4Archive",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4Archive"
        },
        {
          "description" : "Represents a binary function.",
          "name" : "MTL4BinaryFunction",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4BinaryFunction"
        },
        {
          "description" : "Base interface for other function-derived interfaces.",
          "name" : "MTL4BinaryFunctionDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4BinaryFunctionDescriptor"
        },
        {
          "description" : "Options for configuring the creation of binary functions.",
          "name" : "MTL4BinaryFunctionOptions",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4BinaryFunctionOptions"
        },
        {
          "description" : "Groups together properties to drive the dynamic linking process of a pipeline stage.",
          "name" : "MTL4PipelineStageDynamicLinkingDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTL4PipelineStageDynamicLinkingDescriptor"
        }
      ],
      "title" : "Shader compilation"
    }
  ],
  "source" : "appleJSON",
  "title" : "Metal dynamic libraries",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/metal-dynamic-libraries"
}