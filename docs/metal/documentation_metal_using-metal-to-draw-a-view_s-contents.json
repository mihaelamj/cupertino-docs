{
  "abstract" : "Create a MetalKit view and a render pass to draw the view’s contents.",
  "codeExamples" : [
    {
      "code" : "_view.device = MTLCreateSystemDefaultDevice();",
      "language" : "objective-c"
    },
    {
      "code" : "_view.clearColor = MTLClearColorMake(0.0, 0.5, 1.0, 1.0);",
      "language" : "objective-c"
    },
    {
      "code" : "_view.enableSetNeedsDisplay = YES;",
      "language" : "objective-c"
    },
    {
      "code" : "_view.delegate = _renderer;",
      "language" : "objective-c"
    },
    {
      "code" : "MTLRenderPassDescriptor *renderPassDescriptor = view.currentRenderPassDescriptor;\nif (renderPassDescriptor == nil)\n{\n    return;\n}",
      "language" : "objective-c"
    },
    {
      "code" : "id<MTLRenderCommandEncoder> commandEncoder = [commandBuffer renderCommandEncoderWithDescriptor:renderPassDescriptor];",
      "language" : "objective-c"
    },
    {
      "code" : "[commandEncoder endEncoding];",
      "language" : "objective-c"
    },
    {
      "code" : "id<MTLDrawable> drawable = view.currentDrawable;",
      "language" : "objective-c"
    },
    {
      "code" : "[commandBuffer presentDrawable:drawable];",
      "language" : "objective-c"
    },
    {
      "code" : "[commandBuffer commit];",
      "language" : "objective-c"
    }
  ],
  "contentHash" : "9059e0bfcdbfa5fd5fb261d38b59c12075353224b3df8c2599c15f8c194b05c2",
  "crawledAt" : "2025-12-02T16:00:46Z",
  "id" : "08B93BE1-21C7-46EA-883F-86F8C43DB398",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nIn this sample, you’ll learn the basics of rendering graphics content with Metal. You’ll use the MetalKit framework to create a view that uses Metal to draw the contents of the view.  Then, you’ll encode commands for a render pass that erases the view to a background color.\n\n### Prepare a MetalKit view to draw\n\nMetalKit provides a class called [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView], which is a subclass of [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSView] (in macOS) or [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView] (in iOS and tvOS). `MTKView` handles many of the details related to getting the content you draw with Metal onto the screen.\n\nAn `MTKView` needs a reference to a Metal device object in order to create resources internally, so your first step is to set the view’s [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView\/device] property to an existing [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice].\n\nOther properties on `MTKView` allow you to control its behavior. To erase the contents of the view to a solid background color, you set its [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView\/clearColor] property. You create the color using the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLClearColorMake(_:_:_:_:)] function, specifying the red, green, blue, and alpha values.\n\nBecause you won’t be drawing animated content in this sample, configure the view so that it only draws when the contents need to be updated, such as when the view changes shape:\n\n### Delegate drawing responsibilities\n\n`MTKView` relies on your app to issue commands to Metal to produce visual content. `MTKView` uses the delegate pattern to inform your app when it should draw. To receive delegate callbacks, set the view’s `delegate` property to an object that conforms to the [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKViewDelegate] protocol.\n\nThe delegate implements two methods:\n\nIn this sample, a class called `AAPLRenderer` implements the delegate methods and takes on the responsibility of drawing. The view controller creates an instance of this class and sets it as the view’s delegate.\n\n### Create a render pass descriptor\n\nWhen you draw, the GPU stores the results into *textures*, which are blocks of memory that contain image data and are accessible to the GPU. In this sample, the `MTKView` creates all of the textures you need to draw into the view. It creates multiple textures so that it can display the contents of one texture while you render into another.\n\nTo draw, you create a *render pass*, which is a sequence of rendering commands that draw into a set of textures. When used in a render pass, textures are also called *render targets*. To create a render pass, you need a render pass descriptor, an instance of [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRenderPassDescriptor]. In this sample, rather than configuring your own render pass descriptor, ask the MetalKit view to create one for you.\n\nA render pass descriptor describes the set of render targets, and how they should be processed at the start and end of the render pass. Render passes also define some other aspects of rendering that aren’t part of this sample. The view returns a render pass descriptor with a single color attachment that points to one of the view’s textures, and otherwise configures the render pass based on the view’s properties. By default, this means that at the start of the render pass, the render target is erased to a solid color that matches the view’s `clearColor` property, and at the end of the render pass, all changes are stored back to the texture.\n\nBecause a view’s render pass descriptor might be `nil`, you should test to make sure the render pass descriptor object is non-`nil` before creating the render pass.\n\n### Create a render pass\n\nYou create the render pass by encoding it into the command buffer using a  [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRenderCommandEncoder] object. Call the command buffer’s [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/makeRenderCommandEncoder(descriptor:)] method and pass in the render pass descriptor.\n\nIn this sample, you don’t encode any drawing commands, so the only thing the render pass does is erase the texture. Call the encoder’s `endEncoding` method to indicate that the pass is complete.\n\n### Present a drawable to the screen\n\nDrawing to a texture doesn’t automatically display the new contents onscreen. In fact, only some textures can be presented onscreen. In Metal, textures that can be displayed onscreen are managed by *drawable objects*, and to display the content, you present the drawable.\n\n`MTKView` automatically creates drawable objects to manage its textures. Read the [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView\/currentDrawable] property to get the drawable that owns the texture that is the render pass’s target. The view returns a [doc:\/\/com.apple.documentation\/documentation\/QuartzCore\/CAMetalDrawable] object, an object connected to Core Animation.\n\nCall the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/present(_:)] method on the command buffer, passing in the drawable.\n\nThis method tells Metal that when the command buffer is scheduled for execution, Metal should coordinate with Core Animation to display the texture after rendering completes. When Core Animation presents the texture, it becomes the view’s new contents. In this sample, this means that the erased texture becomes the new background for the view. The change happens alongside any other visual updates that Core Animation makes for onscreen user interface elements.\n\n### Commit the command buffer\n\nNow that you’ve issued all the commands for the frame, commit the command buffer.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/using-metal-to-draw-a-view's-contents\ncrawled: 2025-12-02T16:00:46Z\n---\n\n# Using Metal to draw a view’s contents\n\n**Sample Code**\n\nCreate a MetalKit view and a render pass to draw the view’s contents.\n\n## Overview\n\nIn this sample, you’ll learn the basics of rendering graphics content with Metal. You’ll use the MetalKit framework to create a view that uses Metal to draw the contents of the view.  Then, you’ll encode commands for a render pass that erases the view to a background color.\n\n\n\n### Prepare a MetalKit view to draw\n\nMetalKit provides a class called [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView], which is a subclass of [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSView] (in macOS) or [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView] (in iOS and tvOS). `MTKView` handles many of the details related to getting the content you draw with Metal onto the screen.\n\nAn `MTKView` needs a reference to a Metal device object in order to create resources internally, so your first step is to set the view’s [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView\/device] property to an existing [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice].\n\n```objective-c\n_view.device = MTLCreateSystemDefaultDevice();\n```\n\nOther properties on `MTKView` allow you to control its behavior. To erase the contents of the view to a solid background color, you set its [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView\/clearColor] property. You create the color using the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLClearColorMake(_:_:_:_:)] function, specifying the red, green, blue, and alpha values.\n\n```objective-c\n_view.clearColor = MTLClearColorMake(0.0, 0.5, 1.0, 1.0);\n```\n\nBecause you won’t be drawing animated content in this sample, configure the view so that it only draws when the contents need to be updated, such as when the view changes shape:\n\n```objective-c\n_view.enableSetNeedsDisplay = YES;\n```\n\n### Delegate drawing responsibilities\n\n`MTKView` relies on your app to issue commands to Metal to produce visual content. `MTKView` uses the delegate pattern to inform your app when it should draw. To receive delegate callbacks, set the view’s `delegate` property to an object that conforms to the [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKViewDelegate] protocol.\n\n```objective-c\n_view.delegate = _renderer;\n```\n\nThe delegate implements two methods:\n\n- The view calls the [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKViewDelegate\/mtkView(_:drawableSizeWillChange:)] method whenever the size of the contents changes. This happens when the window containing the view is resized, or when the device orientation changes (on iOS). This allows your app to adapt the resolution at which it renders to the size of the view.\n- The view calls the [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKViewDelegate\/draw(in:)] method whenever it’s time to update the view’s contents. In this method, you create a command buffer, encode commands that tell the GPU what to draw and when to display it onscreen, and enqueue that command buffer to be executed by the GPU. This is sometimes referred to as drawing a frame. You can think of a frame as all of the work that goes into producing a single image that gets displayed on the screen. In an interactive app, like a game, you might draw many frames per second.\n\nIn this sample, a class called `AAPLRenderer` implements the delegate methods and takes on the responsibility of drawing. The view controller creates an instance of this class and sets it as the view’s delegate.\n\n### Create a render pass descriptor\n\nWhen you draw, the GPU stores the results into *textures*, which are blocks of memory that contain image data and are accessible to the GPU. In this sample, the `MTKView` creates all of the textures you need to draw into the view. It creates multiple textures so that it can display the contents of one texture while you render into another.\n\nTo draw, you create a *render pass*, which is a sequence of rendering commands that draw into a set of textures. When used in a render pass, textures are also called *render targets*. To create a render pass, you need a render pass descriptor, an instance of [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRenderPassDescriptor]. In this sample, rather than configuring your own render pass descriptor, ask the MetalKit view to create one for you.\n\n```objective-c\nMTLRenderPassDescriptor *renderPassDescriptor = view.currentRenderPassDescriptor;\nif (renderPassDescriptor == nil)\n{\n    return;\n}\n```\n\nA render pass descriptor describes the set of render targets, and how they should be processed at the start and end of the render pass. Render passes also define some other aspects of rendering that aren’t part of this sample. The view returns a render pass descriptor with a single color attachment that points to one of the view’s textures, and otherwise configures the render pass based on the view’s properties. By default, this means that at the start of the render pass, the render target is erased to a solid color that matches the view’s `clearColor` property, and at the end of the render pass, all changes are stored back to the texture.\n\nBecause a view’s render pass descriptor might be `nil`, you should test to make sure the render pass descriptor object is non-`nil` before creating the render pass.\n\n### Create a render pass\n\nYou create the render pass by encoding it into the command buffer using a  [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRenderCommandEncoder] object. Call the command buffer’s [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/makeRenderCommandEncoder(descriptor:)] method and pass in the render pass descriptor.\n\n```objective-c\nid<MTLRenderCommandEncoder> commandEncoder = [commandBuffer renderCommandEncoderWithDescriptor:renderPassDescriptor];\n```\n\nIn this sample, you don’t encode any drawing commands, so the only thing the render pass does is erase the texture. Call the encoder’s `endEncoding` method to indicate that the pass is complete.\n\n```objective-c\n[commandEncoder endEncoding];\n```\n\n### Present a drawable to the screen\n\nDrawing to a texture doesn’t automatically display the new contents onscreen. In fact, only some textures can be presented onscreen. In Metal, textures that can be displayed onscreen are managed by *drawable objects*, and to display the content, you present the drawable.\n\n`MTKView` automatically creates drawable objects to manage its textures. Read the [doc:\/\/com.apple.documentation\/documentation\/MetalKit\/MTKView\/currentDrawable] property to get the drawable that owns the texture that is the render pass’s target. The view returns a [doc:\/\/com.apple.documentation\/documentation\/QuartzCore\/CAMetalDrawable] object, an object connected to Core Animation.\n\n```objective-c\nid<MTLDrawable> drawable = view.currentDrawable;\n```\n\nCall the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/present(_:)] method on the command buffer, passing in the drawable.\n\n```objective-c\n[commandBuffer presentDrawable:drawable];\n```\n\nThis method tells Metal that when the command buffer is scheduled for execution, Metal should coordinate with Core Animation to display the texture after rendering completes. When Core Animation presents the texture, it becomes the view’s new contents. In this sample, this means that the erased texture becomes the new background for the view. The change happens alongside any other visual updates that Core Animation makes for onscreen user interface elements.\n\n### Commit the command buffer\n\nNow that you’ve issued all the commands for the frame, commit the command buffer.\n\n```objective-c\n[commandBuffer commit];\n```\n\n## Essentials\n\n- **Understanding the Metal 4 core API**: Discover the features and functionality in the Metal 4 foundational APIs.\n- **Drawing a triangle with Metal 4**: Render a colorful, rotating 2D triangle by running draw commands with a render pipeline on a GPU.\n- **Performing calculations on a GPU**: Use Metal to find GPUs and perform calculations on them.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Discover the features and functionality in the Metal 4 foundational APIs.",
          "name" : "Understanding the Metal 4 core API",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/understanding-the-metal-4-core-api"
        },
        {
          "description" : "Render a colorful, rotating 2D triangle by running draw commands with a render pipeline on a GPU.",
          "name" : "Drawing a triangle with Metal 4",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/drawing-a-triangle-with-metal-4"
        },
        {
          "description" : "Use Metal to find GPUs and perform calculations on them.",
          "name" : "Performing calculations on a GPU",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/performing-calculations-on-a-gpu"
        }
      ],
      "title" : "Essentials"
    }
  ],
  "source" : "appleJSON",
  "title" : "Using Metal to draw a view’s contents",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/using-metal-to-draw-a-view's-contents"
}