{
  "abstract" : "Registers a completion handler the GPU device calls immediately after the GPU finishes running the commands in the command buffer.",
  "codeExamples" : [

  ],
  "contentHash" : "773925f0fcb6d2e3ba05fa1c77e1e849fca00711cb09acee50a59618e8bdb259",
  "crawledAt" : "2025-12-04T23:36:53Z",
  "declaration" : {
    "code" : "func addCompletedHandler(_ block: @escaping MTLCommandBufferHandler)",
    "language" : "swift"
  },
  "id" : "8A4B1D13-6B11-4A98-AA30-115D51EE128E",
  "kind" : "method",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Discussion\n\nYou can register one or more completion handlers for the same command buffer. The GPU device’s driver (on the CPU) calls the completion handlers after the GPU finishes executing the command buffer.\n\nFor example, you can use the command buffer’s [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/gpuEndTime] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/gpuStartTime] properties to calculate how much time the GPU spends running the command buffer.\n\nThe completion handler is also a good place to check the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/status] property to determine whether the GPU successfully completes the buffer’s commands. If the status is equal to [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBufferStatus\/error], you can investigate further by checking the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/error] and log properties for more details about the issue. See [doc:\/\/com.apple.metal\/documentation\/Metal\/command-buffer-debugging] for more methods and properties that can help you isolate the issue.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/MTLCommandBuffer\/addCompletedHandler(_:)\ncrawled: 2025-12-04T23:36:53Z\n---\n\n# addCompletedHandler(_:)\n\n**Instance Method**\n\nRegisters a completion handler the GPU device calls immediately after the GPU finishes running the commands in the command buffer.\n\n## Declaration\n\n```swift\nfunc addCompletedHandler(_ block: @escaping MTLCommandBufferHandler)\n```\n\n## Parameters\n\n- **block**: A Swift closure or an Objective-C block that Metal calls after the GPU finishes running the commands in the command buffer.\n\n## Discussion\n\nYou can register one or more completion handlers for the same command buffer. The GPU device’s driver (on the CPU) calls the completion handlers after the GPU finishes executing the command buffer.\n\n\n\nFor example, you can use the command buffer’s [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/gpuEndTime] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/gpuStartTime] properties to calculate how much time the GPU spends running the command buffer.\n\n\n\nThe completion handler is also a good place to check the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/status] property to determine whether the GPU successfully completes the buffer’s commands. If the status is equal to [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBufferStatus\/error], you can investigate further by checking the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/error] and log properties for more details about the issue. See [doc:\/\/com.apple.metal\/documentation\/Metal\/command-buffer-debugging] for more methods and properties that can help you isolate the issue.\n\n\n\n## Registering state change handlers\n\n- **addScheduledHandler(_:)**: Registers a completion handler the GPU device calls immediately after it schedules the command buffer to run on the GPU.\n- **MTLCommandBufferHandler**: A completion handler signature a GPU device calls when it finishes scheduling a command buffer, or when the GPU finishes running it.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Registers a completion handler the GPU device calls immediately after it schedules the command buffer to run on the GPU.",
          "name" : "addScheduledHandler(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCommandBuffer\/addScheduledHandler(_:)"
        },
        {
          "description" : "A completion handler signature a GPU device calls when it finishes scheduling a command buffer, or when the GPU finishes running it.",
          "name" : "MTLCommandBufferHandler",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCommandBufferHandler"
        }
      ],
      "title" : "Registering state change handlers"
    }
  ],
  "source" : "appleJSON",
  "title" : "addCompletedHandler(_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCommandBuffer\/addCompletedHandler(_:)"
}