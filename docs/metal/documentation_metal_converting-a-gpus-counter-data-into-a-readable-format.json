{
  "abstract" : "Inspect and use the data within a GPU’s counter sample buffer by resolving it into a standard format.",
  "codeExamples" : [

  ],
  "contentHash" : "ab67c5afe1caa24bc464d58d1c05d54d823dfdd123c0be4a65a8c8b72d2d7176",
  "crawledAt" : "2025-12-02T19:54:47Z",
  "id" : "8A447EF2-8DA2-45B1-8392-853B3AF79965",
  "kind" : "article",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nTo use the data a GPU driver stores in an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer] instance (see [doc:\/\/com.apple.metal\/documentation\/Metal\/sampling-gpu-data-into-counter-sample-buffers]), your app needs to *resolve* it. Resolving the data converts the counter data from the GPU’s internal data structure into a common format that Metal defines.\n\nYou can resolve the data in a counter sample buffer by creating a blit pass that converts the data as it copies it to an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBuffer]. If the CPU can access a counter sample buffer, you can also resolve the data after the GPU finishes running a command buffer. See [doc:\/\/com.apple.metal\/documentation\/Metal\/creating-a-counter-sample-buffer-to-store-a-gpus-counter-data-during-a-pass] for information about making a CPU-accessible counter sample buffer.\n\n### Resolve the counter sample buffer with the CPU\n\nFor an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer] instance that you create with shared memory (see [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBufferDescriptor\/storageMode] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLStorageMode\/shared]), you can resolve the data by calling its [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer\/resolveCounterRange(_:)] method.\n\nYou can resolve a sample counter buffer with the CPU at any time after the GPU finishes running the pass that retrieves the counter’s data. To access the data as soon as possible (with the CPU), add a completion handler to the pass’s command buffer by calling its [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/addCompletedHandler(_:)] method.\n\n### Resolve the counter sample buffer with a blit pass on the GPU\n\nYou can also resolve an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer] instance’s data into an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBuffer] by running a blit pass on the GPU. For some GPUs, this technique is the only way to resolve a counter sample buffer that uses private storage (see [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBufferDescriptor\/storageMode] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLStorageMode\/private]).\n\nTo resolve a sample counter buffer in a blit pass, create an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBlitCommandEncoder] instance and call its [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBlitCommandEncoder\/resolveCounters(_:range:destinationBuffer:destinationOffset:)] method.\n\n### Cast the counter sample’s data to a result type\n\nYour app can inspect and use the resolved data by casting it to the result type that corresponds to the counter set.\n\nFor example, your app can cast the data it resolves from a [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommonCounterSet\/timestamp] counter set as an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterResultTimestamp] array.\n\nThe code example above also checks whether the result type array has the correct number of elements of the counter set for the app.\n\n### Inspect the information and check for error values\n\nYou can also use the result type instances to check whether the GPU stores any error values. The following code example determines whether any of the timestamp samples are equal to `0` or a sentinel error value:\n\nAny time the GPU encounters a runtime error while sampling a counter, it sets the counter datum to the sentinel value [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterErrorValue].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/converting-a-gpus-counter-data-into-a-readable-format\ncrawled: 2025-12-02T19:54:47Z\n---\n\n# Converting a GPU’s counter data into a readable format\n\n**Article**\n\nInspect and use the data within a GPU’s counter sample buffer by resolving it into a standard format.\n\n## Overview\n\nTo use the data a GPU driver stores in an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer] instance (see [doc:\/\/com.apple.metal\/documentation\/Metal\/sampling-gpu-data-into-counter-sample-buffers]), your app needs to *resolve* it. Resolving the data converts the counter data from the GPU’s internal data structure into a common format that Metal defines.\n\nYou can resolve the data in a counter sample buffer by creating a blit pass that converts the data as it copies it to an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBuffer]. If the CPU can access a counter sample buffer, you can also resolve the data after the GPU finishes running a command buffer. See [doc:\/\/com.apple.metal\/documentation\/Metal\/creating-a-counter-sample-buffer-to-store-a-gpus-counter-data-during-a-pass] for information about making a CPU-accessible counter sample buffer.\n\n### Resolve the counter sample buffer with the CPU\n\nFor an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer] instance that you create with shared memory (see [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBufferDescriptor\/storageMode] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLStorageMode\/shared]), you can resolve the data by calling its [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer\/resolveCounterRange(_:)] method.\n\n\n\nYou can resolve a sample counter buffer with the CPU at any time after the GPU finishes running the pass that retrieves the counter’s data. To access the data as soon as possible (with the CPU), add a completion handler to the pass’s command buffer by calling its [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommandBuffer\/addCompletedHandler(_:)] method.\n\n\n\n### Resolve the counter sample buffer with a blit pass on the GPU\n\nYou can also resolve an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBuffer] instance’s data into an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBuffer] by running a blit pass on the GPU. For some GPUs, this technique is the only way to resolve a counter sample buffer that uses private storage (see [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterSampleBufferDescriptor\/storageMode] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLStorageMode\/private]).\n\nTo resolve a sample counter buffer in a blit pass, create an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBlitCommandEncoder] instance and call its [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLBlitCommandEncoder\/resolveCounters(_:range:destinationBuffer:destinationOffset:)] method.\n\n\n\n### Cast the counter sample’s data to a result type\n\nYour app can inspect and use the resolved data by casting it to the result type that corresponds to the counter set.\n\n\n\nFor example, your app can cast the data it resolves from a [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCommonCounterSet\/timestamp] counter set as an [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterResultTimestamp] array.\n\n\n\nThe code example above also checks whether the result type array has the correct number of elements of the counter set for the app.\n\n### Inspect the information and check for error values\n\nYou can also use the result type instances to check whether the GPU stores any error values. The following code example determines whether any of the timestamp samples are equal to `0` or a sentinel error value:\n\n\n\nAny time the GPU encounters a runtime error while sampling a counter, it sets the counter datum to the sentinel value [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLCounterErrorValue].\n\n\n\n## Counter sample data output\n\n- **MTLCounterResultTimestamp**: The data structure for storing the data you resolve from a timestamp counter set.\n- **MTLCounterResultStatistic**: The data structure for storing the data you resolve from a statistic counter set.\n- **MTLCounterResultStageUtilization**: The data structure for storing the data you resolve from a stage-utilization counter set.\n- **MTLCounterErrorValue**: A sentinel value for an entry in a counter sample buffer that indicates the entry’s data is invalid.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "The data structure for storing the data you resolve from a timestamp counter set.",
          "name" : "MTLCounterResultTimestamp",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterResultTimestamp"
        },
        {
          "description" : "The data structure for storing the data you resolve from a statistic counter set.",
          "name" : "MTLCounterResultStatistic",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterResultStatistic"
        },
        {
          "description" : "The data structure for storing the data you resolve from a stage-utilization counter set.",
          "name" : "MTLCounterResultStageUtilization",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterResultStageUtilization"
        },
        {
          "description" : "A sentinel value for an entry in a counter sample buffer that indicates the entry’s data is invalid.",
          "name" : "MTLCounterErrorValue",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLCounterErrorValue"
        }
      ],
      "title" : "Counter sample data output"
    }
  ],
  "source" : "appleJSON",
  "title" : "Converting a GPU’s counter data into a readable format",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/converting-a-gpus-counter-data-into-a-readable-format"
}