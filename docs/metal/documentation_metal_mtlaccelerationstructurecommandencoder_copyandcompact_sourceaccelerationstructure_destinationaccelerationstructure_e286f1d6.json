{
  "abstract" : "Encodes a command to compact an acceleration structure’s data and copy it into a different acceleration structure.",
  "codeExamples" : [

  ],
  "contentHash" : "7e50d32ebca2e37bcbaa096d6aa38f1345a267f4b41924fe582ff086ca7bdd9a",
  "crawledAt" : "2025-12-05T10:25:43Z",
  "declaration" : {
    "code" : "func copyAndCompact(sourceAccelerationStructure: any MTLAccelerationStructure, destinationAccelerationStructure: any MTLAccelerationStructure)",
    "language" : "swift"
  },
  "id" : "369D5A12-7A47-4D59-8A74-246B7DFAB053",
  "kind" : "method",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Discussion\n\nThe source and destination acceleration structures can’t overlap in memory. The destination acceleration structure needs to be at least as large as the compact size of the source acceleration structure, which you obtain by using the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/writeCompactedSize(accelerationStructure:buffer:offset:)] method.\n\nIf the source acceleration structure contains references to other acceleration structures, the copy of the acceleration structure refers to the same child structures.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)\ncrawled: 2025-12-05T10:25:43Z\n---\n\n# copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)\n\n**Instance Method**\n\nEncodes a command to compact an acceleration structure’s data and copy it into a different acceleration structure.\n\n## Declaration\n\n```swift\nfunc copyAndCompact(sourceAccelerationStructure: any MTLAccelerationStructure, destinationAccelerationStructure: any MTLAccelerationStructure)\n```\n\n## Parameters\n\n- **sourceAccelerationStructure**: The source acceleration structure.\n- **destinationAccelerationStructure**: The destination acceleration structure.\n\n## Discussion\n\nThe source and destination acceleration structures can’t overlap in memory. The destination acceleration structure needs to be at least as large as the compact size of the source acceleration structure, which you obtain by using the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/writeCompactedSize(accelerationStructure:buffer:offset:)] method.\n\nIf the source acceleration structure contains references to other acceleration structures, the copy of the acceleration structure refers to the same child structures.\n\n## Copying an acceleration structure\n\n- **copy(sourceAccelerationStructure:destinationAccelerationStructure:)**: Encodes a command to copy the data from one acceleration structure to another.\n- **writeCompactedSize(accelerationStructure:buffer:offset:)**: Encodes a command to calculate the compacted size of an acceleration structure.\n- **writeCompactedSize(accelerationStructure:buffer:offset:sizeDataType:)**: Encodes a command to calculate the compacted size of an acceleration structure, taking into account the size of the output data.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Encodes a command to copy the data from one acceleration structure to another.",
          "name" : "copy(sourceAccelerationStructure:destinationAccelerationStructure:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/copy(sourceAccelerationStructure:destinationAccelerationStructure:)"
        },
        {
          "description" : "Encodes a command to calculate the compacted size of an acceleration structure.",
          "name" : "writeCompactedSize(accelerationStructure:buffer:offset:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/writeCompactedSize(accelerationStructure:buffer:offset:)"
        },
        {
          "description" : "Encodes a command to calculate the compacted size of an acceleration structure, taking into account the size of the output data.",
          "name" : "writeCompactedSize(accelerationStructure:buffer:offset:sizeDataType:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/writeCompactedSize(accelerationStructure:buffer:offset:sizeDataType:)"
        }
      ],
      "title" : "Copying an acceleration structure"
    }
  ],
  "source" : "appleJSON",
  "title" : "copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLAccelerationStructureCommandEncoder\/copyAndCompact(sourceAccelerationStructure:destinationAccelerationStructure:)"
}