{
  "abstract" : "Learn how a sparse texture’s contents are organized in memory.",
  "codeExamples" : [
    {
      "code" : "MTLSize tileSize = [_device sparseTileSizeWithTextureType:MTLTextureType2D\n                        pixelFormat:MTLPixelFormatBGRA8Unorm\n                        sampleCount:1];",
      "language" : "swift"
    },
    {
      "code" : "MTLRegion pixelRegion[1] = { MTLRegionMake2D(64, 64, 128, 128)};\nMTLRegion tileRegion[1];\n\n[_device convertSparsePixelRegions:pixelRegion\n                     toTileRegions:tileRegion\n                      withTileSize:tileSize\n                     alignmentMode:MTLSparseTextureRegionAlignmentModeOutward\n                        numRegions:1];",
      "language" : "objective-c"
    },
    {
      "code" : "[_device convertSparseTileRegions:&tileRegion\n                   toPixelRegions:&pixelRegion\n                     withTileSize:tileSize\n                       numRegions:1];",
      "language" : "objective-c"
    }
  ],
  "contentHash" : "439858026e8ea9923b4010247c6e48595e40263c531b7e3f042ebe44c46ff4f6",
  "crawledAt" : "2025-12-04T02:20:12Z",
  "id" : "5F1C76EC-7257-48DC-94AA-9B69389BF980",
  "kind" : "article",
  "language" : "swift",
  "module" : "Metal",
  "overview" : "## Overview\n\nIn Metal, when you create textures or copy data into or out of them, you specify sizes and regions in pixels. (Usually, this means creating [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSize] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRegion] structures that specify sizes and offsets in pixel units.) You still use [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSize] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRegion] when working with sparse textures. However, some new actions, such as mapping and unmapping of memory in sparse textures, require you to specify sizes in tile-sized units instead. Metal provides utility methods that convert between pixel measurements and tile-sized measurements.\n\n### Determine the dimensions of a sparse tile\n\nAll sparse tiles created by a given device object have the same size in bytes. However, the number of pixels in a sparse tile varies for each texture, depending on pixel size. To get the dimensions, in pixels, of a sparse tile for a specific texture format, call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice\/sparseTileSize(with:pixelFormat:sampleCount:)] method on the device object, passing in the texture format and sample count:\n\nAll tiles in a texture have the same dimensions, and the texture is laid out as a grid of sparse tiles. For example, the following texture image is `256 x 256` pixels.\n\n\n\nIf the tile size is `64 x 64`, to cover the texture, you need a `4 x 4` grid of sparse tiles. An [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRegion] in tile coordinates with an origin of `(0,0)` and a size of `(1,1)` corresponds to a pixel region with an origin of `(0,0)` and a size of `(64,64)`. Similarly, a tile region with an origin of `(2,1)` and a size of `(2,3)` corresponds to a pixel region with an origin of `(128,64)` and a size of `(128,196)`.\n\n### Convert from pixels to tiles\n\nTo convert from a pixel region to a tile region, call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice\/convertSparsePixelRegions(_:toTileRegions:withTileSize:alignmentMode:numRegions:)] method on a device object, as shown in the code below:\n\nIf the pixel region doesn’t precisely align to the tile size, the alignment mode parameter determines whether the tile region expands outward to encompass any partially covered tiles ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSparseTextureRegionAlignmentMode\/outward]) or whether those partially covered regions are ignored ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSparseTextureRegionAlignmentMode\/inward]).\n\n### Convert from tiles to pixels\n\nSimilarly, you can convert from tile units into pixel units. The resulting pixel region is always aligned to tile boundaries, so you don’t need to specify an alignment parameter.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Metal\/converting-between-pixel-regions-and-sparse-tile-regions\ncrawled: 2025-12-04T02:20:12Z\n---\n\n# Converting between pixel regions and sparse tile regions\n\n**Article**\n\nLearn how a sparse texture’s contents are organized in memory.\n\n## Overview\n\nIn Metal, when you create textures or copy data into or out of them, you specify sizes and regions in pixels. (Usually, this means creating [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSize] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRegion] structures that specify sizes and offsets in pixel units.) You still use [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSize] and [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRegion] when working with sparse textures. However, some new actions, such as mapping and unmapping of memory in sparse textures, require you to specify sizes in tile-sized units instead. Metal provides utility methods that convert between pixel measurements and tile-sized measurements.\n\n### Determine the dimensions of a sparse tile\n\nAll sparse tiles created by a given device object have the same size in bytes. However, the number of pixels in a sparse tile varies for each texture, depending on pixel size. To get the dimensions, in pixels, of a sparse tile for a specific texture format, call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice\/sparseTileSize(with:pixelFormat:sampleCount:)] method on the device object, passing in the texture format and sample count:\n\n```swift\nMTLSize tileSize = [_device sparseTileSizeWithTextureType:MTLTextureType2D\n                        pixelFormat:MTLPixelFormatBGRA8Unorm\n                        sampleCount:1];\n```\n\nAll tiles in a texture have the same dimensions, and the texture is laid out as a grid of sparse tiles. For example, the following texture image is `256 x 256` pixels.\n\n\n\nIf the tile size is `64 x 64`, to cover the texture, you need a `4 x 4` grid of sparse tiles. An [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLRegion] in tile coordinates with an origin of `(0,0)` and a size of `(1,1)` corresponds to a pixel region with an origin of `(0,0)` and a size of `(64,64)`. Similarly, a tile region with an origin of `(2,1)` and a size of `(2,3)` corresponds to a pixel region with an origin of `(128,64)` and a size of `(128,196)`.\n\n### Convert from pixels to tiles\n\nTo convert from a pixel region to a tile region, call the [doc:\/\/com.apple.metal\/documentation\/Metal\/MTLDevice\/convertSparsePixelRegions(_:toTileRegions:withTileSize:alignmentMode:numRegions:)] method on a device object, as shown in the code below:\n\n```objective-c\nMTLRegion pixelRegion[1] = { MTLRegionMake2D(64, 64, 128, 128)};\nMTLRegion tileRegion[1];\n\n[_device convertSparsePixelRegions:pixelRegion\n                     toTileRegions:tileRegion\n                      withTileSize:tileSize\n                     alignmentMode:MTLSparseTextureRegionAlignmentModeOutward\n                        numRegions:1];\n```\n\nIf the pixel region doesn’t precisely align to the tile size, the alignment mode parameter determines whether the tile region expands outward to encompass any partially covered tiles ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSparseTextureRegionAlignmentMode\/outward]) or whether those partially covered regions are ignored ([doc:\/\/com.apple.metal\/documentation\/Metal\/MTLSparseTextureRegionAlignmentMode\/inward]).\n\n### Convert from tiles to pixels\n\nSimilarly, you can convert from tile units into pixel units. The resulting pixel region is always aligned to tile boundaries, so you don’t need to specify an alignment parameter.\n\n```objective-c\n[_device convertSparseTileRegions:&tileRegion\n                   toPixelRegions:&pixelRegion\n                     withTileSize:tileSize\n                       numRegions:1];\n```\n\n## Sparse textures\n\n- **Managing sparse texture memory**: Take direct control of memory allocation for texture data by using sparse textures.\n- **Creating sparse heaps and sparse textures**: Allocate memory for sparse textures by creating a sparse heap.\n- **Assigning memory to sparse textures**: Use a resource state encoder to allocate and deallocate sparse tiles for a sparse texture.\n- **Reading and writing to sparse textures**: Decide how to handle access to unmapped texture regions.\n- **Estimating how often a texture region is accessed**: Use texture access patterns to determine when you need to map a texture region.\n- **MTLResourceStatePassDescriptor**: A configuration for a resource state pass, used to create a resource state command encoder.\n- **MTLResourceStatePassSampleBufferAttachmentDescriptor**: A description of where to store GPU counter information at the start and end of a resource state pass.\n- **MTLResourceStatePassSampleBufferAttachmentDescriptorArray**: An array of sample buffer attachments for a resource state pass.\n- **MTLResourceStateCommandEncoder**: An encoder that encodes commands that modify resource configurations.\n- **MTLMapIndirectArguments**: The data layout for mapping sparse texture regions when using indirect commands.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Take direct control of memory allocation for texture data by using sparse textures.",
          "name" : "Managing sparse texture memory",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/managing-sparse-texture-memory"
        },
        {
          "description" : "Allocate memory for sparse textures by creating a sparse heap.",
          "name" : "Creating sparse heaps and sparse textures",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/creating-sparse-heaps-and-sparse-textures"
        },
        {
          "description" : "Use a resource state encoder to allocate and deallocate sparse tiles for a sparse texture.",
          "name" : "Assigning memory to sparse textures",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/assigning-memory-to-sparse-textures"
        },
        {
          "description" : "Decide how to handle access to unmapped texture regions.",
          "name" : "Reading and writing to sparse textures",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/reading-and-writing-to-sparse-textures"
        },
        {
          "description" : "Use texture access patterns to determine when you need to map a texture region.",
          "name" : "Estimating how often a texture region is accessed",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/estimating-how-often-a-texture-region-is-accessed"
        },
        {
          "description" : "A configuration for a resource state pass, used to create a resource state command encoder.",
          "name" : "MTLResourceStatePassDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLResourceStatePassDescriptor"
        },
        {
          "description" : "A description of where to store GPU counter information at the start and end of a resource state pass.",
          "name" : "MTLResourceStatePassSampleBufferAttachmentDescriptor",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLResourceStatePassSampleBufferAttachmentDescriptor"
        },
        {
          "description" : "An array of sample buffer attachments for a resource state pass.",
          "name" : "MTLResourceStatePassSampleBufferAttachmentDescriptorArray",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLResourceStatePassSampleBufferAttachmentDescriptorArray"
        },
        {
          "description" : "An encoder that encodes commands that modify resource configurations.",
          "name" : "MTLResourceStateCommandEncoder",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLResourceStateCommandEncoder"
        },
        {
          "description" : "The data layout for mapping sparse texture regions when using indirect commands.",
          "name" : "MTLMapIndirectArguments",
          "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/MTLMapIndirectArguments"
        }
      ],
      "title" : "Sparse textures"
    }
  ],
  "source" : "appleJSON",
  "title" : "Converting between pixel regions and sparse tile regions",
  "url" : "https:\/\/developer.apple.com\/documentation\/Metal\/converting-between-pixel-regions-and-sparse-tile-regions"
}