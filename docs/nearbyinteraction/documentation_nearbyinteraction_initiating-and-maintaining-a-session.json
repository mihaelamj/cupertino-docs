{
  "abstract" : "Measure the relative position of a nearby device and coach the user to sustain interaction.",
  "codeExamples" : [
    {
      "code" : "if NISession.deviceCapabilities.supportsDirectionMeasurement {\n    \/\/ Interact using device distance and direction.\n} else if NISession.deviceCapabilities.supportsPreciseDistanceMeasurement {\n    \/\/ Interact using distance only.\n} ",
      "language" : "swift"
    },
    {
      "code" : "var isSupported : Bool\nif #available(iOS 16.0, watchOS 9.0, *) {\n    isSupported = NISession.deviceCapabilities.supportsPreciseDistanceMeasurement\n} else {\n    isSupported = NISession.isSupported\n}\nif isSupported {\n    \/\/ Initiate an interaction session.\n}",
      "language" : "swift"
    },
    {
      "code" : "if #available(iOS 15, *) {\n    \/\/ Pursue interaction with nearby third-party accessories or Apple Watch.\n} else {\n    \/\/ Interact only with iPhone.\n}",
      "language" : "swift"
    },
    {
      "code" : "let configuration = NINearbyPeerConfiguration(peerToken: peerDiscoverToken)",
      "language" : "swift"
    },
    {
      "code" : "configuration = try NINearbyAccessoryConfiguration(data: configData)",
      "language" : "swift"
    }
  ],
  "contentHash" : "032ae0e95bad4c47db5de7ade4b46a659d82c9fea80adc23f3d2405012132845",
  "crawledAt" : "2025-12-05T20:00:04Z",
  "id" : "59FC0DB3-CDFC-4A7D-8D53-ECF872503CC2",
  "kind" : "article",
  "language" : "swift",
  "module" : "Nearby Interaction",
  "overview" : "## Overview\n\nWhen an app reacts to the relative position of another device, it creates a unique experience based on the user’s environment. For example, after the user requests a lift in a ride share app, the app can display a graphic that points in the direction of the driver as they approach.\n\nTo create these kinds of spatial interactions with nearby people or objects, your app discovers the available peers with a network technology you choose. If the peer app responds positively, the apps agree to commence receiving respective positions.\n\nTo perform this discovery and handshake, the app implements custom code using a network technology you choose. Common examples are [doc:\/\/com.apple.documentation\/documentation\/CoreBluetooth], [doc:\/\/com.apple.documentation\/documentation\/MultipeerConnectivity], [doc:\/\/com.apple.documentation\/documentation\/WatchConnectivity], or a custom server deployment. Over the network, the apps share specific data that the system requires to begin an interaction session, such as the session’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/discoveryToken].\n\nThe [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIConfiguration] subclass that you choose decides the device type for an interaction: an Apple device or third-party accessory. When you pass the configuration to an [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession] instance and run it, the framework provides your app with the position of the nearby object periodically through [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate] callbacks.\n\nYour session’s delegate also monitors critical state by implementing callbacks. For example, to keep an interaction going, you may need to guide the user to conform to range and line of sight requirements of the Ultra Wideband (UWB) chips.\n\n### Define a usage description\n\nBefore the system allows an interaction session to start, the framework checks for user permission to share the device’s position with a nearby peer. The first time the app runs, the framework presents a prompt that displays the textual value of [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSNearbyInteractionUsageDescription] in the app’s `Info.plist`. This property describes the benefits of position sharing in an interaction session.\n\nThe system persists the user’s choice in Settings. After your app runs for the first time, it consults the user preference in Settings before it begins a new interaction session.\n\n\n\nAlternatively, the user adjusts Nearby Interaction permission in Privacy Settings.\n\n\n\n### Confirm device and feature support\n\nApple devices with a UWB chip support Nearby Interaction. To check whether the user’s device supports Nearby Interaction and the specific features your app requires, inspect [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/deviceCapabilities].\n\nOn iOS 15 and earlier, check the session’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/isSupported] flag.\n\nIn addition to iPhone, Nearby Interaction supports Apple Watch and third-party accessories in iOS 15 and later. If your app runs on iOS 14, check the iOS version of the user’s device before trying to interact with devices other than iPhone.\n\n### Locate peers and exchange discovery data\n\nYour app checks for nearby peers using a network technology that you choose.\n\nApps then exchange data in a particular format that depends on the device types in the interaction session. For interaction between Apple devices, peers share their discovery tokens ([doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/discoveryToken]). For interactions with a third-party accessory, the accessory sends your app a configuration data object as outlined in the [https:\/\/developer.apple.com\/nearby-interaction\/specification\/].\n\n### Create a configuration object\n\nThe app creates a configuration object with the information it receives from the peer. The type of information depends on the particular peer. From an iPhone or Apple Watch, the app receives a discovery token and passes it to the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration\/init(peerToken:)] initializer of [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration].\n\nFrom a peer accessory, the app receives a configuration data object and passes it into the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyAccessoryConfiguration\/init(data:)] initializer of [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyAccessoryConfiguration].\n\n### Respond to session delegate callbacks\n\nTo receive peer positions and react to events in the Nearby Interaction life cycle, the app implements a delegate that conforms to [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate].\n\nWhen the framework detects the location of a nearby peer, it provides the peer’s current position to the delegate’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didUpdate:)] implementation. When interacting with a supported third-party accessory, the framework calls [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didGenerateShareableConfigurationData:for:)], passing in configuration data that the app sends to the accessory.\n\nThe following describes errors that invalidate a session. The framework passes the error into the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didInvalidateWith:)] callback.\n\nIf a user backgrounds the app, Nearby Interaction suspends the session and notifies the delegate through [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/sessionWasSuspended(_:)].\n\nIf a peer device closes the app or moves out of range of the UWB chip, Nearby Interaction times out the peer. The delegate receives the reason the peer left through the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didRemove:reason:)] callback.\n\n### Coach the user on range, orientation, and line of sight\n\nNearby Interaction works best when peer iPhone devices are:\n\nAn iPhone detects a peer device’s direction when it appears within the narrow line of sight illustrated by the conic region in the following diagram.\n\n\n\nThe arrow in the center of the cone represents the direction vector, which extends outward from the center of the back of the device in the direction of the peer. The arrow can point anywhere within the cone in the direction of the peer. However, the line of sight must be clear of obstacles that could interfere with the UWB chip’s communication, such as people, vehicles, or walls.\n\nThe app can present instructional text to facilitate interactions. For example, if a peer device is out of range, the delegate reads [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/distance-676dm] and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/direction-4qh5w] as `nil`. If a peer device is out of the line of sight, the delegate reads the direction as `nil`.\n\nIn Objective-C, if a peer device is out of range, the delegate reads [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/distance-9atp7] as [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObjectDistanceNotAvailable], and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/direction-5xcld] as [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObjectDirectionNotAvailable]. If a peer device is out of the line of sight, the delegate reads the direction as [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObjectDirectionNotAvailable].\n\nIn either situation, the app could request that the user approach the peer to resume the interaction.\n\n### Increase line of sight with Camera Assistance\n\nIn iOS 16, Camera Assistance ([doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration\/isCameraAssistanceEnabled]) increases the device’s line of sight to a larger area that surrounds the device. This provides a nearby object’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/distance-676dm] and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/direction-4qh5w] in a wider range of environmental conditions, in addition to the object’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/horizontalAngle-hsg] and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/verticalDirectionEstimate-swift.property].\n\nTo use Camera Assistance in an interaction session, ensure the device supports the feature first by checking the value of [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIDeviceCapability\/supportsCameraAssistance].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/initiating-and-maintaining-a-session\ncrawled: 2025-12-05T20:00:04Z\n---\n\n# Initiating and maintaining a session\n\n**Article**\n\nMeasure the relative position of a nearby device and coach the user to sustain interaction.\n\n## Overview\n\nWhen an app reacts to the relative position of another device, it creates a unique experience based on the user’s environment. For example, after the user requests a lift in a ride share app, the app can display a graphic that points in the direction of the driver as they approach.\n\nTo create these kinds of spatial interactions with nearby people or objects, your app discovers the available peers with a network technology you choose. If the peer app responds positively, the apps agree to commence receiving respective positions.\n\nTo perform this discovery and handshake, the app implements custom code using a network technology you choose. Common examples are [doc:\/\/com.apple.documentation\/documentation\/CoreBluetooth], [doc:\/\/com.apple.documentation\/documentation\/MultipeerConnectivity], [doc:\/\/com.apple.documentation\/documentation\/WatchConnectivity], or a custom server deployment. Over the network, the apps share specific data that the system requires to begin an interaction session, such as the session’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/discoveryToken].\n\nThe [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIConfiguration] subclass that you choose decides the device type for an interaction: an Apple device or third-party accessory. When you pass the configuration to an [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession] instance and run it, the framework provides your app with the position of the nearby object periodically through [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate] callbacks.\n\nYour session’s delegate also monitors critical state by implementing callbacks. For example, to keep an interaction going, you may need to guide the user to conform to range and line of sight requirements of the Ultra Wideband (UWB) chips.\n\n### Define a usage description\n\nBefore the system allows an interaction session to start, the framework checks for user permission to share the device’s position with a nearby peer. The first time the app runs, the framework presents a prompt that displays the textual value of [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSNearbyInteractionUsageDescription] in the app’s `Info.plist`. This property describes the benefits of position sharing in an interaction session.\n\nThe system persists the user’s choice in Settings. After your app runs for the first time, it consults the user preference in Settings before it begins a new interaction session.\n\n\n\nAlternatively, the user adjusts Nearby Interaction permission in Privacy Settings.\n\n\n\n### Confirm device and feature support\n\nApple devices with a UWB chip support Nearby Interaction. To check whether the user’s device supports Nearby Interaction and the specific features your app requires, inspect [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/deviceCapabilities].\n\n```swift\nif NISession.deviceCapabilities.supportsDirectionMeasurement {\n    \/\/ Interact using device distance and direction.\n} else if NISession.deviceCapabilities.supportsPreciseDistanceMeasurement {\n    \/\/ Interact using distance only.\n} \n```\n\nOn iOS 15 and earlier, check the session’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/isSupported] flag.\n\n```swift\nvar isSupported : Bool\nif #available(iOS 16.0, watchOS 9.0, *) {\n    isSupported = NISession.deviceCapabilities.supportsPreciseDistanceMeasurement\n} else {\n    isSupported = NISession.isSupported\n}\nif isSupported {\n    \/\/ Initiate an interaction session.\n}\n```\n\nIn addition to iPhone, Nearby Interaction supports Apple Watch and third-party accessories in iOS 15 and later. If your app runs on iOS 14, check the iOS version of the user’s device before trying to interact with devices other than iPhone.\n\n```swift\nif #available(iOS 15, *) {\n    \/\/ Pursue interaction with nearby third-party accessories or Apple Watch.\n} else {\n    \/\/ Interact only with iPhone.\n}\n```\n\n### Locate peers and exchange discovery data\n\nYour app checks for nearby peers using a network technology that you choose.\n\n- To locate peers over the local network, see [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/discovering-peers-with-multipeer-connectivity].\n- To locate a paired Apple Watch using Watch Connectivity, see [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/implementing-proximity-based-interactions-between-a-phone-and-watch].\n- To locate a third-party accessory using Core Bluetooth, see [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/implementing-spatial-interactions-with-third-party-accessories].\n\n\n\nApps then exchange data in a particular format that depends on the device types in the interaction session. For interaction between Apple devices, peers share their discovery tokens ([doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISession\/discoveryToken]). For interactions with a third-party accessory, the accessory sends your app a configuration data object as outlined in the [https:\/\/developer.apple.com\/nearby-interaction\/specification\/].\n\n### Create a configuration object\n\nThe app creates a configuration object with the information it receives from the peer. The type of information depends on the particular peer. From an iPhone or Apple Watch, the app receives a discovery token and passes it to the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration\/init(peerToken:)] initializer of [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration].\n\n```swift\nlet configuration = NINearbyPeerConfiguration(peerToken: peerDiscoverToken)\n```\n\nFrom a peer accessory, the app receives a configuration data object and passes it into the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyAccessoryConfiguration\/init(data:)] initializer of [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyAccessoryConfiguration].\n\n```swift\nconfiguration = try NINearbyAccessoryConfiguration(data: configData)\n```\n\n\n\n### Respond to session delegate callbacks\n\nTo receive peer positions and react to events in the Nearby Interaction life cycle, the app implements a delegate that conforms to [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate].\n\nWhen the framework detects the location of a nearby peer, it provides the peer’s current position to the delegate’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didUpdate:)] implementation. When interacting with a supported third-party accessory, the framework calls [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didGenerateShareableConfigurationData:for:)], passing in configuration data that the app sends to the accessory.\n\nThe following describes errors that invalidate a session. The framework passes the error into the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didInvalidateWith:)] callback.\n\n- The delegate receives [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIError\/Code\/invalidConfiguration] if the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration] discovery token is invalid.\n- The delegate receives [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIError\/Code\/invalidConfiguration] if an accessory configuration lacks an [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyAccessoryConfiguration\/accessoryDiscoveryToken].\n- The delegate receives [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIError\/Code\/userDidNotAllow] if the user declines the access prompt.\n\nIf a user backgrounds the app, Nearby Interaction suspends the session and notifies the delegate through [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/sessionWasSuspended(_:)].\n\nIf a peer device closes the app or moves out of range of the UWB chip, Nearby Interaction times out the peer. The delegate receives the reason the peer left through the [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NISessionDelegate\/session(_:didRemove:reason:)] callback.\n\n### Coach the user on range, orientation, and line of sight\n\nNearby Interaction works best when peer iPhone devices are:\n\n- Within 9 meters of each other\n- In portrait orientation\n- Facing each other with their back camera\n\nAn iPhone detects a peer device’s direction when it appears within the narrow line of sight illustrated by the conic region in the following diagram.\n\n\n\nThe arrow in the center of the cone represents the direction vector, which extends outward from the center of the back of the device in the direction of the peer. The arrow can point anywhere within the cone in the direction of the peer. However, the line of sight must be clear of obstacles that could interfere with the UWB chip’s communication, such as people, vehicles, or walls.\n\nThe app can present instructional text to facilitate interactions. For example, if a peer device is out of range, the delegate reads [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/distance-676dm] and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/direction-4qh5w] as `nil`. If a peer device is out of the line of sight, the delegate reads the direction as `nil`.\n\nIn Objective-C, if a peer device is out of range, the delegate reads [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/distance-9atp7] as [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObjectDistanceNotAvailable], and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/direction-5xcld] as [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObjectDirectionNotAvailable]. If a peer device is out of the line of sight, the delegate reads the direction as [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObjectDirectionNotAvailable].\n\nIn either situation, the app could request that the user approach the peer to resume the interaction.\n\n\n\n### Increase line of sight with Camera Assistance\n\nIn iOS 16, Camera Assistance ([doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyPeerConfiguration\/isCameraAssistanceEnabled]) increases the device’s line of sight to a larger area that surrounds the device. This provides a nearby object’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/distance-676dm] and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/direction-4qh5w] in a wider range of environmental conditions, in addition to the object’s [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/horizontalAngle-hsg] and [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NINearbyObject\/verticalDirectionEstimate-swift.property].\n\n\n\nTo use Camera Assistance in an interaction session, ensure the device supports the feature first by checking the value of [doc:\/\/com.apple.nearbyinteraction\/documentation\/NearbyInteraction\/NIDeviceCapability\/supportsCameraAssistance].\n\n## Setup\n\n- **NISession**: An object that identifies a unique connection between two peer devices.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that identifies a unique connection between two peer devices.",
          "name" : "NISession",
          "url" : "https:\/\/developer.apple.com\/documentation\/NearbyInteraction\/NISession"
        }
      ],
      "title" : "Setup"
    }
  ],
  "source" : "appleJSON",
  "title" : "Initiating and maintaining a session",
  "url" : "https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/initiating-and-maintaining-a-session"
}