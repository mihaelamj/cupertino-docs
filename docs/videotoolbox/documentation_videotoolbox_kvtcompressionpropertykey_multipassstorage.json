{
  "abstract" : "A property key that enables multipass compression and provides storage for encoder private data.",
  "codeExamples" : [

  ],
  "contentHash" : "0c770cd12fda0155e2c6eb2d31e0fef758e8de59bd85445a33ea5fff5bdeb217",
  "crawledAt" : "2025-12-03T14:47:50Z",
  "declaration" : {
    "code" : "let kVTCompressionPropertyKey_MultiPassStorage: CFString",
    "language" : "swift"
  },
  "id" : "CED5EB13-B47D-4C33-95BD-9840BA27BE42",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "Video Toolbox",
  "overview" : "## Discussion\n\nSome video encoders support multipass encoding.  To determine whether a [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSession-api-collection] supports multipass encoding, you can inspect the dictionary returned by [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTSessionCopySupportedPropertyDictionary(_:supportedPropertyDictionaryOut:)] to see if it contains [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/kVTCompressionPropertyKey_MultiPassStorage].\n\nTo enable multipass encoding, set the [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/kVTCompressionPropertyKey_MultiPassStorage] property to a [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTMultiPassStorage-api-collection] object, which you can create by calling [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTMultiPassStorageCreate(allocator:fileURL:timeRange:options:multiPassStorageOut:)].  Then make one or more passes over the source frames.  Bracket each pass with a call to [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionBeginPass(_:flags:_:)] at the beginning and [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEndPass(_:furtherPassesRequestedOut:_:)] at the end.\n\nIn the first pass of multipass encoding, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEncodeFrame(_:imageBuffer:presentationTimeStamp:duration:frameProperties:sourceFrameRefcon:infoFlagsOut:)] for every source frame (just as in single-pass encoding).  At the end of every pass, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEndPass(_:furtherPassesRequestedOut:_:)].  This may take some time as the video encoder determines whether it can improve the encoding by performing another pass.  If the user cancels encoding during this time, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionInvalidate(_:)] to interrupt the processing.  [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEndPass(_:furtherPassesRequestedOut:_:)] indicates through the `furtherPassesRequestedOut` argument whether the video encoder has requested another pass.  There is no particular limit on the number of passes the video encoder may request, but the client is free to disregard this request and use the last-emitted set of frames.\n\nIf `furtherPassesRequestedOut` is set to [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] and you want to perform another pass, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionGetTimeRangesForNextPass(_:timeRangeCountOut:timeRangeArrayOut:)] to determine the time ranges for the next pass.  Only the source frames within these time ranges need to be passed to [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEncodeFrame(_:imageBuffer:presentationTimeStamp:duration:frameProperties:sourceFrameRefcon:infoFlagsOut:)]; the video encoder is satisfied with the already-emitted compressed frames outside these ranges, and they can be kept for the final output.\n\nIn second and successive passes, you must pass identical source frames, frame properties, and timestamps to [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEncodeFrame(_:imageBuffer:presentationTimeStamp:duration:frameProperties:sourceFrameRefcon:infoFlagsOut:)] as in the first pass, with the exception that frames not in the requested time ranges should be skipped.\n\nYou can create and use a [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTFrameSilo-api-collection] object to merge sequences of compressed frames across passes during multipass encoding.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/VideoToolbox\/kVTCompressionPropertyKey_MultiPassStorage\ncrawled: 2025-12-03T14:47:50Z\n---\n\n# kVTCompressionPropertyKey_MultiPassStorage\n\n**Global Variable**\n\nA property key that enables multipass compression and provides storage for encoder private data.\n\n## Declaration\n\n```swift\nlet kVTCompressionPropertyKey_MultiPassStorage: CFString\n```\n\n## Discussion\n\nSome video encoders support multipass encoding.  To determine whether a [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSession-api-collection] supports multipass encoding, you can inspect the dictionary returned by [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTSessionCopySupportedPropertyDictionary(_:supportedPropertyDictionaryOut:)] to see if it contains [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/kVTCompressionPropertyKey_MultiPassStorage].\n\nTo enable multipass encoding, set the [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/kVTCompressionPropertyKey_MultiPassStorage] property to a [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTMultiPassStorage-api-collection] object, which you can create by calling [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTMultiPassStorageCreate(allocator:fileURL:timeRange:options:multiPassStorageOut:)].  Then make one or more passes over the source frames.  Bracket each pass with a call to [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionBeginPass(_:flags:_:)] at the beginning and [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEndPass(_:furtherPassesRequestedOut:_:)] at the end.\n\nIn the first pass of multipass encoding, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEncodeFrame(_:imageBuffer:presentationTimeStamp:duration:frameProperties:sourceFrameRefcon:infoFlagsOut:)] for every source frame (just as in single-pass encoding).  At the end of every pass, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEndPass(_:furtherPassesRequestedOut:_:)].  This may take some time as the video encoder determines whether it can improve the encoding by performing another pass.  If the user cancels encoding during this time, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionInvalidate(_:)] to interrupt the processing.  [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEndPass(_:furtherPassesRequestedOut:_:)] indicates through the `furtherPassesRequestedOut` argument whether the video encoder has requested another pass.  There is no particular limit on the number of passes the video encoder may request, but the client is free to disregard this request and use the last-emitted set of frames.\n\nIf `furtherPassesRequestedOut` is set to [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] and you want to perform another pass, call [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionGetTimeRangesForNextPass(_:timeRangeCountOut:timeRangeArrayOut:)] to determine the time ranges for the next pass.  Only the source frames within these time ranges need to be passed to [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEncodeFrame(_:imageBuffer:presentationTimeStamp:duration:frameProperties:sourceFrameRefcon:infoFlagsOut:)]; the video encoder is satisfied with the already-emitted compressed frames outside these ranges, and they can be kept for the final output.\n\nIn second and successive passes, you must pass identical source frames, frame properties, and timestamps to [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTCompressionSessionEncodeFrame(_:imageBuffer:presentationTimeStamp:duration:frameProperties:sourceFrameRefcon:infoFlagsOut:)] as in the first pass, with the exception that frames not in the requested time ranges should be skipped.\n\nYou can create and use a [doc:\/\/com.apple.videotoolbox\/documentation\/VideoToolbox\/VTFrameSilo-api-collection] object to merge sequences of compressed frames across passes during multipass encoding.\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "kVTCompressionPropertyKey_MultiPassStorage",
  "url" : "https:\/\/developer.apple.com\/documentation\/VideoToolbox\/kVTCompressionPropertyKey_MultiPassStorage"
}