{
  "abstract" : "Multiplies each pixel in a set of 8-bit source image planes by a matrix to produce a set of 8-bit destination image planes.",
  "codeExamples" : [
    {
      "code" : "let size = vImage.Size(width: 1, height: 3)\n\nlet red = vImage.PixelBuffer<vImage.Planar8>(\n    pixelValues: [255, 0, 0],\n    size: size)\nlet green = vImage.PixelBuffer<vImage.Planar8>(\n    pixelValues: [0, 255, 0],\n    size: size)\nlet blue = vImage.PixelBuffer<vImage.Planar8>(\n    pixelValues: [0, 0, 255],\n    size: size)\n\nlet destination = vImage.PixelBuffer<vImage.Planar8>(\n    size: size)\n\nlet divisor: Int32 = 0x1000\nlet fDivisor = Float(divisor)\n\nlet redCoefficient: Float = 0.2126\nlet greenCoefficient: Float = 0.7152\nlet blueCoefficient: Float = 0.0722\n\nlet matrix = [\n    Int16(redCoefficient * fDivisor),\n    Int16(greenCoefficient * fDivisor),\n    Int16(blueCoefficient * fDivisor)\n]\n\nred.withUnsafePointerToVImageBuffer { r in\n    green.withUnsafePointerToVImageBuffer { g in\n        blue.withUnsafePointerToVImageBuffer { b in\n            destination.withUnsafePointerToVImageBuffer { dest in\n                \n                var srcs: [UnsafePointer<vImage_Buffer>?] = [ r, g, b ]\n                var dests: [UnsafePointer<vImage_Buffer>?] = [ dest ]\n                \n                vImageMatrixMultiply_Planar8(\n                    &srcs,\n                    &dests,\n                    3,\n                    1,\n                    matrix,\n                    divisor,\n                    nil,\n                    nil,\n                    vImage_Flags(kvImageNoFlags))\n            }\n        }\n    }\n}\n\n\/\/ Prints \"[0.21176471, 0.7137255, 0.07058824]\".\nprint(destination.array.map { Float($0) \/ 255 })",
      "language" : "swift"
    }
  ],
  "contentHash" : "4de233936a808c252629c356fb1604b035f71c68da8542376b4239ebaa4f72f0",
  "crawledAt" : "2025-12-03T20:55:16Z",
  "declaration" : {
    "code" : "func vImageMatrixMultiply_Planar8(_ srcs: UnsafeMutablePointer<UnsafePointer<vImage_Buffer>?>, _ dests: UnsafeMutablePointer<UnsafePointer<vImage_Buffer>?>, _ src_planes: UInt32, _ dest_planes: UInt32, _ matrix: UnsafePointer<Int16>, _ divisor: Int32, _ pre_bias: UnsafePointer<Int16>!, _ post_bias: UnsafePointer<Int32>!, _ flags: vImage_Flags) -> vImage_Error",
    "language" : "swift"
  },
  "id" : "4226A233-276D-432D-A3AD-D77FE57E299D",
  "kind" : "function",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Return Value\n\n[doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoError]; otherwise, one of the error codes in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/data-types-and-constants].\n\n## Discussion\n\nThis function treats corresponding pixels in the source buffers as `m`-element vectors, and the corresponding pixels in the destination buffers as `n`-element vectors. Therefore, the multiplication requires an `m x n` matrix, that is, a matrix with `src_planes` rows and `dest_planes` columns.\n\nThe following code shows three source planes multiplied by a three-element column matrix to produce a single destination plane. The values in the matrix represent the Rec. 709 luminance coefficients that convert the color source pixels to a grayscale destination image. The three source planes represent the individual red, green, and blue channels of an image that contains a red pixel, a green pixel, and a blue pixel.\n\nOn return, the destination buffer contains a grayscale representation of the red, green, and blue source buffers.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageMatrixMultiply_Planar8(_:_:_:_:_:_:_:_:_:)\ncrawled: 2025-12-03T20:55:16Z\n---\n\n# vImageMatrixMultiply_Planar8(_:_:_:_:_:_:_:_:_:)\n\n**Function**\n\nMultiplies each pixel in a set of 8-bit source image planes by a matrix to produce a set of 8-bit destination image planes.\n\n## Declaration\n\n```swift\nfunc vImageMatrixMultiply_Planar8(_ srcs: UnsafeMutablePointer<UnsafePointer<vImage_Buffer>?>, _ dests: UnsafeMutablePointer<UnsafePointer<vImage_Buffer>?>, _ src_planes: UInt32, _ dest_planes: UInt32, _ matrix: UnsafePointer<Int16>, _ divisor: Int32, _ pre_bias: UnsafePointer<Int16>!, _ post_bias: UnsafePointer<Int32>!, _ flags: vImage_Flags) -> vImage_Error\n```\n\n## Parameters\n\n- **srcs**: A pointer to an array of vImage buffers. Each buffer represents a source plane.\n- **dests**: A pointer to an array of vImage buffers. Each buffer represents a destination plane.\n- **src_planes**: The number of source planes.\n- **dest_planes**: The number of destination planes.\n- **matrix**: An array of values that contains the `src_planes` rows multiplied by `dest_planes` columns 2D matrix elements.\n- **divisor**: A value that the function divides the matrix multiplication result by after adding postbias.\n- **pre_bias**: An array of bias values for each source plane. The function adds the corresponding bias value to each source value before the matrix multiplication step. Pass `nil` to specify zero prebias.\n- **post_bias**: An array of bias values for each source plane. The function adds the corresponding bias value to each destination value after the matrix multiplication step. Pass `nil` to specify zero postbias.\n- **flags**: The options to use when performing the operation. If your code implements its own tiling or its own multithreading, pass [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageDoNotTile]; otherwise, pass [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoFlags].\n\n## Return Value\n\n[doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoError]; otherwise, one of the error codes in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/data-types-and-constants].\n\n## Discussion\n\nThis function treats corresponding pixels in the source buffers as `m`-element vectors, and the corresponding pixels in the destination buffers as `n`-element vectors. Therefore, the multiplication requires an `m x n` matrix, that is, a matrix with `src_planes` rows and `dest_planes` columns.\n\nThe following code shows three source planes multiplied by a three-element column matrix to produce a single destination plane. The values in the matrix represent the Rec. 709 luminance coefficients that convert the color source pixels to a grayscale destination image. The three source planes represent the individual red, green, and blue channels of an image that contains a red pixel, a green pixel, and a blue pixel.\n\n```swift\nlet size = vImage.Size(width: 1, height: 3)\n\nlet red = vImage.PixelBuffer<vImage.Planar8>(\n    pixelValues: [255, 0, 0],\n    size: size)\nlet green = vImage.PixelBuffer<vImage.Planar8>(\n    pixelValues: [0, 255, 0],\n    size: size)\nlet blue = vImage.PixelBuffer<vImage.Planar8>(\n    pixelValues: [0, 0, 255],\n    size: size)\n\nlet destination = vImage.PixelBuffer<vImage.Planar8>(\n    size: size)\n\nlet divisor: Int32 = 0x1000\nlet fDivisor = Float(divisor)\n\nlet redCoefficient: Float = 0.2126\nlet greenCoefficient: Float = 0.7152\nlet blueCoefficient: Float = 0.0722\n\nlet matrix = [\n    Int16(redCoefficient * fDivisor),\n    Int16(greenCoefficient * fDivisor),\n    Int16(blueCoefficient * fDivisor)\n]\n\nred.withUnsafePointerToVImageBuffer { r in\n    green.withUnsafePointerToVImageBuffer { g in\n        blue.withUnsafePointerToVImageBuffer { b in\n            destination.withUnsafePointerToVImageBuffer { dest in\n                \n                var srcs: [UnsafePointer<vImage_Buffer>?] = [ r, g, b ]\n                var dests: [UnsafePointer<vImage_Buffer>?] = [ dest ]\n                \n                vImageMatrixMultiply_Planar8(\n                    &srcs,\n                    &dests,\n                    3,\n                    1,\n                    matrix,\n                    divisor,\n                    nil,\n                    nil,\n                    vImage_Flags(kvImageNoFlags))\n            }\n        }\n    }\n}\n\n\/\/ Prints \"[0.21176471, 0.7137255, 0.07058824]\".\nprint(destination.array.map { Float($0) \/ 255 })\n```\n\nOn return, the destination buffer contains a grayscale representation of the red, green, and blue source buffers.\n\n## Multiplying multiple-plane pixels by a matrix\n\n- **Adjusting saturation and applying tone mapping**: Convert an RGB image to discrete luminance and chrominance channels, and apply color and contrast treatments.\n- **vImageMatrixMultiply_Planar16S(_:_:_:_:_:_:_:_:_:)**: Multiplies each pixel in a set of 16-bit source image planes by a matrix to produce a set of 8-bit destination image planes.\n- **vImageMatrixMultiply_PlanarF(_:_:_:_:_:_:_:_:)**: Multiplies each pixel in a set of 32-bit source image planes by a matrix to produce a set of 32-bit destination image planes.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Convert an RGB image to discrete luminance and chrominance channels, and apply color and contrast treatments.",
          "name" : "Adjusting saturation and applying tone mapping",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/adjusting-saturation-and-applying-tone-mapping"
        },
        {
          "description" : "Multiplies each pixel in a set of 16-bit source image planes by a matrix to produce a set of 8-bit destination image planes.",
          "name" : "vImageMatrixMultiply_Planar16S(_:_:_:_:_:_:_:_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageMatrixMultiply_Planar16S(_:_:_:_:_:_:_:_:_:)"
        },
        {
          "description" : "Multiplies each pixel in a set of 32-bit source image planes by a matrix to produce a set of 32-bit destination image planes.",
          "name" : "vImageMatrixMultiply_PlanarF(_:_:_:_:_:_:_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageMatrixMultiply_PlanarF(_:_:_:_:_:_:_:_:)"
        }
      ],
      "title" : "Multiplying multiple-plane pixels by a matrix"
    }
  ],
  "source" : "appleJSON",
  "title" : "vImageMatrixMultiply_Planar8(_:_:_:_:_:_:_:_:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageMatrixMultiply_Planar8(_:_:_:_:_:_:_:_:_:)"
}