{
  "abstract" : "Initializes a vImage buffer with the contents of a Core Graphics image.",
  "codeExamples" : [
    {
      "code" : "static func passThrough(sourceImage: CGImage) -> CGImage? {\n\n    var format = vImage_CGImageFormat()\n    var buffer = vImage_Buffer()\n    \n    defer {\n        buffer.free()\n    }\n\n    vImageBuffer_InitWithCGImage(\n        &buffer,\n        &format,\n        nil,\n        sourceImage,\n        vImage_Flags(kvImageNoFlags))\n   \n    \/\/ Perform image-processing operations on `buffer`.\n\n    let destinationCGImage = vImageCreateCGImageFromBuffer(\n        &buffer,\n        &format,\n        nil,\n        nil,\n        vImage_Flags(kvImageNoFlags),\n        nil)\n    \n    return destinationCGImage?.takeRetainedValue()\n}",
      "language" : "swift"
    },
    {
      "code" : "static func passThrough(sourceImage: CGImage) -> CGImage? {\n    \n    var format = vImage_CGImageFormat(\n        bitsPerComponent: 8,\n        bitsPerPixel: 8 * 3,\n        colorSpace: CGColorSpaceCreateDeviceRGB(),\n        bitmapInfo: CGBitmapInfo(rawValue: CGImageAlphaInfo.none.rawValue),\n        renderingIntent: .defaultIntent)!\n\n    var buffer = vImage_Buffer()\n\n    defer {\n        buffer.free()\n    }\n    \n    vImageBuffer_InitWithCGImage(\n        &buffer,\n        &format,\n        nil,\n        sourceImage,\n        vImage_Flags(kvImageNoFlags))\n    \n    \/\/ Perform image-processing operations on RGB888 `buffer`.\n\n    let destinationCGImage = vImageCreateCGImageFromBuffer(\n        &buffer,\n        &format,\n        nil,\n        nil,\n        vImage_Flags(kvImageNoFlags),\n        nil)\n    \n    return destinationCGImage?.takeRetainedValue()\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "2195d8063c289f853984b6db2cf637fc44e32147604be4f8c2a00a71cb8bf17b",
  "crawledAt" : "2025-12-02T22:18:35Z",
  "declaration" : {
    "code" : "func vImageBuffer_InitWithCGImage(_ buf: UnsafeMutablePointer<vImage_Buffer>, _ format: UnsafeMutablePointer<vImage_CGImageFormat>, _ backgroundColor: UnsafePointer<CGFloat>!, _ image: CGImage, _ flags: vImage_Flags) -> vImage_Error",
    "language" : "swift"
  },
  "id" : "E8BF8743-946C-4C38-A554-A1254C6EA71B",
  "kind" : "function",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Return Value\n\n[doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoError]; otherwise, one of the error codes in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/data-types-and-constants].\n\n## Discussion\n\nThe following code shows a passthrough function that accepts a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] image, populates a vImage buffer from the image, and generates a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] image from the buffer.\n\nIn this example, the call to [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageBuffer_InitWithCGImage(_:_:_:_:_:)] populates the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] and the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] variables with the properties of the source image:\n\nPass a fully initialized [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] to specify that [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageBuffer_InitWithCGImage(_:_:_:_:_:)] converts the source [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] image to the format that `format` describes. The following example converts the source image to a three-channel, 8-bit-per-channel RGB image:",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageBuffer_InitWithCGImage(_:_:_:_:_:)\ncrawled: 2025-12-02T22:18:35Z\n---\n\n# vImageBuffer_InitWithCGImage(_:_:_:_:_:)\n\n**Function**\n\nInitializes a vImage buffer with the contents of a Core Graphics image.\n\n## Declaration\n\n```swift\nfunc vImageBuffer_InitWithCGImage(_ buf: UnsafeMutablePointer<vImage_Buffer>, _ format: UnsafeMutablePointer<vImage_CGImageFormat>, _ backgroundColor: UnsafePointer<CGFloat>!, _ image: CGImage, _ flags: vImage_Flags) -> vImage_Error\n```\n\n## Parameters\n\n- **buf**: The destination vImage buffer. On output, an initialized buffer with all fields populated.\n- **format**: A [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] structure. Pass an empty structure to specify that the function populates the format with the properties of the Core Graphics image. Pass a populated structure to specify that the function converts the Core Graphics image to the format.\n- **backgroundColor**: If the source image contains alpha information and the format doesnâ€™t contain alpha information, this function flattens the source image against this parameter.\n- **image**: The source Core Graphics image.\n- **flags**: The options to use when performing the operation. Pass [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoAllocate] if the destination buffer references existing data; otherwise, pass [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoFlags].\n\n## Return Value\n\n[doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/kvImageNoError]; otherwise, one of the error codes in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/data-types-and-constants].\n\n## Discussion\n\nThe following code shows a passthrough function that accepts a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] image, populates a vImage buffer from the image, and generates a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] image from the buffer.\n\nIn this example, the call to [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageBuffer_InitWithCGImage(_:_:_:_:_:)] populates the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] and the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] variables with the properties of the source image:\n\n```swift\nstatic func passThrough(sourceImage: CGImage) -> CGImage? {\n\n    var format = vImage_CGImageFormat()\n    var buffer = vImage_Buffer()\n    \n    defer {\n        buffer.free()\n    }\n\n    vImageBuffer_InitWithCGImage(\n        &buffer,\n        &format,\n        nil,\n        sourceImage,\n        vImage_Flags(kvImageNoFlags))\n   \n    \/\/ Perform image-processing operations on `buffer`.\n\n    let destinationCGImage = vImageCreateCGImageFromBuffer(\n        &buffer,\n        &format,\n        nil,\n        nil,\n        vImage_Flags(kvImageNoFlags),\n        nil)\n    \n    return destinationCGImage?.takeRetainedValue()\n}\n```\n\nPass a fully initialized [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] to specify that [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageBuffer_InitWithCGImage(_:_:_:_:_:)] converts the source [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] image to the format that `format` describes. The following example converts the source image to a three-channel, 8-bit-per-channel RGB image:\n\n```swift\nstatic func passThrough(sourceImage: CGImage) -> CGImage? {\n    \n    var format = vImage_CGImageFormat(\n        bitsPerComponent: 8,\n        bitsPerPixel: 8 * 3,\n        colorSpace: CGColorSpaceCreateDeviceRGB(),\n        bitmapInfo: CGBitmapInfo(rawValue: CGImageAlphaInfo.none.rawValue),\n        renderingIntent: .defaultIntent)!\n\n    var buffer = vImage_Buffer()\n\n    defer {\n        buffer.free()\n    }\n    \n    vImageBuffer_InitWithCGImage(\n        &buffer,\n        &format,\n        nil,\n        sourceImage,\n        vImage_Flags(kvImageNoFlags))\n    \n    \/\/ Perform image-processing operations on RGB888 `buffer`.\n\n    let destinationCGImage = vImageCreateCGImageFromBuffer(\n        &buffer,\n        &format,\n        nil,\n        nil,\n        vImage_Flags(kvImageNoFlags),\n        nil)\n    \n    return destinationCGImage?.takeRetainedValue()\n}\n```\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "vImageBuffer_InitWithCGImage(_:_:_:_:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageBuffer_InitWithCGImage(_:_:_:_:_:)"
}