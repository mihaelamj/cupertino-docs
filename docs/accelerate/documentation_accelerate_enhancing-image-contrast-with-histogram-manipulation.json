{
  "abstract" : "Enhance and adjust the contrast of an image with histogram equalization and contrast stretching.",
  "codeExamples" : [
    {
      "code" : "\/\/ vImage buffer histogram equalization.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageEqualization_ARGB8888(&sourceBuffer,\n                                &destinationBuffer,\n                                vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer histogram equalization.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    sourceBuffer.equalizeHistogram(destination: destinationBuffer)\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ vImage buffer contrast stretching.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageContrastStretch_ARGB8888(&sourceBuffer,\n                                   &destinationBuffer,\n                                   vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer contrast stretching.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    sourceBuffer.contrastStretch(destination: destinationBuffer)\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ vImage buffer ends-in contrast stretching.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageEndsInContrastStretch_ARGB8888(&sourceBuffer,\n                                         &destinationBuffer,\n                                         [25, 25, 25, 25],\n                                         [0, 0, 0, 0],\n                                         vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer ends-in contrast stretching.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    _ = sourceBuffer.withUnsafePointerToVImageBuffer { src in\n        destinationBuffer.withUnsafePointerToVImageBuffer { dst in\n            vImageEndsInContrastStretch_ARGB8888(src,\n                                                 dst,\n                                                 [25, 25, 25, 25],\n                                                 [0, 0, 0, 0],\n                                                 vImage_Flags(kvImageNoFlags))\n        }\n    }\n}\n ",
      "language" : "swift"
    },
    {
      "code" : "\/\/ vImage buffer ends-in contrast stretching.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageEndsInContrastStretch_ARGB8888(&sourceBuffer,\n                                         &destinationBuffer,\n                                         [0, 0, 0, 0],\n                                         [25, 25, 25, 25],\n                                         vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer ends-in contrast stretching.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    _ = sourceBuffer.withUnsafePointerToVImageBuffer { src in\n        destinationBuffer.withUnsafePointerToVImageBuffer { dst in\n            vImageEndsInContrastStretch_ARGB8888(src,\n                                                 dst,\n                                                 [0, 0, 0, 0],\n                                                 [25, 25, 25, 25],\n                                                 vImage_Flags(kvImageNoFlags))\n        }\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "2fc19173f1aa37dd02c3a5097b4419eae238c2e33649aaa1ec6cb7a96a80030e",
  "crawledAt" : "2025-12-02T15:55:41Z",
  "id" : "EF900834-AF4F-4FA8-A1DB-CF1988141C71",
  "kind" : "article",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Overview\n\nAn image histogram is a representation of an image that describes its color tones distribution. The histogram contains a series of bins that represent the possible values for each color channel. For example, each channel of an 8-bit image contains 256 histogram bins. Each bin contains the image’s pixel count of the corresponding value.\n\nThe histogram of the following low-contrast image shows that almost all of its pixel values are clustered around the mid values. There are no pixels on the left side — corresponding to low values — indicating the image doesn’t contain any very dark colors. Similarly, there are no pixels on the right side — corresponding to high values — indicating the images doesn’t contain any very bright colors. The thin, gray line shows the cumulative histogram, that is, a running sum of pixel counts at each intensity.\n\n\n\nvImage provides functions that can either equalize or stretch an image’s histogram to enhance the contrast of an image.\n\n### Apply histogram equalization to an image\n\nHistogram equalization transforms an image so that its histogram is more uniformly distributed across the entire range of values. The operation stretches dense parts of the histogram, where contrast is low, and condenses sparse parts of the histogram, where contrast is high. A truly uniform histogram is one in which each histogram bin contains the same value, that is, its cumulative histogram is a diagonal line. The vImage histogram equalization functions approximate that truly uniform histogram.\n\nThe following code shows how to perform histogram equalization for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures:\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after histogram equalization. The operation distributed the nonzero histogram bins across the entire range of values, and the result has a lot more contrast. The cumulative histogram is nearly a straight diagonal line, indicating an almost uniform distribution of values.\n\n\n\nNote that the histogram bins aren’t evenly distributed throughout the resulting histogram. The amount of stretching correlates to the number of pixels in each bin.\n\n### Apply contrast stretching to an image\n\nContrast stretching evenly distributes a histogram’s pixel values across the full range of available pixel values. This technique is ideal for enhancing the contrast of an image with pixel values concentrated in one area of the intensity spectrum, such as the original low-contrast image above.\n\nThe following code shows how to perform contrast stretching for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures:\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after histogram stretching. The result has a lot more contrast, and its histogram shows that values are evenly distributed throughout the entire range. The shape of the contrast stretched image’s cumulative histogram is very similar to the original image’s cumulative histogram.\n\n\n\n### Apply ends-in contrast stretching to an image\n\nThe vImage ends-in contrast stretching functions accept parameters that allow you to control which part of the histogram the operation stretches. Use ends-in contrast stretching for images with the majority of their pixels clustered in a single area and a small number of pixels at either end of their histogram. In these situations, standard contrast stretching may not yield your desired result.\n\nThe following figure illustrates how ends-in contrast stretching discards elements from a histogram and stretches the remaining values. The operation maps the 25% low values and 25% high values to 0 and 255 (for an 8-bit image), respectively. The result contains the central 50% of the source histogram stretched to fill the remaining 254 bins.\n\n\n\nNote that this illustration isn’t to scale; the operation uses percentages based on the number of pixels for each intensity.\n\nSet the `percent_low` parameter of the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)] function to define the percentage of pixels that the operation maps to the lowest end of the transformed image’s histogram. The following code shows how to perform ends-in contrast stretching for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures with `percent_low` set to 25% for all channels:\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after ends-in contrast stretching. This result is much darker overall with the histogram shifted to the left.\n\n\n\nSet the `percent_high` parameter of the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)] function to define the percentage of pixels that the operation maps to the high end of the transformed image’s histogram. The following code shows how to perform ends-in contrast stretching for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures with `percent_high` set to 25% for all channels:\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after ends-in contrast stretching. This result is much brighter overall with the histogram shifted to the right.\n\n",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/enhancing-image-contrast-with-histogram-manipulation\ncrawled: 2025-12-02T15:55:41Z\n---\n\n# Enhancing image contrast with histogram manipulation\n\n**Article**\n\nEnhance and adjust the contrast of an image with histogram equalization and contrast stretching.\n\n## Overview\n\nAn image histogram is a representation of an image that describes its color tones distribution. The histogram contains a series of bins that represent the possible values for each color channel. For example, each channel of an 8-bit image contains 256 histogram bins. Each bin contains the image’s pixel count of the corresponding value.\n\nThe histogram of the following low-contrast image shows that almost all of its pixel values are clustered around the mid values. There are no pixels on the left side — corresponding to low values — indicating the image doesn’t contain any very dark colors. Similarly, there are no pixels on the right side — corresponding to high values — indicating the images doesn’t contain any very bright colors. The thin, gray line shows the cumulative histogram, that is, a running sum of pixel counts at each intensity.\n\n\n\nvImage provides functions that can either equalize or stretch an image’s histogram to enhance the contrast of an image.\n\n### Apply histogram equalization to an image\n\nHistogram equalization transforms an image so that its histogram is more uniformly distributed across the entire range of values. The operation stretches dense parts of the histogram, where contrast is low, and condenses sparse parts of the histogram, where contrast is high. A truly uniform histogram is one in which each histogram bin contains the same value, that is, its cumulative histogram is a diagonal line. The vImage histogram equalization functions approximate that truly uniform histogram.\n\nThe following code shows how to perform histogram equalization for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures:\n\n```swift\n\/\/ vImage buffer histogram equalization.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageEqualization_ARGB8888(&sourceBuffer,\n                                &destinationBuffer,\n                                vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer histogram equalization.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    sourceBuffer.equalizeHistogram(destination: destinationBuffer)\n}\n```\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after histogram equalization. The operation distributed the nonzero histogram bins across the entire range of values, and the result has a lot more contrast. The cumulative histogram is nearly a straight diagonal line, indicating an almost uniform distribution of values.\n\n\n\nNote that the histogram bins aren’t evenly distributed throughout the resulting histogram. The amount of stretching correlates to the number of pixels in each bin.\n\n### Apply contrast stretching to an image\n\nContrast stretching evenly distributes a histogram’s pixel values across the full range of available pixel values. This technique is ideal for enhancing the contrast of an image with pixel values concentrated in one area of the intensity spectrum, such as the original low-contrast image above.\n\nThe following code shows how to perform contrast stretching for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures:\n\n```swift\n\/\/ vImage buffer contrast stretching.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageContrastStretch_ARGB8888(&sourceBuffer,\n                                   &destinationBuffer,\n                                   vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer contrast stretching.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    sourceBuffer.contrastStretch(destination: destinationBuffer)\n}\n```\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after histogram stretching. The result has a lot more contrast, and its histogram shows that values are evenly distributed throughout the entire range. The shape of the contrast stretched image’s cumulative histogram is very similar to the original image’s cumulative histogram.\n\n\n\n### Apply ends-in contrast stretching to an image\n\nThe vImage ends-in contrast stretching functions accept parameters that allow you to control which part of the histogram the operation stretches. Use ends-in contrast stretching for images with the majority of their pixels clustered in a single area and a small number of pixels at either end of their histogram. In these situations, standard contrast stretching may not yield your desired result.\n\nThe following figure illustrates how ends-in contrast stretching discards elements from a histogram and stretches the remaining values. The operation maps the 25% low values and 25% high values to 0 and 255 (for an 8-bit image), respectively. The result contains the central 50% of the source histogram stretched to fill the remaining 254 bins.\n\n\n\nNote that this illustration isn’t to scale; the operation uses percentages based on the number of pixels for each intensity.\n\nSet the `percent_low` parameter of the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)] function to define the percentage of pixels that the operation maps to the lowest end of the transformed image’s histogram. The following code shows how to perform ends-in contrast stretching for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures with `percent_low` set to 25% for all channels:\n\n```swift\n\/\/ vImage buffer ends-in contrast stretching.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageEndsInContrastStretch_ARGB8888(&sourceBuffer,\n                                         &destinationBuffer,\n                                         [25, 25, 25, 25],\n                                         [0, 0, 0, 0],\n                                         vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer ends-in contrast stretching.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    _ = sourceBuffer.withUnsafePointerToVImageBuffer { src in\n        destinationBuffer.withUnsafePointerToVImageBuffer { dst in\n            vImageEndsInContrastStretch_ARGB8888(src,\n                                                 dst,\n                                                 [25, 25, 25, 25],\n                                                 [0, 0, 0, 0],\n                                                 vImage_Flags(kvImageNoFlags))\n        }\n    }\n}\n \n```\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after ends-in contrast stretching. This result is much darker overall with the histogram shifted to the left.\n\n\n\nSet the `percent_high` parameter of the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)] function to define the percentage of pixels that the operation maps to the high end of the transformed image’s histogram. The following code shows how to perform ends-in contrast stretching for [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer] structures with `percent_high` set to 25% for all channels:\n\n```swift\n\/\/ vImage buffer ends-in contrast stretching.\ndo {\n    var sourceBuffer: vImage_Buffer = ...\n    var destinationBuffer: vImage_Buffer = ...\n    \n    vImageEndsInContrastStretch_ARGB8888(&sourceBuffer,\n                                         &destinationBuffer,\n                                         [0, 0, 0, 0],\n                                         [25, 25, 25, 25],\n                                         vImage_Flags(kvImageNoFlags))\n}\n\n\/\/ vImage pixel buffer ends-in contrast stretching.\ndo {\n    let sourceBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    let destinationBuffer: vImage.PixelBuffer<vImage.Interleaved8x4> = ...\n    \n    _ = sourceBuffer.withUnsafePointerToVImageBuffer { src in\n        destinationBuffer.withUnsafePointerToVImageBuffer { dst in\n            vImageEndsInContrastStretch_ARGB8888(src,\n                                                 dst,\n                                                 [0, 0, 0, 0],\n                                                 [25, 25, 25, 25],\n                                                 vImage_Flags(kvImageNoFlags))\n        }\n    }\n}\n```\n\nOn return, `destinationBuffer` contains the transformed image. The picture below shows the low-contrast image after ends-in contrast stretching. This result is much brighter overall with the histogram shifted to the right.\n\n\n\n## Related Documentation\n\n- **equalizeHistogram(destination:)**: Equalizes the histogram of a multiple-plane 8-bit pixel buffer.\n- **contrastStretch(destination:)**: Stretches the histogram of an 8-bit-per-channel, 4-channel interleaved pixel buffer.\n- **vImageEqualization_ARGB8888(_:_:_:)**: Performs histogram equalization on an 8-bit-per-channel, 4-channel interleaved buffer.\n- **vImageContrastStretch_ARGB8888(_:_:_:)**: Performs contrast stretching on an 8-bit-per-channel, 4-channel interleaved buffer.\n- **vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)**: Performs ends-in contrast stretching on an 8-bit-per-channel, 4-channel interleaved buffer.\n\n## Color and Tone Adjustment\n\n- **Adjusting the brightness and contrast of an image**: Use a gamma function to apply a linear or exponential curve.\n- **Adjusting saturation and applying tone mapping**: Convert an RGB image to discrete luminance and chrominance channels, and apply color and contrast treatments.\n- **Applying tone curve adjustments to images**: Use the vImage library’s polynomial transform to apply tone curve adjustments to images.\n- **Adjusting the hue of an image**: Convert an image to L*a*b* color space and apply hue adjustment.\n- **Specifying histograms with vImage**: Calculate the histogram of one image, and apply it to a second image.\n- **Histogram**: Calculate or manipulate an image’s histogram.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Equalizes the histogram of a multiple-plane 8-bit pixel buffer.",
          "name" : "equalizeHistogram(destination:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImage\/PixelBuffer\/equalizeHistogram(destination:)-939xn"
        },
        {
          "description" : "Stretches the histogram of an 8-bit-per-channel, 4-channel interleaved pixel buffer.",
          "name" : "contrastStretch(destination:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImage\/PixelBuffer\/contrastStretch(destination:)-7zo9"
        },
        {
          "description" : "Performs histogram equalization on an 8-bit-per-channel, 4-channel interleaved buffer.",
          "name" : "vImageEqualization_ARGB8888(_:_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageEqualization_ARGB8888(_:_:_:)"
        },
        {
          "description" : "Performs contrast stretching on an 8-bit-per-channel, 4-channel interleaved buffer.",
          "name" : "vImageContrastStretch_ARGB8888(_:_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageContrastStretch_ARGB8888(_:_:_:)"
        },
        {
          "description" : "Performs ends-in contrast stretching on an 8-bit-per-channel, 4-channel interleaved buffer.",
          "name" : "vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImageEndsInContrastStretch_ARGB8888(_:_:_:_:_:)"
        }
      ],
      "title" : "Related Documentation"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Use a gamma function to apply a linear or exponential curve.",
          "name" : "Adjusting the brightness and contrast of an image",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/adjusting-the-brightness-and-contrast-of-an-image"
        },
        {
          "description" : "Convert an RGB image to discrete luminance and chrominance channels, and apply color and contrast treatments.",
          "name" : "Adjusting saturation and applying tone mapping",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/adjusting-saturation-and-applying-tone-mapping"
        },
        {
          "description" : "Use the vImage library’s polynomial transform to apply tone curve adjustments to images.",
          "name" : "Applying tone curve adjustments to images",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/applying-tone-curve-adjustments-to-images"
        },
        {
          "description" : "Convert an image to L*a*b* color space and apply hue adjustment.",
          "name" : "Adjusting the hue of an image",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/adjusting-the-hue-of-an-image"
        },
        {
          "description" : "Calculate the histogram of one image, and apply it to a second image.",
          "name" : "Specifying histograms with vImage",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/specifying-histograms-with-vimage"
        },
        {
          "description" : "Calculate or manipulate an image’s histogram.",
          "name" : "Histogram",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/histogram"
        }
      ],
      "title" : "Color and Tone Adjustment"
    }
  ],
  "source" : "appleJSON",
  "title" : "Enhancing image contrast with histogram manipulation",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/enhancing-image-contrast-with-histogram-manipulation"
}