{
  "abstract" : "Initialize vImage buffers from Core Graphics images.",
  "codeExamples" : [
    {
      "code" : "guard\n    let cgImage = UIImage(named: \"Flowers_2.jpg\")?.cgImage,\n    var sourceBuffer = try? vImage_Buffer(cgImage: cgImage,\n                                          format: format) else {\n                                            return nil\n}",
      "language" : "swift"
    },
    {
      "code" : "guard var destinationBuffer = try? vImage_Buffer(width: Int(sourceBuffer.width),\n                                                 height: Int(sourceBuffer.height),\n                                                 bitsPerPixel: format.bitsPerPixel) else {\n                                                    return nil\n}",
      "language" : "swift"
    },
    {
      "code" : "sourceBuffer.free()\ndestinationBuffer.free()",
      "language" : "swift"
    }
  ],
  "contentHash" : "b46b63b2cfae362ae62379d46fed45f27237d81112d51b514873f385d1081ace",
  "crawledAt" : "2025-12-02T15:55:11Z",
  "id" : "C8768B22-F59C-47FE-9BC6-391637E62A39",
  "kind" : "article",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Overview\n\n[doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] structures are the basic data structures that vImage uses for working with images. They describe an image’s dimensions and contain the pixel data that vImage routines operate on.\n\nTypically, you’ll initialize a source buffer from an image and initialize and allocate a destination buffer to receive the result of a vImage operation.\n\n### Initialize a Source Buffer from a Core Graphics Image\n\nThe vImage functions that initialize a buffer’s size and data require an instantiated [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] structure. Typically, you declare a buffer as a variable because these functions mutate the buffer.\n\nYou can initialize a vImage buffer from a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] instance that’s acquired from the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIImage\/cgImage] property of an image. In the following example, the image is named `Flowers_2.jpg`. The [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer\/init(cgImage:format:flags:)] function initializes a [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] structure with the image data using the format discussed in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/converting-bitmap-data-between-core-graphics-images-and-vimage-buffers].\n\n### Initialize and Allocate a Destination Buffer\n\nTypically, in addition to creating a buffer to represent your source image, you create a destination buffer to receive the result of the vImage operation. In this case, you use the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer\/init(width:height:bitsPerPixel:)] function to initialize a buffer of a specified size and the correct memory allocation for the bit-depth of the image:\n\n### Free the Buffer Memory\n\nAfter you’re finished with buffers that have have their own memory allocation, it’s important that you free the memory allocated to them:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/creating-and-populating-buffers-from-core-graphics-images\ncrawled: 2025-12-02T15:55:11Z\n---\n\n# Creating and Populating Buffers from Core Graphics Images\n\n**Article**\n\nInitialize vImage buffers from Core Graphics images.\n\n## Overview\n\n[doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] structures are the basic data structures that vImage uses for working with images. They describe an image’s dimensions and contain the pixel data that vImage routines operate on.\n\nTypically, you’ll initialize a source buffer from an image and initialize and allocate a destination buffer to receive the result of a vImage operation.\n\n### Initialize a Source Buffer from a Core Graphics Image\n\nThe vImage functions that initialize a buffer’s size and data require an instantiated [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] structure. Typically, you declare a buffer as a variable because these functions mutate the buffer.\n\nYou can initialize a vImage buffer from a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] instance that’s acquired from the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIImage\/cgImage] property of an image. In the following example, the image is named `Flowers_2.jpg`. The [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer\/init(cgImage:format:flags:)] function initializes a [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer] structure with the image data using the format discussed in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/converting-bitmap-data-between-core-graphics-images-and-vimage-buffers].\n\n```swift\nguard\n    let cgImage = UIImage(named: \"Flowers_2.jpg\")?.cgImage,\n    var sourceBuffer = try? vImage_Buffer(cgImage: cgImage,\n                                          format: format) else {\n                                            return nil\n}\n```\n\n### Initialize and Allocate a Destination Buffer\n\nTypically, in addition to creating a buffer to represent your source image, you create a destination buffer to receive the result of the vImage operation. In this case, you use the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_Buffer\/init(width:height:bitsPerPixel:)] function to initialize a buffer of a specified size and the correct memory allocation for the bit-depth of the image:\n\n```swift\nguard var destinationBuffer = try? vImage_Buffer(width: Int(sourceBuffer.width),\n                                                 height: Int(sourceBuffer.height),\n                                                 bitsPerPixel: format.bitsPerPixel) else {\n                                                    return nil\n}\n```\n\n### Free the Buffer Memory\n\nAfter you’re finished with buffers that have have their own memory allocation, it’s important that you free the memory allocated to them:\n\n```swift\nsourceBuffer.free()\ndestinationBuffer.free()\n```\n\n## Image Processing Essentials\n\n- **Converting bitmap data between Core Graphics images and vImage buffers**: Pass image data between Core Graphics and vImage to create and manipulate images.\n- **Creating a Core Graphics Image from a vImage Buffer**: Create displayable representations of vImage buffers.\n- **Building a Basic Image-Processing Workflow**: Resize an image with vImage.\n- **Applying geometric transforms to images**: Reflect, shear, rotate, and scale image buffers using vImage.\n- **Compositing images with alpha blending**: Combine two images by using alpha blending to create a single output.\n- **Compositing images with vImage blend modes**: Combine two images by using blend modes to create a single output.\n- **Applying vImage operations to regions of interest**: Limit the effect of vImage operations to rectangular regions of interest.\n- **Optimizing image-processing performance**: Improve your app’s performance by converting image buffer formats from interleaved to planar.\n- **vImage**: Manipulate large images using the CPU’s vector processor.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Pass image data between Core Graphics and vImage to create and manipulate images.",
          "name" : "Converting bitmap data between Core Graphics images and vImage buffers",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/converting-bitmap-data-between-core-graphics-images-and-vimage-buffers"
        },
        {
          "description" : "Create displayable representations of vImage buffers.",
          "name" : "Creating a Core Graphics Image from a vImage Buffer",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/creating-a-core-graphics-image-from-a-vimage-buffer"
        },
        {
          "description" : "Resize an image with vImage.",
          "name" : "Building a Basic Image-Processing Workflow",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/building-a-basic-image-processing-workflow"
        },
        {
          "description" : "Reflect, shear, rotate, and scale image buffers using vImage.",
          "name" : "Applying geometric transforms to images",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/applying-geometric-transforms-to-images"
        },
        {
          "description" : "Combine two images by using alpha blending to create a single output.",
          "name" : "Compositing images with alpha blending",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/compositing-images-with-alpha-blending"
        },
        {
          "description" : "Combine two images by using blend modes to create a single output.",
          "name" : "Compositing images with vImage blend modes",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/compositing-images-with-vimage-blend-modes"
        },
        {
          "description" : "Limit the effect of vImage operations to rectangular regions of interest.",
          "name" : "Applying vImage operations to regions of interest",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/applying-vimage-operations-to-regions-of-interest"
        },
        {
          "description" : "Improve your app’s performance by converting image buffer formats from interleaved to planar.",
          "name" : "Optimizing image-processing performance",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/optimizing-image-processing-performance"
        },
        {
          "description" : "Manipulate large images using the CPU’s vector processor.",
          "name" : "vImage",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vimage-library"
        }
      ],
      "title" : "Image Processing Essentials"
    }
  ],
  "source" : "appleJSON",
  "title" : "Creating and Populating Buffers from Core Graphics Images",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/creating-and-populating-buffers-from-core-graphics-images"
}