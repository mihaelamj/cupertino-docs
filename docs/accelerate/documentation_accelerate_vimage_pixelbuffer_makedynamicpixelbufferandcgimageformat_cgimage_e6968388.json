{
  "abstract" : "Returns a new dynamic pixel format pixel buffer and Core Graphics image format structure from a Core Graphics image.",
  "codeExamples" : [
    {
      "code" : "let srcImage = imageLiteral(resourceName: \" ... \").cgImage(\n    forProposedRect: nil,\n    context: nil,\n    hints: nil)!\n\nlet source = try vImage.PixelBuffer.makeDynamicPixelBufferAndCGImageFormat(\n    cgImage: srcImage)\n\nlet destFormat = vImage_CGImageFormat(\n    bitsPerComponent: 8,\n    bitsPerPixel: 8,\n    colorSpace: CGColorSpaceCreateDeviceGray(),\n    bitmapInfo: CGBitmapInfo(rawValue: CGImageAlphaInfo.none.rawValue))!\n\nlet destBuffer = vImage.PixelBuffer(size: source.pixelBuffer.size,\n                                    pixelFormat: vImage.Planar8.self)\n\nlet converter = try vImageConverter.make(sourceFormat: source.cgImageFormat,\n                                         destinationFormat: destFormat)\n\ntry converter.convert(from: source.pixelBuffer, to: destBuffer)",
      "language" : "swift"
    }
  ],
  "contentHash" : "220c7171a292920a62e70e4e0b2d7654c7644b22bb424ac6835da3f13dbff3af",
  "crawledAt" : "2025-12-03T08:24:34Z",
  "declaration" : {
    "code" : "static func makeDynamicPixelBufferAndCGImageFormat(cgImage: CGImage) throws -> (pixelBuffer: vImage.PixelBuffer<vImage.DynamicPixelFormat>, cgImageFormat: vImage_CGImageFormat)",
    "language" : "swift"
  },
  "id" : "E2537512-A2C8-42AE-8788-0C17601CAC5B",
  "kind" : "method",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Return Value\n\nA new pixel buffer of type [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/DynamicPixelFormat] and a [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] that describes the ordering and number of the color channels, the size and type of the data in the color channels, and whether or not the data is premultiplied by alpha.\n\n## Discussion\n\nUse this function to create an image format and pixel buffer from a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] instance. The pixel buffer that this function returns has a pixel format that’s unknown at compile time.\n\nNote that you can call [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer\/init(cgImage:cgImageFormat:pixelFormat:)] to create a statically typed pixel buffer from a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] instance. However, this function allows you to create your own any-to-any converter for more control over the conversion process to a statically typed buffer.\n\nFor example, the following code creates a dynamically typed pixel buffer and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] from a source image. Use the returned [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] as the source format on an any-to-any converter. For example:\n\nOn return, `destBuffer` contains an 8-bit, grayscale representation of the original image.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/vImage\/PixelBuffer\/makeDynamicPixelBufferAndCGImageFormat(cgImage:)\ncrawled: 2025-12-03T08:24:34Z\n---\n\n# makeDynamicPixelBufferAndCGImageFormat(cgImage:)\n\n**Type Method**\n\nReturns a new dynamic pixel format pixel buffer and Core Graphics image format structure from a Core Graphics image.\n\n## Declaration\n\n```swift\nstatic func makeDynamicPixelBufferAndCGImageFormat(cgImage: CGImage) throws -> (pixelBuffer: vImage.PixelBuffer<vImage.DynamicPixelFormat>, cgImageFormat: vImage_CGImageFormat)\n```\n\n## Parameters\n\n- **cgImage**: The source Core Graphics image.\n\n## Return Value\n\nA new pixel buffer of type [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/DynamicPixelFormat] and a [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] that describes the ordering and number of the color channels, the size and type of the data in the color channels, and whether or not the data is premultiplied by alpha.\n\n## Discussion\n\nUse this function to create an image format and pixel buffer from a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] instance. The pixel buffer that this function returns has a pixel format that’s unknown at compile time.\n\nNote that you can call [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage\/PixelBuffer\/init(cgImage:cgImageFormat:pixelFormat:)] to create a statically typed pixel buffer from a [doc:\/\/com.apple.documentation\/documentation\/CoreGraphics\/CGImage] instance. However, this function allows you to create your own any-to-any converter for more control over the conversion process to a statically typed buffer.\n\nFor example, the following code creates a dynamically typed pixel buffer and [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] from a source image. Use the returned [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vImage_CGImageFormat] as the source format on an any-to-any converter. For example:\n\n```swift\nlet srcImage = imageLiteral(resourceName: \" ... \").cgImage(\n    forProposedRect: nil,\n    context: nil,\n    hints: nil)!\n\nlet source = try vImage.PixelBuffer.makeDynamicPixelBufferAndCGImageFormat(\n    cgImage: srcImage)\n\nlet destFormat = vImage_CGImageFormat(\n    bitsPerComponent: 8,\n    bitsPerPixel: 8,\n    colorSpace: CGColorSpaceCreateDeviceGray(),\n    bitmapInfo: CGBitmapInfo(rawValue: CGImageAlphaInfo.none.rawValue))!\n\nlet destBuffer = vImage.PixelBuffer(size: source.pixelBuffer.size,\n                                    pixelFormat: vImage.Planar8.self)\n\nlet converter = try vImageConverter.make(sourceFormat: source.cgImageFormat,\n                                         destinationFormat: destFormat)\n\ntry converter.convert(from: source.pixelBuffer, to: destBuffer)\n```\n\nOn return, `destBuffer` contains an 8-bit, grayscale representation of the original image.\n\n## Creating a pixel buffer and image format\n\n- **makePixelBufferAndCGImageFormat(cgImage:pixelFormat:)**: Returns a new pixel buffer and Core Graphics image format structure from a Core Graphics image.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns a new pixel buffer and Core Graphics image format structure from a Core Graphics image.",
          "name" : "makePixelBufferAndCGImageFormat(cgImage:pixelFormat:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImage\/PixelBuffer\/makePixelBufferAndCGImageFormat(cgImage:pixelFormat:)"
        }
      ],
      "title" : "Creating a pixel buffer and image format"
    }
  ],
  "source" : "appleJSON",
  "title" : "makeDynamicPixelBufferAndCGImageFormat(cgImage:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/vImage\/PixelBuffer\/makeDynamicPixelBufferAndCGImageFormat(cgImage:)"
}