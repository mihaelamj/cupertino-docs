{
  "abstract" : "Change the frequency response of an audio signal using a cascaded biquadratic filter.",
  "codeExamples" : [
    {
      "code" : "public let biquadSectionCount = vDSP_Length(3)",
      "language" : "swift"
    },
    {
      "code" : "let coefficients = [[Float]](\n    repeating: BiquadCoefficientCalculator.passthroughCoefficients.array,\n    count: Int(biquadSectionCount)).flatMap {\n        $0\n}\n\nbiquadSetup = vDSP_biquad_CreateSetup(vDSP.floatToDouble(coefficients),\n                                      biquadSectionCount)!",
      "language" : "swift"
    },
    {
      "code" : "let omega = 2.0 * .pi * frequency \/ Float(sampleRate)\nlet sinOmega = sin(omega)\nlet alpha = sinOmega \/ (2 * Q)\nlet cosOmega = cos(omega)",
      "language" : "swift"
    },
    {
      "code" : "case .lowpass:\n    b0 = (1 - cosOmega) \/ 2\n    b1 = 1 - cosOmega\n    b2 = (1 - cosOmega) \/ 2\n    a0 = 1 + alpha\n    a1 = -2 * cosOmega\n    a2 = 1 - alpha",
      "language" : "swift"
    },
    {
      "code" : "vDSP_biquad_SetCoefficientsSingle(biquadSetup,\n                                  selectedSectionCoefficients.array,\n                                  vDSP_Length(selectedSectionIndex),\n                                  1)",
      "language" : "swift"
    },
    {
      "code" : "vDSP_biquad(biquadSetup,\n            &delay,\n            page, 1,\n            &outputSignal, 1,\n            vDSP_Length(Self.sampleCount))",
      "language" : "swift"
    }
  ],
  "contentHash" : "492068fcf26255091db1c542ff3b27959a4d48301c7b3a5b20b5eca5c57c7579",
  "crawledAt" : "2025-12-02T15:45:55Z",
  "id" : "FDDCD453-8DC7-402F-BAF5-A5242BFBFCE3",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Overview\n\nYou can shape the output of an audio signal, such as by boosting or cutting the bass or treble of a music track, with the single-channel and multichannel biquadratic filters that the vDSP library provides.\n\nThe vDSP library defines a biquadratic filter from a set of five coefficients for each section. This sample code app calculates those coefficients from a set of properties that it displays as controls in the user interface. The user interface provides controls to select the filter type (such as low-pass or high-pass), the center frequency of the filter, and the Q value that controls the width of the filter’s frequency band.\n\nThe sample code app displays the magnitude response of the selected section, the magnitude response of the entire filter, the frequency-domain representation of the input signal, and the frequency-domain representation of the filtered, output signal.\n\n\n\nBefore exploring the code, try building and running the app to familiarize yourself with the effect of the different parameters on the music loop.\n\n### Initialize the biquadratic filter\n\nThe `biquadSectionCount` constant defines the number of sections that the biquadratic filter implements. The sample code app sets this to `3` by default.\n\nThe [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad_CreateSetup] function returns a new biquadratic filter structure that contains `biquadSectionCount` sections. The sample code app defines the coefficients to produce a filter that returns an output that’s identical to the input.\n\n### Define the biquadratic coefficients\n\nFive coefficients define each section of a biquadratic filter. The following formula describes the underlying math of the biquadratic filter, with *z* referring to the complex frequency-domain representation of the signal:\n\n\n\nThe sample code app includes the `BiquadCoefficientCalculator` structure that provides the `static BiquadCoefficientCalculator.coefficients(for:sampleRate:)` function. This function returns the five coefficients for a filter type, center frequency, Q, and sample rate.\n\nEach filter type uses the same shared values.\n\nA `switch` statement calculates the coefficients for each filter type case. For example, the following code calculates the coefficients for a low-pass filter (that reduces high frequencies):\n\n### Set the biquadratic coefficients\n\nThe [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad_SetCoefficientsSingle] function sets the coefficients for a section of the biquadratic filter. The sample code app defines `selectedSectionIndex` as the index of the currently selected section, and the `BiquadCoefficientCalculator.SectionCoefficients` structure provides an `array` variable that returns `[b0, b1, b2, a1, a2]`.\n\n### Apply the biquadratic filter to the audio sample\n\nThe [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad] function applies the biquadratic filter to a page of input samples and writes the result to the `outputSignal` array. The `delay` array contains the past state for each section of the biquadratic filter.\n\nOn return, `outputSignal` contains the filtered version of `page`, and `delay` contains the final state data of the filter. The sample code app passes `delay` to the next call of [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/applying-biquadratic-filters-to-a-music-loop\ncrawled: 2025-12-02T15:45:55Z\n---\n\n# Applying biquadratic filters to a music loop\n\n**Sample Code**\n\nChange the frequency response of an audio signal using a cascaded biquadratic filter.\n\n## Overview\n\nYou can shape the output of an audio signal, such as by boosting or cutting the bass or treble of a music track, with the single-channel and multichannel biquadratic filters that the vDSP library provides.\n\nThe vDSP library defines a biquadratic filter from a set of five coefficients for each section. This sample code app calculates those coefficients from a set of properties that it displays as controls in the user interface. The user interface provides controls to select the filter type (such as low-pass or high-pass), the center frequency of the filter, and the Q value that controls the width of the filter’s frequency band.\n\nThe sample code app displays the magnitude response of the selected section, the magnitude response of the entire filter, the frequency-domain representation of the input signal, and the frequency-domain representation of the filtered, output signal.\n\n\n\nBefore exploring the code, try building and running the app to familiarize yourself with the effect of the different parameters on the music loop.\n\n### Initialize the biquadratic filter\n\nThe `biquadSectionCount` constant defines the number of sections that the biquadratic filter implements. The sample code app sets this to `3` by default.\n\n```swift\npublic let biquadSectionCount = vDSP_Length(3)\n```\n\nThe [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad_CreateSetup] function returns a new biquadratic filter structure that contains `biquadSectionCount` sections. The sample code app defines the coefficients to produce a filter that returns an output that’s identical to the input.\n\n```swift\nlet coefficients = [[Float]](\n    repeating: BiquadCoefficientCalculator.passthroughCoefficients.array,\n    count: Int(biquadSectionCount)).flatMap {\n        $0\n}\n\nbiquadSetup = vDSP_biquad_CreateSetup(vDSP.floatToDouble(coefficients),\n                                      biquadSectionCount)!\n```\n\n### Define the biquadratic coefficients\n\nFive coefficients define each section of a biquadratic filter. The following formula describes the underlying math of the biquadratic filter, with *z* referring to the complex frequency-domain representation of the signal:\n\n\n\nThe sample code app includes the `BiquadCoefficientCalculator` structure that provides the `static BiquadCoefficientCalculator.coefficients(for:sampleRate:)` function. This function returns the five coefficients for a filter type, center frequency, Q, and sample rate.\n\nEach filter type uses the same shared values.\n\n```swift\nlet omega = 2.0 * .pi * frequency \/ Float(sampleRate)\nlet sinOmega = sin(omega)\nlet alpha = sinOmega \/ (2 * Q)\nlet cosOmega = cos(omega)\n```\n\nA `switch` statement calculates the coefficients for each filter type case. For example, the following code calculates the coefficients for a low-pass filter (that reduces high frequencies):\n\n```swift\ncase .lowpass:\n    b0 = (1 - cosOmega) \/ 2\n    b1 = 1 - cosOmega\n    b2 = (1 - cosOmega) \/ 2\n    a0 = 1 + alpha\n    a1 = -2 * cosOmega\n    a2 = 1 - alpha\n```\n\n### Set the biquadratic coefficients\n\nThe [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad_SetCoefficientsSingle] function sets the coefficients for a section of the biquadratic filter. The sample code app defines `selectedSectionIndex` as the index of the currently selected section, and the `BiquadCoefficientCalculator.SectionCoefficients` structure provides an `array` variable that returns `[b0, b1, b2, a1, a2]`.\n\n```swift\nvDSP_biquad_SetCoefficientsSingle(biquadSetup,\n                                  selectedSectionCoefficients.array,\n                                  vDSP_Length(selectedSectionIndex),\n                                  1)\n```\n\n### Apply the biquadratic filter to the audio sample\n\nThe [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad] function applies the biquadratic filter to a page of input samples and writes the result to the `outputSignal` array. The `delay` array contains the past state for each section of the biquadratic filter.\n\n```swift\nvDSP_biquad(biquadSetup,\n            &delay,\n            page, 1,\n            &outputSignal, 1,\n            vDSP_Length(Self.sampleCount))\n```\n\nOn return, `outputSignal` contains the filtered version of `page`, and `delay` contains the final state data of the filter. The sample code app passes `delay` to the next call of [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/vDSP_biquad].\n\n## Audio Processing\n\n- **Visualizing sound as an audio spectrogram**: Share image data between vDSP and vImage to visualize audio that a device microphone captures.\n- **Equalizing audio with discrete cosine transforms (DCTs)**: Change the frequency response of an audio signal by manipulating frequency-domain data.\n- **Biquadratic IIR filters**: Apply biquadratic filters to single-channel and multichannel data.\n- **Discrete Cosine transforms**: Transform vectors of temporal and spatial domain real values to the frequency domain, and vice versa.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Share image data between vDSP and vImage to visualize audio that a device microphone captures.",
          "name" : "Visualizing sound as an audio spectrogram",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/visualizing-sound-as-an-audio-spectrogram"
        },
        {
          "description" : "Change the frequency response of an audio signal by manipulating frequency-domain data.",
          "name" : "Equalizing audio with discrete cosine transforms (DCTs)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/equalizing-audio-with-discrete-cosine-transforms-dcts"
        },
        {
          "description" : "Apply biquadratic filters to single-channel and multichannel data.",
          "name" : "Biquadratic IIR filters",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/biquadratic-iir-filters"
        },
        {
          "description" : "Transform vectors of temporal and spatial domain real values to the frequency domain, and vice versa.",
          "name" : "Discrete Cosine transforms",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/discrete-cosine-transforms"
        }
      ],
      "title" : "Audio Processing"
    }
  ],
  "source" : "appleJSON",
  "title" : "Applying biquadratic filters to a music loop",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/applying-biquadratic-filters-to-a-music-loop"
}