{
  "abstract" : "Recreate an entire file system directory from an archive file.",
  "codeExamples" : [
    {
      "code" : "let archiveFilePath = FilePath(NSTemporaryDirectory() + \"directory.aar\")\n\nguard let readFileStream = ArchiveByteStream.fileStream(\n        path: archiveFilePath,\n        mode: .readOnly,\n        options: [ ],\n        permissions: FilePermissions(rawValue: 0o644)) else {\n    return\n}\ndefer {\n    try? readFileStream.close()\n}",
      "language" : "swift"
    },
    {
      "code" : "guard let decompressStream = ArchiveByteStream.decompressionStream(readingFrom: readFileStream) else {\n    return\n}\ndefer {\n    try? decompressStream.close()\n}",
      "language" : "swift"
    },
    {
      "code" : "guard let decodeStream = ArchiveStream.decodeStream(readingFrom: decompressStream) else {\n    print(\"unable to create decode stream\")\n    return\n}\ndefer {\n    try? decodeStream.close()\n}",
      "language" : "swift"
    },
    {
      "code" : "let decompressPath = NSTemporaryDirectory() + \"dest\/\"\n\nif !FileManager.default.fileExists(atPath: decompressPath) {\n    do {\n        try FileManager.default.createDirectory(atPath: decompressPath,\n                                                withIntermediateDirectories: false)\n    } catch {\n        fatalError(\"Unable to create destination directory.\")\n    }\n}\n\nlet decompressDestination = FilePath(decompressPath)",
      "language" : "swift"
    },
    {
      "code" : "guard let extractStream = ArchiveStream.extractStream(extractingTo: decompressDestination,\n                                                      flags: [ .ignoreOperationNotPermitted ]) else {\n    return\n}\ndefer {\n    try? extractStream.close()\n}",
      "language" : "swift"
    },
    {
      "code" : "do {\n    _ = try ArchiveStream.process(readingFrom: decodeStream,\n                                  writingTo: extractStream)\n} catch {\n    print(\"process failed\")\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "13319130a9ae1122e72ef825f22ac85ec6b1e1ef011c47a054347b5040713ee9",
  "crawledAt" : "2025-12-02T16:25:37Z",
  "id" : "03221FF9-0D0E-4CB6-B96A-7CB7BD273F8D",
  "kind" : "article",
  "language" : "swift",
  "module" : "Accelerate",
  "overview" : "## Overview\n\nIn this article, you’ll learn how to use AppleArchive to decompress and extract a previously compressed file system directory.\n\nThe code below decompresses the file generated using the steps explained in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/compressing-file-system-directories] and writes the files to a directory named `dest`.\n\n### Create the file stream to read the source archive\n\nThe [doc:\/\/com.apple.documentation\/documentation\/AppleArchive\/ArchiveByteStream] class provides static factory methods that create streams for different functions. In this case, use [doc:\/\/com.apple.documentation\/documentation\/AppleArchive\/ArchiveByteStream\/fileStream(path:mode:options:permissions:)] to create a byte stream that reads the source file:\n\n### Create the decompression stream\n\nCreate the decompression stream. Specify the file-reading stream as the input stream that provides the compressed data:\n\n### Create the decoding stream\n\nCreate a decoding stream that provides archive elements from the raw, decompressed data:\n\n### Specify the destination\n\nSpecify a destination path for the decompressed directory contents. The following code checks that the destination directory exists and creates the destination if neccessary:\n\n### Create the extract stream\n\nCreate an extract stream that receives archive elements, and extracts to the specified directory:\n\n### Decompress and extract the archived directory\n\nFinally, call [doc:\/\/com.apple.documentation\/documentation\/AppleArchive\/ArchiveByteStream\/process(readingFrom:writingTo:)] to write the output of the decode stream to the extract stream. In turn, the extract stream extracts each archive element to the decompression destination:\n\nOn return, the operation recreates the contents of the directory previously archived in `directory.aar` in [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSTemporaryDirectory()] `+ “dest\/”.`",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/accelerate\/decompressing-and-extracting-an-archived-directory\ncrawled: 2025-12-02T16:25:37Z\n---\n\n# Decompressing and extracting an archived directory\n\n**Article**\n\nRecreate an entire file system directory from an archive file.\n\n## Overview\n\nIn this article, you’ll learn how to use AppleArchive to decompress and extract a previously compressed file system directory.\n\nThe code below decompresses the file generated using the steps explained in [doc:\/\/com.apple.documentation\/documentation\/Accelerate\/compressing-file-system-directories] and writes the files to a directory named `dest`.\n\n### Create the file stream to read the source archive\n\nThe [doc:\/\/com.apple.documentation\/documentation\/AppleArchive\/ArchiveByteStream] class provides static factory methods that create streams for different functions. In this case, use [doc:\/\/com.apple.documentation\/documentation\/AppleArchive\/ArchiveByteStream\/fileStream(path:mode:options:permissions:)] to create a byte stream that reads the source file:\n\n```swift\nlet archiveFilePath = FilePath(NSTemporaryDirectory() + \"directory.aar\")\n\nguard let readFileStream = ArchiveByteStream.fileStream(\n        path: archiveFilePath,\n        mode: .readOnly,\n        options: [ ],\n        permissions: FilePermissions(rawValue: 0o644)) else {\n    return\n}\ndefer {\n    try? readFileStream.close()\n}\n```\n\n### Create the decompression stream\n\nCreate the decompression stream. Specify the file-reading stream as the input stream that provides the compressed data:\n\n```swift\nguard let decompressStream = ArchiveByteStream.decompressionStream(readingFrom: readFileStream) else {\n    return\n}\ndefer {\n    try? decompressStream.close()\n}\n```\n\n### Create the decoding stream\n\nCreate a decoding stream that provides archive elements from the raw, decompressed data:\n\n```swift\nguard let decodeStream = ArchiveStream.decodeStream(readingFrom: decompressStream) else {\n    print(\"unable to create decode stream\")\n    return\n}\ndefer {\n    try? decodeStream.close()\n}\n```\n\n### Specify the destination\n\nSpecify a destination path for the decompressed directory contents. The following code checks that the destination directory exists and creates the destination if neccessary:\n\n```swift\nlet decompressPath = NSTemporaryDirectory() + \"dest\/\"\n\nif !FileManager.default.fileExists(atPath: decompressPath) {\n    do {\n        try FileManager.default.createDirectory(atPath: decompressPath,\n                                                withIntermediateDirectories: false)\n    } catch {\n        fatalError(\"Unable to create destination directory.\")\n    }\n}\n\nlet decompressDestination = FilePath(decompressPath)\n```\n\n### Create the extract stream\n\nCreate an extract stream that receives archive elements, and extracts to the specified directory:\n\n```swift\nguard let extractStream = ArchiveStream.extractStream(extractingTo: decompressDestination,\n                                                      flags: [ .ignoreOperationNotPermitted ]) else {\n    return\n}\ndefer {\n    try? extractStream.close()\n}\n```\n\n### Decompress and extract the archived directory\n\nFinally, call [doc:\/\/com.apple.documentation\/documentation\/AppleArchive\/ArchiveByteStream\/process(readingFrom:writingTo:)] to write the output of the decode stream to the extract stream. In turn, the extract stream extracts each archive element to the decompression destination:\n\n```swift\ndo {\n    _ = try ArchiveStream.process(readingFrom: decodeStream,\n                                  writingTo: extractStream)\n} catch {\n    print(\"process failed\")\n}\n```\n\nOn return, the operation recreates the contents of the directory previously archived in `directory.aar` in [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSTemporaryDirectory()] `+ “dest\/”.`\n\n## Directories, Files, and Data Archives\n\n- **Compressing single files**: Compress a single file and store the result on the file system.\n- **Decompressing single files**: Recreate a single file from a compressed file.\n- **Compressing file system directories**: Compress the contents of an entire directory and store the result on the file system.\n- **Compressing and saving a string to the file system**: Compress the contents of a Unicode string and store the result on the file system.\n- **Decompressing and parsing an archived string**: Recreate a string from an archive file.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Compress a single file and store the result on the file system.",
          "name" : "Compressing single files",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/compressing-single-files"
        },
        {
          "description" : "Recreate a single file from a compressed file.",
          "name" : "Decompressing single files",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/decompressing-single-files"
        },
        {
          "description" : "Compress the contents of an entire directory and store the result on the file system.",
          "name" : "Compressing file system directories",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/compressing-file-system-directories"
        },
        {
          "description" : "Compress the contents of a Unicode string and store the result on the file system.",
          "name" : "Compressing and saving a string to the file system",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/compressing-and-saving-a-string-to-the-file-system"
        },
        {
          "description" : "Recreate a string from an archive file.",
          "name" : "Decompressing and parsing an archived string",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/decompressing-and-parsing-an-archived-string"
        }
      ],
      "title" : "Directories, Files, and Data Archives"
    }
  ],
  "source" : "appleJSON",
  "title" : "Decompressing and extracting an archived directory",
  "url" : "https:\/\/developer.apple.com\/documentation\/accelerate\/decompressing-and-extracting-an-archived-directory"
}