{
  "abstract" : "Returns a new convolution layer.",
  "codeExamples" : [
    {
      "code" : "let channelZero: [Float] = [10, 11,\n                            12, 13]\nlet channelOne: [Float] = [20, 21,\n                           22, 23]\nlet channelTwo: [Float] = [30, 31,\n                           32, 33]\n\nlet input = channelZero + channelOne + channelTwo\n\nvar weights = [Float](repeating: 1 \/ Float(input.count),\n                      count: input.count)",
      "language" : "swift"
    },
    {
      "code" : "var bias = [Float(0)]\n\nvar output = [Float](repeating: 0, count: 1)\n\nweights.withUnsafeMutableBufferPointer { weightsPtr in\n    bias.withUnsafeMutableBufferPointer { biasPtr in\n        \n        let inDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                 layout: BNNSDataLayoutImageCHW,\n                                                 size: (2, 2, 3, 0, 0, 0, 0, 0),\n                                                 stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                 data: nil,\n                                                 data_type: .float,\n                                                 table_data: nil,\n                                                 table_data_type: .float,\n                                                 data_scale: 1,\n                                                 data_bias: 0)\n        \n        let outDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                  layout: BNNSDataLayoutImageCHW,\n                                                  size: (1, 1, 1, 0, 0, 0, 0, 0),\n                                                  stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                  data: nil,\n                                                  data_type: .float,\n                                                  table_data: nil,\n                                                  table_data_type: .float,\n                                                  data_scale: 1,\n                                                  data_bias: 0)\n        \n        let weightsDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                      layout: BNNSDataLayoutConvolutionWeightsOIHW,\n                                                      size: (2, 2, 3, 1, 0, 0, 0, 0),\n                                                      stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                      data: weightsPtr.baseAddress,\n                                                      data_type: .float,\n                                                      table_data: nil,\n                                                      table_data_type: .float,\n                                                      data_scale: 1,\n                                                      data_bias: 0)\n        \n        let biasDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                   layout: BNNSDataLayoutVector,\n                                                   size: (1, 0, 0, 1, 0, 0, 0, 0),\n                                                   stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                   data: biasPtr.baseAddress,\n                                                   data_type: .float,\n                                                   table_data: nil,\n                                                   table_data_type: .float,\n                                                   data_scale: 1,\n                                                   data_bias: 0)\n        \n        var parameters = BNNSLayerParametersConvolution(i_desc: inDescriptor,\n                                                        w_desc: weightsDescriptor,\n                                                        o_desc: outDescriptor,\n                                                        bias: biasDescriptor,\n                                                        activation: .identity,\n                                                        x_stride: 1, y_stride: 1,\n                                                        x_dilation_stride: 0, y_dilation_stride: 0,\n                                                        x_padding: 0, y_padding: 0,\n                                                        groups: 1,\n                                                        pad: (0, 0, 0, 0))\n        \n        guard let filter = BNNSFilterCreateLayerConvolution(&parameters, nil) else {\n            fatalError(\"`BNNSFilterCreateLayerConvolution` returns `nil`.\")\n        }\n        defer {\n            BNNSFilterDestroy(filter)\n        }\n        \n        BNNSFilterApply(filter,\n                        input,\n                        &output)\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ 1.0 \/ 12.0 ≅ 0.0833\n\n( (10.0 * 0.0833) + (11.0 * 0.0833) + \n  (12.0 * 0.0833) + (13.0 * 0.0833) ) +\n\n( (20.0 * 0.0833) + (21.0 * 0.0833) + \n  (22.0 * 0.0833) + (23.0 * 0.0833) ) +\n\n( (30.0 * 0.0833) + (31.0 * 0.0833) + \n  (32.0 * 0.0833) + (33.0 * 0.0833) ) = 21.5\n",
      "language" : "c"
    }
  ],
  "contentHash" : "93f97e5aa9d7466ecc15f903c5b9d0c0fdc73d68f73f3677782d8ce5bfa3398c",
  "crawledAt" : "2025-12-02T01:21:18Z",
  "declaration" : {
    "code" : "func BNNSFilterCreateLayerConvolution(_ layer_params: UnsafePointer<BNNSLayerParametersConvolution>, _ filter_params: UnsafePointer<BNNSFilterParameters>?) -> BNNSFilter?",
    "language" : "swift"
  },
  "id" : "3D48ED87-EEA5-4240-A724-48B921F1CBD6",
  "kind" : "function",
  "module" : "Accelerate",
  "overview" : "## Discussion\n\nUse convolution to convolve an input image over all dimensions. For example, given the following inputs and weights:\n\nThe following code creates and applies convolution:\n\nOn return, the output contains `[21.5]`, calculated using the following arithmetic:",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSFilterCreateLayerConvolution(_:_:)\ncrawled: 2025-12-02T01:21:18Z\n---\n\n# BNNSFilterCreateLayerConvolution(_:_:)\n\n**Function**\n\nReturns a new convolution layer.\n\n## Declaration\n\n```swift\nfunc BNNSFilterCreateLayerConvolution(_ layer_params: UnsafePointer<BNNSLayerParametersConvolution>, _ filter_params: UnsafePointer<BNNSFilterParameters>?) -> BNNSFilter?\n```\n\n## Parameters\n\n- **layer_params**: Layer parameters.\n- **filter_params**: The filter runtime parameters.\n\n## Discussion\n\nUse convolution to convolve an input image over all dimensions. For example, given the following inputs and weights:\n\n```swift\nlet channelZero: [Float] = [10, 11,\n                            12, 13]\nlet channelOne: [Float] = [20, 21,\n                           22, 23]\nlet channelTwo: [Float] = [30, 31,\n                           32, 33]\n\nlet input = channelZero + channelOne + channelTwo\n\nvar weights = [Float](repeating: 1 \/ Float(input.count),\n                      count: input.count)\n```\n\nThe following code creates and applies convolution:\n\n```swift\nvar bias = [Float(0)]\n\nvar output = [Float](repeating: 0, count: 1)\n\nweights.withUnsafeMutableBufferPointer { weightsPtr in\n    bias.withUnsafeMutableBufferPointer { biasPtr in\n        \n        let inDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                 layout: BNNSDataLayoutImageCHW,\n                                                 size: (2, 2, 3, 0, 0, 0, 0, 0),\n                                                 stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                 data: nil,\n                                                 data_type: .float,\n                                                 table_data: nil,\n                                                 table_data_type: .float,\n                                                 data_scale: 1,\n                                                 data_bias: 0)\n        \n        let outDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                  layout: BNNSDataLayoutImageCHW,\n                                                  size: (1, 1, 1, 0, 0, 0, 0, 0),\n                                                  stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                  data: nil,\n                                                  data_type: .float,\n                                                  table_data: nil,\n                                                  table_data_type: .float,\n                                                  data_scale: 1,\n                                                  data_bias: 0)\n        \n        let weightsDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                      layout: BNNSDataLayoutConvolutionWeightsOIHW,\n                                                      size: (2, 2, 3, 1, 0, 0, 0, 0),\n                                                      stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                      data: weightsPtr.baseAddress,\n                                                      data_type: .float,\n                                                      table_data: nil,\n                                                      table_data_type: .float,\n                                                      data_scale: 1,\n                                                      data_bias: 0)\n        \n        let biasDescriptor = BNNSNDArrayDescriptor(flags: BNNSNDArrayFlags(0),\n                                                   layout: BNNSDataLayoutVector,\n                                                   size: (1, 0, 0, 1, 0, 0, 0, 0),\n                                                   stride: (0, 0, 0, 0, 0, 0, 0, 0),\n                                                   data: biasPtr.baseAddress,\n                                                   data_type: .float,\n                                                   table_data: nil,\n                                                   table_data_type: .float,\n                                                   data_scale: 1,\n                                                   data_bias: 0)\n        \n        var parameters = BNNSLayerParametersConvolution(i_desc: inDescriptor,\n                                                        w_desc: weightsDescriptor,\n                                                        o_desc: outDescriptor,\n                                                        bias: biasDescriptor,\n                                                        activation: .identity,\n                                                        x_stride: 1, y_stride: 1,\n                                                        x_dilation_stride: 0, y_dilation_stride: 0,\n                                                        x_padding: 0, y_padding: 0,\n                                                        groups: 1,\n                                                        pad: (0, 0, 0, 0))\n        \n        guard let filter = BNNSFilterCreateLayerConvolution(&parameters, nil) else {\n            fatalError(\"`BNNSFilterCreateLayerConvolution` returns `nil`.\")\n        }\n        defer {\n            BNNSFilterDestroy(filter)\n        }\n        \n        BNNSFilterApply(filter,\n                        input,\n                        &output)\n    }\n}\n```\n\nOn return, the output contains `[21.5]`, calculated using the following arithmetic:\n\n```c\n\/\/ 1.0 \/ 12.0 ≅ 0.0833\n\n( (10.0 * 0.0833) + (11.0 * 0.0833) + \n  (12.0 * 0.0833) + (13.0 * 0.0833) ) +\n\n( (20.0 * 0.0833) + (21.0 * 0.0833) + \n  (22.0 * 0.0833) + (23.0 * 0.0833) ) +\n\n( (30.0 * 0.0833) + (31.0 * 0.0833) + \n  (32.0 * 0.0833) + (33.0 * 0.0833) ) = 21.5\n\n```\n\n## Convolution layers\n\n- **BNNSConvolutionLayerParameters**: A structure containing convolution parameters.\n- **BNNSFilterCreateConvolutionLayer(_:_:_:_:)**: Returns a convolution filter, initialized with input, output, layer, and filter parameters.\n- **BNNS.ConvolutionLayer**: A layer object that wraps a convolution filter and manages its deinitialization.\n- **BNNSLayerParametersConvolution**: A structure that contains the parameters of a convolution layer.\n- **BNNSFilterCreateLayerTransposedConvolution(_:_:)**: Returns a new transposed convolution layer.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A structure containing convolution parameters.",
          "name" : "BNNSConvolutionLayerParameters",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSConvolutionLayerParameters"
        },
        {
          "description" : "Returns a convolution filter, initialized with input, output, layer, and filter parameters.",
          "name" : "BNNSFilterCreateConvolutionLayer(_:_:_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSFilterCreateConvolutionLayer(_:_:_:_:)"
        },
        {
          "description" : "A layer object that wraps a convolution filter and manages its deinitialization.",
          "name" : "BNNS.ConvolutionLayer",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNS\/ConvolutionLayer"
        },
        {
          "description" : "A structure that contains the parameters of a convolution layer.",
          "name" : "BNNSLayerParametersConvolution",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSLayerParametersConvolution"
        },
        {
          "description" : "Returns a new transposed convolution layer.",
          "name" : "BNNSFilterCreateLayerTransposedConvolution(_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSFilterCreateLayerTransposedConvolution(_:_:)"
        }
      ],
      "title" : "Convolution layers"
    }
  ],
  "source" : "appleJSON",
  "title" : "BNNSFilterCreateLayerConvolution(_:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSFilterCreateLayerConvolution(_:_:)"
}