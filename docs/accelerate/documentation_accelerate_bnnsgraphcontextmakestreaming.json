{
  "abstract" : "Returns an allocated and initialized graph context with streaming support from the specified graph.",
  "codeExamples" : [
    {
      "code" : "output_state = concat(input_state, tensorX)",
      "language" : "c"
    }
  ],
  "contentHash" : "08cf6d692ee8858e17aa43d72dd99bc581ae70f71755f538a5c06c68cf001ea7",
  "crawledAt" : "2025-11-30T20:10:39Z",
  "declaration" : {
    "code" : "func BNNSGraphContextMakeStreaming(_ graph: bnns_graph_t, _ function: UnsafePointer<CChar>?, _ initial_states_count: Int, _ initial_states: UnsafePointer<BNNSTensor>?) -> bnns_graph_context_t",
    "language" : "swift"
  },
  "id" : "0DBDE0C2-812C-4524-A12A-2DC29861216B",
  "kind" : "function",
  "module" : "Accelerate",
  "overview" : "## Return Value\n\nA compiled graph context object. If the operation fails, the graph object’s [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/bnns_graph_context_t\/data] property is `nil`.\n\n## Discussion\n\nIn addition to the work that [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphContextMake(_:)] performs, this call allocates ring-buffer backed memory for all [doc:\/\/com.apple.documentation\/documentation\/CoreML] state arguments of the given function.\n\nIf your model runs on a stream of data, such as processing audio data, it may benefit from working on one frame at a time. You can express this functionality through a model that uses Core ML’s concept of states. In this case, BNNS stores information that the model needs from a previous frame in the state that dilations on convolution layers may require.\n\nIf your model uses the pattern below, use this function to specify that BNNS uses an optimized mode that allocates and manages ring buffers for states. Doing so eliminates memory copies associated with the approach.\n\nBNNS advances the ring buffer by the size of `tensorX` in the concatenation dimension after the function executes.\n\nTo use a context with streaming support, your function must include an attribute dictionary named `BNNSOptions` that includes the entry `{ ‘StateMode’: ‘Streaming’ }`. This specifies that the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphCompileFromFile(_:_:_:)] function encodes additional metadata into the graph that describes the streaming rate.\n\nCalls to [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphContextExecute(_:_:_:_:_:_:)] that use contexts this function creates ignore any user-provided pointers for input and output arguments. Instead, context execution uses the internal ring buffer and updates any nonnull input and output arguments to point to the same ring-buffer backed memory. On return, an analysis of the compiled program for use in the next frame determines the distance by which the operation advances the ring buffer.\n\nTo prevent memory leaks, call [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphContextDestroy(_:)] when you’re finished using the graph context.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSGraphContextMakeStreaming(_:_:_:_:)\ncrawled: 2025-11-30T20:10:39Z\n---\n\n# BNNSGraphContextMakeStreaming(_:_:_:_:)\n\n**Function**\n\nReturns an allocated and initialized graph context with streaming support from the specified graph.\n\n## Declaration\n\n```swift\nfunc BNNSGraphContextMakeStreaming(_ graph: bnns_graph_t, _ function: UnsafePointer<CChar>?, _ initial_states_count: Int, _ initial_states: UnsafePointer<BNNSTensor>?) -> bnns_graph_context_t\n```\n\n## Parameters\n\n- **graph**: The compiled graph object.\n- **function**: The function that the new context initializes the state for. Specify as `nil` if the graph only contains one function.\n- **initial_states_count**: The number of elements in the `initial_states_count` array.\n- **initial_states**: An array of [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSTensor] structures that describe the data that the context uses to initialize each state. The context uses `initial_states[i]` to intialize the state with the name `initial_state[i]->name`.\n\n## Return Value\n\nA compiled graph context object. If the operation fails, the graph object’s [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/bnns_graph_context_t\/data] property is `nil`.\n\n## Discussion\n\nIn addition to the work that [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphContextMake(_:)] performs, this call allocates ring-buffer backed memory for all [doc:\/\/com.apple.documentation\/documentation\/CoreML] state arguments of the given function.\n\nIf your model runs on a stream of data, such as processing audio data, it may benefit from working on one frame at a time. You can express this functionality through a model that uses Core ML’s concept of states. In this case, BNNS stores information that the model needs from a previous frame in the state that dilations on convolution layers may require.\n\nIf your model uses the pattern below, use this function to specify that BNNS uses an optimized mode that allocates and manages ring buffers for states. Doing so eliminates memory copies associated with the approach.\n\n```c\noutput_state = concat(input_state, tensorX)\n```\n\nBNNS advances the ring buffer by the size of `tensorX` in the concatenation dimension after the function executes.\n\nTo use a context with streaming support, your function must include an attribute dictionary named `BNNSOptions` that includes the entry `{ ‘StateMode’: ‘Streaming’ }`. This specifies that the [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphCompileFromFile(_:_:_:)] function encodes additional metadata into the graph that describes the streaming rate.\n\nCalls to [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphContextExecute(_:_:_:_:_:_:)] that use contexts this function creates ignore any user-provided pointers for input and output arguments. Instead, context execution uses the internal ring buffer and updates any nonnull input and output arguments to point to the same ring-buffer backed memory. On return, an analysis of the compiled program for use in the next frame determines the distance by which the operation advances the ring buffer.\n\nTo prevent memory leaks, call [doc:\/\/com.apple.accelerate\/documentation\/Accelerate\/BNNSGraphContextDestroy(_:)] when you’re finished using the graph context.\n\n## Creating and destroying a context\n\n- **bnns_graph_context_t**: An object that wraps a compiled graph object.\n- **BNNSGraphContextMake(_:)**: Returns an allocated and initialized graph context from the specified graph.\n- **BNNSGraphContextDestroy(_:)**: Destroys the specified graph context.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that wraps a compiled graph object.",
          "name" : "bnns_graph_context_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/bnns_graph_context_t"
        },
        {
          "description" : "Returns an allocated and initialized graph context from the specified graph.",
          "name" : "BNNSGraphContextMake(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSGraphContextMake(_:)"
        },
        {
          "description" : "Destroys the specified graph context.",
          "name" : "BNNSGraphContextDestroy(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSGraphContextDestroy(_:)"
        }
      ],
      "title" : "Creating and destroying a context"
    }
  ],
  "source" : "appleJSON",
  "title" : "BNNSGraphContextMakeStreaming(_:_:_:_:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Accelerate\/BNNSGraphContextMakeStreaming(_:_:_:_:)"
}