{
  "abstract" : "Use touch input and virtual controllers to make your game available to players without controllers.",
  "codeExamples" : [
    {
      "code" : "@implementation MyGameViewController {\n    GCVirtualController *_virtualController;\n}\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n\n    if (!_virtualController) {\n        GCVirtualControllerConfiguration *config = [[GCVirtualControllerConfiguration alloc] init];\n        \/\/ Add elements that your controller-handling code currently supports.\n        config.elements = [NSSet setWithArray:@[\n            GCInputButtonA,\n            GCInputButtonB,\n            GCInputButtonX,\n            GCInputButtonY,\n            GCInputLeftThumbstick,\n            GCInputRightThumbstick]];\n        _virtualController = [[GCVirtualController alloc] initWithConfiguration:config];\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "- (void)controllerDidDisconnect:(NSNotification *)notification {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "- (void)gameDidStart {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "- (void)controllerDidConnect:(NSNotification *)notification {\n    if (_virtualController != nil) {\n        BOOL hasPhysicalController = NO;\n        for (GCController *controller in GCController.controllers) {\n            if (controller != _virtualController.controller) {\n                hasPhysicalController = YES;\n                break;\n            }\n        }\n        if (hasPhysicalController) {\n            [_virtualController disconnect];\n        }\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "- (void)configureVirtualControllerForCutscene:(BOOL)isInCutscene {\n    if (!_virtualController) {\n        return;\n    }\n\n    \/\/ Only the X button is available when in a cutscene.\n    NSArray *elementsToShowOrHide = @[\n        GCInputButtonA,\n        GCInputButtonB,\n        GCInputButtonY,\n        GCInputLeftThumbstick,\n        GCInputRightThumbstick];\n    for (GCInputElementName input in elementsToShowOrHide) {\n        [_virtualController updateConfigurationForElement:input\n                            configuration:^(GCVirtualControllerElementConfiguration *configuration) {\n            configuration.hidden = isInCutscene;\n            return configuration;\n        }];\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "- (void)viewDidLoad {\n    [super viewDidLoad];\n\n    if (!_virtualController) {\n        GCVirtualControllerConfiguration *configuration = [[GCVirtualControllerConfiguration alloc] init];\n        \/\/ Add elements that your controller-handling code currently supports.\n        configuration.elements = [NSSet setWithArray:@[\n            GCInputButtonA,\n            GCInputButtonB,\n            GCInputButtonX,\n            GCInputButtonY,\n            GCInputLeftThumbstick,\n            GCInputRightThumbstick]];\n        configuration.hidden = YES;\n        _virtualController = [[GCVirtualController alloc] initWithConfiguration:configuration];\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "@implementation MyGameViewController {\n    GCVirtualController *_virtualController;\n    UIPanGestureRecognizer *_thumbstickGR;\n    UILongPressGestureRecognizer *_primaryButtonGR;\n}\n\n- (void)viewDidLoad {\n    \/\/ ...\n    \/\/ ... Continued from above.\n    \/\/ ...\n\n    _thumbstickGR = [[UIPanGestureRecognizer alloc] init];\n    _thumbstickGR.delegate = self;\n    [_thumbstickGR addTarget:self action:@selector(thumbstickAction)];\n    [self.view addGestureRecognizer:_thumbstickGR];\n\n    _primaryButtonGR = [[UILongPressGestureRecognizer alloc] init];\n    _primaryButtonGR.minimumPressDuration = 0; \/\/ Invoke action method immediately.\n    _primaryButtonGR.delegate = self;\n    [_primaryButtonGR addTarget:self action:@selector(primaryButtonAction)];\n    [self.view addGestureRecognizer:_primaryButtonGR];\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Declares an extension (unnamed category) of MyGameViewController.\n\/\/ Place this declaration in the implementation file instead of the header file.\n@interface MyGameViewController() <UIGestureRecognizerDelegate>\n- (void)thumbstickAction;\n- (void)primaryButtonAction;\n@end",
      "language" : "swift"
    },
    {
      "code" : "- (void)thumbstickAction {\n    UIGestureRecognizerState state = _thumbstickGR.state;\n    if (state == UIGestureRecognizerStateBegan || state == UIGestureRecognizerStateChanged) {\n        CGPoint translation = [_thumbstickGR translationInView:self.view];\n        CGRect bounds = [self calculateThumbstickRegionBounds];\n        translation.x \/= (bounds.size.width \/ 2);\n        translation.y \/= (bounds.size.height \/ 2);\n        [_virtualController setPosition:translation forDirectionPadElement:GCInputLeftThumbstick];\n        uiSystem->set_thumbstick_position_and_visibility(translation, true);\n    } else {\n        uiSystem->set_thumbstick_position_and_visibility(CGPointZero, false);\n    }\n}\n\n- (void)primaryButtonAction {\n    UIGestureRecognizerState state = _primaryButtonGR.state;\n    if (state == UIGestureRecognizerStateBegan || state == UIGestureRecognizerStateChanged) {\n        [_virtualController setValue:1.0 forButtonElement:GCInputButtonX];\n        uiSystem->set_primary_button_pressed(true);\n    } else {\n        [_virtualController setValue:0.0 forButtonElement:GCInputButtonX];\n        uiSystem->set_primary_button_pressed(false);\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "- (CGRect)calculateThumbstickRegionBounds {\n    CGRect viewBounds = self.view.bounds;\n    UIEdgeInsets safeAreaInsets = self.view.safeAreaInsets;\n    CGSize thumbstickRegionSize = CGSizeMake(200, 200);\n    return CGRectMake(\n        safeAreaInsets.left,\n        viewBounds.size.height - thumbstickRegionSize.height - safeAreaInsets.bottom,\n        thumbstickRegionSize.width,\n        thumbstickRegionSize.height);\n}\n\n- (CGRect)calculatePrimaryActionButtonBounds {\n    CGRect viewBounds = self.view.bounds;\n    UIEdgeInsets safeAreaInsets = self.view.safeAreaInsets;\n    CGSize actionButtonSize = CGSizeMake(88, 88);\n    return CGRectMake(\n        viewBounds.size.width - actionButtonSize.width - safeAreaInsets.right,\n        viewBounds.size.height - actionButtonSize.height - safeAreaInsets.bottom,\n        actionButtonSize.width,\n        actionButtonSize.height);\n}\n\n- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gr shouldReceiveTouch:(UITouch *)touch {\n    \/\/ Constrain the gesture recognizer to tracking one touch at any given time.\n    if (gr.numberOfTouches >= 1) {\n        return NO;\n    }\n\n    CGPoint location = [touch locationInView:self.view];\n    if (gr == _thumbstickGR) {\n        CGRect thumbstickRegionBounds = [self calculateThumbstickRegionBounds];\n        return CGRectContainsPoint(thumbstickRegionBounds, location);\n    } else if (gr == _primaryButtonGR) {\n        CGRect primaryActionButtonBounds = [self calculatePrimaryActionButtonBounds];\n        return CGRectContainsPoint(primaryActionButtonBounds, location);\n    }\n\n    return YES;\n}",
      "language" : "swift"
    },
    {
      "code" : "- (void)gameDidStart {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n        uiSystem->set_visible(true);\n    }\n}\n\n- (void)controllerDidConnect:(NSNotification *)note {\n    if (_virtualController != nil) {\n        BOOL hasPhysicalController = NO;\n        for (GCController *controller in GCController.controllers) {\n            if (controller != _virtualController.controller) {\n                hasPhysicalController = YES;\n                break;\n            }\n        }\n        if (hasPhysicalController) {\n            [_virtualController disconnect];\n            uiSystem->set_visible(false);\n        }\n    }\n}\n\n- (void)controllerDidDisconnect:(NSNotification *)note {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n        uiSystem->set_visible(true);\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "e7e96a996a20915663642ec0eecbbcc57464135d458c352807e75a875d44f2be",
  "crawledAt" : "2025-12-02T16:43:33Z",
  "id" : "DE6B68B3-1D89-4767-824C-DF21D1D9961E",
  "kind" : "article",
  "language" : "swift",
  "module" : "Game Controller",
  "overview" : "## Overview\n\nMany people play games on iOS devices without using a physical controller. You can make your game available to them by adding touch controls, even if you designed your game for a physical controller. The [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] class leverages the Game Controller framework and optionally provides a default user interface. [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] can also render custom controls.\n\n### Create a custom view controller subclass\n\nA Metal-based game typically presents content in a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView]. An instance of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController], known as the root view controller, manages the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView]. Your root view controller is responsible for the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] instance. To take responsibility, subclass from [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCEventViewController] rather than [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController].\n\nTo create a custom subclass of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController], create a new file in your project using the Cocoa Touch Class template. In the “Subclass of” combination box, enter “GCEventViewController”. In the Language menu, choose Objective-C. Then, open the newly created header file and import the Game Controller framework.\n\nIf the game uses a storyboard, [https:\/\/developer.apple.com\/library\/archive\/featuredarticles\/ViewControllerPGforiPhoneOS\/DefiningYourSubclass.html] to use a new view controller class derived from [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCEventViewController]. Alternatively, if the game creates a root view controller programmatically, then update the code to create an instance of a new subclass derived from [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCEventViewController].\n\n### Configure the virtual controller\n\nWhen you connect a [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController], a new [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCController] appears in the controllers array. The elements that this controller supports are controlled by the configuration created for [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController]. To configure a virtual controller, follow these steps:\n\n### Show and hide the virtual controller\n\nIf there are no physical controllers connected, the game shows the virtual controller by default. If the player connects a physical controller, the game hides the virtual controller.\n\nTo show a virtual controller when there are no physical controllers connected, call [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/connect(replyHandler:)] on it in the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidDisconnect] (Swift) or [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidDisconnectNotification] (Objective-C) handler.\n\nWhen your game starts and there are no controllers connected, call [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/connect(replyHandler:)] on the virtual controller to show it.\n\nTo hide the virtual controller when a player connects a physical controller, call disconnect on the virtual controller in the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidConnect] (Swift) or [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidConnectNotification] (Objective-C) handler. The game might receive a connection notification for a physical controller before receiving a notification for the virtual controller because controller connections are asynchronous.\n\n### Show and hide controls\n\nWhen the player can’t perform certain actions in the game, hide the corresponding control elements using the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/updateConfiguration(forElement:configuration:)] method. For example, during cutscene playback, the player can only press a button to skip playback.\n\n### Render custom touch controls\n\nFor better immersion and performance, the game can render a custom virtual controller instead of the default. Custom controls render symbols that represent their mapped actions rather than generic symbols.\n\nSet the hidden property to true when you create the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/Configuration]. Continue to set the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/Configuration\/elements] property because this affects the elements of the corresponding [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCController].\n\nAdd code to the implementation of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController\/viewDidLoad()] to install one or more [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIGestureRecognizer] objects on the game’s view. For example, use a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIPanGestureRecognizer] to implement a direction pad or a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UILongPressGestureRecognizer] to implement a button. Set the view controller as the delegate and the target of each gesture recognizer, and store them in instance variables.\n\nThen, declare an extension of the root view controller subclass that conforms to [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIGestureRecognizerDelegate]. In the extension, declare the action methods that the configured gesture recognizers invoke.\n\nImplement the action methods to interpret the location of the touch, update the virtual controller, and inform the render thread.\n\nNext, implement the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIGestureRecognizerDelegate\/gestureRecognizer(_:shouldReceive:)-16fuh] delegate method to define the bounds of the gesture recognizer. Calculate the bounding boxes of the controls based on the view’s current size, and place it within the view’s current safe area.\n\nUpdate [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidConnect] (Swift) and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidDisconnect] (Swift) handlers to show or hide the custom user interface when the virtual controller is connected. For Objective-C, update the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidConnectNotification] and [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidDisconnectNotification] handlers.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/GameController\/adding-touch-controls-to-games-that-support-game-controllers-in-ios\ncrawled: 2025-12-02T16:43:33Z\n---\n\n# Adding touch controls to games that support game controllers in iOS\n\n**Article**\n\nUse touch input and virtual controllers to make your game available to players without controllers.\n\n## Overview\n\nMany people play games on iOS devices without using a physical controller. You can make your game available to them by adding touch controls, even if you designed your game for a physical controller. The [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] class leverages the Game Controller framework and optionally provides a default user interface. [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] can also render custom controls.\n\n### Create a custom view controller subclass\n\nA Metal-based game typically presents content in a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView]. An instance of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController], known as the root view controller, manages the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIView]. Your root view controller is responsible for the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] instance. To take responsibility, subclass from [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCEventViewController] rather than [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController].\n\n\n\nTo create a custom subclass of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController], create a new file in your project using the Cocoa Touch Class template. In the “Subclass of” combination box, enter “GCEventViewController”. In the Language menu, choose Objective-C. Then, open the newly created header file and import the Game Controller framework.\n\nIf the game uses a storyboard, [https:\/\/developer.apple.com\/library\/archive\/featuredarticles\/ViewControllerPGforiPhoneOS\/DefiningYourSubclass.html] to use a new view controller class derived from [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCEventViewController]. Alternatively, if the game creates a root view controller programmatically, then update the code to create an instance of a new subclass derived from [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCEventViewController].\n\n### Configure the virtual controller\n\nWhen you connect a [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController], a new [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCController] appears in the controllers array. The elements that this controller supports are controlled by the configuration created for [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController]. To configure a virtual controller, follow these steps:\n\n1. In your subclass of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController], add a [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController] instance variable.\n2. Add an override to the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController\/viewDidLoad()] method that creates the virtual controller and stores it in an instance variable.\n\n```swift\n@implementation MyGameViewController {\n    GCVirtualController *_virtualController;\n}\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n\n    if (!_virtualController) {\n        GCVirtualControllerConfiguration *config = [[GCVirtualControllerConfiguration alloc] init];\n        \/\/ Add elements that your controller-handling code currently supports.\n        config.elements = [NSSet setWithArray:@[\n            GCInputButtonA,\n            GCInputButtonB,\n            GCInputButtonX,\n            GCInputButtonY,\n            GCInputLeftThumbstick,\n            GCInputRightThumbstick]];\n        _virtualController = [[GCVirtualController alloc] initWithConfiguration:config];\n    }\n}\n```\n\n### Show and hide the virtual controller\n\nIf there are no physical controllers connected, the game shows the virtual controller by default. If the player connects a physical controller, the game hides the virtual controller.\n\nTo show a virtual controller when there are no physical controllers connected, call [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/connect(replyHandler:)] on it in the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidDisconnect] (Swift) or [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidDisconnectNotification] (Objective-C) handler.\n\n```swift\n- (void)controllerDidDisconnect:(NSNotification *)notification {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n    }\n}\n```\n\nWhen your game starts and there are no controllers connected, call [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/connect(replyHandler:)] on the virtual controller to show it.\n\n```swift\n- (void)gameDidStart {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n    }\n}\n```\n\nTo hide the virtual controller when a player connects a physical controller, call disconnect on the virtual controller in the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidConnect] (Swift) or [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidConnectNotification] (Objective-C) handler. The game might receive a connection notification for a physical controller before receiving a notification for the virtual controller because controller connections are asynchronous.\n\n```swift\n- (void)controllerDidConnect:(NSNotification *)notification {\n    if (_virtualController != nil) {\n        BOOL hasPhysicalController = NO;\n        for (GCController *controller in GCController.controllers) {\n            if (controller != _virtualController.controller) {\n                hasPhysicalController = YES;\n                break;\n            }\n        }\n        if (hasPhysicalController) {\n            [_virtualController disconnect];\n        }\n    }\n}\n```\n\n### Show and hide controls\n\nWhen the player can’t perform certain actions in the game, hide the corresponding control elements using the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/updateConfiguration(forElement:configuration:)] method. For example, during cutscene playback, the player can only press a button to skip playback.\n\n```swift\n- (void)configureVirtualControllerForCutscene:(BOOL)isInCutscene {\n    if (!_virtualController) {\n        return;\n    }\n\n    \/\/ Only the X button is available when in a cutscene.\n    NSArray *elementsToShowOrHide = @[\n        GCInputButtonA,\n        GCInputButtonB,\n        GCInputButtonY,\n        GCInputLeftThumbstick,\n        GCInputRightThumbstick];\n    for (GCInputElementName input in elementsToShowOrHide) {\n        [_virtualController updateConfigurationForElement:input\n                            configuration:^(GCVirtualControllerElementConfiguration *configuration) {\n            configuration.hidden = isInCutscene;\n            return configuration;\n        }];\n    }\n}\n```\n\n### Render custom touch controls\n\nFor better immersion and performance, the game can render a custom virtual controller instead of the default. Custom controls render symbols that represent their mapped actions rather than generic symbols.\n\n\n\nSet the hidden property to true when you create the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/Configuration]. Continue to set the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCVirtualController\/Configuration\/elements] property because this affects the elements of the corresponding [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCController].\n\n```swift\n- (void)viewDidLoad {\n    [super viewDidLoad];\n\n    if (!_virtualController) {\n        GCVirtualControllerConfiguration *configuration = [[GCVirtualControllerConfiguration alloc] init];\n        \/\/ Add elements that your controller-handling code currently supports.\n        configuration.elements = [NSSet setWithArray:@[\n            GCInputButtonA,\n            GCInputButtonB,\n            GCInputButtonX,\n            GCInputButtonY,\n            GCInputLeftThumbstick,\n            GCInputRightThumbstick]];\n        configuration.hidden = YES;\n        _virtualController = [[GCVirtualController alloc] initWithConfiguration:configuration];\n    }\n}\n```\n\nAdd code to the implementation of [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIViewController\/viewDidLoad()] to install one or more [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIGestureRecognizer] objects on the game’s view. For example, use a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIPanGestureRecognizer] to implement a direction pad or a [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UILongPressGestureRecognizer] to implement a button. Set the view controller as the delegate and the target of each gesture recognizer, and store them in instance variables.\n\n```swift\n@implementation MyGameViewController {\n    GCVirtualController *_virtualController;\n    UIPanGestureRecognizer *_thumbstickGR;\n    UILongPressGestureRecognizer *_primaryButtonGR;\n}\n\n- (void)viewDidLoad {\n    \/\/ ...\n    \/\/ ... Continued from above.\n    \/\/ ...\n\n    _thumbstickGR = [[UIPanGestureRecognizer alloc] init];\n    _thumbstickGR.delegate = self;\n    [_thumbstickGR addTarget:self action:@selector(thumbstickAction)];\n    [self.view addGestureRecognizer:_thumbstickGR];\n\n    _primaryButtonGR = [[UILongPressGestureRecognizer alloc] init];\n    _primaryButtonGR.minimumPressDuration = 0; \/\/ Invoke action method immediately.\n    _primaryButtonGR.delegate = self;\n    [_primaryButtonGR addTarget:self action:@selector(primaryButtonAction)];\n    [self.view addGestureRecognizer:_primaryButtonGR];\n}\n```\n\nThen, declare an extension of the root view controller subclass that conforms to [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIGestureRecognizerDelegate]. In the extension, declare the action methods that the configured gesture recognizers invoke.\n\n```swift\n\/\/ Declares an extension (unnamed category) of MyGameViewController.\n\/\/ Place this declaration in the implementation file instead of the header file.\n@interface MyGameViewController() <UIGestureRecognizerDelegate>\n- (void)thumbstickAction;\n- (void)primaryButtonAction;\n@end\n```\n\nImplement the action methods to interpret the location of the touch, update the virtual controller, and inform the render thread.\n\n\n\n```swift\n- (void)thumbstickAction {\n    UIGestureRecognizerState state = _thumbstickGR.state;\n    if (state == UIGestureRecognizerStateBegan || state == UIGestureRecognizerStateChanged) {\n        CGPoint translation = [_thumbstickGR translationInView:self.view];\n        CGRect bounds = [self calculateThumbstickRegionBounds];\n        translation.x \/= (bounds.size.width \/ 2);\n        translation.y \/= (bounds.size.height \/ 2);\n        [_virtualController setPosition:translation forDirectionPadElement:GCInputLeftThumbstick];\n        uiSystem->set_thumbstick_position_and_visibility(translation, true);\n    } else {\n        uiSystem->set_thumbstick_position_and_visibility(CGPointZero, false);\n    }\n}\n\n- (void)primaryButtonAction {\n    UIGestureRecognizerState state = _primaryButtonGR.state;\n    if (state == UIGestureRecognizerStateBegan || state == UIGestureRecognizerStateChanged) {\n        [_virtualController setValue:1.0 forButtonElement:GCInputButtonX];\n        uiSystem->set_primary_button_pressed(true);\n    } else {\n        [_virtualController setValue:0.0 forButtonElement:GCInputButtonX];\n        uiSystem->set_primary_button_pressed(false);\n    }\n}\n```\n\nNext, implement the [doc:\/\/com.apple.documentation\/documentation\/UIKit\/UIGestureRecognizerDelegate\/gestureRecognizer(_:shouldReceive:)-16fuh] delegate method to define the bounds of the gesture recognizer. Calculate the bounding boxes of the controls based on the view’s current size, and place it within the view’s current safe area.\n\n```swift\n- (CGRect)calculateThumbstickRegionBounds {\n    CGRect viewBounds = self.view.bounds;\n    UIEdgeInsets safeAreaInsets = self.view.safeAreaInsets;\n    CGSize thumbstickRegionSize = CGSizeMake(200, 200);\n    return CGRectMake(\n        safeAreaInsets.left,\n        viewBounds.size.height - thumbstickRegionSize.height - safeAreaInsets.bottom,\n        thumbstickRegionSize.width,\n        thumbstickRegionSize.height);\n}\n\n- (CGRect)calculatePrimaryActionButtonBounds {\n    CGRect viewBounds = self.view.bounds;\n    UIEdgeInsets safeAreaInsets = self.view.safeAreaInsets;\n    CGSize actionButtonSize = CGSizeMake(88, 88);\n    return CGRectMake(\n        viewBounds.size.width - actionButtonSize.width - safeAreaInsets.right,\n        viewBounds.size.height - actionButtonSize.height - safeAreaInsets.bottom,\n        actionButtonSize.width,\n        actionButtonSize.height);\n}\n\n- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gr shouldReceiveTouch:(UITouch *)touch {\n    \/\/ Constrain the gesture recognizer to tracking one touch at any given time.\n    if (gr.numberOfTouches >= 1) {\n        return NO;\n    }\n\n    CGPoint location = [touch locationInView:self.view];\n    if (gr == _thumbstickGR) {\n        CGRect thumbstickRegionBounds = [self calculateThumbstickRegionBounds];\n        return CGRectContainsPoint(thumbstickRegionBounds, location);\n    } else if (gr == _primaryButtonGR) {\n        CGRect primaryActionButtonBounds = [self calculatePrimaryActionButtonBounds];\n        return CGRectContainsPoint(primaryActionButtonBounds, location);\n    }\n\n    return YES;\n}\n```\n\nUpdate [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidConnect] (Swift) and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSNotification\/Name-swift.struct\/GCControllerDidDisconnect] (Swift) handlers to show or hide the custom user interface when the virtual controller is connected. For Objective-C, update the [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidConnectNotification] and [doc:\/\/com.apple.gamecontroller\/documentation\/GameController\/GCControllerDidDisconnectNotification] handlers.\n\n```swift\n- (void)gameDidStart {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n        uiSystem->set_visible(true);\n    }\n}\n\n- (void)controllerDidConnect:(NSNotification *)note {\n    if (_virtualController != nil) {\n        BOOL hasPhysicalController = NO;\n        for (GCController *controller in GCController.controllers) {\n            if (controller != _virtualController.controller) {\n                hasPhysicalController = YES;\n                break;\n            }\n        }\n        if (hasPhysicalController) {\n            [_virtualController disconnect];\n            uiSystem->set_visible(false);\n        }\n    }\n}\n\n- (void)controllerDidDisconnect:(NSNotification *)note {\n    if (GCController.controllers.count == 0 && _virtualController != nil) {\n        [_virtualController connectWithReplyHandler:nil];\n        uiSystem->set_visible(true);\n    }\n}\n```\n\n## Touch controller\n\n- **GCVirtualController**: A software emulation of a real controller that you configure specifically for your game.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A software emulation of a real controller that you configure specifically for your game.",
          "name" : "GCVirtualController",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameController\/GCVirtualController"
        }
      ],
      "title" : "Touch controller"
    }
  ],
  "source" : "appleJSON",
  "title" : "Adding touch controls to games that support game controllers in iOS",
  "url" : "https:\/\/developer.apple.com\/documentation\/GameController\/adding-touch-controls-to-games-that-support-game-controllers-in-ios"
}