{
  "abstract" : "Finish encoding the render context.",
  "codeExamples" : [

  ],
  "contentHash" : "a97d43bab786a727bd308e3a0c8b638023b319c2c88b3918b9021672343791e2",
  "crawledAt" : "2025-12-08T02:13:54Z",
  "declaration" : {
    "code" : "func endEncoding(commandEncoder command_encoder: any MTL4RenderCommandEncoder)",
    "language" : "swift"
  },
  "id" : "7A3E45DB-A98E-4A0E-9E25-D1DE1C282FB8",
  "kind" : "method",
  "language" : "swift",
  "module" : "Compositor Services",
  "overview" : "## Discussion\n\n`endEncoding(commandEncoder:)` passes the ownership of the command encoder to the drawable render context and calls [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCommandEncoder\/endEncoding()] on the command encoder. The command encoder used in the render context has the following constraints:\n\nIf the render encoder has multiple color attachments, set [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTL4RenderPassDescriptor\/supportColorAttachmentMapping] to `true` to avoid Metal API validation errors.\n\nFor testing performance of this method, always test your app on-device rather than in Simulator. However, if you need to iterate on your code in development, you can disable API validation in Xcode, or separate the rendering into multiple render encoders for other color attachments.",
  "platforms" : [
    "macOS",
    "visionOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CompositorServices\/LayerRenderer\/Drawable\/RenderContext\/endEncoding(commandEncoder:)-2l6lk\ncrawled: 2025-12-08T02:13:54Z\n---\n\n# endEncoding(commandEncoder:)\n\n**Instance Method**\n\nFinish encoding the render context.\n\n## Declaration\n\n```swift\nfunc endEncoding(commandEncoder command_encoder: any MTL4RenderCommandEncoder)\n```\n\n## Discussion\n\n`endEncoding(commandEncoder:)` passes the ownership of the command encoder to the drawable render context and calls [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLCommandEncoder\/endEncoding()] on the command encoder. The command encoder used in the render context has the following constraints:\n\n- The `colorAttachment[0]` contains the color texture provided by the layer renderer drawable.\n- The [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPassDescriptor\/depthAttachment] contains the depth texture provided by the layer renderer drawable.\n- The [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPassDescriptor\/renderTargetArrayLength] is the same as the number of views in the layer renderer drawable.\n- The [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLRenderPassDescriptor\/rasterizationRateMap] matches the one provided by the layer renderer drawable.\n- The API doesnâ€™t support dedicated and shared layouts.\n\nIf the render encoder has multiple color attachments, set [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTL4RenderPassDescriptor\/supportColorAttachmentMapping] to `true` to avoid Metal API validation errors.\n\nFor testing performance of this method, always test your app on-device rather than in Simulator. However, if you need to iterate on your code in development, you can disable API validation in Xcode, or separate the rendering into multiple render encoders for other color attachments.\n\n## Rendering with Metal 4\n\n- **drawMaskOnStencilAttachment(commandEncoder:value:)**: Store the value parameter in the stencil texture in the pixels that the Compositor displays onscreen.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Store the value parameter in the stencil texture in the pixels that the Compositor displays onscreen.",
          "name" : "drawMaskOnStencilAttachment(commandEncoder:value:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/CompositorServices\/LayerRenderer\/Drawable\/RenderContext\/drawMaskOnStencilAttachment(commandEncoder:value:)-7npim"
        }
      ],
      "title" : "Rendering with Metal 4"
    }
  ],
  "source" : "appleJSON",
  "title" : "endEncoding(commandEncoder:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/CompositorServices\/LayerRenderer\/Drawable\/RenderContext\/endEncoding(commandEncoder:)-2l6lk"
}