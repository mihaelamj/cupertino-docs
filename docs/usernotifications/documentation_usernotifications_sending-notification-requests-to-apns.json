{
  "abstract" : "Transmit your remote notification payload and device token information to Apple Push Notification service (APNs).",
  "codeExamples" : [
    {
      "code" : "HEADERS\n  - END_STREAM\n  + END_HEADERS\n  :method = POST\n  :scheme = https\n  :path = \/3\/device\/00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0\n  host = api.sandbox.push.apple.com\n  authorization = bearer eyAia2lkIjogIjhZTDNHM1JSWDciIH0.eyAiaXNzIjogIkM4Nk5WOUpYM0QiLCAiaWF0I\n         jogIjE0NTkxNDM1ODA2NTAiIH0.MEYCIQDzqyahmH1rz1s-LFNkylXEa2lZ_aOCX4daxxTZkVEGzwIhALvkClnx5m5eAT6\n         Lxw7LZtEQcH6JENhJTMArwLf3sXwi\n  apns-id = eabeae54-14a8-11e5-b60b-1697f925ec7b\n  apns-push-type = alert\n  apns-expiration = 0\n  apns-priority = 10\n  apns-topic = com.example.MyApp\nDATA\n  + END_STREAM\n  { \"aps\" : { \"alert\" : \"Hello\" } }\n",
      "language" : "other"
    },
    {
      "code" : "HEADERS\n  - END_STREAM\n  + END_HEADERS\n  :method = POST\n  :scheme = https\n  :path = \/3\/device\/00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0\n  host = api.sandbox.push.apple.com\n  apns-id = eabeae54-14a8-11e5-b60b-1697f925ec7b\n  apns-push-type = alert\n  apns-expiration = 0\n  apns-priority = 10\nDATA\n  + END_STREAM\n  { \"aps\" : { \"alert\" : \"Hello\" } }\n",
      "language" : "other"
    }
  ],
  "contentHash" : "3869f2309a15eaa9b39af8fe80a5c168369b0e3e735de3b2e4150d5b0cd06e3a",
  "crawledAt" : "2025-12-04T09:10:57Z",
  "id" : "B4B46471-C4DA-4113-8C39-96F99AABFD9E",
  "kind" : "article",
  "language" : "swift",
  "module" : "User Notifications",
  "overview" : "## Overview\n\nAs a best-effort service, APNs may reorder notifications you send to the same device token. If APNs can’t deliver a notification immediately, it may store the notification for 30 days or less, depending on the date you specify in the `apns-expiration` header. APNs attempts to deliver the notification the next time the device activates and is available online.\n\nAPNs stores only one notification per bundle ID. When you send multiple notifications to the same device for a bundle ID, APNs selects only one notification to store. In most cases, the latest notification is stored. However, this behavior isn’t always guaranteed when multiple notifications are stored in a short duration. Notifications with `apns-priority 5` and `apns-priority 1` might get grouped and delivered in bursts to a person’s device. Your notifications may also get throttled, saved in storage, and in some cases, not delivered. The way a person interacts with your app and the power state of the device determines the exact behavior. For more information about the factors that impact the delivery of a push notification, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/viewing-the-status-of-push-notifications-using-metrics-and-apns].\n\nWhen you have a notification to send to a user, your provider must construct a POST request and send it to Apple Push Notification service (APNs). Upon receiving your server’s POST request, APNs validates the request using either the provided authentication token or your server’s certificate. If validation succeeds, APNs uses the provided device token to identify the user’s device. It then tries to send your JSON payload to that device. For information on sending test notifications without setting up the environment, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/testing-notifications-using-the-push-notification-console].\n\n### Establish a connection to APNs\n\nUse HTTP\/2 and TLS 1.2 or later to establish a connection between your provider server and one of the following servers:\n\nUse the production server for your shipping apps and the development server for testing. When sending many remote notifications, you can establish multiple connections to these servers to improve performance.\n\nAPNs allows multiple concurrent streams for each connection, but don’t assume a specific number of streams. The exact number varies based on server load and whether you use a provider certificate or an authentication token. For example, when using an authentication token, APNs allows only one stream until you post a request with a valid authentication token. APNs ignores `HTTP\/2 PRIORITY` frames, so don’t send them on your streams.\n\nIf you experience a revoked provider certificate, or if you revoke your authentication token, close all connections to APNs, fix the problem, and then open new connections. APNs may also terminate a connection by sending a `GOAWAY` frame. The payload of the `GOAWAY` frame includes JSON data with a `reason` key, indicating the reason for the connection termination. For a list of values for the `reason` key, refer to the response error strings in [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/handling-notification-responses-from-apns].\n\n### Create a POST request to APNs\n\nTo send a notification to a user’s device, construct and send a POST notification to APNs. Send this request over the connection you created using HTTP\/2 and TLS. To create your POST notification, you must already have the following pieces of information:\n\n### Send a POST request to APNs\n\nTo deliver the notifications, you’re required to have some header fields. In addition to the preceding data, add the following header fields in to your request. Other headers are optional or may depend on whether you’re using token-based or certificate-based authentication.\n\nAPNs requires the use of HPACK (header compression for HTTP\/2), which prevents repeatedly storing header keys and values. APNs maintains a small dynamic table for HPACK. To avoid filling up that table, encode your headers in the following way—especially when using many streams:\n\nPut the JSON payload with the notification’s content into the body of your request. You must not use a compressed JSON payload, and it’s limited to a maximum size of 4 KB (4096 bytes). The maxiumum size for a Voice over Internet Protocol (VoIP) notification is 5 KB (5120 bytes).\n\nThe code snippet below shows a sample request constructed with an authentication token.\n\nThe code snippet below shows a sample request constructed for use with a certificate. APNs uses the app’s bundle ID as the default topic.\n\n### Know when to use push types\n\nThe `apns-push-type` header field has the following valid values. The descriptions below describe when and how to use these values. Send an `apns-push-type` header with each push. Recent and upcoming features may not work if this header is missing. See the table above to determine if this header is required or optional.\n\nCertificate-based connection supports only a subset of push types and token-based connection supports all push-types. For more information, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/establishing-a-certificate-based-connection-to-apns]. Check Extension `1.2.840.113635.100.6.3.6` and `1.2.840.113635.100.6.3.4` of your push certificate. These extensions list all the push topics allowed for your certificate. If a push topic for a specific push type isn’t listed, you can’t use the certificate to send a notification of that push type.\n\n### Follow best practices while sending push notifications with APNs\n\nBelow are some APNs best practices to consider:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/UserNotifications\/sending-notification-requests-to-apns\ncrawled: 2025-12-04T09:10:57Z\n---\n\n# Sending notification requests to APNs\n\n**Article**\n\nTransmit your remote notification payload and device token information to Apple Push Notification service (APNs).\n\n## Overview\n\nAs a best-effort service, APNs may reorder notifications you send to the same device token. If APNs can’t deliver a notification immediately, it may store the notification for 30 days or less, depending on the date you specify in the `apns-expiration` header. APNs attempts to deliver the notification the next time the device activates and is available online.\n\nAPNs stores only one notification per bundle ID. When you send multiple notifications to the same device for a bundle ID, APNs selects only one notification to store. In most cases, the latest notification is stored. However, this behavior isn’t always guaranteed when multiple notifications are stored in a short duration. Notifications with `apns-priority 5` and `apns-priority 1` might get grouped and delivered in bursts to a person’s device. Your notifications may also get throttled, saved in storage, and in some cases, not delivered. The way a person interacts with your app and the power state of the device determines the exact behavior. For more information about the factors that impact the delivery of a push notification, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/viewing-the-status-of-push-notifications-using-metrics-and-apns].\n\nWhen you have a notification to send to a user, your provider must construct a POST request and send it to Apple Push Notification service (APNs). Upon receiving your server’s POST request, APNs validates the request using either the provided authentication token or your server’s certificate. If validation succeeds, APNs uses the provided device token to identify the user’s device. It then tries to send your JSON payload to that device. For information on sending test notifications without setting up the environment, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/testing-notifications-using-the-push-notification-console].\n\n### Establish a connection to APNs\n\nUse HTTP\/2 and TLS 1.2 or later to establish a connection between your provider server and one of the following servers:\n\n- Development server: [https:\/\/api.sandbox.push.apple.com:443]\n- Production server: [https:\/\/api.push.apple.com:443]\n\nUse the production server for your shipping apps and the development server for testing. When sending many remote notifications, you can establish multiple connections to these servers to improve performance.\n\n\n\nAPNs allows multiple concurrent streams for each connection, but don’t assume a specific number of streams. The exact number varies based on server load and whether you use a provider certificate or an authentication token. For example, when using an authentication token, APNs allows only one stream until you post a request with a valid authentication token. APNs ignores `HTTP\/2 PRIORITY` frames, so don’t send them on your streams.\n\nIf you experience a revoked provider certificate, or if you revoke your authentication token, close all connections to APNs, fix the problem, and then open new connections. APNs may also terminate a connection by sending a `GOAWAY` frame. The payload of the `GOAWAY` frame includes JSON data with a `reason` key, indicating the reason for the connection termination. For a list of values for the `reason` key, refer to the response error strings in [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/handling-notification-responses-from-apns].\n\n### Create a POST request to APNs\n\nTo send a notification to a user’s device, construct and send a POST notification to APNs. Send this request over the connection you created using HTTP\/2 and TLS. To create your POST notification, you must already have the following pieces of information:\n\n- The device token that identifies the user device to receive the notification; refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/registering-your-app-with-apns].\n- Your current authentication token (only if you’re using token-based authentication); refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/establishing-a-token-based-connection-to-apns].\n- The notification’s payload, specified as JSON data; refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/generating-a-remote-notification].\n\n\n\n### Send a POST request to APNs\n\nTo deliver the notifications, you’re required to have some header fields. In addition to the preceding data, add the following header fields in to your request. Other headers are optional or may depend on whether you’re using token-based or certificate-based authentication.\n\n\n\nAPNs requires the use of HPACK (header compression for HTTP\/2), which prevents repeatedly storing header keys and values. APNs maintains a small dynamic table for HPACK. To avoid filling up that table, encode your headers in the following way—especially when using many streams:\n\n- Encode the `:path` and `authorization` values as *literal header fields without indexing*.\n- Encode the `apns-id`, `apns-expiration`, and `apns-collapse-id` values differently based on whether this is an initial or subsequent request.\n- The first time you send these headers, encode them with *incremental indexing* to add the header fields to the dynamic table.\n- For subsequent requests, encode these headers as *literal header fields without indexing*.\n- Encode all other fields as literal header fields with *incremental indexing*.\n\nPut the JSON payload with the notification’s content into the body of your request. You must not use a compressed JSON payload, and it’s limited to a maximum size of 4 KB (4096 bytes). The maxiumum size for a Voice over Internet Protocol (VoIP) notification is 5 KB (5120 bytes).\n\nThe code snippet below shows a sample request constructed with an authentication token.\n\n```other\nHEADERS\n  - END_STREAM\n  + END_HEADERS\n  :method = POST\n  :scheme = https\n  :path = \/3\/device\/00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0\n  host = api.sandbox.push.apple.com\n  authorization = bearer eyAia2lkIjogIjhZTDNHM1JSWDciIH0.eyAiaXNzIjogIkM4Nk5WOUpYM0QiLCAiaWF0I\n         jogIjE0NTkxNDM1ODA2NTAiIH0.MEYCIQDzqyahmH1rz1s-LFNkylXEa2lZ_aOCX4daxxTZkVEGzwIhALvkClnx5m5eAT6\n         Lxw7LZtEQcH6JENhJTMArwLf3sXwi\n  apns-id = eabeae54-14a8-11e5-b60b-1697f925ec7b\n  apns-push-type = alert\n  apns-expiration = 0\n  apns-priority = 10\n  apns-topic = com.example.MyApp\nDATA\n  + END_STREAM\n  { \"aps\" : { \"alert\" : \"Hello\" } }\n\n```\n\nThe code snippet below shows a sample request constructed for use with a certificate. APNs uses the app’s bundle ID as the default topic.\n\n```other\nHEADERS\n  - END_STREAM\n  + END_HEADERS\n  :method = POST\n  :scheme = https\n  :path = \/3\/device\/00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0\n  host = api.sandbox.push.apple.com\n  apns-id = eabeae54-14a8-11e5-b60b-1697f925ec7b\n  apns-push-type = alert\n  apns-expiration = 0\n  apns-priority = 10\nDATA\n  + END_STREAM\n  { \"aps\" : { \"alert\" : \"Hello\" } }\n\n```\n\n### Know when to use push types\n\nThe `apns-push-type` header field has the following valid values. The descriptions below describe when and how to use these values. Send an `apns-push-type` header with each push. Recent and upcoming features may not work if this header is missing. See the table above to determine if this header is required or optional.\n\n\n\nCertificate-based connection supports only a subset of push types and token-based connection supports all push-types. For more information, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/establishing-a-certificate-based-connection-to-apns]. Check Extension `1.2.840.113635.100.6.3.6` and `1.2.840.113635.100.6.3.4` of your push certificate. These extensions list all the push topics allowed for your certificate. If a push topic for a specific push type isn’t listed, you can’t use the certificate to send a notification of that push type.\n\n### Follow best practices while sending push notifications with APNs\n\nBelow are some APNs best practices to consider:\n\n- Make an uncached DNS query to resolve the APNs server name, before each connection. This helps distribute push traffic from all providers across all APNs servers.\n- Avoid push bursts over selective connections. Diversifying push traffic over many connections distributes push traffic for your application across all APNs servers.\n- Reuse a connection as long as possible. In most cases, you can reuse a connection for many hours to days. If your connection is mostly idle, you may send a HTTP2 PING frame after an hour of inactivity. Reusing a connection often results in less bandwidth and CPU consumption.\n- Create a unique value for the `apns-id` header to track your push notification. If you don’t provide one, APNs creates one and returns it as part of the response. Record this UUID to assist with debugging.\n- Pay attention to status returned by APNs for each push and take appropriate action for your application. For more information, refer to [doc:\/\/com.apple.usernotifications\/documentation\/UserNotifications\/handling-notification-responses-from-apns].\n- If you’re using a certificate to connect to APNs, remember to get a new certificate and deploy it with your service before the expiry of the current certificate.\n- Don’t make assumptions about device token size.\n\n\n\n## Device push notifications\n\n- **Handling notification responses from APNs**: Respond to the status codes that the APNs servers return.\n- **Viewing the status of push notifications using Metrics and APNs**: Monitor and interpret the status of your push notifications with Apple Push Notification service (APNs).\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Respond to the status codes that the APNs servers return.",
          "name" : "Handling notification responses from APNs",
          "url" : "https:\/\/developer.apple.com\/documentation\/UserNotifications\/handling-notification-responses-from-apns"
        },
        {
          "description" : "Monitor and interpret the status of your push notifications with Apple Push Notification service (APNs).",
          "name" : "Viewing the status of push notifications using Metrics and APNs",
          "url" : "https:\/\/developer.apple.com\/documentation\/UserNotifications\/viewing-the-status-of-push-notifications-using-metrics-and-apns"
        }
      ],
      "title" : "Device push notifications"
    }
  ],
  "source" : "appleJSON",
  "title" : "Sending notification requests to APNs",
  "url" : "https:\/\/developer.apple.com\/documentation\/UserNotifications\/sending-notification-requests-to-apns"
}