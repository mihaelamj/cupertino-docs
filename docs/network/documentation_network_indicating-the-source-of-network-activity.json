{
  "abstract" : "Control whether the App Privacy Report attributes network traffic to the app or to the user.",
  "codeExamples" : [
    {
      "code" : "import Foundation\n\nlet url = URL(string: \"https:\/\/example.com\")!\nvar request = URLRequest(url: url)\nrequest.attribution = .user\n\nlet (data, response) = try await URLSession.shared.data(for: request)",
      "language" : "swift"
    },
    {
      "code" : "import WebKit\n\nlet webView = WKWebView()\nlet html = \"<html><body><h1>Hello, world!<\/h1><\/body><\/html>\"\n\nwebView.loadSimulatedRequest(request, responseHTML: html)",
      "language" : "swift"
    },
    {
      "code" : "let data = Data(html.utf8)\nlet response = URLResponse(\n    url: url,\n    mimeType: \"text\/HTML\",\n    expectedContentLength: data.count,\n    textEncodingName: \"UTF-8\")\n\nwebView.loadSimulatedRequest(request, response: response, responseData: data)",
      "language" : "swift"
    },
    {
      "code" : "let fileURL = Bundle.main.url(\n    forResource: \"index\",\n    withExtension: \"html\",\n    subdirectory: \"resources\")!\n\nvar fileRequest = URLRequest(url: fileURL)\nfileRequest.attribution = .user\n\nwebView.loadFileRequest(\n    fileRequest,\n    allowingReadAccessTo: fileURL.deletingLastPathComponent())",
      "language" : "swift"
    },
    {
      "code" : "import LinkPresentation\n\nlet metadataProvider = LPMetadataProvider()\nlet metadata = try await metadataProvider.startFetchingMetadata(for: request)",
      "language" : "swift"
    },
    {
      "code" : "import Network\n\nlet parameters = NWParameters()\nparameters.attribution = .user\nlet endpoint = NWEndpoint.url(url)\nlet connection = NWConnection(to: endpoint, using: parameters)",
      "language" : "swift"
    },
    {
      "code" : "let parameters = nw_parameters_create()\nnw_parameters_set_attribution(parameters, .user)\nlet endpoint = nw_endpoint_create_url(\"https:\/\/example.com\")\nlet connection = nw_connection_create(endpoint, parameters)",
      "language" : "swift"
    },
    {
      "code" : "#include <sys\/socket.h>\n#include <networkext\/ne_socket.h>\n\nint tcpSocket = socket(PF_INET, SOCK_STREAM, 0);\nif (ne_socket_set_attribution(tcpSocket, NE_SOCKET_ATTRIBUTION_USER) != 0) {\n    \/\/ Handle error.\n}",
      "language" : "objc"
    },
    {
      "code" : "const char *domains[] = { \"resolved.example.com\" };\nif (ne_socket_set_domains(tcpSocket, domains, 1) != 0) {\n    \/\/ Handle error.\n}",
      "language" : "objc"
    },
    {
      "code" : "const struct sockaddr *address = <#Some address#>;\nint connectResult = connect(tcpSocket, address, address->sa_len);",
      "language" : "objc"
    }
  ],
  "contentHash" : "3178bb4b5a05c6a09e9daac602087bede6f1fc8ede5d09e85349f26b84c0df0f",
  "crawledAt" : "2025-12-05T12:16:15Z",
  "id" : "834D4ED2-E46F-4410-B620-4E43B11226E0",
  "kind" : "article",
  "language" : "swift",
  "module" : "Network",
  "overview" : "## Overview\n\nIn iOS and iPadOS 15 or later, users can view an App Privacy Report that includes the network domains that apps on the device have recently accessed. The report differentiates between network connections that the user initiates and those that the app initiates.\n\nBy default, the system attributes all connections — except those that your app makes using [doc:\/\/com.apple.documentation\/documentation\/SafariServices\/SFSafariViewController] or [doc:\/\/com.apple.documentation\/documentation\/AuthenticationServices\/ASWebAuthenticationSession] — to the app. However, for network connections that meet certain criteria, you can tell the system to attribute the connection to the user. The API you use to control attribution depends on how you make the network connection.\n\nTo learn how to examine all the data your app contributes to the privacy report, see [doc:\/\/com.apple.network\/documentation\/Network\/inspecting-app-activity-data].\n\n### Determine the appropriate attribution\n\nAll connections, other than those that use [doc:\/\/com.apple.documentation\/documentation\/SafariServices\/SFSafariViewController] or [doc:\/\/com.apple.documentation\/documentation\/AuthenticationServices\/ASWebAuthenticationSession], are classified by default as *app-initiated*. User-initiated network connections are the exception. Network connections to third-party domains can only be classified as *user-initiated* if they meet all of the following criteria:\n\nIf you don’t categorize your app’s traffic using the APIs, all network connections are classified as app-initiated.\n\nFor example, the following connections should retain the app-initiated attribution:\n\nIn contrast, you can attribute these connections to the user:\n\nTo reclassify an access as user-initiated, use API at the same layer of the protocol stack that you use to make the connection.\n\n### Attribute URL Loading System connections\n\nTo mark a connection as user-initiated when using the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/url-loading-system], create an explicit [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLRequest] and set its [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLRequest\/attribution-swift.property] property to [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSURLRequest\/Attribution-swift.enum\/user] before calling one of the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession] methods that takes a request, like [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession\/data(for:delegate:)]:\n\nThe [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSURLRequest] and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableURLRequest] classes also have a comparable property. Use this kind of parameterized request for other high level link types as well, as the next few sections describe.\n\n### Attribute WebKit loads\n\nA [doc:\/\/com.apple.documentation\/documentation\/WebKit] network access that you initiate with a URL request using the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/load(_:)] method honors the attribution parameter that you set on the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLRequest] instance, just like the previous section describes for a [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession] access. If you want to set an attribution when you use WebKit to load an HTML string, data, or a file URL, use one of the corresponding load methods that takes a request. For example, you can load an HTML string with attribution using the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadSimulatedRequest(_:responseHTML:)] method, relying on the `request` defined in the previous section:\n\nAlternatively, you can load a data version of the same content using the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadSimulatedRequest(_:response:responseData:)] method:\n\nTo load a file called `index.html` from your main bundle’s `resources` directory with user attribution, use the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadFileRequest(_:allowingReadAccessTo:)] method:\n\nThese load methods — as opposed to their non-request counterparts like [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadHTMLString(_:baseURL:)] and [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadFileRequest(_:allowingReadAccessTo:)] — also enable the user to browse backward and forward among the corresponding pages.\n\n### Attribute LinkPresentation metadata fetches\n\nTo load link presentation metadata with attribution, use the [doc:\/\/com.apple.documentation\/documentation\/LinkPresentation\/LPMetadataProvider] fetch method that takes a request. Specifically, use the [doc:\/\/com.apple.documentation\/documentation\/LinkPresentation\/LPMetadataProvider\/startFetchingMetadata(for:completionHandler:)-9e6s8] method — again, relying on the user-attributed `request` value that you defined earlier:\n\n### Attribute Network framework connections\n\nTo control attribution when using the [doc:\/\/com.apple.network\/documentation\/Network] framework, set the [doc:\/\/com.apple.network\/documentation\/Network\/NWParameters\/attribution-swift.property] property of an [doc:\/\/com.apple.network\/documentation\/Network\/NWParameters] instance to [doc:\/\/com.apple.network\/documentation\/Network\/NWParameters\/Attribution-swift.enum\/user], and use that to create a connection:\n\nAlternatively, you can work with an [doc:\/\/com.apple.network\/documentation\/Network\/nw_parameters_t] instance, and set the attribution to [doc:\/\/com.apple.network\/documentation\/Network\/nw_parameters_attribution_t\/user] with a call to the [doc:\/\/com.apple.network\/documentation\/Network\/nw_parameters_set_attribution(_:_:)] function:\n\n### Attribute connections made with sockets\n\nTo control attribution when working with sockets, import the `ne_socket.h` header file, and use the `ne_socket_set_attribution` function to set the value `NE_SOCKET_ATTRIBUTION_USER` on a socket:\n\nIf you use custom DNS resolution, also call `ne_socket_set_domains()` function to associate the resolved domain name (as well as any resolved `CNAME`) with the socket:\n\nThis gives the system an opportunity to evaluate whether the resolved domain has been identified as potentially collecting information across apps and sites. After performing any additional configuration, use the socket to create a connection:",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/network\/indicating-the-source-of-network-activity\ncrawled: 2025-12-05T12:16:15Z\n---\n\n# Indicating the source of network activity\n\n**Article**\n\nControl whether the App Privacy Report attributes network traffic to the app or to the user.\n\n## Overview\n\nIn iOS and iPadOS 15 or later, users can view an App Privacy Report that includes the network domains that apps on the device have recently accessed. The report differentiates between network connections that the user initiates and those that the app initiates.\n\nBy default, the system attributes all connections — except those that your app makes using [doc:\/\/com.apple.documentation\/documentation\/SafariServices\/SFSafariViewController] or [doc:\/\/com.apple.documentation\/documentation\/AuthenticationServices\/ASWebAuthenticationSession] — to the app. However, for network connections that meet certain criteria, you can tell the system to attribute the connection to the user. The API you use to control attribution depends on how you make the network connection.\n\nTo learn how to examine all the data your app contributes to the privacy report, see [doc:\/\/com.apple.network\/documentation\/Network\/inspecting-app-activity-data].\n\n### Determine the appropriate attribution\n\nAll connections, other than those that use [doc:\/\/com.apple.documentation\/documentation\/SafariServices\/SFSafariViewController] or [doc:\/\/com.apple.documentation\/documentation\/AuthenticationServices\/ASWebAuthenticationSession], are classified by default as *app-initiated*. User-initiated network connections are the exception. Network connections to third-party domains can only be classified as *user-initiated* if they meet all of the following criteria:\n\n- User-directed — Network connections to domains that occur only when a user affirmatively chooses to engage with content in your app. For a connection to qualify as user-directed, the user must be provided with a meaningful choice of whether to interact with the content.\n- Non-primary functionality — The app’s features must be functional without this particular network connection.\n\nIf you don’t categorize your app’s traffic using the APIs, all network connections are classified as app-initiated.\n\nFor example, the following connections should retain the app-initiated attribution:\n\n- A podcast app that automatically chooses and downloads podcasts based on the user’s interests. While the loaded content isn’t core to the app, the user has no control over it.\n- An app that transmits analytics and other user data for use in improving the app. The access is core to the app’s functionality, and the user has no control over it.\n- A maps app that loads and presents content from a review service — for example, for hotels or restaurants — when the user taps on a location pin. The action is core to the app’s functionality, and the user didn’t explicitly request the information.\n\nIn contrast, you can attribute these connections to the user:\n\n- Links to user-generated content in a social media app, like when a user clicks or taps a news feed link. The user chooses the link, and the particular link isn’t part of the app’s primary functionality.\n- Messages in an email app. The user creates and configures the email account, and no particular email or email account is central to the app’s functionality.\n- Pages loaded by a web browser. The user chooses the web sites to visit, and no particular web site is specific to the app’s functionality. Note that connections made by the browser that the user doesn’t choose, like sending analytics data or retrieving user configuration information, should retain app attribution.\n\nTo reclassify an access as user-initiated, use API at the same layer of the protocol stack that you use to make the connection.\n\n### Attribute URL Loading System connections\n\nTo mark a connection as user-initiated when using the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/url-loading-system], create an explicit [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLRequest] and set its [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLRequest\/attribution-swift.property] property to [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSURLRequest\/Attribution-swift.enum\/user] before calling one of the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession] methods that takes a request, like [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession\/data(for:delegate:)]:\n\n```swift\nimport Foundation\n\nlet url = URL(string: \"https:\/\/example.com\")!\nvar request = URLRequest(url: url)\nrequest.attribution = .user\n\nlet (data, response) = try await URLSession.shared.data(for: request)\n```\n\nThe [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSURLRequest] and [doc:\/\/com.apple.documentation\/documentation\/Foundation\/NSMutableURLRequest] classes also have a comparable property. Use this kind of parameterized request for other high level link types as well, as the next few sections describe.\n\n### Attribute WebKit loads\n\nA [doc:\/\/com.apple.documentation\/documentation\/WebKit] network access that you initiate with a URL request using the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/load(_:)] method honors the attribution parameter that you set on the [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLRequest] instance, just like the previous section describes for a [doc:\/\/com.apple.documentation\/documentation\/Foundation\/URLSession] access. If you want to set an attribution when you use WebKit to load an HTML string, data, or a file URL, use one of the corresponding load methods that takes a request. For example, you can load an HTML string with attribution using the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadSimulatedRequest(_:responseHTML:)] method, relying on the `request` defined in the previous section:\n\n```swift\nimport WebKit\n\nlet webView = WKWebView()\nlet html = \"<html><body><h1>Hello, world!<\/h1><\/body><\/html>\"\n\nwebView.loadSimulatedRequest(request, responseHTML: html)\n```\n\nAlternatively, you can load a data version of the same content using the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadSimulatedRequest(_:response:responseData:)] method:\n\n```swift\nlet data = Data(html.utf8)\nlet response = URLResponse(\n    url: url,\n    mimeType: \"text\/HTML\",\n    expectedContentLength: data.count,\n    textEncodingName: \"UTF-8\")\n\nwebView.loadSimulatedRequest(request, response: response, responseData: data)\n```\n\nTo load a file called `index.html` from your main bundle’s `resources` directory with user attribution, use the [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadFileRequest(_:allowingReadAccessTo:)] method:\n\n```swift\nlet fileURL = Bundle.main.url(\n    forResource: \"index\",\n    withExtension: \"html\",\n    subdirectory: \"resources\")!\n\nvar fileRequest = URLRequest(url: fileURL)\nfileRequest.attribution = .user\n\nwebView.loadFileRequest(\n    fileRequest,\n    allowingReadAccessTo: fileURL.deletingLastPathComponent())\n```\n\nThese load methods — as opposed to their non-request counterparts like [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadHTMLString(_:baseURL:)] and [doc:\/\/com.apple.documentation\/documentation\/WebKit\/WKWebView\/loadFileRequest(_:allowingReadAccessTo:)] — also enable the user to browse backward and forward among the corresponding pages.\n\n### Attribute LinkPresentation metadata fetches\n\nTo load link presentation metadata with attribution, use the [doc:\/\/com.apple.documentation\/documentation\/LinkPresentation\/LPMetadataProvider] fetch method that takes a request. Specifically, use the [doc:\/\/com.apple.documentation\/documentation\/LinkPresentation\/LPMetadataProvider\/startFetchingMetadata(for:completionHandler:)-9e6s8] method — again, relying on the user-attributed `request` value that you defined earlier:\n\n```swift\nimport LinkPresentation\n\nlet metadataProvider = LPMetadataProvider()\nlet metadata = try await metadataProvider.startFetchingMetadata(for: request)\n```\n\n### Attribute Network framework connections\n\nTo control attribution when using the [doc:\/\/com.apple.network\/documentation\/Network] framework, set the [doc:\/\/com.apple.network\/documentation\/Network\/NWParameters\/attribution-swift.property] property of an [doc:\/\/com.apple.network\/documentation\/Network\/NWParameters] instance to [doc:\/\/com.apple.network\/documentation\/Network\/NWParameters\/Attribution-swift.enum\/user], and use that to create a connection:\n\n```swift\nimport Network\n\nlet parameters = NWParameters()\nparameters.attribution = .user\nlet endpoint = NWEndpoint.url(url)\nlet connection = NWConnection(to: endpoint, using: parameters)\n```\n\nAlternatively, you can work with an [doc:\/\/com.apple.network\/documentation\/Network\/nw_parameters_t] instance, and set the attribution to [doc:\/\/com.apple.network\/documentation\/Network\/nw_parameters_attribution_t\/user] with a call to the [doc:\/\/com.apple.network\/documentation\/Network\/nw_parameters_set_attribution(_:_:)] function:\n\n```swift\nlet parameters = nw_parameters_create()\nnw_parameters_set_attribution(parameters, .user)\nlet endpoint = nw_endpoint_create_url(\"https:\/\/example.com\")\nlet connection = nw_connection_create(endpoint, parameters)\n```\n\n### Attribute connections made with sockets\n\nTo control attribution when working with sockets, import the `ne_socket.h` header file, and use the `ne_socket_set_attribution` function to set the value `NE_SOCKET_ATTRIBUTION_USER` on a socket:\n\n```objc\n#include <sys\/socket.h>\n#include <networkext\/ne_socket.h>\n\nint tcpSocket = socket(PF_INET, SOCK_STREAM, 0);\nif (ne_socket_set_attribution(tcpSocket, NE_SOCKET_ATTRIBUTION_USER) != 0) {\n    \/\/ Handle error.\n}\n```\n\nIf you use custom DNS resolution, also call `ne_socket_set_domains()` function to associate the resolved domain name (as well as any resolved `CNAME`) with the socket:\n\n```objc\nconst char *domains[] = { \"resolved.example.com\" };\nif (ne_socket_set_domains(tcpSocket, domains, 1) != 0) {\n    \/\/ Handle error.\n}\n```\n\nThis gives the system an opportunity to evaluate whether the resolved domain has been identified as potentially collecting information across apps and sites. After performing any additional configuration, use the socket to create a connection:\n\n```objc\nconst struct sockaddr *address = <#Some address#>;\nint connectResult = connect(tcpSocket, address, address->sa_len);\n```\n\n## Traffic Attribution\n\n- **Inspecting app activity data**: Verify that your app accesses only the user data and network resources that you expect it to access.\n- **nw_parameters_set_attribution(_:_:)**: Sets a flag that indicates whether the network request originates from the developer or the user.\n- **nw_parameters_get_attribution(_:)**: Gets a flag that indicates whether the network request originates from the developer or the user.\n- **nw_parameters_attribution_t**: The entities that can make a network request.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Verify that your app accesses only the user data and network resources that you expect it to access.",
          "name" : "Inspecting app activity data",
          "url" : "https:\/\/developer.apple.com\/documentation\/Network\/inspecting-app-activity-data"
        },
        {
          "description" : "Sets a flag that indicates whether the network request originates from the developer or the user.",
          "name" : "nw_parameters_set_attribution(_:_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Network\/nw_parameters_set_attribution(_:_:)"
        },
        {
          "description" : "Gets a flag that indicates whether the network request originates from the developer or the user.",
          "name" : "nw_parameters_get_attribution(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Network\/nw_parameters_get_attribution(_:)"
        },
        {
          "description" : "The entities that can make a network request.",
          "name" : "nw_parameters_attribution_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/Network\/nw_parameters_attribution_t"
        }
      ],
      "title" : "Traffic Attribution"
    }
  ],
  "source" : "appleJSON",
  "title" : "Indicating the source of network activity",
  "url" : "https:\/\/developer.apple.com\/documentation\/network\/indicating-the-source-of-network-activity"
}