{
  "abstract" : "Focus on a part of an image by applying Gaussian blur and gradient masks.",
  "codeExamples" : [
    {
      "code" : "const CGFloat h = inputImage.extent.size.height;\nCIFilter<CILinearGradient>* topGradient = CIFilter.linearGradientFilter;\ntopGradient.point0 = CGPointMake(0, 0.85 * h);\ntopGradient.color0 = CIColor.greenColor;\ntopGradient.point1 = CGPointMake(0, 0.6 * h);\ntopGradient.color1 = [CIColor colorWithRed:0 green:1 blue:0];",
      "language" : "swift"
    },
    {
      "code" : "CIFilter<CILinearGradient>* bottomGradient = CIFilter.linearGradientFilter;\nbottomGradient.point0 = CGPointMake(0, 0.35 * h);\nbottomGradient.color0 = CIColor.greenColor;\nbottomGradient.point1 = CGPointMake(0, 0.6 * h);\nbottomGradient.color1 = [CIColor colorWithRed:0 green:1 blue:0 alpha:0];",
      "language" : "swift"
    },
    {
      "code" : "CIFilter<CICompositeOperation> *gradientMask = CIFilter.additionCompositingFilter\ngradientMask.inputImage = topGradient.outputImage;\ngradientMask.backgroundImage = bottomGradient.outputImage;",
      "language" : "swift"
    },
    {
      "code" : "CIFilter<CIRadialGradient> *radialMask = CIFilter.radialGradientFilter;\nradialMask.center = CGPointMake(0.55 * w, 0.6 * h);\nradialMask.radius0 = 0.2 * h;\nradialMask.radius1 = 0.3 * h;\nradialMask.color0 = [CIColor colorWithRed:0 green:1 blue:0 alpha:0];\nradialMask.color1 = [CIColor colorWithRed:0 green:1 blue:0 alpha:1];",
      "language" : "swift"
    },
    {
      "code" : "CIFilter<CIMaskedVariableBlur> *maskedVariableBlur = CIFilter.maskedVariableBlurFilter;\nmaskedVariableBlur.inputImage = inputImage;\nmaskedVariableBlur.mask = radialMask.outputImage;\nmaskedVariableBlur.radius = 10;\nCIImage *selectivelyFocusedCIImage = maskedVariableBlur.outputImage;",
      "language" : "swift"
    }
  ],
  "contentHash" : "603d800a5fd376523d14867b6b07cbc5038521fdccb59c76a308df9452e37641",
  "crawledAt" : "2025-12-04T21:21:22Z",
  "id" : "666AAB45-417C-400D-87B8-655EE5FE24A8",
  "kind" : "article",
  "language" : "swift",
  "module" : "Core Image",
  "overview" : "## Overview\n\nYou can selectively blur areas of an image using [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter.\n\n\n\nYou specify the region to blur by applying a mask image; the shape and values of the mask image determine the location and strength of the blurring. Creating this effect involves the following steps:\n\n### Focusing on a Strip of the Image\n\nYou can build your mask in any shape, but the general strategy remains the same: leave the mask transparent where you want the original image to stay sharp and focused. This section covers focusing on a horizontal strip.\n\nTo build a mask that leaves out a stripe, create linear gradients from a single color, such as green or gray. Our goal is to build the mask shown in Figure 2.\n\n\n\nThe linear gradients cause the blur to taper smoothly as it approaches the focused stripe of the image. The Core Image [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] named [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/linearGradient()] generates filters of the desired color. The linear gradient has four parameters:\n\nCompute the start and stop points of the gradient as fractions of the image height, as obtained through [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIImage\/extent]. For this particular mask and example image, focus on the area near the middle, in the second quarter of the image. Set the linear gradient’s `point0` and `point1` to reflect the region through which the gradient tapers.\n\nThe lower gradient should complement the upper gradient, so that their combined coverage delineates the entire area to blur. Express the starting `inputPoint0` y-value at `0.35` of the image height and taper to `0.6`, where the top gradient began. This leaves a gap in the combined mask through which the sharp image will show.\n\n### Creating a Mask by Compositing Linear Gradients\n\nTo create a mask that dilineates where and how strong a blur to apply, combine the two linear gradients.\n\n\n\nSince the gradients themselves are [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] objects, compositing them is as simple as concatenating their filter outputs to a compositing filter.  Use the built-in [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] named [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/additionCompositing()] to composite two images additively.\n\nThe resulting mask is now ready to be applied as part of the [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter.\n\n### Focusing on a Circular Region\n\nIn order to focus on a circular region of an image, you can create a Core Image [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/radialGradient()] filter.\n\nThe filter takes four parameters:\n\nThis yields a circular mask to use with the [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter.\n\n\n\n### Masking the Blurred Image to Apply Selective Focus\n\nThe final step is applying your choice of mask with the input image. The [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] built-in [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] accomplishes this task with the following input parameters:\n\nThe resulting image shows the original image with portions blurred out according to the mask applied. The linear gradient mask results in an output image focused on a strip, and the radial gradient mask results in an output image focused on a circular region.\n\n\n\n",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CoreImage\/selectively-focusing-on-an-image\ncrawled: 2025-12-04T21:21:22Z\n---\n\n# Selectively Focusing on an Image\n\n**Article**\n\nFocus on a part of an image by applying Gaussian blur and gradient masks.\n\n## Overview\n\nYou can selectively blur areas of an image using [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter.\n\n\n\nYou specify the region to blur by applying a mask image; the shape and values of the mask image determine the location and strength of the blurring. Creating this effect involves the following steps:\n\n1. To focus on a strip across the image, create two linear gradients representing the portions of the image to blur.\n2. To focus on a circular region in the image, create a radial gradient centered on the region to keep sharp.\n3. Composite the gradients into a mask.\n4. Apply Core Image’s [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter to the original image, inputting the created mask.\n\n### Focusing on a Strip of the Image\n\nYou can build your mask in any shape, but the general strategy remains the same: leave the mask transparent where you want the original image to stay sharp and focused. This section covers focusing on a horizontal strip.\n\nTo build a mask that leaves out a stripe, create linear gradients from a single color, such as green or gray. Our goal is to build the mask shown in Figure 2.\n\n\n\nThe linear gradients cause the blur to taper smoothly as it approaches the focused stripe of the image. The Core Image [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] named [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/linearGradient()] generates filters of the desired color. The linear gradient has four parameters:\n\n\n\nCompute the start and stop points of the gradient as fractions of the image height, as obtained through [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIImage\/extent]. For this particular mask and example image, focus on the area near the middle, in the second quarter of the image. Set the linear gradient’s `point0` and `point1` to reflect the region through which the gradient tapers.\n\n```swift\nconst CGFloat h = inputImage.extent.size.height;\nCIFilter<CILinearGradient>* topGradient = CIFilter.linearGradientFilter;\ntopGradient.point0 = CGPointMake(0, 0.85 * h);\ntopGradient.color0 = CIColor.greenColor;\ntopGradient.point1 = CGPointMake(0, 0.6 * h);\ntopGradient.color1 = [CIColor colorWithRed:0 green:1 blue:0];\n```\n\nThe lower gradient should complement the upper gradient, so that their combined coverage delineates the entire area to blur. Express the starting `inputPoint0` y-value at `0.35` of the image height and taper to `0.6`, where the top gradient began. This leaves a gap in the combined mask through which the sharp image will show.\n\n```swift\nCIFilter<CILinearGradient>* bottomGradient = CIFilter.linearGradientFilter;\nbottomGradient.point0 = CGPointMake(0, 0.35 * h);\nbottomGradient.color0 = CIColor.greenColor;\nbottomGradient.point1 = CGPointMake(0, 0.6 * h);\nbottomGradient.color1 = [CIColor colorWithRed:0 green:1 blue:0 alpha:0];\n```\n\n### Creating a Mask by Compositing Linear Gradients\n\nTo create a mask that dilineates where and how strong a blur to apply, combine the two linear gradients.\n\n\n\nSince the gradients themselves are [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] objects, compositing them is as simple as concatenating their filter outputs to a compositing filter.  Use the built-in [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] named [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/additionCompositing()] to composite two images additively.\n\n```swift\nCIFilter<CICompositeOperation> *gradientMask = CIFilter.additionCompositingFilter\ngradientMask.inputImage = topGradient.outputImage;\ngradientMask.backgroundImage = bottomGradient.outputImage;\n```\n\nThe resulting mask is now ready to be applied as part of the [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter.\n\n### Focusing on a Circular Region\n\nIn order to focus on a circular region of an image, you can create a Core Image [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/radialGradient()] filter.\n\nThe filter takes four parameters:\n\n\n\n1. Set the `center` to a [doc:\/\/com.apple.documentation\/documentation\/CoreFoundation\/CGPoint] pointing to the center of the region you want to leave unblurred.\n2. Set the `radius0` to a fraction of the image’s dimension, like `0.2*h` in this example. You can tweak this parameter to determine the size of the sharp region.\n3. Set the `radius1` to a larger fraction of the image’s dimension, like `0.3*h` in this example. Tweaking this parameter changes the extent of the blur’s tapering effect; a larger value makes the blur more gradual, whereas a smaller value makes the image transition more abruptly from sharp (at `inputRadius0`) to blur (at `inputRadius1`).\n4. As with the linear gradients, set `color0` to transparency, and `color1` to a solid opaque color, to indicate the blur’s gradation from nonexistent to full.\n\n```swift\nCIFilter<CIRadialGradient> *radialMask = CIFilter.radialGradientFilter;\nradialMask.center = CGPointMake(0.55 * w, 0.6 * h);\nradialMask.radius0 = 0.2 * h;\nradialMask.radius1 = 0.3 * h;\nradialMask.color0 = [CIColor colorWithRed:0 green:1 blue:0 alpha:0];\nradialMask.color1 = [CIColor colorWithRed:0 green:1 blue:0 alpha:1];\n```\n\nThis yields a circular mask to use with the [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] filter.\n\n\n\n### Masking the Blurred Image to Apply Selective Focus\n\nThe final step is applying your choice of mask with the input image. The [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class\/maskedVariableBlur()] built-in [doc:\/\/com.apple.coreimage\/documentation\/CoreImage\/CIFilter-swift.class] accomplishes this task with the following input parameters:\n\n\n\n```swift\nCIFilter<CIMaskedVariableBlur> *maskedVariableBlur = CIFilter.maskedVariableBlurFilter;\nmaskedVariableBlur.inputImage = inputImage;\nmaskedVariableBlur.mask = radialMask.outputImage;\nmaskedVariableBlur.radius = 10;\nCIImage *selectivelyFocusedCIImage = maskedVariableBlur.outputImage;\n```\n\nThe resulting image shows the original image with portions blurred out according to the mask applied. The linear gradient mask results in an output image focused on a strip, and the radial gradient mask results in an output image focused on a circular region.\n\n\n\n\n\n## Filter Recipes\n\n- **Applying a Chroma Key Effect**: Replace a color in one image with the background from another.\n- **Customizing Image Transitions**: Transition between images in creative ways using Core Image filters.\n- **Simulating Scratchy Analog Film**: Degrade the quality of an image to make it look like dated, analog film.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Replace a color in one image with the background from another.",
          "name" : "Applying a Chroma Key Effect",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreImage\/applying-a-chroma-key-effect"
        },
        {
          "description" : "Transition between images in creative ways using Core Image filters.",
          "name" : "Customizing Image Transitions",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreImage\/customizing-image-transitions"
        },
        {
          "description" : "Degrade the quality of an image to make it look like dated, analog film.",
          "name" : "Simulating Scratchy Analog Film",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreImage\/simulating-scratchy-analog-film"
        }
      ],
      "title" : "Filter Recipes"
    }
  ],
  "source" : "appleJSON",
  "title" : "Selectively Focusing on an Image",
  "url" : "https:\/\/developer.apple.com\/documentation\/CoreImage\/selectively-focusing-on-an-image"
}