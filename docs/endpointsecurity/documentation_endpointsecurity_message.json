{
  "abstract" : "A type used by Endpoint Security to notify your client when a monitored action occurs.",
  "codeExamples" : [
    {
      "code" : "es_handler_block_t handler = ^void  (es_client_t* _Nonnull client, const es_message_t* _Nonnull message) {\n    switch (message->event_type) {\n        case ES_EVENT_TYPE_AUTH_RENAME: {\n            es_auth_result_t myResult = strstr(message->event.rename.source->path.data, \"DONOTMOVE\")\n                ? ES_AUTH_RESULT_DENY : ES_AUTH_RESULT_ALLOW;\n            es_respond_auth_result(client, message, myResult, false);\n            break;\n        }\n        \/\/ Handle any other cases you have subscribed to with\n        \/\/ additional case: statements.\n        default:\n            break;\n    }\n};\n",
      "language" : "c"
    }
  ],
  "contentHash" : "a2b9a1d3ab8a2bda6c1891d7b9b24456de361aaf4be8d367bfbb7f039e81da2c",
  "crawledAt" : "2025-12-05T02:31:52Z",
  "id" : "BB7FCAA4-3663-4284-A4F3-CBFE83FFB7DD",
  "kind" : "collection",
  "language" : "swift",
  "module" : "Endpoint Security",
  "overview" : "## Overview\n\nWhen Endpoint Security monitors an event of a given type, it sends a message to all clients subscribed to that event type, containing data about the event. Handlers use this information to react to the event. In the case of authorization events, handlers must actively respond to the message and authorize or deny the monitored action. The client must respond before the [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_message_t\/deadline] specified by the message.\n\nThe following code shows a handler that reacts to events of the type [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/ES_EVENT_TYPE_AUTH_RENAME]. Because the handler knows the event type, it can access the [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_events_t\/rename] member of the message’s [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_message_t\/event] union. From this, it gets the [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_event_rename_t\/source] of the rename event, and inspects the source file path. The handler denies authorization to the event if the filename includes the string `DONOTMOVE`, and allows it otherwise.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/endpointsecurity\/message\ncrawled: 2025-12-05T02:31:52Z\n---\n\n# Message\n\n**API Collection**\n\nA type used by Endpoint Security to notify your client when a monitored action occurs.\n\n## Overview\n\nWhen Endpoint Security monitors an event of a given type, it sends a message to all clients subscribed to that event type, containing data about the event. Handlers use this information to react to the event. In the case of authorization events, handlers must actively respond to the message and authorize or deny the monitored action. The client must respond before the [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_message_t\/deadline] specified by the message.\n\nThe following code shows a handler that reacts to events of the type [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/ES_EVENT_TYPE_AUTH_RENAME]. Because the handler knows the event type, it can access the [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_events_t\/rename] member of the message’s [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_message_t\/event] union. From this, it gets the [doc:\/\/com.apple.endpointsecurity\/documentation\/EndpointSecurity\/es_event_rename_t\/source] of the rename event, and inspects the source file path. The handler denies authorization to the event if the filename includes the string `DONOTMOVE`, and allows it otherwise.\n\n```c\nes_handler_block_t handler = ^void  (es_client_t* _Nonnull client, const es_message_t* _Nonnull message) {\n    switch (message->event_type) {\n        case ES_EVENT_TYPE_AUTH_RENAME: {\n            es_auth_result_t myResult = strstr(message->event.rename.source->path.data, \"DONOTMOVE\")\n                ? ES_AUTH_RESULT_DENY : ES_AUTH_RESULT_ALLOW;\n            es_respond_auth_result(client, message, myResult, false);\n            break;\n        }\n        \/\/ Handle any other cases you have subscribed to with\n        \/\/ additional case: statements.\n        default:\n            break;\n    }\n};\n\n```\n\n## Inspecting Messages\n\n- **es_message_t**: A message from the Endpoint Security subsystem that describes a security event.\n\n## Retaining and Releasing Messages\n\n- **es_retain_message(_:)**: Retains the given message, extending its lifetime until released.\n- **es_release_message(_:)**: Releases a previously-retained message.\n\n## Deprecated Functions\n\n- **es_copy_message(_:)**: Copies a message, by allocating new memory.\n- **es_message_size(_:)**: Calculates the size of a message structure.\n- **es_free_message(_:)**: Frees the memory allocated for the given message.\n\n## Supporting Types\n\n- **es_result_t**: The result of the Endpoint Security subsystem authorization process.\n- **es_string_token_t**: A pointer to a null-terminated string, and the length in bytes of that string.\n- **es_token_t**: An arbitrary buffer of data with its size.\n\n## Event Monitoring\n\n- **Client**: An opaque type that maintains Endpoint Security client state, and functions related to this type.\n- **Event Types**: Types used by messages to deliver details specific to different kinds of Endpoint Security events.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A message from the Endpoint Security subsystem that describes a security event.",
          "name" : "es_message_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_message_t"
        }
      ],
      "title" : "Inspecting Messages"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Retains the given message, extending its lifetime until released.",
          "name" : "es_retain_message(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_retain_message(_:)"
        },
        {
          "description" : "Releases a previously-retained message.",
          "name" : "es_release_message(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_release_message(_:)"
        }
      ],
      "title" : "Retaining and Releasing Messages"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Copies a message, by allocating new memory.",
          "name" : "es_copy_message(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_copy_message(_:)"
        },
        {
          "description" : "Calculates the size of a message structure.",
          "name" : "es_message_size(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_message_size(_:)"
        },
        {
          "description" : "Frees the memory allocated for the given message.",
          "name" : "es_free_message(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_free_message(_:)"
        }
      ],
      "title" : "Deprecated Functions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The result of the Endpoint Security subsystem authorization process.",
          "name" : "es_result_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_result_t"
        },
        {
          "description" : "A pointer to a null-terminated string, and the length in bytes of that string.",
          "name" : "es_string_token_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_string_token_t"
        },
        {
          "description" : "An arbitrary buffer of data with its size.",
          "name" : "es_token_t",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/es_token_t"
        }
      ],
      "title" : "Supporting Types"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "An opaque type that maintains Endpoint Security client state, and functions related to this type.",
          "name" : "Client",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/client"
        },
        {
          "description" : "Types used by messages to deliver details specific to different kinds of Endpoint Security events.",
          "name" : "Event Types",
          "url" : "https:\/\/developer.apple.com\/documentation\/EndpointSecurity\/event-types"
        }
      ],
      "title" : "Event Monitoring"
    }
  ],
  "source" : "appleJSON",
  "title" : "Message",
  "url" : "https:\/\/developer.apple.com\/documentation\/endpointsecurity\/message"
}