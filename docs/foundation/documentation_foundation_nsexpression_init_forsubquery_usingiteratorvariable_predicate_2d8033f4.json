{
  "abstract" : "Creates an expression that filters a collection by storing elements in the collection in a specified variable and keeping the elements that the qualifier returns as true.",
  "codeExamples" : [
    {
      "code" : "resident.firstname == \"Jane\" && resident.lastname == \"Doe\"",
      "language" : "objc"
    },
    {
      "code" : "resident.firstname CONTAINS \"Jane\" && resident.lastname CONTAINS \"Doe\"",
      "language" : "objc"
    },
    {
      "code" : "SUBQUERY(collection_expression, variable_expression, predicate);",
      "language" : "objc"
    },
    {
      "code" : "(SUBQUERY(residents, $x, $x.firstname == \"Jane\" && $x.lastname == \"Doe\").@count != 0)",
      "language" : "objc"
    },
    {
      "code" : "(SUBQUERY(residents, $x, $x.firstname == \"Jane\" && $x.lastname == \"Doe\")[size] != 0)",
      "language" : "objc"
    }
  ],
  "contentHash" : "380b32e998fa4ee70b1a518679d08cb3b7aec6b9dd42ea8c4c81e26f1b46d89d",
  "crawledAt" : "2025-12-05T00:28:35Z",
  "declaration" : {
    "code" : "init(forSubquery expression: NSExpression, usingIteratorVariable variable: String, predicate: NSPredicate)",
    "language" : "swift"
  },
  "id" : "EE4E4A44-4D40-4267-A42C-FB4A1668939A",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "Foundation",
  "overview" : "## Return Value\n\nAn expression that filters a collection by storing elements in the collection in the variable variable and keeping the elements for which qualifier returns true\n\n## Discussion\n\nThis method creates a sub-expression, evaluation of which returns a subset of a collection of objects. It allows you to create sophisticated queries across relationships, such as a search for multiple correlated values on the destination object of a relationship.\n\nFor example, suppose you have an Apartment entity that has a to-many relationship to a Resident entity, and that you want to create a query for all apartments inhabited by a resident whose first name is “Jane” and whose last name is “Doe”. Using only API available for OS X v 10.4, you could try the predicate:\n\nbut this will always return false since `resident.firstname` and `resident.lastname` both return collections. You could also try:\n\nbut this is also flawed—it returns true if there are two residents, one of whom is John Doe and one of whom is Jane Smith. The only way to find the desired apartments is to do two passes: one through residents to find “Jane Doe”, and one through apartments to find the ones where our Jane Does reside.\n\nSubquery expressions provide a way to encapsulate this type of qualification into a single query.\n\nThe string format for a subquery expression is:\n\nwhere `expression` is a predicate expression that evaluates to a collection, `variableExpression` is an expression which will be used to contain each individual element of `collection`, and `predicate` is the predicate used to determine whether the element belongs in the result collection.\n\nUsing subqueries, the apartment query could be reformulated as\n\nor",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Foundation\/NSExpression\/init(forSubquery:usingIteratorVariable:predicate:)\ncrawled: 2025-12-05T00:28:35Z\n---\n\n# init(forSubquery:usingIteratorVariable:predicate:)\n\n**Initializer**\n\nCreates an expression that filters a collection by storing elements in the collection in a specified variable and keeping the elements that the qualifier returns as true.\n\n## Declaration\n\n```swift\ninit(forSubquery expression: NSExpression, usingIteratorVariable variable: String, predicate: NSPredicate)\n```\n\n## Parameters\n\n- **expression**: A predicate expression that evaluates to a collection.\n- **variable**: Used as a local variable, and will shadow any instances of variable in the bindings dictionary. The variable is removed or the old value replaced once evaluation completes.\n- **predicate**: The predicate used to determine whether the element belongs in the result collection.\n\n## Return Value\n\nAn expression that filters a collection by storing elements in the collection in the variable variable and keeping the elements for which qualifier returns true\n\n## Discussion\n\nThis method creates a sub-expression, evaluation of which returns a subset of a collection of objects. It allows you to create sophisticated queries across relationships, such as a search for multiple correlated values on the destination object of a relationship.\n\nFor example, suppose you have an Apartment entity that has a to-many relationship to a Resident entity, and that you want to create a query for all apartments inhabited by a resident whose first name is “Jane” and whose last name is “Doe”. Using only API available for OS X v 10.4, you could try the predicate:\n\n```objc\nresident.firstname == \"Jane\" && resident.lastname == \"Doe\"\n```\n\nbut this will always return false since `resident.firstname` and `resident.lastname` both return collections. You could also try:\n\n```objc\nresident.firstname CONTAINS \"Jane\" && resident.lastname CONTAINS \"Doe\"\n```\n\nbut this is also flawed—it returns true if there are two residents, one of whom is John Doe and one of whom is Jane Smith. The only way to find the desired apartments is to do two passes: one through residents to find “Jane Doe”, and one through apartments to find the ones where our Jane Does reside.\n\nSubquery expressions provide a way to encapsulate this type of qualification into a single query.\n\nThe string format for a subquery expression is:\n\n```objc\nSUBQUERY(collection_expression, variable_expression, predicate);\n```\n\nwhere `expression` is a predicate expression that evaluates to a collection, `variableExpression` is an expression which will be used to contain each individual element of `collection`, and `predicate` is the predicate used to determine whether the element belongs in the result collection.\n\nUsing subqueries, the apartment query could be reformulated as\n\n```objc\n(SUBQUERY(residents, $x, $x.firstname == \"Jane\" && $x.lastname == \"Doe\").@count != 0)\n```\n\nor\n\n```objc\n(SUBQUERY(residents, $x, $x.firstname == \"Jane\" && $x.lastname == \"Doe\")[size] != 0)\n```\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "init(forSubquery:usingIteratorVariable:predicate:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/NSExpression\/init(forSubquery:usingIteratorVariable:predicate:)"
}