{
  "abstract" : "Cleans up font, paragraph style, and attachment attributes within the given range.",
  "codeExamples" : [

  ],
  "contentHash" : "bd7bbbd9997a2860fff7b87b9fb66bd089540d631785c44db66d5219feb212f7",
  "crawledAt" : "2025-12-04T02:05:24Z",
  "declaration" : {
    "code" : "func fixAttributes(in range: NSRange)",
    "language" : "swift"
  },
  "id" : "B94616C6-CB70-4430-904E-4EEFABB1C60E",
  "kind" : "method",
  "language" : "swift",
  "module" : "Foundation",
  "overview" : "## Discussion\n\nRemoves attachment attributes assigned to characters other than [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextAttachment\/character], assigns default fonts to characters with illegal fonts for their scripts and otherwise corrects font attribute assignments, and assigns the first paragraph style attribute value in each paragraph to all characters of the paragraph.\n\nThis method extends the range as needed to cover the last paragraph partially contained.\n\nRaises an [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSExceptionName\/rangeException] if any part of aRange lies beyond the end of the receiver’s characters.\n\n`NSTextStorage` subclasses that return [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] from the [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextStorage\/fixesAttributesLazily] method should avoid directly calling [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSMutableAttributedString\/fixAttributes(in:)] or else bracket such calls with [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSMutableAttributedString\/beginEditing()] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSMutableAttributedString\/endEditing()] messages.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Foundation\/NSMutableAttributedString\/fixAttributes(in:)\ncrawled: 2025-12-04T02:05:24Z\n---\n\n# fixAttributes(in:)\n\n**Instance Method**\n\nCleans up font, paragraph style, and attachment attributes within the given range.\n\n## Declaration\n\n```swift\nfunc fixAttributes(in range: NSRange)\n```\n\n## Parameters\n\n- **range**: The character range within which to fix attributes. Raises an [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSExceptionName\/rangeException] if any part of `range` lies beyond the end of the receiver’s characters.\n\n## Discussion\n\nRemoves attachment attributes assigned to characters other than [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextAttachment\/character], assigns default fonts to characters with illegal fonts for their scripts and otherwise corrects font attribute assignments, and assigns the first paragraph style attribute value in each paragraph to all characters of the paragraph.\n\nThis method extends the range as needed to cover the last paragraph partially contained.\n\nRaises an [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSExceptionName\/rangeException] if any part of aRange lies beyond the end of the receiver’s characters.\n\n`NSTextStorage` subclasses that return [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] from the [doc:\/\/com.apple.documentation\/documentation\/AppKit\/NSTextStorage\/fixesAttributesLazily] method should avoid directly calling [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSMutableAttributedString\/fixAttributes(in:)] or else bracket such calls with [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSMutableAttributedString\/beginEditing()] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSMutableAttributedString\/endEditing()] messages.\n\n## Fixing Attributes After Changes\n\n- **fixAttachmentAttribute(in:)**: Cleans up attachment attributes in the specified range and removes all attachment attributes assigned to characters except the designated attachment character.\n- **fixFontAttribute(in:)**: Fixes the font attribute in the specified range and assigns default fonts where appropriate.\n- **fixParagraphStyleAttribute(in:)**: Fixes the paragraph style attributes in the specified range and assigns a paragraph style to all characters in the paragraph.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Cleans up attachment attributes in the specified range and removes all attachment attributes assigned to characters except the designated attachment character.",
          "name" : "fixAttachmentAttribute(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/NSMutableAttributedString\/fixAttachmentAttribute(in:)"
        },
        {
          "description" : "Fixes the font attribute in the specified range and assigns default fonts where appropriate.",
          "name" : "fixFontAttribute(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/NSMutableAttributedString\/fixFontAttribute(in:)"
        },
        {
          "description" : "Fixes the paragraph style attributes in the specified range and assigns a paragraph style to all characters in the paragraph.",
          "name" : "fixParagraphStyleAttribute(in:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/NSMutableAttributedString\/fixParagraphStyleAttribute(in:)"
        }
      ],
      "title" : "Fixing Attributes After Changes"
    }
  ],
  "source" : "appleJSON",
  "title" : "fixAttributes(in:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/NSMutableAttributedString\/fixAttributes(in:)"
}