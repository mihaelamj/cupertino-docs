{
  "abstract" : "Control how URL requests make use of previously cached data.",
  "codeExamples" : [
    {
      "code" : "func urlSession(_ session: URLSession, dataTask: URLSessionDataTask,\n                willCacheResponse proposedResponse: CachedURLResponse,\n                completionHandler: @escaping (CachedURLResponse?) -> Void) {\n    if proposedResponse.response.url?.scheme == \"https\" {\n        let updatedResponse = CachedURLResponse(response: proposedResponse.response,\n                                                data: proposedResponse.data,\n                                                userInfo: proposedResponse.userInfo,\n                                                storagePolicy: .allowedInMemoryOnly)\n        completionHandler(updatedResponse)\n    } else {\n        completionHandler(proposedResponse)\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "24c921e05a6cee1737e20811eea6ccff3935965990d0d3e47e7a0044d1e905ae",
  "crawledAt" : "2025-12-04T17:55:54Z",
  "id" : "CF0D4AB6-E06E-43FC-B615-B4DD5E27A1D5",
  "kind" : "article",
  "language" : "swift",
  "module" : "Foundation",
  "overview" : "## Overview\n\nThe URL Loading System caches responses both in memory and on disk, improving performance and reducing network traffic.\n\nThe [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache] class is used for caching responses from network resources. Your app can directly access the shared cache instance by using the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/shared] property of `URLCache`. Or, you can create your own caches for different purposes, setting distinct caches on your [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration] objects.\n\n### Set a cache policy for URL requests\n\nEach [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLRequest] instance contains a [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLRequest\/CachePolicy-swift.typealias] object to indicate if and how caching should be performed.  You can change this policy to control caching for the request.\n\nFor convenience, [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration] has a property called [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration\/requestCachePolicy]; all requests created from sessions that use this configuration inherit their cache policy from the configuration.\n\nThe behaviors of the various policies are described in doc:accessing-cached-data#Table-1. This table shows the policies’ respective preferences for loading from cache or from the originating source, like a server or the local file system. Currently, only HTTP and HTTPS responses are cached. For FTP and file URLs, the only effect of a policy is to determine whether the request is allowed to access the originating source.\n\nFor an explanation of how `useProtocolCachePolicy` is implemented for HTTP and HTTPS, see [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSURLRequest\/CachePolicy-swift.enum].  `useProtocolCachePolicy` is the default value for a `URLRequest` object.\n\n### Access the cache directly\n\nYou can get or set the cache object used by a `URLSession` object by using the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration\/urlCache] property of the session’s [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSession\/configuration] object.\n\nTo look for the cached response to a given request, call [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/cachedResponse(for:)] on the cache. If cached data exists for the request, this call returns a [doc:\/\/com.apple.foundation\/documentation\/Foundation\/CachedURLResponse] object; otherwise, it returns `nil`.\n\nYou can inspect resources used by the cache. The properties [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/currentDiskUsage] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/diskCapacity] represent the file system resources used by the cache, and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/currentMemoryUsage] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/memoryCapacity] represent memory use.\n\nYou can remove cached data for individual items with [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/removeCachedResponse(for:)-1dh89]. You can also clear out many cached items simultaneously with [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/removeCachedResponses(since:)], which removes cached items past a given date, or [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/removeAllCachedResponses()], which wipes the entire cache.\n\n### Manage caching programmatically\n\nYou can write to the cache programmatically, with the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/storeCachedResponse(_:for:)-7p7bl] method, passing in a new `CachedURLResponse` object and a `URLRequest` object.\n\nTypically, you manage the caching of a response while it’s being handled by a `URLSessionTask` object. To manage caching on a per-response basis, implement the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionDataDelegate\/urlSession(_:dataTask:willCacheResponse:completionHandler:)] method of the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionDataDelegate] protocol. Note that this delegate method is called only for uploads and data tasks, and is not called for sessions with a background or ephemeral configuration.\n\nThe delegate receives two parameters: a `CachedURLResponse` object and a completion handler. Your delegate *must* call this completion handler directly, passing in one of the following:\n\nThe following example shows an implementation of `urlSession(_:dataTask:willCacheResponse:completionHandler:)`, which intercepts responses to HTTPS requests and allows the responses to be stored in the in-memory cache only.\n\nHandling the urlSession(_:dataTask:willCacheResponse:completionHandler:) callback",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Foundation\/accessing-cached-data\ncrawled: 2025-12-04T17:55:54Z\n---\n\n# Accessing cached data\n\n**Article**\n\nControl how URL requests make use of previously cached data.\n\n## Overview\n\nThe URL Loading System caches responses both in memory and on disk, improving performance and reducing network traffic.\n\nThe [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache] class is used for caching responses from network resources. Your app can directly access the shared cache instance by using the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/shared] property of `URLCache`. Or, you can create your own caches for different purposes, setting distinct caches on your [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration] objects.\n\n### Set a cache policy for URL requests\n\nEach [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLRequest] instance contains a [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLRequest\/CachePolicy-swift.typealias] object to indicate if and how caching should be performed.  You can change this policy to control caching for the request.\n\nFor convenience, [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration] has a property called [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration\/requestCachePolicy]; all requests created from sessions that use this configuration inherit their cache policy from the configuration.\n\nThe behaviors of the various policies are described in doc:accessing-cached-data#Table-1. This table shows the policies’ respective preferences for loading from cache or from the originating source, like a server or the local file system. Currently, only HTTP and HTTPS responses are cached. For FTP and file URLs, the only effect of a policy is to determine whether the request is allowed to access the originating source.\n\n\n\nFor an explanation of how `useProtocolCachePolicy` is implemented for HTTP and HTTPS, see [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSURLRequest\/CachePolicy-swift.enum].  `useProtocolCachePolicy` is the default value for a `URLRequest` object.\n\n\n\n### Access the cache directly\n\nYou can get or set the cache object used by a `URLSession` object by using the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionConfiguration\/urlCache] property of the session’s [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSession\/configuration] object.\n\nTo look for the cached response to a given request, call [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/cachedResponse(for:)] on the cache. If cached data exists for the request, this call returns a [doc:\/\/com.apple.foundation\/documentation\/Foundation\/CachedURLResponse] object; otherwise, it returns `nil`.\n\nYou can inspect resources used by the cache. The properties [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/currentDiskUsage] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/diskCapacity] represent the file system resources used by the cache, and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/currentMemoryUsage] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/memoryCapacity] represent memory use.\n\nYou can remove cached data for individual items with [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/removeCachedResponse(for:)-1dh89]. You can also clear out many cached items simultaneously with [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/removeCachedResponses(since:)], which removes cached items past a given date, or [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/removeAllCachedResponses()], which wipes the entire cache.\n\n### Manage caching programmatically\n\nYou can write to the cache programmatically, with the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLCache\/storeCachedResponse(_:for:)-7p7bl] method, passing in a new `CachedURLResponse` object and a `URLRequest` object.\n\nTypically, you manage the caching of a response while it’s being handled by a `URLSessionTask` object. To manage caching on a per-response basis, implement the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionDataDelegate\/urlSession(_:dataTask:willCacheResponse:completionHandler:)] method of the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLSessionDataDelegate] protocol. Note that this delegate method is called only for uploads and data tasks, and is not called for sessions with a background or ephemeral configuration.\n\nThe delegate receives two parameters: a `CachedURLResponse` object and a completion handler. Your delegate *must* call this completion handler directly, passing in one of the following:\n\n- The provided `CachedURLResponse` object, to cache the proposed response as-is\n- `nil`, to prevent caching\n- A newly created `CachedURLResponse` object, typically based on the provided object, but with a modified [doc:\/\/com.apple.foundation\/documentation\/Foundation\/CachedURLResponse\/storagePolicy] and [doc:\/\/com.apple.foundation\/documentation\/Foundation\/CachedURLResponse\/userInfo] dictionary, as you see fit\n\nThe following example shows an implementation of `urlSession(_:dataTask:willCacheResponse:completionHandler:)`, which intercepts responses to HTTPS requests and allows the responses to be stored in the in-memory cache only.\n\nHandling the urlSession(_:dataTask:willCacheResponse:completionHandler:) callback\n\n```swift\nfunc urlSession(_ session: URLSession, dataTask: URLSessionDataTask,\n                willCacheResponse proposedResponse: CachedURLResponse,\n                completionHandler: @escaping (CachedURLResponse?) -> Void) {\n    if proposedResponse.response.url?.scheme == \"https\" {\n        let updatedResponse = CachedURLResponse(response: proposedResponse.response,\n                                                data: proposedResponse.data,\n                                                userInfo: proposedResponse.userInfo,\n                                                storagePolicy: .allowedInMemoryOnly)\n        completionHandler(updatedResponse)\n    } else {\n        completionHandler(proposedResponse)\n    }\n}\n```\n\n## Cache behavior\n\n- **CachedURLResponse**: A cached response to a URL request.\n- **URLCache**: An object that maps URL requests to cached response objects.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A cached response to a URL request.",
          "name" : "CachedURLResponse",
          "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/CachedURLResponse"
        },
        {
          "description" : "An object that maps URL requests to cached response objects.",
          "name" : "URLCache",
          "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/URLCache"
        }
      ],
      "title" : "Cache behavior"
    }
  ],
  "source" : "appleJSON",
  "title" : "Accessing cached data",
  "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/accessing-cached-data"
}