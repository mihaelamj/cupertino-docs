{
  "abstract" : "Asks the delegate whether the data (or upload) task should store the response in the cache.",
  "codeExamples" : [

  ],
  "contentHash" : "e64cbab4abef19d1628f9505d4659a02b5842d9ec9f900b82d28cf350c319307",
  "crawledAt" : "2025-12-06T04:33:44Z",
  "declaration" : {
    "code" : "optional func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, willCacheResponse proposedResponse: CachedURLResponse, completionHandler: @escaping (CachedURLResponse?) -> Void)",
    "language" : "swift"
  },
  "id" : "7AC2CB1F-99EE-4037-B1E2-9802D623B43B",
  "kind" : "method",
  "language" : "swift",
  "module" : "Foundation",
  "overview" : "## Discussion\n\nThe session calls this delegate method after the task finishes receiving all of the expected data. If you don’t implement this method, the default behavior is to use the caching policy specified in the session’s configuration object. The primary purpose of this method is to prevent caching of specific URLs or to modify the `userInfo` dictionary associated with the URL response.\n\nThis method is called only if the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLProtocol] handling the request decides to cache the response. As a rule, responses are cached only when all of the following are true:",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Foundation\/URLSessionDataDelegate\/urlSession(_:dataTask:willCacheResponse:completionHandler:)\ncrawled: 2025-12-06T04:33:44Z\n---\n\n# urlSession(_:dataTask:willCacheResponse:completionHandler:)\n\n**Instance Method**\n\nAsks the delegate whether the data (or upload) task should store the response in the cache.\n\n## Declaration\n\n```swift\noptional func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, willCacheResponse proposedResponse: CachedURLResponse, completionHandler: @escaping (CachedURLResponse?) -> Void)\n```\n\n```swift\noptional func urlSession(_ session: URLSession, dataTask: URLSessionDataTask, willCacheResponse proposedResponse: CachedURLResponse) async -> CachedURLResponse?\n```\n\n## Parameters\n\n- **session**: The session containing the data (or upload) task.\n- **dataTask**: The data (or upload) task.\n- **proposedResponse**: The default caching behavior. This behavior is determined based on the current caching policy and the values of certain received headers, such as the `Pragma` and `Cache-Control` headers.\n- **completionHandler**: A block that your handler must call, providing either the original proposed response, a modified version of that response, or `NULL` to prevent caching the response. If your delegate implements this method, it *must* call this completion handler; otherwise, your app leaks memory.\n\n## Discussion\n\nThe session calls this delegate method after the task finishes receiving all of the expected data. If you don’t implement this method, the default behavior is to use the caching policy specified in the session’s configuration object. The primary purpose of this method is to prevent caching of specific URLs or to modify the `userInfo` dictionary associated with the URL response.\n\nThis method is called only if the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLProtocol] handling the request decides to cache the response. As a rule, responses are cached only when all of the following are true:\n\n- The request is for an HTTP or HTTPS URL (or your own custom networking protocol that supports caching).\n- The request was successful (with a status code in the `200–299` range).\n- The provided response came from the server, rather than out of the cache.\n- The session configuration’s cache policy allows caching.\n- The provided [doc:\/\/com.apple.foundation\/documentation\/Foundation\/URLRequest] object’s cache policy (if applicable) allows caching.\n- The cache-related headers in the server’s response (if present) allow caching.\n- The response size is small enough to reasonably fit within the cache. (For example, if you provide a disk cache, the response must be no larger than about 5% of the disk cache size.)\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "urlSession(_:dataTask:willCacheResponse:completionHandler:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/URLSessionDataDelegate\/urlSession(_:dataTask:willCacheResponse:completionHandler:)"
}