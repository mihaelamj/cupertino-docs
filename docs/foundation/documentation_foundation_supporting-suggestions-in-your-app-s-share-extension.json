{
  "abstract" : "Make your messaging app available for share sheet suggestions and use SiriKit intents to populate your app’s share extension.",
  "codeExamples" : [
    {
      "code" : "\/\/ Create an INSendMessageIntent to donate an intent for a conversation with Juan Chavez.\nlet groupName = INSpeakableString(spokenPhrase: \"Juan Chavez\")\nlet sendMessageIntent = INSendMessageIntent(recipients: nil,\n                                            content: nil,\n                                            speakableGroupName: groupName,\n                                            conversationIdentifier: \"sampleConversationIdentifier\",\n                                            serviceName: nil,\n                                            sender: nil)\n\n\/\/ Add the person's avatar to the intent.\nlet image = INImage(named: \"Juan Chavez\")\nsendMessageIntent.setImage(image, forParameterNamed: \\.speakableGroupName)\n\n\/\/ Donate the intent.\nlet interaction = INInteraction(intent: sendMessageIntent, response: nil)\ninteraction.donate(completion: { error in\n    if error != nil {\n        \/\/ Add error handling here.\n    } else {\n        \/\/ Do something, for example, send the content to a contact.\n    }\n})",
      "language" : "swift"
    },
    {
      "code" : "import Intents\nimport Social\nimport UIKit\n\nclass ShareViewController: SLComposeServiceViewController {\n\n    var recipient: Recipient = Recipient(withName: \"Placeholder\")\n    \n    override func viewDidLoad() {\n        super.viewDidLoad()\n        \n        \/\/ Populate the recipient property with the metadata in case the person taps a suggestion from the share sheet.\n        let intent = self.extensionContext?.intent as? INSendMessageIntent\n        if intent != nil {\n            let conversationIdentifier = intent!.conversationIdentifier\n            self.recipient = recipient(identifier: conversationIdentifier!)\n        }\n    }\n\n    func recipient(identifier: String) -> Recipient {\n        \/\/ Create a recipient object, for example, by loading it from a data base.\n        return Recipient(withName: identifier)\n    }\n\n    override func isContentValid() -> Bool {\n        \/\/ Validate contentText and NSExtensionContext attachments here.\n        return true\n    }\n\n    override func didSelectPost() {\n        \/\/ This is called after the person selects Post. Upload contentText and NSExtensionContext attachments.\n        \n        \/\/ Inform the host that the selection is done, so it unblocks its UI.\n        \/\/ Note: Alternatively, you could call super's -didSelectPost, which similarly completes the extension context.\n        self.extensionContext!.completeRequest(returningItems: [], completionHandler: nil)\n    }\n\n    override func configurationItems() -> [Any]! {\n        \/\/ To add configuration options via table cells at the bottom of the sheet, return an array of SLComposeSheetConfigurationItem here.\n        \n        \/\/ Use the Recipient object to populate the share sheet.\n        let item = SLComposeSheetConfigurationItem()\n        item?.title = NSLocalizedString(\"To:\", comment: \"The To: label when sharing content.\")\n        item?.value = self.recipient.name\n        item?.tapHandler = {\n            self.validateContent()\n            item!.value = self.recipient.name\n        }\n        \n        return [item!]\n    }\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "9618b26310e0e6bd677ec4e3ee78dffcd9893f4ca4c028739684e5ac13f0b77a",
  "crawledAt" : "2025-12-04T16:24:02Z",
  "id" : "9AA427A4-AE91-479E-820F-DD85D1FC3E93",
  "kind" : "article",
  "language" : "swift",
  "module" : "Foundation",
  "overview" : "## Overview\n\nUsing the iOS share sheet, people can launch your messaging app instantly from a list of suggestions when sharing content like a link, image, video, or file. The share sheet suggests conversations with people in apps that a person interacts with frequently, and updates its suggestions over time based on a person’s favorite apps and conversations. When a person shares an image in iOS 16 or later, the share sheet prioritizes conversations with people it identifies in the image.\n\n\n\nTo allow iOS to include conversations from your messaging app in the list of suggestions:\n\nAs a person selects an app from the list of suggestions, the app’s sharing interface, implemented as a share extension, accesses additional metadata. iOS provides the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] for you to prepopulate the interface of your app’s share extension. For example, you can access the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/conversationIdentifier] property and preselect a conversation to share content so a person doesn’t need to search for a contact in a list or type a friend’s name.\n\nA screenshot of an iPhone with the Safari browser displaying the apple.com homepage. The person tapped the Share button and selected an app from the list of suggestions. The platforms default sharing interface, based on an SLComposeViewController, is visible. Based on the available metadata, the extension has prepopulated the interface with a recipient (Juan Chavez).\n\n\n\n### Add a share extension to your app\n\nTo add a share extension to your app, open your app’s project in Xcode and select File > New > Target from the menu bar. Xcode presents a sheet that contains templates for different kinds of targets. Select the share extension template from the iOS pane and follow the steps in Xcode’s interface to add one to your app. For more information, see [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/ExtensibilityPG\/Share.html#\/\/apple_ref\/doc\/uid\/TP40014214-CH12-SW2] in the App Extension Programming Guide.\n\n### Support the send message intent\n\nOpen the Share extension’s `Info.plist`, and expand the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension] and [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes] keys. Add a new entry with the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/IntentsSupported] key and select `Array` for its value type. Add the string `INSendMessageIntent` as a new value to the array to declare support for the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] intent type.\n\n\n\nTo make debugging easier, set the value of [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes\/NSExtensionActivationRule] to `TRUEPREDICATE` when you first add a share extension using Xcode’s template. Replace it with valid activation rules as described in [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/ExtensibilityPG\/ExtensionScenarios.html#\/\/apple_ref\/doc\/uid\/TP40014214-CH21-SW8] before submitting your app for review.\n\n### Donate a send message intent\n\nDonate an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] only when a person sends or receives a message in your app and its share extension. Donate a [doc:\/\/com.apple.documentation\/documentation\/Contacts\/CNContact] along with [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] for [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/sender] and [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/recipients] by adding values to the contact [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/contactIdentifier] field when initializing an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson].\n\nAs you initialize the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] object, provide metadata that’s available later when a person choses your app’s share extension from the list of suggestions. The following code snippet donates an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] with a [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/speakableGroupName], a [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/conversationIdentifier], and an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage].\n\nWhen iOS includes a conversation within your app as a suggestion in the share sheet, it displays your app’s icon along with the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage] you associated with your [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent]. If there’s no [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage] set on the intent, iOS uses the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/image] property from the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson] object for each recipient. If the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson] object’s [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/image] is `nil`, iOS looks up the corresponding contact in the Contacts app using a person’s [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/contactIdentifier]. The share sheet then uses the contact’s image.\n\nWhen a person shares an image in iOS 16 or later with the suggestions from Apple setting enabled, the share sheet prioritizes displaying conversations with people the system identifies in the image in the suggestions list. Include an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage] with the sharing intent you donate, so the system can attempt to identify people in the image. Provide an image that’s at least 360 pixels tall or wide to improve matching.\n\n### Populate your share extension’s interface with metadata\n\nWhen a person selects your app from the list of suggestions, you can access the metadata that you created when your app donated the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent]. Use it to populate your share extension’s interface.\n\nThe following code listing shows a template implementation for an [doc:\/\/com.apple.documentation\/documentation\/Social\/SLComposeServiceViewController] subclass. It accesses the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSExtensionContext\/intent] property, makes sure it’s an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent], and uses the intent’s [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/conversationIdentifier] to create a new `Recipient` object. It then uses the `Recipient` object to populate the share extension’s interface in the [doc:\/\/com.apple.documentation\/documentation\/Social\/SLComposeServiceViewController\/configurationItems()] method.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/Foundation\/supporting-suggestions-in-your-app-s-share-extension\ncrawled: 2025-12-04T16:24:02Z\n---\n\n# Supporting suggestions in your app’s share extension\n\n**Article**\n\nMake your messaging app available for share sheet suggestions and use SiriKit intents to populate your app’s share extension.\n\n## Overview\n\nUsing the iOS share sheet, people can launch your messaging app instantly from a list of suggestions when sharing content like a link, image, video, or file. The share sheet suggests conversations with people in apps that a person interacts with frequently, and updates its suggestions over time based on a person’s favorite apps and conversations. When a person shares an image in iOS 16 or later, the share sheet prioritizes conversations with people it identifies in the image.\n\n\n\nTo allow iOS to include conversations from your messaging app in the list of suggestions:\n\n- Add a share extension to your app as described in [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/ExtensibilityPG\/Share.html#\/\/apple_ref\/doc\/uid\/TP40014214-CH12-SW2].\n- Declare support for the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] intent type.\n- Donate an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] in your messaging app and its share extension.\n\nAs a person selects an app from the list of suggestions, the app’s sharing interface, implemented as a share extension, accesses additional metadata. iOS provides the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] for you to prepopulate the interface of your app’s share extension. For example, you can access the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/conversationIdentifier] property and preselect a conversation to share content so a person doesn’t need to search for a contact in a list or type a friend’s name.\n\nA screenshot of an iPhone with the Safari browser displaying the apple.com homepage. The person tapped the Share button and selected an app from the list of suggestions. The platforms default sharing interface, based on an SLComposeViewController, is visible. Based on the available metadata, the extension has prepopulated the interface with a recipient (Juan Chavez).\n\n\n\n### Add a share extension to your app\n\nTo add a share extension to your app, open your app’s project in Xcode and select File > New > Target from the menu bar. Xcode presents a sheet that contains templates for different kinds of targets. Select the share extension template from the iOS pane and follow the steps in Xcode’s interface to add one to your app. For more information, see [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/ExtensibilityPG\/Share.html#\/\/apple_ref\/doc\/uid\/TP40014214-CH12-SW2] in the App Extension Programming Guide.\n\n### Support the send message intent\n\nOpen the Share extension’s `Info.plist`, and expand the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension] and [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes] keys. Add a new entry with the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/IntentsSupported] key and select `Array` for its value type. Add the string `INSendMessageIntent` as a new value to the array to declare support for the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] intent type.\n\n\n\nTo make debugging easier, set the value of [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes\/NSExtensionActivationRule] to `TRUEPREDICATE` when you first add a share extension using Xcode’s template. Replace it with valid activation rules as described in [https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Conceptual\/ExtensibilityPG\/ExtensionScenarios.html#\/\/apple_ref\/doc\/uid\/TP40014214-CH21-SW8] before submitting your app for review.\n\n### Donate a send message intent\n\nDonate an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] only when a person sends or receives a message in your app and its share extension. Donate a [doc:\/\/com.apple.documentation\/documentation\/Contacts\/CNContact] along with [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] for [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/sender] and [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/recipients] by adding values to the contact [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/contactIdentifier] field when initializing an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson].\n\nAs you initialize the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] object, provide metadata that’s available later when a person choses your app’s share extension from the list of suggestions. The following code snippet donates an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent] with a [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/speakableGroupName], a [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/conversationIdentifier], and an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage].\n\n```swift\n\/\/ Create an INSendMessageIntent to donate an intent for a conversation with Juan Chavez.\nlet groupName = INSpeakableString(spokenPhrase: \"Juan Chavez\")\nlet sendMessageIntent = INSendMessageIntent(recipients: nil,\n                                            content: nil,\n                                            speakableGroupName: groupName,\n                                            conversationIdentifier: \"sampleConversationIdentifier\",\n                                            serviceName: nil,\n                                            sender: nil)\n\n\/\/ Add the person's avatar to the intent.\nlet image = INImage(named: \"Juan Chavez\")\nsendMessageIntent.setImage(image, forParameterNamed: \\.speakableGroupName)\n\n\/\/ Donate the intent.\nlet interaction = INInteraction(intent: sendMessageIntent, response: nil)\ninteraction.donate(completion: { error in\n    if error != nil {\n        \/\/ Add error handling here.\n    } else {\n        \/\/ Do something, for example, send the content to a contact.\n    }\n})\n```\n\nWhen iOS includes a conversation within your app as a suggestion in the share sheet, it displays your app’s icon along with the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage] you associated with your [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent]. If there’s no [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage] set on the intent, iOS uses the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/image] property from the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson] object for each recipient. If the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson] object’s [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/image] is `nil`, iOS looks up the corresponding contact in the Contacts app using a person’s [doc:\/\/com.apple.documentation\/documentation\/Intents\/INPerson\/contactIdentifier]. The share sheet then uses the contact’s image.\n\nWhen a person shares an image in iOS 16 or later with the suggestions from Apple setting enabled, the share sheet prioritizes displaying conversations with people the system identifies in the image in the suggestions list. Include an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INImage] with the sharing intent you donate, so the system can attempt to identify people in the image. Provide an image that’s at least 360 pixels tall or wide to improve matching.\n\n\n\n### Populate your share extension’s interface with metadata\n\nWhen a person selects your app from the list of suggestions, you can access the metadata that you created when your app donated the [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent]. Use it to populate your share extension’s interface.\n\nThe following code listing shows a template implementation for an [doc:\/\/com.apple.documentation\/documentation\/Social\/SLComposeServiceViewController] subclass. It accesses the [doc:\/\/com.apple.foundation\/documentation\/Foundation\/NSExtensionContext\/intent] property, makes sure it’s an [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent], and uses the intent’s [doc:\/\/com.apple.documentation\/documentation\/Intents\/INSendMessageIntent\/conversationIdentifier] to create a new `Recipient` object. It then uses the `Recipient` object to populate the share extension’s interface in the [doc:\/\/com.apple.documentation\/documentation\/Social\/SLComposeServiceViewController\/configurationItems()] method.\n\n```swift\nimport Intents\nimport Social\nimport UIKit\n\nclass ShareViewController: SLComposeServiceViewController {\n\n    var recipient: Recipient = Recipient(withName: \"Placeholder\")\n    \n    override func viewDidLoad() {\n        super.viewDidLoad()\n        \n        \/\/ Populate the recipient property with the metadata in case the person taps a suggestion from the share sheet.\n        let intent = self.extensionContext?.intent as? INSendMessageIntent\n        if intent != nil {\n            let conversationIdentifier = intent!.conversationIdentifier\n            self.recipient = recipient(identifier: conversationIdentifier!)\n        }\n    }\n\n    func recipient(identifier: String) -> Recipient {\n        \/\/ Create a recipient object, for example, by loading it from a data base.\n        return Recipient(withName: identifier)\n    }\n\n    override func isContentValid() -> Bool {\n        \/\/ Validate contentText and NSExtensionContext attachments here.\n        return true\n    }\n\n    override func didSelectPost() {\n        \/\/ This is called after the person selects Post. Upload contentText and NSExtensionContext attachments.\n        \n        \/\/ Inform the host that the selection is done, so it unblocks its UI.\n        \/\/ Note: Alternatively, you could call super's -didSelectPost, which similarly completes the extension context.\n        self.extensionContext!.completeRequest(returningItems: [], completionHandler: nil)\n    }\n\n    override func configurationItems() -> [Any]! {\n        \/\/ To add configuration options via table cells at the bottom of the sheet, return an array of SLComposeSheetConfigurationItem here.\n        \n        \/\/ Use the Recipient object to populate the share sheet.\n        let item = SLComposeSheetConfigurationItem()\n        item?.title = NSLocalizedString(\"To:\", comment: \"The To: label when sharing content.\")\n        item?.value = self.recipient.name\n        item?.tapHandler = {\n            self.validateContent()\n            item!.value = self.recipient.name\n        }\n        \n        return [item!]\n    }\n}\n```\n\n",
  "sections" : [

  ],
  "source" : "appleJSON",
  "title" : "Supporting suggestions in your app’s share extension",
  "url" : "https:\/\/developer.apple.com\/documentation\/Foundation\/supporting-suggestions-in-your-app-s-share-extension"
}