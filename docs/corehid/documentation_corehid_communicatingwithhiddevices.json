{
  "abstract" : "Interact with and obtain data from devices such as keyboards and mice.",
  "codeExamples" : [
    {
      "code" : "let matchingCriteria = HIDDeviceManager.DeviceMatchingCriteria(primaryUsage: .genericDesktop(.keyboard), product: \"Magic Keyboard with Numeric Keypad\")",
      "language" : "swift"
    },
    {
      "code" : "let manager = HIDDeviceManager()\n\n\/\/ The criteria combines multiple sets in a single array.\nfor try await notification in await manager.monitorNotifications(matchingCriteria: [matchingCriteria]) {\n    switch notification {\n        case .deviceMatched(let deviceReference):\n            print(\"A device was found.\")\n\n        case .deviceRemoved(let deviceReference):\n            print(\"A device was removed.\")\n\n        default:\n            continue\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "enum ExampleError : Error {\n    case deviceCreation\n    case wrongUsage\n    case wrongTransport\n    case wrongProduct\n    case noElement\n    case noValue\n    case valuesNotEqual\n}\n\nguard let client = HIDDeviceClient(deviceReference: deviceReference) else {\n    throw ExampleError.deviceCreation\n}\n\nlet usage = await client.primaryUsage\nguard usage == .genericDesktop(.keyboard) else {\n    print(\"Wrong usage: \\(usage)\")\n    throw ExampleError.wrongUsage\n}\n\nlet transport = await client.transport\nguard transport == .bluetooth else {\n    print(\"Wrong transport: \\(String(describing: transport))\")\n    throw ExampleError.wrongTransport\n}\n\nlet product = await client.product\nguard product == \"Magic Keyboard with Numeric Keypad\" else {\n    print(\"Wrong product: \\(String(describing: product))\")\n    throw ExampleError.wrongProduct\n}",
      "language" : "swift"
    },
    {
      "code" : "let report = try await client.dispatchGetReportRequest(type: .input, id: HIDReportID(rawValue: 1))\nprint(\"Get report data: [\\(report.map { String(format: \"%02x\", $0) }.joined(separator: \" \"))]\")",
      "language" : "swift"
    },
    {
      "code" : "for try await notification in await client.monitorNotifications(reportIDsToMonitor: [HIDReportID.allReports], elementsToMonitor: []) {\n    switch notification {\n\n    \/\/ Receive device input data.\n    case .inputReport(let reportID, let reportData, let timestamp):\n        print(\"Received input report ID:\\(String(describing: reportID)) timestamp:\\(timestamp) data:[\\(reportData.map { String(format: \"%02x\", $0) }.joined(separator: \" \"))]\")\n\n    \/\/ Receive a notification if another client seizes this device.\n    case .deviceSeized:\n        print(\"\\(client) seized\")\n\n    \/\/ Receive a notification if another client releases this device.\n    case .deviceUnseized:\n        print(\"\\(client) unseized\")\n\n    \/\/ Receive a notification if a person removes the client.\n    case .deviceRemoved:\n        print(\"\\(client) removed\")\n\n    default:\n        continue\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "let elements = await client.elements\nguard let leftShiftKey = elements.filter({ $0.usage == .keyboardOrKeypad(.keyboardLeftShift) }).first else {\n    throw ExampleError.noElement\n}",
      "language" : "swift"
    },
    {
      "code" : "for try await notification in await client.monitorNotifications(reportIDsToMonitor: [], elementsToMonitor: [leftShiftKey]) {\n    switch notification {\n    case .elementUpdates(let values):\n        let leftShiftVal = values[0]\n        print(\"Left shift state: \\(leftShiftVal.integerValue(asTypeTruncatingIfNeeded: UInt8.self))\")\n\n    default:\n        continue\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "guard let capsLockLED = elements.filter({ $0.usage == .led(.capsLock) }).first else {\n    throw ExampleError.noElement\n}\n\nlet turnOffVal = HIDElement.Value(element: capsLockLED, fromIntegerTruncatingIfNeeded: 0, timestamp: SuspendingClock.now)\nlet turnOnVal  = HIDElement.Value(element: capsLockLED, fromIntegerTruncatingIfNeeded: 1, timestamp: SuspendingClock.now)\n\nlet turnOffRequest     = HIDDeviceClient.ProvideElementUpdate(values:   [turnOffVal])\nlet stateRequestBefore = HIDDeviceClient.RequestElementUpdate(elements: [leftShiftKey])\nlet turnOnRequest      = HIDDeviceClient.ProvideElementUpdate(values:   [turnOnVal])\nlet stateRequestAfter  = HIDDeviceClient.RequestElementUpdate(elements: [leftShiftKey])\nlet requestResults     = await client.updateElements([turnOffRequest, stateRequestBefore, turnOnRequest, stateRequestAfter])\n\n\/\/ Ensure that the set operations succeed.\ntry requestResults[turnOffRequest]!.get()\ntry requestResults[turnOnRequest]!.get()\n\n\/\/ Read the initial state of the left Shift key.\nguard let leftShiftStateBefore = try requestResults[stateRequestBefore]?.get().first?.integerValue(asTypeTruncatingIfNeeded: UInt8.self) else {\n    throw ExampleError.noValue\n}\n\n\/\/ Read the final state of the left Shift key.\nguard let leftShiftStateAfter = try requestResults[stateRequestAfter]?.get().first?.integerValue(asTypeTruncatingIfNeeded: UInt8.self) else {\n    throw ExampleError.noValue\n}\n\n\/\/ Ensure the initial state didn't change as a result of the LED toggle.\nguard leftShiftStateBefore == leftShiftStateAfter else {\n    throw ExampleError.valuesNotEqual\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "630ebfaf96cec27d241a016aa66cc97a25171c97ea671a415eff4e33959099b7",
  "crawledAt" : "2025-12-07T14:56:19Z",
  "id" : "8F0D04A4-5A51-41EA-ADD5-B925A17631B0",
  "kind" : "article",
  "language" : "swift",
  "module" : "Core HID",
  "overview" : "## Overview\n\nTo communicate with a human interface device (HID), you must identify and match it using a set of matching critiera. When you match the device, you become its client and can query its properties and capabilities.\n\n### Locate the device of interest\n\nTo locate the device you’re interested in, specify a set of matching criteria using [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager\/DeviceMatchingCriteria]. The following code uses this method to discover the Magic Keyboard with Numeric Keypad `product`:\n\nCreate a [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager] and provide the criteria to [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager\/monitorNotifications(matchingCriteria:)]. Notifications arrive immediately for connected devices, and later when newly connected matching devices appear. `monitorNotifications` returns an asynchronous stream that you iterate over. The loop awaits and releases the current Task until a notification comes in.\n\nTo specify matching criteria using additional properties, see [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager\/DeviceMatchingCriteria\/init(primaryUsage:deviceUsages:vendorID:productID:transport:product:manufacturer:modelNumber:versionNumber:serialNumber:uniqueID:locationID:localizationCode:isBuiltIn:extraProperties:)].\n\n### Communicate with the device\n\nCreate a [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient] and pass in the device reference to start communication with the device. Verify that you’re communicating with the correct device by checking the usage with [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/primaryUsage], the transport with [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/transport], and the product name with [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/product].\n\nObtain the device’s input report using [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/dispatchGetReportRequest(type:id:timeout:)]. Specify [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDReportType\/input] for the type, and provide the appropriate [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDReportID]. This method initiates a get report request to the device over Bluetooth and returns the device’s response.\n\nMonitor the device for input reports or other notifications by calling [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/monitorNotifications(reportIDsToMonitor:elementsToMonitor:)]:\n\nRaw reports provide detailed information about data going to and from the device; however, this can generate more detail than you need. Instead, use [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement] to obtain specific information from a device.\n\nFor the keyboard in this example, the input report contains the report ID, status of the modifier keys, the currently pressed keys, vendor defined data and padding. To obtain just the state of the Shift key, obtain the corresponding element.\n\nWith `leftShiftKey`, monitor [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/Notification\/elementUpdates(values:)] for any changes using [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement\/Value]. Values also arrive as a byte stream in [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement\/Value\/bytes], but are interpretable as integers using extensions such as [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement\/Value\/integerValue(asTypeTruncatingIfNeeded:)]. Because the Shift key state is 1 bit, treat it as a `UInt8`.\n\nUse [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement] with get and set reports through [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/updateElements(_:timeout:)]. This takes [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement] from [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/RequestElementUpdate] and [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/ProvideElementUpdate], then issues get and set reports with the raw report data in the background.\n\nThe following example creates a unit test for the keyboard. It turns off the Caps Lock LED, queries the state of the left Shift key, turns on the Caps Lock LED, then queries the state of the left Shift key again to determine if toggling the LED alters the state of the left Shift key.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/CoreHID\/CommunicatingWithHIDDevices\ncrawled: 2025-12-07T14:56:19Z\n---\n\n# Communicating with human interface devices\n\n**Article**\n\nInteract with and obtain data from devices such as keyboards and mice.\n\n## Overview\n\nTo communicate with a human interface device (HID), you must identify and match it using a set of matching critiera. When you match the device, you become its client and can query its properties and capabilities.\n\n\n\n### Locate the device of interest\n\nTo locate the device you’re interested in, specify a set of matching criteria using [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager\/DeviceMatchingCriteria]. The following code uses this method to discover the Magic Keyboard with Numeric Keypad `product`:\n\n```swift\nlet matchingCriteria = HIDDeviceManager.DeviceMatchingCriteria(primaryUsage: .genericDesktop(.keyboard), product: \"Magic Keyboard with Numeric Keypad\")\n```\n\nCreate a [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager] and provide the criteria to [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager\/monitorNotifications(matchingCriteria:)]. Notifications arrive immediately for connected devices, and later when newly connected matching devices appear. `monitorNotifications` returns an asynchronous stream that you iterate over. The loop awaits and releases the current Task until a notification comes in.\n\n```swift\nlet manager = HIDDeviceManager()\n\n\/\/ The criteria combines multiple sets in a single array.\nfor try await notification in await manager.monitorNotifications(matchingCriteria: [matchingCriteria]) {\n    switch notification {\n        case .deviceMatched(let deviceReference):\n            print(\"A device was found.\")\n\n        case .deviceRemoved(let deviceReference):\n            print(\"A device was removed.\")\n\n        default:\n            continue\n    }\n}\n```\n\nTo specify matching criteria using additional properties, see [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceManager\/DeviceMatchingCriteria\/init(primaryUsage:deviceUsages:vendorID:productID:transport:product:manufacturer:modelNumber:versionNumber:serialNumber:uniqueID:locationID:localizationCode:isBuiltIn:extraProperties:)].\n\n### Communicate with the device\n\nCreate a [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient] and pass in the device reference to start communication with the device. Verify that you’re communicating with the correct device by checking the usage with [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/primaryUsage], the transport with [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/transport], and the product name with [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/product].\n\n```swift\nenum ExampleError : Error {\n    case deviceCreation\n    case wrongUsage\n    case wrongTransport\n    case wrongProduct\n    case noElement\n    case noValue\n    case valuesNotEqual\n}\n\nguard let client = HIDDeviceClient(deviceReference: deviceReference) else {\n    throw ExampleError.deviceCreation\n}\n\nlet usage = await client.primaryUsage\nguard usage == .genericDesktop(.keyboard) else {\n    print(\"Wrong usage: \\(usage)\")\n    throw ExampleError.wrongUsage\n}\n\nlet transport = await client.transport\nguard transport == .bluetooth else {\n    print(\"Wrong transport: \\(String(describing: transport))\")\n    throw ExampleError.wrongTransport\n}\n\nlet product = await client.product\nguard product == \"Magic Keyboard with Numeric Keypad\" else {\n    print(\"Wrong product: \\(String(describing: product))\")\n    throw ExampleError.wrongProduct\n}\n```\n\nObtain the device’s input report using [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/dispatchGetReportRequest(type:id:timeout:)]. Specify [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDReportType\/input] for the type, and provide the appropriate [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDReportID]. This method initiates a get report request to the device over Bluetooth and returns the device’s response.\n\n```swift\nlet report = try await client.dispatchGetReportRequest(type: .input, id: HIDReportID(rawValue: 1))\nprint(\"Get report data: [\\(report.map { String(format: \"%02x\", $0) }.joined(separator: \" \"))]\")\n```\n\nMonitor the device for input reports or other notifications by calling [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/monitorNotifications(reportIDsToMonitor:elementsToMonitor:)]:\n\n```swift\nfor try await notification in await client.monitorNotifications(reportIDsToMonitor: [HIDReportID.allReports], elementsToMonitor: []) {\n    switch notification {\n\n    \/\/ Receive device input data.\n    case .inputReport(let reportID, let reportData, let timestamp):\n        print(\"Received input report ID:\\(String(describing: reportID)) timestamp:\\(timestamp) data:[\\(reportData.map { String(format: \"%02x\", $0) }.joined(separator: \" \"))]\")\n\n    \/\/ Receive a notification if another client seizes this device.\n    case .deviceSeized:\n        print(\"\\(client) seized\")\n\n    \/\/ Receive a notification if another client releases this device.\n    case .deviceUnseized:\n        print(\"\\(client) unseized\")\n\n    \/\/ Receive a notification if a person removes the client.\n    case .deviceRemoved:\n        print(\"\\(client) removed\")\n\n    default:\n        continue\n    }\n}\n```\n\nRaw reports provide detailed information about data going to and from the device; however, this can generate more detail than you need. Instead, use [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement] to obtain specific information from a device.\n\nFor the keyboard in this example, the input report contains the report ID, status of the modifier keys, the currently pressed keys, vendor defined data and padding. To obtain just the state of the Shift key, obtain the corresponding element.\n\n```swift\nlet elements = await client.elements\nguard let leftShiftKey = elements.filter({ $0.usage == .keyboardOrKeypad(.keyboardLeftShift) }).first else {\n    throw ExampleError.noElement\n}\n```\n\nWith `leftShiftKey`, monitor [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/Notification\/elementUpdates(values:)] for any changes using [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement\/Value]. Values also arrive as a byte stream in [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement\/Value\/bytes], but are interpretable as integers using extensions such as [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement\/Value\/integerValue(asTypeTruncatingIfNeeded:)]. Because the Shift key state is 1 bit, treat it as a `UInt8`.\n\n```swift\nfor try await notification in await client.monitorNotifications(reportIDsToMonitor: [], elementsToMonitor: [leftShiftKey]) {\n    switch notification {\n    case .elementUpdates(let values):\n        let leftShiftVal = values[0]\n        print(\"Left shift state: \\(leftShiftVal.integerValue(asTypeTruncatingIfNeeded: UInt8.self))\")\n\n    default:\n        continue\n    }\n}\n```\n\nUse [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement] with get and set reports through [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/updateElements(_:timeout:)]. This takes [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDElement] from [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/RequestElementUpdate] and [doc:\/\/com.apple.CoreHID\/documentation\/CoreHID\/HIDDeviceClient\/ProvideElementUpdate], then issues get and set reports with the raw report data in the background.\n\nThe following example creates a unit test for the keyboard. It turns off the Caps Lock LED, queries the state of the left Shift key, turns on the Caps Lock LED, then queries the state of the left Shift key again to determine if toggling the LED alters the state of the left Shift key.\n\n```swift\nguard let capsLockLED = elements.filter({ $0.usage == .led(.capsLock) }).first else {\n    throw ExampleError.noElement\n}\n\nlet turnOffVal = HIDElement.Value(element: capsLockLED, fromIntegerTruncatingIfNeeded: 0, timestamp: SuspendingClock.now)\nlet turnOnVal  = HIDElement.Value(element: capsLockLED, fromIntegerTruncatingIfNeeded: 1, timestamp: SuspendingClock.now)\n\nlet turnOffRequest     = HIDDeviceClient.ProvideElementUpdate(values:   [turnOffVal])\nlet stateRequestBefore = HIDDeviceClient.RequestElementUpdate(elements: [leftShiftKey])\nlet turnOnRequest      = HIDDeviceClient.ProvideElementUpdate(values:   [turnOnVal])\nlet stateRequestAfter  = HIDDeviceClient.RequestElementUpdate(elements: [leftShiftKey])\nlet requestResults     = await client.updateElements([turnOffRequest, stateRequestBefore, turnOnRequest, stateRequestAfter])\n\n\/\/ Ensure that the set operations succeed.\ntry requestResults[turnOffRequest]!.get()\ntry requestResults[turnOnRequest]!.get()\n\n\/\/ Read the initial state of the left Shift key.\nguard let leftShiftStateBefore = try requestResults[stateRequestBefore]?.get().first?.integerValue(asTypeTruncatingIfNeeded: UInt8.self) else {\n    throw ExampleError.noValue\n}\n\n\/\/ Read the final state of the left Shift key.\nguard let leftShiftStateAfter = try requestResults[stateRequestAfter]?.get().first?.integerValue(asTypeTruncatingIfNeeded: UInt8.self) else {\n    throw ExampleError.noValue\n}\n\n\/\/ Ensure the initial state didn't change as a result of the LED toggle.\nguard leftShiftStateBefore == leftShiftStateAfter else {\n    throw ExampleError.valuesNotEqual\n}\n```\n\n## Interaction\n\n- **HIDDeviceClient**: A client of a physical or virtual HID compatible peripheral.\n- **HIDElement**: A representation of an item from a report descriptor for a HID device.\n- **HIDElementCollection**: A collection of items from a report descriptor for a HID device.\n- **HIDElement.Value**: Data associated with a HID element.\n- **HIDElementUpdate**: A base protocol for element update types.\n- **HIDReportType**: Types for HID reports.\n- **HIDReportID**: A type to represent the report IDs of HID reports.\n- **HIDUsage**: A type to represent HID usage pages.\n- **HIDDeviceError**: Errors that the framework can throw.\n- **HIDDeviceTransport**: Common transport types that transmit data to or from a HID device.\n- **HIDDeviceLocalizationCode**: The localization codes that some HID devices declare to specify conformance to a certain format or language.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "A client of a physical or virtual HID compatible peripheral.",
          "name" : "HIDDeviceClient",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDDeviceClient"
        },
        {
          "description" : "A representation of an item from a report descriptor for a HID device.",
          "name" : "HIDElement",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDElement"
        },
        {
          "description" : "A collection of items from a report descriptor for a HID device.",
          "name" : "HIDElementCollection",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDElementCollection"
        },
        {
          "description" : "Data associated with a HID element.",
          "name" : "HIDElement.Value",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDElement\/Value"
        },
        {
          "description" : "A base protocol for element update types.",
          "name" : "HIDElementUpdate",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDElementUpdate"
        },
        {
          "description" : "Types for HID reports.",
          "name" : "HIDReportType",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDReportType"
        },
        {
          "description" : "A type to represent the report IDs of HID reports.",
          "name" : "HIDReportID",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDReportID"
        },
        {
          "description" : "A type to represent HID usage pages.",
          "name" : "HIDUsage",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDUsage"
        },
        {
          "description" : "Errors that the framework can throw.",
          "name" : "HIDDeviceError",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDDeviceError"
        },
        {
          "description" : "Common transport types that transmit data to or from a HID device.",
          "name" : "HIDDeviceTransport",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDDeviceTransport"
        },
        {
          "description" : "The localization codes that some HID devices declare to specify conformance to a certain format or language.",
          "name" : "HIDDeviceLocalizationCode",
          "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/HIDDeviceLocalizationCode"
        }
      ],
      "title" : "Interaction"
    }
  ],
  "source" : "appleJSON",
  "title" : "Communicating with human interface devices",
  "url" : "https:\/\/developer.apple.com\/documentation\/CoreHID\/CommunicatingWithHIDDevices"
}