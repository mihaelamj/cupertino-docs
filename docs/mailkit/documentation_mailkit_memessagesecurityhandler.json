{
  "abstract" : "An object that digitally signs or encrypts messages the user sends and receives.",
  "codeExamples" : [
    {
      "code" : "<key>NSExtensionAttributes<\/key>\n<dict>\n    <key>MEExtensionCapabilities<\/key>\n    <array>\n        <string>MEMessageSecurityHandler<\/string>\n    <\/array>\n<\/dict>",
      "language" : "plist"
    }
  ],
  "contentHash" : "2bec4fd6bddcc81acbee7cacdeb830c3a472c3622d0eb8cf50b05099724b2e6c",
  "crawledAt" : "2025-12-02T12:46:54Z",
  "declaration" : {
    "code" : "@MainActor protocol MEMessageSecurityHandler : MEMessageDecoder, MEMessageEncoder",
    "language" : "swift"
  },
  "id" : "C1E78E4A-9124-45D4-A6DD-8A1B66CBCAE0",
  "kind" : "protocol",
  "module" : "MailKit",
  "overview" : "## Overview\n\nWhen users enable an extension that implements a message security handler, Mail passes incoming and outgoing message content to the extension for encryption and digital signing.\n\nTo encompass the symmetrical halves for encoding and decoding, MailKit defines two protocols that [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageSecurityHandler] conforms to:\n\nAs the user composes a mail message, MailKit calls [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageEncoder\/getEncodingStatus(for:composeContext:completionHandler:)] to determine if the handler can sign or encrypt the message. The handler indicates the capabilities by providing an instance of [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEOutgoingMessageEncodingStatus]. Mail reflects this status in the compose window by enabling the appropriate buttons to let the user choose how to encode the message. When the user sends the message, MailKit invokes the [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageEncoder\/encode(_:composeContext:completionHandler:)] method, and indicates whether the user chose to encrypt or sign the message.\n\nWhen MailKit needs the original message content, it invokes the handler’s [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageDecoder\/decodedMessage(forMessageData:)] method. This method creates an instance of [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEDecodedMessage] that includes the raw decoded message data and the details of who signed the message in an instance of [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageSecurityInformation].\n\nTo indicate that your extension contains a message security handler, add `MEMessageSecurityHandler` to the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes\/MEExtensionCapabilities] array in the extension’s `Info.plist` file:",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/mailkit\/memessagesecurityhandler\ncrawled: 2025-12-02T12:46:54Z\n---\n\n# MEMessageSecurityHandler\n\n**Protocol**\n\nAn object that digitally signs or encrypts messages the user sends and receives.\n\n## Declaration\n\n```swift\n@MainActor protocol MEMessageSecurityHandler : MEMessageDecoder, MEMessageEncoder\n```\n\n## Overview\n\nWhen users enable an extension that implements a message security handler, Mail passes incoming and outgoing message content to the extension for encryption and digital signing.\n\nTo encompass the symmetrical halves for encoding and decoding, MailKit defines two protocols that [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageSecurityHandler] conforms to:\n\n\n\nAs the user composes a mail message, MailKit calls [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageEncoder\/getEncodingStatus(for:composeContext:completionHandler:)] to determine if the handler can sign or encrypt the message. The handler indicates the capabilities by providing an instance of [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEOutgoingMessageEncodingStatus]. Mail reflects this status in the compose window by enabling the appropriate buttons to let the user choose how to encode the message. When the user sends the message, MailKit invokes the [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageEncoder\/encode(_:composeContext:completionHandler:)] method, and indicates whether the user chose to encrypt or sign the message.\n\nWhen MailKit needs the original message content, it invokes the handler’s [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageDecoder\/decodedMessage(forMessageData:)] method. This method creates an instance of [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEDecodedMessage] that includes the raw decoded message data and the details of who signed the message in an instance of [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEMessageSecurityInformation].\n\n\n\nTo indicate that your extension contains a message security handler, add `MEMessageSecurityHandler` to the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes\/MEExtensionCapabilities] array in the extension’s `Info.plist` file:\n\n```plist\n<key>NSExtensionAttributes<\/key>\n<dict>\n    <key>MEExtensionCapabilities<\/key>\n    <array>\n        <string>MEMessageSecurityHandler<\/string>\n    <\/array>\n<\/dict>\n```\n\n## Encrypting and Signing Messages\n\n- **MEMessageEncoder**: An object that encrypts or digitally signs outgoing messages.\n- **MEEncodedOutgoingMessage**: An object that contains the signed or encrypted representation of a message’s RFC 2822 data.\n- **MEOutgoingMessageEncodingStatus**: An object that contains information about security measures the user can apply when composing a message.\n- **MEMessageEncodingResult**: An object that contains a signed or encrypted message, or errors that indicate failure to encode the message.\n\n## Decrypting Messages and Verifying Signatures\n\n- **MEMessageDecoder**: An object that decrypts messages and provides details about digital signatures.\n- **MEDecodedMessage**: An object that contains the RFC 2822 data for a message, without encryption or digital signatures.\n- **MEMessageSigner**: An object that contains details about the person who signed a message.\n- **MEMessageSecurityInformation**: An object that contains details about a message’s content, such as if it’s encrypted and who digitally signed it.\n\n## Displaying Signature Details\n\n- **extensionViewController(signers:)**: Returns a view controller that displays details about a message’s digital signature.\n\n## Instance Methods\n\n- **extensionViewController(messageContext:)**\n- **primaryActionClicked(forMessageContext:completionHandler:)**\n\n## Inherits From\n\n- MEMessageDecoder\n- MEMessageEncoder\n- NSObjectProtocol\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that encrypts or digitally signs outgoing messages.",
          "name" : "MEMessageEncoder",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageEncoder"
        },
        {
          "description" : "An object that contains the signed or encrypted representation of a message’s RFC 2822 data.",
          "name" : "MEEncodedOutgoingMessage",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEEncodedOutgoingMessage"
        },
        {
          "description" : "An object that contains information about security measures the user can apply when composing a message.",
          "name" : "MEOutgoingMessageEncodingStatus",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEOutgoingMessageEncodingStatus"
        },
        {
          "description" : "An object that contains a signed or encrypted message, or errors that indicate failure to encode the message.",
          "name" : "MEMessageEncodingResult",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageEncodingResult"
        }
      ],
      "title" : "Encrypting and Signing Messages"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that decrypts messages and provides details about digital signatures.",
          "name" : "MEMessageDecoder",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageDecoder"
        },
        {
          "description" : "An object that contains the RFC 2822 data for a message, without encryption or digital signatures.",
          "name" : "MEDecodedMessage",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEDecodedMessage"
        },
        {
          "description" : "An object that contains details about the person who signed a message.",
          "name" : "MEMessageSigner",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageSigner"
        },
        {
          "description" : "An object that contains details about a message’s content, such as if it’s encrypted and who digitally signed it.",
          "name" : "MEMessageSecurityInformation",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageSecurityInformation"
        }
      ],
      "title" : "Decrypting Messages and Verifying Signatures"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Returns a view controller that displays details about a message’s digital signature.",
          "name" : "extensionViewController(signers:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageSecurityHandler\/extensionViewController(signers:)"
        }
      ],
      "title" : "Displaying Signature Details"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "extensionViewController(messageContext:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageSecurityHandler\/extensionViewController(messageContext:)"
        },
        {
          "description" : "",
          "name" : "primaryActionClicked(forMessageContext:completionHandler:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEMessageSecurityHandler\/primaryActionClicked(forMessageContext:completionHandler:)"
        }
      ],
      "title" : "Instance Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "MEMessageDecoder"
        },
        {
          "name" : "MEMessageEncoder"
        },
        {
          "name" : "NSObjectProtocol"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "MEMessageSecurityHandler",
  "url" : "https:\/\/developer.apple.com\/documentation\/mailkit\/memessagesecurityhandler"
}