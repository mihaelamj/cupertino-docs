{
  "abstract" : "An object that participates in the composition of mail messages, and annotates recipient tokens.",
  "codeExamples" : [
    {
      "code" : "<key>NSExtensionAttributes<\/key>\n<dict>\n    <key>MEExtensionCapabilities<\/key>\n    <array>\n        <string>MEComposeSessionHandler<\/string>\n    <\/array>\n<\/dict>",
      "language" : "swift"
    }
  ],
  "contentHash" : "e2e3a5036eb7753e406347fd9368aae62acfdaae31967463f4239ac9e5b31b47",
  "crawledAt" : "2025-12-04T09:13:45Z",
  "declaration" : {
    "code" : "@MainActor protocol MEComposeSessionHandler : NSObjectProtocol",
    "language" : "swift"
  },
  "id" : "39B69F8C-FBEA-4EE6-A1BF-AE92736F4F88",
  "kind" : "protocol",
  "language" : "swift",
  "module" : "MailKit",
  "overview" : "## Overview\n\nWhen the user composes a message, MailKit requests a compose session handler object from your extension. MailKit uses this handler in the following ways:\n\nEach of the items in the list above corresponds to methods that the handler implements.\n\nTo indicate that your extension contains a compose session handler, add `MEComposeSessionHandler` to the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes\/MEExtensionCapabilities] array in the extension’s `Info.plist` file:",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/mailkit\/mecomposesessionhandler\ncrawled: 2025-12-04T09:13:45Z\n---\n\n# MEComposeSessionHandler\n\n**Protocol**\n\nAn object that participates in the composition of mail messages, and annotates recipient tokens.\n\n## Declaration\n\n```swift\n@MainActor protocol MEComposeSessionHandler : NSObjectProtocol\n```\n\n## Overview\n\nWhen the user composes a message, MailKit requests a compose session handler object from your extension. MailKit uses this handler in the following ways:\n\n- To inform it when the compose session begins and ends\n- To add status annotations for email addresses that the user enters into the To, Cc, and Bcc fields\n- To display a custom popover in the compose window\n- To include custom headers in an outgoing message\n- To confirm that an outgoing message is ready for delivery\n\nEach of the items in the list above corresponds to methods that the handler implements.\n\nTo indicate that your extension contains a compose session handler, add `MEComposeSessionHandler` to the [doc:\/\/com.apple.documentation\/documentation\/BundleResources\/Information-Property-List\/NSExtension\/NSExtensionAttributes\/MEExtensionCapabilities] array in the extension’s `Info.plist` file:\n\n```swift\n<key>NSExtensionAttributes<\/key>\n<dict>\n    <key>MEExtensionCapabilities<\/key>\n    <array>\n        <string>MEComposeSessionHandler<\/string>\n    <\/array>\n<\/dict>\n```\n\n## Handling Compose Sessions\n\n- **MEComposeSession**: An object that represents a single mail compose window.\n- **mailComposeSessionDidBegin(_:)**: Informs the handler when the user opens a compose window.\n- **mailComposeSessionDidEnd(_:)**: Informs the handler when the user closes a compose window.\n- **MEComposeSessionError**: An error that indicates the compose session is in an erroneous state.\n\n## Annotating Email Address Tokens\n\n- **annotateAddressesForSession(_:completion:)**: Indicates whether recipients in the compose window are valid or not.\n- **MEAddressAnnotation**: An object that indicates the validity of an email address.\n\n## Extending the Compose Window Interface\n\n- **viewController(for:)**: Provides a custom view controller to display as part of the compose window.\n\n## Adding Custom Headers\n\n- **additionalHeaders(for:)**: Provides custom headers to include in the outgoing message.\n\n## Approving Message Delivery\n\n- **allowMessageSendForSession(_:completion:)**: Confirms that the message is ready for delivery.\n\n## Inherits From\n\n- NSObjectProtocol\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that represents a single mail compose window.",
          "name" : "MEComposeSession",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSession"
        },
        {
          "description" : "Informs the handler when the user opens a compose window.",
          "name" : "mailComposeSessionDidBegin(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/mailComposeSessionDidBegin(_:)"
        },
        {
          "description" : "Informs the handler when the user closes a compose window.",
          "name" : "mailComposeSessionDidEnd(_:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/mailComposeSessionDidEnd(_:)"
        },
        {
          "description" : "An error that indicates the compose session is in an erroneous state.",
          "name" : "MEComposeSessionError",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionError"
        }
      ],
      "title" : "Handling Compose Sessions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Indicates whether recipients in the compose window are valid or not.",
          "name" : "annotateAddressesForSession(_:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/annotateAddressesForSession(_:completion:)"
        },
        {
          "description" : "An object that indicates the validity of an email address.",
          "name" : "MEAddressAnnotation",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEAddressAnnotation"
        }
      ],
      "title" : "Annotating Email Address Tokens"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Provides a custom view controller to display as part of the compose window.",
          "name" : "viewController(for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/viewController(for:)"
        }
      ],
      "title" : "Extending the Compose Window Interface"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Provides custom headers to include in the outgoing message.",
          "name" : "additionalHeaders(for:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/additionalHeaders(for:)"
        }
      ],
      "title" : "Adding Custom Headers"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Confirms that the message is ready for delivery.",
          "name" : "allowMessageSendForSession(_:completion:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/allowMessageSendForSession(_:completion:)"
        }
      ],
      "title" : "Approving Message Delivery"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NSObjectProtocol"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "MEComposeSessionHandler",
  "url" : "https:\/\/developer.apple.com\/documentation\/mailkit\/mecomposesessionhandler"
}