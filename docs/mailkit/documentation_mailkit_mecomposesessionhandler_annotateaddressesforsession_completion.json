{
  "abstract" : "Indicates whether recipients in the compose window are valid or not.",
  "codeExamples" : [
    {
      "code" : "func annotateAddressesForSession(_ session: MEComposeSession) async -> [String : MEAddressAnnotation] {\n    var annotations: [String: MEAddressAnnotation] = [:]\n    \n    \/\/ Iterate through all the recipient email addresses.\n    for address in session.mailMessage.allRecipientAddresses {\n        \/\/ Check if it has an @example.com domain.\n        if address.hasSuffix(\"@example.com\") {\n            \/\/ Create an annotation with detail about why the address is invalid.\n            let message = \"example.com is not a valid domain\"\n            let annotation = MEAddressAnnotation.error(withLocalizedDescription: message)\n            \n            \/\/ Add the annotation to the dictionary.\n            annotations[address] = annotation\n        }\n    }\n    \n    return annotations\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "a44646c67cec831f5823c4625478fdabfacd87f9f8864690da8a41d40ef1f6a1",
  "crawledAt" : "2025-12-02T12:46:03Z",
  "declaration" : {
    "code" : "@MainActor optional func annotateAddressesForSession(_ session: MEComposeSession, completion completionHandler: @escaping ([MEEmailAddress : MEAddressAnnotation]) -> Void)",
    "language" : "swift"
  },
  "id" : "FB73776F-F691-418A-9AE7-D810F1864E90",
  "kind" : "method",
  "module" : "MailKit",
  "overview" : "## Discussion\n\nAs the user enters recipients for a mail message, MailKit invokes this method to allow your extension to provide feedback about the validity of recipient email addresses. The status you provide indicates one of the following:\n\nMail displays the status in the address field using a status icon and color. In addition to the validity, you provide a localized string with additional information that Mail displays to the user.\n\nTo provide status, iterate through the addresses available in the [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEComposeSession\/mailMessage] property of the `session` parameter. For addresses that are meaningful to your extension, determine the current status and add a [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEAddressAnnotation] to the dictionary you pass to the completion block.\n\nThe following code shows how to mark recipients with email addresses using `@example.com` as invalid.",
  "platforms" : [
    "macOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/annotateAddressesForSession(_:completion:)\ncrawled: 2025-12-02T12:46:03Z\n---\n\n# annotateAddressesForSession(_:completion:)\n\n**Instance Method**\n\nIndicates whether recipients in the compose window are valid or not.\n\n## Declaration\n\n```swift\n@MainActor optional func annotateAddressesForSession(_ session: MEComposeSession, completion completionHandler: @escaping ([MEEmailAddress : MEAddressAnnotation]) -> Void)\n```\n\n```swift\n@MainActor optional func annotateAddressesForSession(_ session: MEComposeSession) async -> [MEEmailAddress : MEAddressAnnotation]\n```\n\n## Parameters\n\n- **session**: The session that represents the properties of the message in the compose window.\n- **completionHandler**: A block you call with a dictionary that contains annotation objects for recipient email addresses.\n\n## Discussion\n\n\n\nAs the user enters recipients for a mail message, MailKit invokes this method to allow your extension to provide feedback about the validity of recipient email addresses. The status you provide indicates one of the following:\n\n- The address is valid and correct.\n- The address is invalid or may result in failure to deliver, such as the address of an employee who is no longer at your company.\n- The address may not be valid and needs attention, such as an address outside of your companyâ€™s domain.\n\nMail displays the status in the address field using a status icon and color. In addition to the validity, you provide a localized string with additional information that Mail displays to the user.\n\nTo provide status, iterate through the addresses available in the [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEComposeSession\/mailMessage] property of the `session` parameter. For addresses that are meaningful to your extension, determine the current status and add a [doc:\/\/com.apple.mailkit\/documentation\/MailKit\/MEAddressAnnotation] to the dictionary you pass to the completion block.\n\n\n\nThe following code shows how to mark recipients with email addresses using `@example.com` as invalid.\n\n```swift\nfunc annotateAddressesForSession(_ session: MEComposeSession) async -> [String : MEAddressAnnotation] {\n    var annotations: [String: MEAddressAnnotation] = [:]\n    \n    \/\/ Iterate through all the recipient email addresses.\n    for address in session.mailMessage.allRecipientAddresses {\n        \/\/ Check if it has an @example.com domain.\n        if address.hasSuffix(\"@example.com\") {\n            \/\/ Create an annotation with detail about why the address is invalid.\n            let message = \"example.com is not a valid domain\"\n            let annotation = MEAddressAnnotation.error(withLocalizedDescription: message)\n            \n            \/\/ Add the annotation to the dictionary.\n            annotations[address] = annotation\n        }\n    }\n    \n    return annotations\n}\n```\n\n## Annotating Email Address Tokens\n\n- **MEAddressAnnotation**: An object that indicates the validity of an email address.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "An object that indicates the validity of an email address.",
          "name" : "MEAddressAnnotation",
          "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEAddressAnnotation"
        }
      ],
      "title" : "Annotating Email Address Tokens"
    }
  ],
  "source" : "appleJSON",
  "title" : "annotateAddressesForSession(_:completion:)",
  "url" : "https:\/\/developer.apple.com\/documentation\/MailKit\/MEComposeSessionHandler\/annotateAddressesForSession(_:completion:)"
}