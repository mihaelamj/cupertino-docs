{
  "abstract" : "The controls and environment configuration you use to test StoreKit transactions in Xcode.",
  "codeExamples" : [

  ],
  "conformsTo" : [
    "CVarArg",
    "CustomDebugStringConvertible",
    "CustomStringConvertible",
    "Equatable",
    "Hashable",
    "NSObjectProtocol",
    "Sendable",
    "SendableMetatype"
  ],
  "contentHash" : "27abc529bb05dcd623b440d7e0aee0c08c8c0b92be37252aa314b2756d596845",
  "crawledAt" : "2025-12-04T03:00:57Z",
  "declaration" : {
    "code" : "class SKTestSession",
    "language" : "swift"
  },
  "id" : "DC11710D-A199-452B-AFC2-F9DB088C1276",
  "kind" : "class",
  "language" : "swift",
  "module" : "StoreKit Test",
  "overview" : "## Overview\n\nThis class controls the settings that the server uses when it processes transactions. Run tests that reconfigure the environment serially, not concurrently, to avoid overwriting each other’s environment settings.\n\nThe test environment creates an [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestTransaction] instance each time your test code calls any method of `SKTestSession` that affects in-app purchases, including:\n\nYou can manage the transactions in the test environment. To get a list of all transactions in the test environment, call [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/allTransactions()]. To delete a single transaction, call [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/deleteTransaction(identifier:)]. To delete all the transactions, call [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/clearTransactions()].\n\nBefore automating a test session with `SKTestSession`, you must create a StoreKit configuration file. For more information, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/setting-up-storekit-testing-in-xcode] and [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/init(configurationFileNamed:)]. Set [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/disableDialogs] to `true` to run tests without showing test environment UI.",
  "platforms" : [
    "iOS",
    "iPadOS",
    "Mac Catalyst",
    "macOS",
    "tvOS",
    "visionOS",
    "watchOS"
  ],
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\ncrawled: 2025-12-04T03:00:57Z\n---\n\n# SKTestSession\n\n**Class**\n\nThe controls and environment configuration you use to test StoreKit transactions in Xcode.\n\n## Declaration\n\n```swift\nclass SKTestSession\n```\n\n## Overview\n\nThis class controls the settings that the server uses when it processes transactions. Run tests that reconfigure the environment serially, not concurrently, to avoid overwriting each other’s environment settings.\n\n\n\nThe test environment creates an [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestTransaction] instance each time your test code calls any method of `SKTestSession` that affects in-app purchases, including:\n\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/buyProduct(productIdentifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/refundTransaction(identifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/enableAutoRenewForTransaction(identifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/disableAutoRenewForTransaction(identifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/forceRenewalOfSubscription(productIdentifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/expireSubscription(productIdentifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/approveAskToBuyTransaction(identifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/declineAskToBuyTransaction(identifier:)]\n- [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/resolveIssueForTransaction(identifier:)]\n\nYou can manage the transactions in the test environment. To get a list of all transactions in the test environment, call [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/allTransactions()]. To delete a single transaction, call [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/deleteTransaction(identifier:)]. To delete all the transactions, call [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/clearTransactions()].\n\nBefore automating a test session with `SKTestSession`, you must create a StoreKit configuration file. For more information, see [doc:\/\/com.apple.documentation\/documentation\/Xcode\/setting-up-storekit-testing-in-xcode] and [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/init(configurationFileNamed:)]. Set [doc:\/\/com.apple.storekittest\/documentation\/StoreKitTest\/SKTestSession\/disableDialogs] to `true` to run tests without showing test environment UI.\n\n## Initializing test sessions\n\n- **init(configurationFileNamed:)**: Initializes the test session with the provided configuration file that you include in your application’s bundle.\n- **init(contentsOf:)**: Initializes the test session with a configuration file you provide through a URL.\n- **resetToDefaultState()**: Removes all property overrides and resets all test session settings to their default state.\n\n## Configuring the test environment\n\n- **storefront**: The three-letter code that represents the region associated with the App Store storefront.\n- **locale**: The value that determines the localization metadata the test environment uses.\n- **disableDialogs**: A Boolean value that determines whether the testing environment disables dialogs during automated testing.\n\n## Managing transactions in the test environment\n\n- **allTransactions()**: Gets a list of all transactions in the test environment.\n- **deleteTransaction(identifier:)**: Deletes a specific transaction from the test environment.\n- **clearTransactions()**: Removes all transactions from the test environment.\n\n## Forcing failed transactions\n\n- **failTransactionsEnabled**: A Boolean value that determines whether transactions fail in the testing environment.\n- **failureError**: The error code that transactions return when you enable failing transactions.\n\n## Testing interrupted purchases\n\n- **interruptedPurchasesEnabled**: A Boolean value that determines whether the test environment simulates an interrupted purchase.\n- **resolveIssueForTransaction(identifier:)**: Simulates resolving an issue when you test interrupted purchases or billing retry scenarios.\n\n## Testing Ask To Buy transactions\n\n- **askToBuyEnabled**: A Boolean value that determines whether the testing environment simulates an Ask to Buy scenario.\n- **approveAskToBuyTransaction(identifier:)**: Resolves an Ask to Buy test scenario by approving the transaction.\n- **declineAskToBuyTransaction(identifier:)**: Resolves an Ask to Buy test scenario by declining the transaction.\n\n## Testing subscription renewals\n\n- **timeRate**: The rate at which time passes for subscriptions in the test environment as compared to real time.\n- **SKTestSession.TimeRate**: The values for rates of time passing in the test environment.\n- **enableAutoRenewForTransaction(identifier:)**: Enables auto-renewing for an auto-renewable subscription in the test environment.\n- **disableAutoRenewForTransaction(identifier:)**: Disables auto-renewing for an auto-renewable subscription in the test environment.\n- **forceRenewalOfSubscription(productIdentifier:)**: Ends the previous subscription period and begins the next period in the test environment.\n- **expireSubscription(productIdentifier:)**: Causes the identified auto-renewable subscription to expire immediately in the test environment.\n\n## Testing billing retry and grace period\n\n- **billingGracePeriodIsEnabled**: A Boolean value that indicates whether the test environment simulates a billing grace period for auto-renewable subscriptions.\n- **shouldEnterBillingRetryOnRenewal**: A Boolean value that indicates whether the testing environment enters a billing retry state when an auto-renewable subscription renews.\n- **resolveIssueForTransaction(identifier:)**: Simulates resolving an issue when you test interrupted purchases or billing retry scenarios.\n\n## Testing price increase consent\n\n- **requestPriceIncreaseConsentForTransaction(identifier:)**: Simulates a price increase that requires customer consent for an auto-renewable subscription.\n- **consentToPriceIncreaseForTransaction(identifier:)**: Simulates a user consenting to a price increase for an auto-renewable subscription.\n- **declinePriceIncreaseForTransaction(identifier:)**: Simulates a user canceling an auto-renewable subscription by disabling auto-renew.\n\n## Testing externally performed transactions\n\n- **buyProduct(productIdentifier:)**: Simulates buying an in-app purchase or subscription outside the app.\n- **refundTransaction(identifier:)**: Simulates a refund for an in-app purchase that completes outside of the app.\n\n## Instance Methods\n\n- **buyProduct(identifier:options:)**\n- **setSimulatedError(_:forAPI:)**\n- **simulatedError(forAPI:)**\n\n## StoreKit transaction testing\n\n- **Setting up StoreKit Testing in Xcode**: Prepare your test environment to test in-app purchases with data you configure locally.\n- **SKTestTransaction**: A transaction that occurs in the testing environment.\n\n## Inherits From\n\n- NSObject\n\n## Conforms To\n\n- CVarArg\n- CustomDebugStringConvertible\n- CustomStringConvertible\n- Equatable\n- Hashable\n- NSObjectProtocol\n- Sendable\n- SendableMetatype\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Initializes the test session with the provided configuration file that you include in your application’s bundle.",
          "name" : "init(configurationFileNamed:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/init(configurationFileNamed:)"
        },
        {
          "description" : "Initializes the test session with a configuration file you provide through a URL.",
          "name" : "init(contentsOf:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/init(contentsOf:)"
        },
        {
          "description" : "Removes all property overrides and resets all test session settings to their default state.",
          "name" : "resetToDefaultState()",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/resetToDefaultState()"
        }
      ],
      "title" : "Initializing test sessions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The three-letter code that represents the region associated with the App Store storefront.",
          "name" : "storefront",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/storefront"
        },
        {
          "description" : "The value that determines the localization metadata the test environment uses.",
          "name" : "locale",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/locale"
        },
        {
          "description" : "A Boolean value that determines whether the testing environment disables dialogs during automated testing.",
          "name" : "disableDialogs",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/disableDialogs"
        }
      ],
      "title" : "Configuring the test environment"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Gets a list of all transactions in the test environment.",
          "name" : "allTransactions()",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/allTransactions()"
        },
        {
          "description" : "Deletes a specific transaction from the test environment.",
          "name" : "deleteTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/deleteTransaction(identifier:)"
        },
        {
          "description" : "Removes all transactions from the test environment.",
          "name" : "clearTransactions()",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/clearTransactions()"
        }
      ],
      "title" : "Managing transactions in the test environment"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that determines whether transactions fail in the testing environment.",
          "name" : "failTransactionsEnabled",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/failTransactionsEnabled"
        },
        {
          "description" : "The error code that transactions return when you enable failing transactions.",
          "name" : "failureError",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/failureError"
        }
      ],
      "title" : "Forcing failed transactions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that determines whether the test environment simulates an interrupted purchase.",
          "name" : "interruptedPurchasesEnabled",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/interruptedPurchasesEnabled"
        },
        {
          "description" : "Simulates resolving an issue when you test interrupted purchases or billing retry scenarios.",
          "name" : "resolveIssueForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/resolveIssueForTransaction(identifier:)"
        }
      ],
      "title" : "Testing interrupted purchases"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that determines whether the testing environment simulates an Ask to Buy scenario.",
          "name" : "askToBuyEnabled",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/askToBuyEnabled"
        },
        {
          "description" : "Resolves an Ask to Buy test scenario by approving the transaction.",
          "name" : "approveAskToBuyTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/approveAskToBuyTransaction(identifier:)"
        },
        {
          "description" : "Resolves an Ask to Buy test scenario by declining the transaction.",
          "name" : "declineAskToBuyTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/declineAskToBuyTransaction(identifier:)"
        }
      ],
      "title" : "Testing Ask To Buy transactions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "The rate at which time passes for subscriptions in the test environment as compared to real time.",
          "name" : "timeRate",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/timeRate-swift.property"
        },
        {
          "description" : "The values for rates of time passing in the test environment.",
          "name" : "SKTestSession.TimeRate",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/TimeRate-swift.enum"
        },
        {
          "description" : "Enables auto-renewing for an auto-renewable subscription in the test environment.",
          "name" : "enableAutoRenewForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/enableAutoRenewForTransaction(identifier:)"
        },
        {
          "description" : "Disables auto-renewing for an auto-renewable subscription in the test environment.",
          "name" : "disableAutoRenewForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/disableAutoRenewForTransaction(identifier:)"
        },
        {
          "description" : "Ends the previous subscription period and begins the next period in the test environment.",
          "name" : "forceRenewalOfSubscription(productIdentifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/forceRenewalOfSubscription(productIdentifier:)"
        },
        {
          "description" : "Causes the identified auto-renewable subscription to expire immediately in the test environment.",
          "name" : "expireSubscription(productIdentifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/expireSubscription(productIdentifier:)"
        }
      ],
      "title" : "Testing subscription renewals"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "A Boolean value that indicates whether the test environment simulates a billing grace period for auto-renewable subscriptions.",
          "name" : "billingGracePeriodIsEnabled",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/billingGracePeriodIsEnabled"
        },
        {
          "description" : "A Boolean value that indicates whether the testing environment enters a billing retry state when an auto-renewable subscription renews.",
          "name" : "shouldEnterBillingRetryOnRenewal",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/shouldEnterBillingRetryOnRenewal"
        },
        {
          "description" : "Simulates resolving an issue when you test interrupted purchases or billing retry scenarios.",
          "name" : "resolveIssueForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/resolveIssueForTransaction(identifier:)"
        }
      ],
      "title" : "Testing billing retry and grace period"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Simulates a price increase that requires customer consent for an auto-renewable subscription.",
          "name" : "requestPriceIncreaseConsentForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/requestPriceIncreaseConsentForTransaction(identifier:)"
        },
        {
          "description" : "Simulates a user consenting to a price increase for an auto-renewable subscription.",
          "name" : "consentToPriceIncreaseForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/consentToPriceIncreaseForTransaction(identifier:)"
        },
        {
          "description" : "Simulates a user canceling an auto-renewable subscription by disabling auto-renew.",
          "name" : "declinePriceIncreaseForTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/declinePriceIncreaseForTransaction(identifier:)"
        }
      ],
      "title" : "Testing price increase consent"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Simulates buying an in-app purchase or subscription outside the app.",
          "name" : "buyProduct(productIdentifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/buyProduct(productIdentifier:)"
        },
        {
          "description" : "Simulates a refund for an in-app purchase that completes outside of the app.",
          "name" : "refundTransaction(identifier:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/refundTransaction(identifier:)"
        }
      ],
      "title" : "Testing externally performed transactions"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "",
          "name" : "buyProduct(identifier:options:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/buyProduct(identifier:options:)"
        },
        {
          "description" : "",
          "name" : "setSimulatedError(_:forAPI:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/setSimulatedError(_:forAPI:)"
        },
        {
          "description" : "",
          "name" : "simulatedError(forAPI:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession\/simulatedError(forAPI:)"
        }
      ],
      "title" : "Instance Methods"
    },
    {
      "content" : "",
      "items" : [
        {
          "description" : "Prepare your test environment to test in-app purchases with data you configure locally.",
          "name" : "Setting up StoreKit Testing in Xcode",
          "url" : "https:\/\/developer.apple.com\/documentation\/Xcode\/setting-up-storekit-testing-in-xcode"
        },
        {
          "description" : "A transaction that occurs in the testing environment.",
          "name" : "SKTestTransaction",
          "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestTransaction"
        }
      ],
      "title" : "StoreKit transaction testing"
    },
    {
      "content" : "",
      "items" : [
        {
          "name" : "NSObject"
        }
      ],
      "title" : "Inherits From"
    }
  ],
  "source" : "appleJSON",
  "title" : "SKTestSession",
  "url" : "https:\/\/developer.apple.com\/documentation\/StoreKitTest\/SKTestSession"
}