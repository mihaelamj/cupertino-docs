{
  "abstract" : "Leverage the Metal Performance Shaders framework to create special rendering effects for your RealityKit scenes.",
  "codeExamples" : [
    {
      "code" : "    func postEffectMPSGaussianBlur(context: ARView.PostProcessContext) {\n        let gaussianBlur = MPSImageGaussianBlur(device: context.device, sigma: 4)\n        gaussianBlur.encode(commandBuffer: context.commandBuffer,\n                            sourceTexture: context.sourceColorTexture,\n                            destinationTexture: context.compatibleTargetTexture)",
      "language" : "swift"
    },
    {
      "code" : "arView.renderCallbacks.postProcess = postEffectMPSGaussianBlur",
      "language" : "swift"
    }
  ],
  "contentHash" : "9141b4fea6dac3afd0ba8a7c88e8e44bd8190d86810122888a95eda65ff1c5a4",
  "crawledAt" : "2025-12-02T16:14:30Z",
  "id" : "E08CA664-2877-4AB7-A294-9BABB4094B6A",
  "kind" : "article",
  "language" : "swift",
  "module" : "RealityKit",
  "overview" : "## Overview\n\nIn iOS 15 and later, and macOS 12 and later, you can apply postprocess effects to a RealityKit scene after RealityKit renders it, but before RealityKit displays it. If you register a postprocess callback function, RealityKit passes that function the complete, rendered frame so you can modify it before the viewer sees it. You can use any image processing or drawing APIs on the rendered frame but, as a practical matter, only APIs that execute on the GPU are fast enough to use every frame and maintain a good framerate.\n\nOne way to implement postprocess effects is to apply filters from the [doc:\/\/com.apple.documentation\/documentation\/MetalPerformanceShaders] framework to the rendered scene. You can use apply these filters to an image without writing any custom shader code. Because these filters run on the GPU and operate directly on Metal textures, they’re a good choice for postprocessing effects.\n\nIf the Metal Performance Shaders framework doesn’t provide an image filter that meets your needs, you can also use Core Image to postprocess frames. Core Image provides a greater selection of image filters, which also run on the GPU, but Core Image requires you to convert the rendered frame into a [doc:\/\/com.apple.documentation\/documentation\/CoreImage\/CIImage]. For more information, see [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/applying-core-image-filters-as-a-postprocess-effect].\n\nIf neither the Metal Performance Shaders framework nor Core Image provide the effect you need, you can also write custom compute functions to implement postprocess effects. For more information, see [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/implementing-postprocess-effects-using-metal-compute-functions].\n\n### Check the output texture pixel format\n\nSome device GPUs require that the output texture be in a specific pixel format. If the device your code is running on doesn’t support [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLGPUFamily\/apple2], convert the output texture to [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLPixelFormat\/bgra8Unorm] before using it. For more information, see [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/checking-the-pixel-format-of-a-postprocess-effect-s-output-texture].\n\n### Create a callback function\n\nTo create postprocess effects using image filters from the Metal Performance Shaders framework, create a Swift function that takes a single [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView\/PostProcessContext] parameter. In that method, create and configure an instance of the filter that you want to apply using the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView\/PostProcessContext\/device] property from the context. Once you’ve created an instance of the shader, call its encode method, passing the command buffer, source color texture, and output texture from the context.\n\n### Register the callback function\n\nTo apply the effect, register the function as the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView\/RenderCallbacks-swift.struct\/postProcess] render callback for the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/RealityKit\/using-metal-performance-shaders-to-create-custom-postprocess-effects\ncrawled: 2025-12-02T16:14:30Z\n---\n\n# Using Metal performance shaders to create custom postprocess effects\n\n**Article**\n\nLeverage the Metal Performance Shaders framework to create special rendering effects for your RealityKit scenes.\n\n## Overview\n\nIn iOS 15 and later, and macOS 12 and later, you can apply postprocess effects to a RealityKit scene after RealityKit renders it, but before RealityKit displays it. If you register a postprocess callback function, RealityKit passes that function the complete, rendered frame so you can modify it before the viewer sees it. You can use any image processing or drawing APIs on the rendered frame but, as a practical matter, only APIs that execute on the GPU are fast enough to use every frame and maintain a good framerate.\n\nOne way to implement postprocess effects is to apply filters from the [doc:\/\/com.apple.documentation\/documentation\/MetalPerformanceShaders] framework to the rendered scene. You can use apply these filters to an image without writing any custom shader code. Because these filters run on the GPU and operate directly on Metal textures, they’re a good choice for postprocessing effects.\n\nIf the Metal Performance Shaders framework doesn’t provide an image filter that meets your needs, you can also use Core Image to postprocess frames. Core Image provides a greater selection of image filters, which also run on the GPU, but Core Image requires you to convert the rendered frame into a [doc:\/\/com.apple.documentation\/documentation\/CoreImage\/CIImage]. For more information, see [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/applying-core-image-filters-as-a-postprocess-effect].\n\nIf neither the Metal Performance Shaders framework nor Core Image provide the effect you need, you can also write custom compute functions to implement postprocess effects. For more information, see [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/implementing-postprocess-effects-using-metal-compute-functions].\n\n### Check the output texture pixel format\n\nSome device GPUs require that the output texture be in a specific pixel format. If the device your code is running on doesn’t support [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLGPUFamily\/apple2], convert the output texture to [doc:\/\/com.apple.documentation\/documentation\/Metal\/MTLPixelFormat\/bgra8Unorm] before using it. For more information, see [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/checking-the-pixel-format-of-a-postprocess-effect-s-output-texture].\n\n### Create a callback function\n\nTo create postprocess effects using image filters from the Metal Performance Shaders framework, create a Swift function that takes a single [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView\/PostProcessContext] parameter. In that method, create and configure an instance of the filter that you want to apply using the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView\/PostProcessContext\/device] property from the context. Once you’ve created an instance of the shader, call its encode method, passing the command buffer, source color texture, and output texture from the context.\n\n```swift\n    func postEffectMPSGaussianBlur(context: ARView.PostProcessContext) {\n        let gaussianBlur = MPSImageGaussianBlur(device: context.device, sigma: 4)\n        gaussianBlur.encode(commandBuffer: context.commandBuffer,\n                            sourceTexture: context.sourceColorTexture,\n                            destinationTexture: context.compatibleTargetTexture)\n```\n\n\n\n### Register the callback function\n\nTo apply the effect, register the function as the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView\/RenderCallbacks-swift.struct\/postProcess] render callback for the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/ARView].\n\n```swift\narView.renderCallbacks.postProcess = postEffectMPSGaussianBlur\n```\n\n\n\n## Metal effects\n\n- **Implementing special rendering effects with RealityKit postprocessing**: Implement a variety of postprocessing techniques to alter RealityKit rendering.\n- **Checking the pixel format of a postprocess effect’s output texture**: Make sure your postprocess effect works on all devices.\n- **Passing Structured Data to a Metal Compute Function**: Send nontexture data from Swift to your Metal shaders using a shared header file.\n- **Implementing postprocess effects using Metal compute functions**: Create custom shaders to implement postprocess effects.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Implement a variety of postprocessing techniques to alter RealityKit rendering.",
          "name" : "Implementing special rendering effects with RealityKit postprocessing",
          "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/implementing-special-rendering-effects-with-realitykit-postprocessing"
        },
        {
          "description" : "Make sure your postprocess effect works on all devices.",
          "name" : "Checking the pixel format of a postprocess effect’s output texture",
          "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/checking-the-pixel-format-of-a-postprocess-effect-s-output-texture"
        },
        {
          "description" : "Send nontexture data from Swift to your Metal shaders using a shared header file.",
          "name" : "Passing Structured Data to a Metal Compute Function",
          "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/passing-structured-data-to-a-metal-compute-function"
        },
        {
          "description" : "Create custom shaders to implement postprocess effects.",
          "name" : "Implementing postprocess effects using Metal compute functions",
          "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/implementing-postprocess-effects-using-metal-compute-functions"
        }
      ],
      "title" : "Metal effects"
    }
  ],
  "source" : "appleJSON",
  "title" : "Using Metal performance shaders to create custom postprocess effects",
  "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/using-metal-performance-shaders-to-create-custom-postprocess-effects"
}