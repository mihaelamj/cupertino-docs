{
  "abstract" : "Move an entity between a volumetric window and an immersive space using coordinate space transformations.",
  "codeExamples" : [
    {
      "code" : "var body: some Scene {\n    WindowGroup(id: \"VolumetricView\") {\n        VolumetricView()\n            .environment(appModel)\n            .onChange(of: appModel.showImmersiveSpace) { _, newValue in\n                handleImmersiveSpaceStateChange(showImmersiveSpace: newValue)\n            }\n    }\n    .windowStyle(.volumetric)\n    .defaultSize(width: 1.0, height: 1.0, depth: 1.0, in: .meters)\n\n    ImmersiveSpace(id: \"ImmersiveSpace\") {\n        ImmersiveView()\n            .environment(appModel)\n            .preferredSurroundingsEffect(.dark)\n    }\n}",
      "language" : "swift"
    },
    {
      "code" : "private func createCube() {\n\n    appModel.volumeCube.components.set([\n        ModelComponent(\n            mesh: .generateBox(size: 0.1, cornerRadius: 0.01),\n            materials: [appModel.volumetricMaterial]),\n        InputTargetComponent(allowedInputTypes: .indirect),\n        HoverEffectComponent(),\n        CollisionComponent(shapes: [\n            ShapeResource.generateBox(size: [0.1, 0.1, 0.1])\n        ])\n    ])\n    \n    \/\/ Make the volume cube a subentity of the volumetric window's root.\n    appModel.volumeRootEntity.addChild(appModel.volumeCube)\n}",
      "language" : "swift"
    },
    {
      "code" : "private func createVolumetricWindowCube() -> ModelEntity {\n    var volumetricWindowCubematerial = SimpleMaterial(\n        color: #colorLiteral(red: 0.0, green: 1.0, blue: 0.0, alpha: 0.4),\n        roughness: 0.5,\n        isMetallic: false)\n\n    volumetricWindowCubematerial.faceCulling = .front\n\n    let volumetricWindowCube = ModelEntity(\n        mesh: .generateBox(size: 1.0, cornerRadius: 0.1),\n        materials: [volumetricWindowCubematerial])\n\n    return volumetricWindowCube\n}",
      "language" : "swift"
    },
    {
      "code" : "private func moveCubeFromVolumetricWindowToImmersiveSpace() {\n    \n    \/\/ Only move the cube if the immersive space is open.\n    guard appModel.immersiveSpaceIsShown else { return }\n\n    \/\/ Record the cube's transform before moving it to the immersive space.\n    \/\/ The app uses this information to move the cube back to the volumetric window.\n    appModel.volumeCubeLastSceneTransformEntity.transform = appModel.volumeCube.transform\n\n    \/\/ Get the transformation matrix of the cube relative to the immersive space.\n    let cubeToSpaceMatrix = appModel.volumeCube.transformMatrix(relativeTo: .immersiveSpace)\n\n    \/\/ Add the cube as a child of the immersive space's root entity.\n    appModel.immersiveSpaceRootEntity.addChild(appModel.volumeCube)\n    \n    \/\/ Set the transformation matrix of the cube relative to the immersive space.\n    appModel.volumeCube.setTransformMatrix(cubeToSpaceMatrix ?? matrix_identity_float4x4,\n                                           relativeTo: appModel.volumeCube.parent)\n\n    \/\/ Change the material to the immersive space material.\n    appModel.volumeCube.components[ModelComponent.self]?.materials = [\n        appModel.immersiveSpaceMaterial\n    ]\n\n    \/\/ Disable the scene transform attachment as the volume cube is in the immersive space now.\n    appModel.sceneAttachmentEntity?.isEnabled = false\n    \n    appModel.cubeInImmersiveSpace = true\n}",
      "language" : "swift"
    },
    {
      "code" : "func moveCubeFromImmersiveSpaceToVolumetricWindow() {\n\n    \/\/ Get the transformation matrix of the volume cube's previously\n    \/\/ recorded transform relative to the immersive space.\n    let cubeToSpaceMatrix =\n        volumeCubeLastSceneTransformEntity.transformMatrix(\n            relativeTo: .immersiveSpace)\n    \n    \/\/ Create a transform from the transformation matrix.\n    let cubeToSpaceTransform = Transform(\n        matrix: cubeToSpaceMatrix ?? matrix_identity_float4x4)\n    \n    \/\/ Move the volume cube to its previously recorded transform\n    \/\/ over a period of time.\n    volumeCube.move(\n        to: cubeToSpaceTransform,\n        relativeTo: nil,\n        duration: getDurationBasedOnDistance(durationMaxLimit: 2.0),\n        timingFunction: .easeOut)\n}",
      "language" : "swift"
    },
    {
      "code" : "func makeCubeSubEntityOfVolumeRoot() {\n\n    \/\/ Make the volume cube a subentity of the volumetric window's root.\n    appModel.volumeRootEntity.addChild(appModel.volumeCube)\n    \n    \/\/ Set the transform to the last recorded transform.\n    appModel.volumeCube.transform =\n        appModel.volumeCubeLastSceneTransformEntity.transform\n    \n    \/\/ Set the material to the volumetric material.\n    appModel.volumeCube.components[ModelComponent.self]?.materials = [\n        appModel.volumetricMaterial\n    ]\n    \n    \/\/ Update the scene and immersive space transforms.\n    appModel.updateTransform(relativeTo: .scene)\n    appModel.updateTransform(relativeTo: .immersiveSpace)\n    \n    \/\/ Enable the scene transform attachment because the cube is in the\n    \/\/ volumetric window.\n    appModel.sceneAttachmentEntity?.isEnabled = true\n    \n    appModel.cubeInImmersiveSpace = false\n}",
      "language" : "swift"
    }
  ],
  "contentHash" : "88e26ca8e93f2298e595a0a52ae12f4a3a88f1e8874ba9a11feb36404a912b9c",
  "crawledAt" : "2025-12-02T15:50:35Z",
  "id" : "2A904048-3EED-4543-AFCE-01CB437AA697",
  "kind" : "unknown",
  "language" : "swift",
  "module" : "RealityKit",
  "overview" : "## Overview\n\nvisionOS has three scene types: Windows, Volumes, and Immersive Spaces.\n\nThe article describes how you can move entities between these different types by transforming an entity from one coordinate space to another.\n\nOne example of wanting to do this could be a shopping app that displays content within a volumetric window. A person may want to move that content outside of the window, and into their surroundings (an immersive space), to compare multiple items with each other. The person using this app would expect its size to remain consistent, and have no disconnect between spaces.\n\nRealityKit has two named coordinate spaces:\n\nThe scene coordinate space has its origin at the center-back of the volumetric window and is a reference to the entity’s container window scene. The immersive coordinate space has its origin at the point on the ground below you while the immersive space is open.\n\nThe sample code seamlessly moves an entity from a volumetric window to an immersive space using the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/transformMatrix(relativeTo:)] method.\n\nThe sample code creates a cube in a volumetric window and moves the cube to an immersive space and back.\n\n## Create the volumetric and immersive views\n\nCreate the volumetric reality view `VolumetricView` in the `WindowGroup` and the immersive reality view `ImmersiveView` in an `ImmersiveSpace`:\n\nThe width, height and depth of the volumetric window is set to 1 meter. When the immersive space is open, the surroundings become dark so that the virtual content is in focus and when it is hidden, the surroundings gradually become brighter again.\n\n## Create a cube in the volumetric window\n\nCreate an entity with a cube mesh in the volumetric window and set the material to the `volumetricMaterial` which is blue in color. The blue color indicates that it is part of the volumetric window. Make the cube a subentity of the `volumeRootEntity` which is an entity at the root of the volumetric window.\n\n## Create a cube representing the bounds of the volumetric window\n\nCreate an entity with a cube mesh with the size of 1 meter to represent the bounds of the volumetric window. Set the material to the `volumetricWindowCubematerial` which is set to a transparent green color.\n\nThe `faceCulling` property of the material is set to `front` so that the bounds of the volume and cube inside it can be seen clearly.\n\n## Move the cube from the volumetric window to the immersive space\n\nGet the transform matrix of the entity relative to the open immersive space calling the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/transformMatrix(relativeTo:)] method.\n\nMake the cube a subentity of the `immersiveSpaceRootEntity`, which is an entity at the root of the immersive space. Set the transform matrix of the entity relative to it’s container entity calling the `Entity\/setTransformMatrix(_:relativeTo:)` method.\n\nThe method records the cube’s transform for use when the cube moves from the immersive space back to the volumetric window. The color of the cube changes from blue to red when the material changes to the `immersiveSpaceMaterial`. Disable the `sceneAttachmentEntity`, as the translation value with respect to the scene coordinate space is the same as the translation value with respect to the immersive space. The sample code allows you to move the cube between the volumetric window and the immersive space by either tapping on the button on the volumetric window or by double-tapping the cube itself.\n\n## Move the cube back to the volumetric window\n\nTo move the entity back to the volumetric window, set the transform of the cube to the previously recorded value before it moved to the immersive space.\n\nThe sample code uses the `Entity\/move(to:relativeTo:duration:timingFunction:)-905k` method to smoothly animate the transformation to the previously recorded transform of the cube relative to the immersive space:\n\nThe above code uses the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/transformMatrix(relativeTo:)] method to get the transformation matrix of the previously recorded value relative to the immersive space. The transformation matrix creates a [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Transform] for specifying the target transform in the `Entity\/move(to:relativeTo:duration:timingFunction:)-905k` method.\n\n## Make the cube a subentity of the volumetric window’s root\n\nWhen the move animation finishes, make the cube a subentity of the volumetric window’s root entity and set the transform to the previously recorded value:\n\nThe cube is made a subentity of the `volumeRootEntity` as it needs to move from the immersive space into the volumetric space. If this isn’t done, the cube remains in the immersive space and won’t move along with the volumetric window.\n\nThe color of the cube changes from red back to blue, indicating that it’s in the volumetric window. The scene and immersive space transforms update to the latest values after completing the move animation. The scene attachment is enabled as the scene and immersive space transform values are different when the cube is in the volumetric window.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/RealityKit\/transforming-entities-between-realitykit-coordinate-spaces\ncrawled: 2025-12-02T15:50:35Z\n---\n\n# Transforming entities between RealityKit coordinate spaces\n\n**Sample Code**\n\nMove an entity between a volumetric window and an immersive space using coordinate space transformations.\n\n## Overview\n\nvisionOS has three scene types: Windows, Volumes, and Immersive Spaces.\n\nThe article describes how you can move entities between these different types by transforming an entity from one coordinate space to another.\n\n\n\nOne example of wanting to do this could be a shopping app that displays content within a volumetric window. A person may want to move that content outside of the window, and into their surroundings (an immersive space), to compare multiple items with each other. The person using this app would expect its size to remain consistent, and have no disconnect between spaces.\n\nRealityKit has two named coordinate spaces:\n\n- [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/CoordinateSpaceReference\/scene]\n- [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/CoordinateSpaceReference\/immersiveSpace]\n\nThe scene coordinate space has its origin at the center-back of the volumetric window and is a reference to the entity’s container window scene. The immersive coordinate space has its origin at the point on the ground below you while the immersive space is open.\n\nThe sample code seamlessly moves an entity from a volumetric window to an immersive space using the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/transformMatrix(relativeTo:)] method.\n\n\n\nThe sample code creates a cube in a volumetric window and moves the cube to an immersive space and back.\n\n## Create the volumetric and immersive views\n\nCreate the volumetric reality view `VolumetricView` in the `WindowGroup` and the immersive reality view `ImmersiveView` in an `ImmersiveSpace`:\n\n```swift\nvar body: some Scene {\n    WindowGroup(id: \"VolumetricView\") {\n        VolumetricView()\n            .environment(appModel)\n            .onChange(of: appModel.showImmersiveSpace) { _, newValue in\n                handleImmersiveSpaceStateChange(showImmersiveSpace: newValue)\n            }\n    }\n    .windowStyle(.volumetric)\n    .defaultSize(width: 1.0, height: 1.0, depth: 1.0, in: .meters)\n\n    ImmersiveSpace(id: \"ImmersiveSpace\") {\n        ImmersiveView()\n            .environment(appModel)\n            .preferredSurroundingsEffect(.dark)\n    }\n}\n```\n\nThe width, height and depth of the volumetric window is set to 1 meter. When the immersive space is open, the surroundings become dark so that the virtual content is in focus and when it is hidden, the surroundings gradually become brighter again.\n\n## Create a cube in the volumetric window\n\nCreate an entity with a cube mesh in the volumetric window and set the material to the `volumetricMaterial` which is blue in color. The blue color indicates that it is part of the volumetric window. Make the cube a subentity of the `volumeRootEntity` which is an entity at the root of the volumetric window.\n\n```swift\nprivate func createCube() {\n\n    appModel.volumeCube.components.set([\n        ModelComponent(\n            mesh: .generateBox(size: 0.1, cornerRadius: 0.01),\n            materials: [appModel.volumetricMaterial]),\n        InputTargetComponent(allowedInputTypes: .indirect),\n        HoverEffectComponent(),\n        CollisionComponent(shapes: [\n            ShapeResource.generateBox(size: [0.1, 0.1, 0.1])\n        ])\n    ])\n    \n    \/\/ Make the volume cube a subentity of the volumetric window's root.\n    appModel.volumeRootEntity.addChild(appModel.volumeCube)\n}\n```\n\n## Create a cube representing the bounds of the volumetric window\n\nCreate an entity with a cube mesh with the size of 1 meter to represent the bounds of the volumetric window. Set the material to the `volumetricWindowCubematerial` which is set to a transparent green color.\n\n```swift\nprivate func createVolumetricWindowCube() -> ModelEntity {\n    var volumetricWindowCubematerial = SimpleMaterial(\n        color: #colorLiteral(red: 0.0, green: 1.0, blue: 0.0, alpha: 0.4),\n        roughness: 0.5,\n        isMetallic: false)\n\n    volumetricWindowCubematerial.faceCulling = .front\n\n    let volumetricWindowCube = ModelEntity(\n        mesh: .generateBox(size: 1.0, cornerRadius: 0.1),\n        materials: [volumetricWindowCubematerial])\n\n    return volumetricWindowCube\n}\n```\n\nThe `faceCulling` property of the material is set to `front` so that the bounds of the volume and cube inside it can be seen clearly.\n\n\n\n## Move the cube from the volumetric window to the immersive space\n\nGet the transform matrix of the entity relative to the open immersive space calling the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/transformMatrix(relativeTo:)] method.\n\n\n\nMake the cube a subentity of the `immersiveSpaceRootEntity`, which is an entity at the root of the immersive space. Set the transform matrix of the entity relative to it’s container entity calling the `Entity\/setTransformMatrix(_:relativeTo:)` method.\n\n```swift\nprivate func moveCubeFromVolumetricWindowToImmersiveSpace() {\n    \n    \/\/ Only move the cube if the immersive space is open.\n    guard appModel.immersiveSpaceIsShown else { return }\n\n    \/\/ Record the cube's transform before moving it to the immersive space.\n    \/\/ The app uses this information to move the cube back to the volumetric window.\n    appModel.volumeCubeLastSceneTransformEntity.transform = appModel.volumeCube.transform\n\n    \/\/ Get the transformation matrix of the cube relative to the immersive space.\n    let cubeToSpaceMatrix = appModel.volumeCube.transformMatrix(relativeTo: .immersiveSpace)\n\n    \/\/ Add the cube as a child of the immersive space's root entity.\n    appModel.immersiveSpaceRootEntity.addChild(appModel.volumeCube)\n    \n    \/\/ Set the transformation matrix of the cube relative to the immersive space.\n    appModel.volumeCube.setTransformMatrix(cubeToSpaceMatrix ?? matrix_identity_float4x4,\n                                           relativeTo: appModel.volumeCube.parent)\n\n    \/\/ Change the material to the immersive space material.\n    appModel.volumeCube.components[ModelComponent.self]?.materials = [\n        appModel.immersiveSpaceMaterial\n    ]\n\n    \/\/ Disable the scene transform attachment as the volume cube is in the immersive space now.\n    appModel.sceneAttachmentEntity?.isEnabled = false\n    \n    appModel.cubeInImmersiveSpace = true\n}\n```\n\nThe method records the cube’s transform for use when the cube moves from the immersive space back to the volumetric window. The color of the cube changes from blue to red when the material changes to the `immersiveSpaceMaterial`. Disable the `sceneAttachmentEntity`, as the translation value with respect to the scene coordinate space is the same as the translation value with respect to the immersive space. The sample code allows you to move the cube between the volumetric window and the immersive space by either tapping on the button on the volumetric window or by double-tapping the cube itself.\n\n\n\n## Move the cube back to the volumetric window\n\nTo move the entity back to the volumetric window, set the transform of the cube to the previously recorded value before it moved to the immersive space.\n\nThe sample code uses the `Entity\/move(to:relativeTo:duration:timingFunction:)-905k` method to smoothly animate the transformation to the previously recorded transform of the cube relative to the immersive space:\n\n```swift\nfunc moveCubeFromImmersiveSpaceToVolumetricWindow() {\n\n    \/\/ Get the transformation matrix of the volume cube's previously\n    \/\/ recorded transform relative to the immersive space.\n    let cubeToSpaceMatrix =\n        volumeCubeLastSceneTransformEntity.transformMatrix(\n            relativeTo: .immersiveSpace)\n    \n    \/\/ Create a transform from the transformation matrix.\n    let cubeToSpaceTransform = Transform(\n        matrix: cubeToSpaceMatrix ?? matrix_identity_float4x4)\n    \n    \/\/ Move the volume cube to its previously recorded transform\n    \/\/ over a period of time.\n    volumeCube.move(\n        to: cubeToSpaceTransform,\n        relativeTo: nil,\n        duration: getDurationBasedOnDistance(durationMaxLimit: 2.0),\n        timingFunction: .easeOut)\n}\n```\n\nThe above code uses the [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Entity\/transformMatrix(relativeTo:)] method to get the transformation matrix of the previously recorded value relative to the immersive space. The transformation matrix creates a [doc:\/\/com.apple.RealityKit\/documentation\/RealityKit\/Transform] for specifying the target transform in the `Entity\/move(to:relativeTo:duration:timingFunction:)-905k` method.\n\n## Make the cube a subentity of the volumetric window’s root\n\nWhen the move animation finishes, make the cube a subentity of the volumetric window’s root entity and set the transform to the previously recorded value:\n\n```swift\nfunc makeCubeSubEntityOfVolumeRoot() {\n\n    \/\/ Make the volume cube a subentity of the volumetric window's root.\n    appModel.volumeRootEntity.addChild(appModel.volumeCube)\n    \n    \/\/ Set the transform to the last recorded transform.\n    appModel.volumeCube.transform =\n        appModel.volumeCubeLastSceneTransformEntity.transform\n    \n    \/\/ Set the material to the volumetric material.\n    appModel.volumeCube.components[ModelComponent.self]?.materials = [\n        appModel.volumetricMaterial\n    ]\n    \n    \/\/ Update the scene and immersive space transforms.\n    appModel.updateTransform(relativeTo: .scene)\n    appModel.updateTransform(relativeTo: .immersiveSpace)\n    \n    \/\/ Enable the scene transform attachment because the cube is in the\n    \/\/ volumetric window.\n    appModel.sceneAttachmentEntity?.isEnabled = true\n    \n    appModel.cubeInImmersiveSpace = false\n}\n```\n\nThe cube is made a subentity of the `volumeRootEntity` as it needs to move from the immersive space into the volumetric space. If this isn’t done, the cube remains in the immersive space and won’t move along with the volumetric window.\n\nThe color of the cube changes from red back to blue, indicating that it’s in the volumetric window. The scene and immersive space transforms update to the latest values after completing the move animation. The scene attachment is enabled as the scene and immersive space transform values are different when the cube is in the volumetric window.\n\n\n\n## Using a matrix\n\n- **transformMatrix(relativeTo:)**: Gets the 4 x 4 transform matrix of an entity relative to the given entity.\n- **setTransformMatrix(_:relativeTo:)**: Sets the transform of the entity relative to the given reference entity using a 4x4 matrix representation.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Gets the 4 x 4 transform matrix of an entity relative to the given entity.",
          "name" : "transformMatrix(relativeTo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/HasTransform\/transformMatrix(relativeTo:)"
        },
        {
          "description" : "Sets the transform of the entity relative to the given reference entity using a 4x4 matrix representation.",
          "name" : "setTransformMatrix(_:relativeTo:)",
          "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/HasTransform\/setTransformMatrix(_:relativeTo:)"
        }
      ],
      "title" : "Using a matrix"
    }
  ],
  "source" : "appleJSON",
  "title" : "Transforming entities between RealityKit coordinate spaces",
  "url" : "https:\/\/developer.apple.com\/documentation\/RealityKit\/transforming-entities-between-realitykit-coordinate-spaces"
}