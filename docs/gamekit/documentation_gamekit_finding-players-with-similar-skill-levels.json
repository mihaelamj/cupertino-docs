{
  "abstract" : "Add a rule to find players in a range of skill levels to balance competitive gameplay.",
  "codeExamples" : [
    {
      "code" : "POST \/v1\/gameCenterMatchmakingRuleSets\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRuleSets\",\n        \"attributes\": {\n            \"referenceName\": \"com.example.mygame.SkillBasedRules\",\n            \"ruleLanguageVersion\": 1,\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4\n        },\n        \"relationships\": {}\n    }\n}",
      "language" : "json"
    },
    {
      "code" : "{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRuleSets\",\n        \"id\": \"36c540f2-031a-4e35-8260-d0804e40376b\",\n        \"attributes\": {\n            \"referenceName\": \"com.example.mygame.SkillBasedRules\",\n            \"ruleLanguageVersion\": 1,\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4\n        },\n...\n}",
      "language" : "json"
    },
    {
      "code" : "POST \/v1\/gameCenterMatchmakingQueues\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingQueues\",\n        \"attributes\": {\n            \"referenceName\": \"com.example.mygame.SkillBasedRules\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"36c540f2-031a-4e35-8260-d0804e40376b\"\n                }\n            }\n        }\n    }\n}",
      "language" : "json"
    },
    {
      "code" : "diff(players[].properties.skill)",
      "language" : "json"
    },
    {
      "code" : "avg(requests[].secondsInQueue)",
      "language" : "json"
    },
    {
      "code" : "agedValues(avg(requests[].secondsInQueue), `20`, [ `40`, `100` ], [ `10`, `20` ])",
      "language" : "json"
    },
    {
      "code" : "diff(players[].properties.skill) <= agedValues(avg(requests[].secondsInQueue), `20`, [ `40`, `100` ], [ `10`, `20` ])",
      "language" : "json"
    },
    {
      "code" : "POST \/v1\/gameCenterMatchmakingRules\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRules\",\n        \"attributes\": {\n            \"type\": \"MATCH\",\n            \"description\": \"Players must have skill in given range\",\n            \"referenceName\": \"SkillDifference\",\n            \"expression\": \"diff(players[].properties.skill) <= agedValues(avg(requests[].secondsInQueue), `20`, [ `40`, `100` ], [ `10`, `20` ])\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"36c540f2-031a-4e35-8260-d0804e40376b\"\n                }\n            }\n        }\n    }\n}",
      "language" : "json"
    },
    {
      "code" : "\/\/ Create a match request.\nlet request = GKMatchRequest()",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Set the matchmaking rules queue name.\nrequest.queueName = \"com.example.mygame.SkillBasedRules\"",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Set properties to the game-specific keys you use in the rules.\nlet skill = localPlayerData.skill\nrequest.properties = [ \"skill\": skill]",
      "language" : "swift"
    }
  ],
  "contentHash" : "0bb071aed4a4c322a9f48f66afa9dff06002d96ea08bb2c976dc1c8bfc97ec14",
  "crawledAt" : "2025-12-02T19:33:57Z",
  "id" : "65824A55-186E-47C4-9FFD-97C049BF0C24",
  "kind" : "article",
  "language" : "swift",
  "module" : "GameKit",
  "overview" : "## Overview\n\nWhen finding players using matchmaking rules, consider adding a rule that finds players in a range of skill levels to make gameplay more enjoyable and fair for all players. To reduce wait times for players, make the rule widen the skill range as the wait time, or age of the match request, increases.\n\nThis article shows one way to find players by skill level that you can combine with your other matchmaking rules. For other types of matchmaking rules, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/letting-players-join-matches-using-party-codes] and [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/assigning-players-to-teams-using-rules].\n\n### Create a skill-level rule set and queue\n\nFirst create a rule set to contain the skill-level rule. Pass a reference name, the minimum players, and the maximum players properties that are game-specific to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRuleSets] endpoint.\n\nRetain the `id` field of the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GameCenterMatchmakingRuleSet] object that this endpoint returns to use later when you create the skill-level rule.\n\nThen create and add the rule set to a skill-level queue. Pass a reference name and the rule set that you create to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingQueues] endpoint. Pass the `id` for the rule set in the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GameCenterMatchmakingQueueCreateRequest\/Data-data.dictionary\/Relationships-data.dictionary\/RuleSet-data.dictionary\/Data-data.dictionary] object.\n\n### Choose parameters that work best for your game\n\nYou can create a matchmaking rule that initially attempts to match players with similar skill values, then after a few seconds, increases the skill range for another period of seconds. The rule repeats the increments at specified intervals until it reaches a maximum difference in skill levels.\n\nFor example, if the skill of players ranges from `0` to `100` in your game, create a rule that:\n\nYou choose the number of increments and the ranges of wait times and skill levels.\n\n### Write an expression that matches players by skill level\n\nWrite an expression for a match rule where the expression returns a Boolean value of [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] for an acceptable range of skill values that expands at specified time increments. An expression is a JMESPath formatted string with some Game Center matchmaking function additions.\n\nFirst use the `diff()` function (see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/computing-numeric-differences]) to compute the difference between the maximum and minimum skill values of players, where `skill` is a game-specific property name that you set in your code when you submit a match request.\n\nIn a match rule, the requests array contains only compatible matches because Game Center applies compatible and distance rules before match rules.\n\nThen use the `agedValues()` function to return a range of desired skill values depending on the average wait time or age of the requests. Compute the average age of the requests using the `avg()` function.\n\nPass the average age as the first parameter to the `agedValues()` function and other parameters depending on your game (see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/getting-value-based-on-age-using-an-array]).\n\nFor example, if the ideal difference in skill is `20`, pass `20` as the `initialValue` parameter. Then pass an array of age increments as the `ages` parameter (`[ `10`, `20` ]`) and corresponding skill differences as the `values` parameter (`[ `40`, `100` ]`) to the `agedValues()` function.\n\nNow compose a Boolean expression that compares the maximum difference in skill between compatible requests with the desired difference in skill as a function of wait time.\n\nFor more information on the Game Center functions you can use in expressions, see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/expressions] in App Store Connect API.\n\n### Create a match rule containing the expression\n\nCreate a skill-level rule and add it to the rule set. Pass `MATCH` for the rule `type` field, the skill-level expression, and the rule set, along with other settings, to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRules] ``endpoint.\n\nThe `description` and `referenceName` fields are specific to your game. In the `relationships` field, pass the `id` for the rule set in the `GameCenterMatchmakingQueueCreateRequest.Data.Relationships.RuleSet.Data` object.\n\n### Submit a skill-level match request\n\nIn your code, create a [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest] object that uses the skill-level queue and its set of rules to find players. Set the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/properties] and [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/queueName] properties of the match request, so that Game Center uses the matchmaking rules to find players.\n\nSet the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/queueName] property to the reference name of the queue that you previously created using the `Create a queue` endpoint.\n\nSet [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/properties] to a dictionary of key-value pairs that provide values you can use in expressions. Add a `skill` key with a value that represents the local player’s skill level.\n\nIf you set the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/recipients] property, you can also set skill levels for each recipient using the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/recipientProperties] property.\n\nThen submit the match request using the same APIs regardless of whether you configure matchmaking rules. For example, present the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmakerViewController] interface or use the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmaker] class that finds players using automatch without presenting an interface.\n\nWhen all the players accept their invitations and GameKit invokes the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmakerViewControllerDelegate\/matchmakerViewController(_:didFind:)] delegate method in the app instances for all players in the game, you can access the skill levels of all the players using the `GKMatch.playerProperties` property.\n\nFor more information, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/finding-multiple-players-for-a-game].",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/GameKit\/finding-players-with-similar-skill-levels\ncrawled: 2025-12-02T19:33:57Z\n---\n\n# Finding players with similar skill levels\n\n**Article**\n\nAdd a rule to find players in a range of skill levels to balance competitive gameplay.\n\n## Overview\n\nWhen finding players using matchmaking rules, consider adding a rule that finds players in a range of skill levels to make gameplay more enjoyable and fair for all players. To reduce wait times for players, make the rule widen the skill range as the wait time, or age of the match request, increases.\n\nThis article shows one way to find players by skill level that you can combine with your other matchmaking rules. For other types of matchmaking rules, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/letting-players-join-matches-using-party-codes] and [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/assigning-players-to-teams-using-rules].\n\n### Create a skill-level rule set and queue\n\nFirst create a rule set to contain the skill-level rule. Pass a reference name, the minimum players, and the maximum players properties that are game-specific to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRuleSets] endpoint.\n\n```json\nPOST \/v1\/gameCenterMatchmakingRuleSets\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRuleSets\",\n        \"attributes\": {\n            \"referenceName\": \"com.example.mygame.SkillBasedRules\",\n            \"ruleLanguageVersion\": 1,\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4\n        },\n        \"relationships\": {}\n    }\n}\n```\n\nRetain the `id` field of the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GameCenterMatchmakingRuleSet] object that this endpoint returns to use later when you create the skill-level rule.\n\n```json\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRuleSets\",\n        \"id\": \"36c540f2-031a-4e35-8260-d0804e40376b\",\n        \"attributes\": {\n            \"referenceName\": \"com.example.mygame.SkillBasedRules\",\n            \"ruleLanguageVersion\": 1,\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4\n        },\n...\n}\n```\n\nThen create and add the rule set to a skill-level queue. Pass a reference name and the rule set that you create to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingQueues] endpoint. Pass the `id` for the rule set in the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GameCenterMatchmakingQueueCreateRequest\/Data-data.dictionary\/Relationships-data.dictionary\/RuleSet-data.dictionary\/Data-data.dictionary] object.\n\n```json\nPOST \/v1\/gameCenterMatchmakingQueues\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingQueues\",\n        \"attributes\": {\n            \"referenceName\": \"com.example.mygame.SkillBasedRules\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"36c540f2-031a-4e35-8260-d0804e40376b\"\n                }\n            }\n        }\n    }\n}\n```\n\n### Choose parameters that work best for your game\n\nYou can create a matchmaking rule that initially attempts to match players with similar skill values, then after a few seconds, increases the skill range for another period of seconds. The rule repeats the increments at specified intervals until it reaches a maximum difference in skill levels.\n\nFor example, if the skill of players ranges from `0` to `100` in your game, create a rule that:\n\n- For the first `10` seconds, tries to find players with an ideal `20` points or less difference in skill level.\n- For the next `10` seconds, compromises to find players within `40` points or less difference in skill level.\n- After `20` seconds, finds players with no more than the maximum `100` points difference.\n\nYou choose the number of increments and the ranges of wait times and skill levels.\n\n### Write an expression that matches players by skill level\n\nWrite an expression for a match rule where the expression returns a Boolean value of [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] for an acceptable range of skill values that expands at specified time increments. An expression is a JMESPath formatted string with some Game Center matchmaking function additions.\n\nFirst use the `diff()` function (see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/computing-numeric-differences]) to compute the difference between the maximum and minimum skill values of players, where `skill` is a game-specific property name that you set in your code when you submit a match request.\n\n```json\ndiff(players[].properties.skill)\n```\n\nIn a match rule, the requests array contains only compatible matches because Game Center applies compatible and distance rules before match rules.\n\nThen use the `agedValues()` function to return a range of desired skill values depending on the average wait time or age of the requests. Compute the average age of the requests using the `avg()` function.\n\n```json\navg(requests[].secondsInQueue)\n```\n\nPass the average age as the first parameter to the `agedValues()` function and other parameters depending on your game (see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/getting-value-based-on-age-using-an-array]).\n\nFor example, if the ideal difference in skill is `20`, pass `20` as the `initialValue` parameter. Then pass an array of age increments as the `ages` parameter (`[ `10`, `20` ]`) and corresponding skill differences as the `values` parameter (`[ `40`, `100` ]`) to the `agedValues()` function.\n\n```json\nagedValues(avg(requests[].secondsInQueue), `20`, [ `40`, `100` ], [ `10`, `20` ])\n```\n\nNow compose a Boolean expression that compares the maximum difference in skill between compatible requests with the desired difference in skill as a function of wait time.\n\n```json\ndiff(players[].properties.skill) <= agedValues(avg(requests[].secondsInQueue), `20`, [ `40`, `100` ], [ `10`, `20` ])\n```\n\nFor more information on the Game Center functions you can use in expressions, see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/expressions] in App Store Connect API.\n\n\n\n### Create a match rule containing the expression\n\nCreate a skill-level rule and add it to the rule set. Pass `MATCH` for the rule `type` field, the skill-level expression, and the rule set, along with other settings, to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRules] ``endpoint.\n\n```json\nPOST \/v1\/gameCenterMatchmakingRules\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRules\",\n        \"attributes\": {\n            \"type\": \"MATCH\",\n            \"description\": \"Players must have skill in given range\",\n            \"referenceName\": \"SkillDifference\",\n            \"expression\": \"diff(players[].properties.skill) <= agedValues(avg(requests[].secondsInQueue), `20`, [ `40`, `100` ], [ `10`, `20` ])\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"36c540f2-031a-4e35-8260-d0804e40376b\"\n                }\n            }\n        }\n    }\n}\n```\n\nThe `description` and `referenceName` fields are specific to your game. In the `relationships` field, pass the `id` for the rule set in the `GameCenterMatchmakingQueueCreateRequest.Data.Relationships.RuleSet.Data` object.\n\n\n\n### Submit a skill-level match request\n\nIn your code, create a [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest] object that uses the skill-level queue and its set of rules to find players. Set the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/properties] and [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/queueName] properties of the match request, so that Game Center uses the matchmaking rules to find players.\n\n```swift\n\/\/ Create a match request.\nlet request = GKMatchRequest()\n```\n\nSet the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/queueName] property to the reference name of the queue that you previously created using the `Create a queue` endpoint.\n\n```swift\n\/\/ Set the matchmaking rules queue name.\nrequest.queueName = \"com.example.mygame.SkillBasedRules\"\n```\n\nSet [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/properties] to a dictionary of key-value pairs that provide values you can use in expressions. Add a `skill` key with a value that represents the local player’s skill level.\n\n```swift\n\/\/ Set properties to the game-specific keys you use in the rules.\nlet skill = localPlayerData.skill\nrequest.properties = [ \"skill\": skill]\n```\n\nIf you set the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/recipients] property, you can also set skill levels for each recipient using the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/recipientProperties] property.\n\nThen submit the match request using the same APIs regardless of whether you configure matchmaking rules. For example, present the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmakerViewController] interface or use the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmaker] class that finds players using automatch without presenting an interface.\n\nWhen all the players accept their invitations and GameKit invokes the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmakerViewControllerDelegate\/matchmakerViewController(_:didFind:)] delegate method in the app instances for all players in the game, you can access the skill levels of all the players using the `GKMatch.playerProperties` property.\n\nFor more information, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/finding-multiple-players-for-a-game].\n\n## Rules\n\n- **Letting players join matches using party codes**: Add a rule that lets players invite players and join matches using a shared party code.\n- **Assigning players to teams using rules**: Set criteria for assigning players to teams in your game using matchmaking rules.\n- **Creating matchmaking rules for backward compatibility**: Add matchmaking rules that support previous classic matchmaking versions of your game.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Add a rule that lets players invite players and join matches using a shared party code.",
          "name" : "Letting players join matches using party codes",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/letting-players-join-matches-using-party-codes"
        },
        {
          "description" : "Set criteria for assigning players to teams in your game using matchmaking rules.",
          "name" : "Assigning players to teams using rules",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/assigning-players-to-teams-using-rules"
        },
        {
          "description" : "Add matchmaking rules that support previous classic matchmaking versions of your game.",
          "name" : "Creating matchmaking rules for backward compatibility",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/creating-matchmaking-rules-for-backward-compatibility"
        }
      ],
      "title" : "Rules"
    }
  ],
  "source" : "appleJSON",
  "title" : "Finding players with similar skill levels",
  "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/finding-players-with-similar-skill-levels"
}