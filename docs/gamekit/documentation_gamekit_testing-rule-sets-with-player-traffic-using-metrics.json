{
  "abstract" : "Get metrics on a new rule set with real match requests before releasing it.",
  "codeExamples" : [
    {
      "code" : "PATCH \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\n{\n  \"data\" : {\n    \"type\" : \"gameCenterMatchmakingQueues\",\n    \"id\" : \"532ad9c0-1a28-4536-ad57-33213bcc0a29\"\n    \"relationships\" : {\n      \"experimentRuleSet\" : {\n        \"data\" : { \"type\": \"gameCenterMatchmakingRuleSet\", \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\" }\n      }\n    }\n  }\n}",
      "language" : "json"
    },
    {
      "code" : "GET \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\/experimentMatchmakingRequests?granularity=PT15M&groupBy=result",
      "language" : "other"
    },
    {
      "code" : "GET \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\/metrics\/experimentMatchmakingQueueSizes?granularity=PT15M",
      "language" : "other"
    },
    {
      "code" : "PATCH \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\/relationships\/experimentRuleSet\n{\n   \"data\" : null\n}",
      "language" : "json"
    },
    {
      "code" : "PATCH \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\n{\n  \"data\" : {\n    \"type\" : \"gameCenterMatchmakingQueues\",\n    \"id\" : \"532ad9c0-1a28-4536-ad57-33213bcc0a29\"\n    \"relationships\" : {\n      \"ruleSet\" : {\n        \"data\" : { \"type\": \"gameCenterMatchmakingRuleSet\", \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\" }\n      }\n    }\n  }\n}",
      "language" : "json"
    }
  ],
  "contentHash" : "ba72f9a5958ec2521ccab2ec712ad4b3408023f41f6415c7b46d81c45c7f6c29",
  "crawledAt" : "2025-12-02T19:15:15Z",
  "id" : "1BF4FAA2-5E2F-4B54-BD50-2A9E8C183514",
  "kind" : "article",
  "language" : "swift",
  "module" : "GameKit",
  "overview" : "## Overview\n\nBefore you update the rule set of a queue that actively processes player match requests, make sure that the new rule set doesn’t introduce any performance regressions. Game Center provides APIs to evaluate the performance of a prerelease rule set with production match requests that the queue actively processes, without impacting the player experience.\n\n### Add an experimental rule set to a queue\n\nYou can add an optional experimental rule set to a queue, in addition to the required rule set that Game Center uses in production. When you add an experimental rule set, Game Center processes the match requests in the queue using both the existing rule set and the experimental rule set, except that it doesn’t return the results of the experimental rule set to clients. So you can apply the same metrics APIs on the experimental rule set to analyze performance issues before you release it.\n\nTo set the experimental rule set of a queue, use the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/PATCH-v1-gameCenterMatchmakingQueues-_id_] endpoint. Pass the queue’s identifier in the path parameters and include the experimental rule set’s identifier in the request body.\n\nGame Center uses the experimental rule set for next three days. If you want to use the experimental rule set longer, add it to the queue every three days until you’re done testing it.\n\nTo create a new rule set and get its identifier, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/finding-players-using-matchmaking-rules].\n\n### View the results of an experimental rule set\n\nTo get the results of processing match requests using the experimental rule set, pass `experimentalRuleSet` in the query parameter to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GET-v1-gameCenterMatchmakingQueues] or [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GET-v1-gameCenterMatchmakingQueues-_id_] endpoints. Then compare the results of the experimental rule set with the production rule set.\n\nIf it takes Game Center longer to find players or Game Center finds fewer players with the experimental rule set, check whether errors occur applying the rules and consider relaxing the rule conditions. For more information, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/troubleshooting-matchmaking-rules-using-metrics].\n\n### Check the size of the queue\n\nAlso, check the queue size over time using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GET-v1-gameCenterMatchmakingQueues-_id_-metrics-experimentMatchmakingQueueSizes] endpoint. If the queue size for the experimental rule set is larger than the queue size for the existing rule set, investigate whether the new rule set causes this before releasing it.\n\n### Release the new rule set\n\nAfter you finish testing the new rule set, release it by replacing the queue’s rule set with the new one.\n\nFirst, remove the experimental rule set that you used for testing from the queue using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/PATCH-v1-gameCenterMatchmakingQueues-_id_] endpoint. Pass the queue identifier in the parameters and set `data` to `null` in the request body.\n\nThen set the queue’s rule set using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/PATCH-v1-gameCenterMatchmakingQueues-_id_] endpoint. Pass the queue identifier in the parameters and include the new rule set’s identifier in the request body.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/GameKit\/testing-rule-sets-with-player-traffic-using-metrics\ncrawled: 2025-12-02T19:15:15Z\n---\n\n# Testing rule sets with player traffic using metrics\n\n**Article**\n\nGet metrics on a new rule set with real match requests before releasing it.\n\n## Overview\n\nBefore you update the rule set of a queue that actively processes player match requests, make sure that the new rule set doesn’t introduce any performance regressions. Game Center provides APIs to evaluate the performance of a prerelease rule set with production match requests that the queue actively processes, without impacting the player experience.\n\n### Add an experimental rule set to a queue\n\nYou can add an optional experimental rule set to a queue, in addition to the required rule set that Game Center uses in production. When you add an experimental rule set, Game Center processes the match requests in the queue using both the existing rule set and the experimental rule set, except that it doesn’t return the results of the experimental rule set to clients. So you can apply the same metrics APIs on the experimental rule set to analyze performance issues before you release it.\n\nTo set the experimental rule set of a queue, use the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/PATCH-v1-gameCenterMatchmakingQueues-_id_] endpoint. Pass the queue’s identifier in the path parameters and include the experimental rule set’s identifier in the request body.\n\n```json\nPATCH \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\n{\n  \"data\" : {\n    \"type\" : \"gameCenterMatchmakingQueues\",\n    \"id\" : \"532ad9c0-1a28-4536-ad57-33213bcc0a29\"\n    \"relationships\" : {\n      \"experimentRuleSet\" : {\n        \"data\" : { \"type\": \"gameCenterMatchmakingRuleSet\", \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\" }\n      }\n    }\n  }\n}\n```\n\nGame Center uses the experimental rule set for next three days. If you want to use the experimental rule set longer, add it to the queue every three days until you’re done testing it.\n\nTo create a new rule set and get its identifier, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/finding-players-using-matchmaking-rules].\n\n### View the results of an experimental rule set\n\nTo get the results of processing match requests using the experimental rule set, pass `experimentalRuleSet` in the query parameter to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GET-v1-gameCenterMatchmakingQueues] or [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GET-v1-gameCenterMatchmakingQueues-_id_] endpoints. Then compare the results of the experimental rule set with the production rule set.\n\n```other\nGET \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\/experimentMatchmakingRequests?granularity=PT15M&groupBy=result\n```\n\nIf it takes Game Center longer to find players or Game Center finds fewer players with the experimental rule set, check whether errors occur applying the rules and consider relaxing the rule conditions. For more information, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/troubleshooting-matchmaking-rules-using-metrics].\n\n### Check the size of the queue\n\nAlso, check the queue size over time using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/GET-v1-gameCenterMatchmakingQueues-_id_-metrics-experimentMatchmakingQueueSizes] endpoint. If the queue size for the experimental rule set is larger than the queue size for the existing rule set, investigate whether the new rule set causes this before releasing it.\n\n```other\nGET \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\/metrics\/experimentMatchmakingQueueSizes?granularity=PT15M\n```\n\n### Release the new rule set\n\nAfter you finish testing the new rule set, release it by replacing the queue’s rule set with the new one.\n\nFirst, remove the experimental rule set that you used for testing from the queue using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/PATCH-v1-gameCenterMatchmakingQueues-_id_] endpoint. Pass the queue identifier in the parameters and set `data` to `null` in the request body.\n\n```json\nPATCH \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\/relationships\/experimentRuleSet\n{\n   \"data\" : null\n}\n```\n\nThen set the queue’s rule set using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/PATCH-v1-gameCenterMatchmakingQueues-_id_] endpoint. Pass the queue identifier in the parameters and include the new rule set’s identifier in the request body.\n\n```json\nPATCH \/v1\/gameCenterMatchmakingQueues\/532ad9c0-1a28-4536-ad57-33213bcc0a29\n{\n  \"data\" : {\n    \"type\" : \"gameCenterMatchmakingQueues\",\n    \"id\" : \"532ad9c0-1a28-4536-ad57-33213bcc0a29\"\n    \"relationships\" : {\n      \"ruleSet\" : {\n        \"data\" : { \"type\": \"gameCenterMatchmakingRuleSet\", \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\" }\n      }\n    }\n  }\n}\n```\n\n## Testing\n\n- **Testing matchmaking rules**: Test your matchmaking rules before you use them in your game.\n- **Troubleshooting matchmaking rules using metrics**: Investigate issues with Game Center by evaluating your matchmaking rules using metrics endpoints.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Test your matchmaking rules before you use them in your game.",
          "name" : "Testing matchmaking rules",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/testing-matchmaking-rules"
        },
        {
          "description" : "Investigate issues with Game Center by evaluating your matchmaking rules using metrics endpoints.",
          "name" : "Troubleshooting matchmaking rules using metrics",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/troubleshooting-matchmaking-rules-using-metrics"
        }
      ],
      "title" : "Testing"
    }
  ],
  "source" : "appleJSON",
  "title" : "Testing rule sets with player traffic using metrics",
  "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/testing-rule-sets-with-player-traffic-using-metrics"
}