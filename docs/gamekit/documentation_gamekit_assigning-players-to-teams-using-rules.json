{
  "abstract" : "Set criteria for assigning players to teams in your game using matchmaking rules.",
  "codeExamples" : [
    {
      "code" : "POST \/v1\/gameCenterMatchmakingTeams\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingTeams\",\n        \"attributes\": {\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4,\n            \"referenceName\": \"blue\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\"\n                }\n            }\n        }\n    }\n}",
      "language" : "json"
    },
    {
      "code" : "POST \/v1\/gameCenterMatchmakingTeams\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingTeams\",\n        \"attributes\": {\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4,\n            \"referenceName\": \"red\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\"\n                }\n            }\n        }\n    }\n}",
      "language" : "json"
    },
    {
      "code" : "length(teams[?name == 'red'].players[]) == length(teams[?name == 'blue'].players[])",
      "language" : "json"
    },
    {
      "code" : "POST \/v1\/gameCenterMatchmakingRules\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRules\",\n        \"attributes\": {\n            \"type\": \"TEAM\",\n            \"description\": \"Teams must have same number of players\",\n            \"referenceName\": \"SameSizeTeams\",\n            \"expression\": \"length(teams[?name == 'red'].players[]) == length(teams[?name == 'blue'].players[])\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\"\n                }\n            }\n        }\n    }\n}",
      "language" : "json"
    },
    {
      "code" : "\/\/ Create a match request.\nlet request = GKMatchRequest()\n\n\/\/ Set the matchmaking rules queue name.\nrequest.queueName = \"com.example.mygame.TeamBasedQueue\"",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Set properties to the game-specific keys you use in the rules.\nlet skill = localPlayerData.skill\nrequest.properties = [ \"skill\": skill]",
      "language" : "swift"
    },
    {
      "code" : "func matchmakerViewController(_ viewController: GKMatchmakerViewController,\n                                  didFind match: GKMatch) {\n    \/\/ Dismiss the view controller.\n    viewController.dismiss(animated: true, completion: nil)\n\n    \/\/ Set the match delegate.\n    match.delegate = myGame\n          \n    \/\/ Start the game with the players in the match.\n}",
      "language" : "swift"
    },
    {
      "code" : "\/\/ Get the local player's team assignment.\nproperties = match.properties\nteam = properties[\"gc\"][\"team\"]",
      "language" : "swift"
    }
  ],
  "contentHash" : "08af7155aa0dc1b64c6a96718d6096308a97e913cae8ea0e3cf8581af01938d0",
  "crawledAt" : "2025-12-02T19:33:58Z",
  "id" : "C01B8067-5800-4C2B-8FC0-991CBF3B1C00",
  "kind" : "article",
  "language" : "swift",
  "module" : "GameKit",
  "overview" : "## Overview\n\nIf your game has teams, add team rules to balance the assignment of players to teams that makes gameplay more fair and enjoyable for the players. Team rules create constraints on adding players to teams.\n\nGame Center applies the team rules to match requests in the queue after applying other compatible, distance, and match rules. Game Center applies the team rules to candidate teams from combinations of compatible match requests.\n\nBefore you begin adding team rules:\n\nFor more information on creating the other types of rules, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/letting-players-join-matches-using-party-codes] and [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/finding-players-with-similar-skill-levels].\n\n### Add teams to the rule set\n\nCreate two or more teams to compete in your game using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingTeams] endpoint.\n\nIn the attributes property, pass the minimum and maximum players, and a name of the team. In the relationships property, pass the rule set `id` that the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRuleSets] endpoint returns in the response.\n\nCreate one or more other teams to compete with the first team using a different name and add them to the same rule set:\n\n### Add team rules to the rule set\n\nYou can add one or more team rules to your rule set depending on how many constraints you want to add to the team assignments. For example, if your matches have a variable number of team members, you can create a team rule that keeps the sizes of the teams balanced. You can also balance the teams by skill level and ensure that invited players are on the same team.\n\nTo create a team rule, set the rule’s type field to `TEAM` and the `teams` array becomes available to use in expressions. The `teams` array contains `Team` objects that represent the teams in the rule set. A team has a `players` property that contains `Player` objects that represent the players assigned to the team.\n\nWrite an expression that returns [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] when the size of the teams are the same using expression functions, the `teams` array, and the `players` property.\n\nPass the rule type, the expression, and the rule set, along with other settings, to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRules] endpoint.\n\nIn team rule expressions, the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/player] object has a `requestName` field that is an identifier for the associated match request. For more information on the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/team] and [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/player] objects you use in team rules, see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/expressions] in App Store Connect API.\n\n### Create match requests that assign players to teams\n\nIn your code, create a [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest] object that initiates a team game. Set the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/queueName] property to the reference name of the queue that contains your team rules.\n\nIf you add a rule to balance the teams by skill level, add the local player’s skill to the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/properties] property:\n\nGame Center finds all compatible players and assigns them to teams.\n\n### Get team assignments when players accept invitations\n\nWhen all the players accept their invitations, GameKit invokes the `GKMatchmakerViewControllerDelegate` [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmakerViewControllerDelegate\/matchmakerViewController(_:didFind:)] method in the app instances for all players in the game, including the player who sent the invitations.\n\nBefore your implementation of this delegate method starts the game, you can get all the team assignments from the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatch] object. Use the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatch\/players] property to get the players that accepted the invitation, including the player that initiated the match. Then use the `GKMatch.``playersProperties` to get the game-specific properties for each player, such as the `skill` property, including the team assignment. If you add team rules to your rule set, use the `gc` and `team` keys to get the name of the player’s team that you previously configured using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingTeams] endpoint.",
  "rawMarkdown" : "---\nsource: https:\/\/developer.apple.com\/documentation\/GameKit\/assigning-players-to-teams-using-rules\ncrawled: 2025-12-02T19:33:58Z\n---\n\n# Assigning players to teams using rules\n\n**Article**\n\nSet criteria for assigning players to teams in your game using matchmaking rules.\n\n## Overview\n\nIf your game has teams, add team rules to balance the assignment of players to teams that makes gameplay more fair and enjoyable for the players. Team rules create constraints on adding players to teams.\n\nGame Center applies the team rules to match requests in the queue after applying other compatible, distance, and match rules. Game Center applies the team rules to candidate teams from combinations of compatible match requests.\n\nBefore you begin adding team rules:\n\n- Create a rule set to contain the team rules using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRuleSets] endpoint.\n- Add compatibility and distance rules that filter the match requests using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRules] endpoint.\n- Add match rules, such as skill-level rules, that apply to compatible requests.\n\nFor more information on creating the other types of rules, see [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/letting-players-join-matches-using-party-codes] and [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/finding-players-with-similar-skill-levels].\n\n### Add teams to the rule set\n\nCreate two or more teams to compete in your game using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingTeams] endpoint.\n\nIn the attributes property, pass the minimum and maximum players, and a name of the team. In the relationships property, pass the rule set `id` that the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRuleSets] endpoint returns in the response.\n\n```json\nPOST \/v1\/gameCenterMatchmakingTeams\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingTeams\",\n        \"attributes\": {\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4,\n            \"referenceName\": \"blue\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\"\n                }\n            }\n        }\n    }\n}\n```\n\nCreate one or more other teams to compete with the first team using a different name and add them to the same rule set:\n\n```json\nPOST \/v1\/gameCenterMatchmakingTeams\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingTeams\",\n        \"attributes\": {\n            \"minPlayers\": 2,\n            \"maxPlayers\": 4,\n            \"referenceName\": \"red\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\"\n                }\n            }\n        }\n    }\n}\n```\n\n### Add team rules to the rule set\n\nYou can add one or more team rules to your rule set depending on how many constraints you want to add to the team assignments. For example, if your matches have a variable number of team members, you can create a team rule that keeps the sizes of the teams balanced. You can also balance the teams by skill level and ensure that invited players are on the same team.\n\nTo create a team rule, set the rule’s type field to `TEAM` and the `teams` array becomes available to use in expressions. The `teams` array contains `Team` objects that represent the teams in the rule set. A team has a `players` property that contains `Player` objects that represent the players assigned to the team.\n\nWrite an expression that returns [doc:\/\/com.apple.documentation\/documentation\/Swift\/true] when the size of the teams are the same using expression functions, the `teams` array, and the `players` property.\n\n```json\nlength(teams[?name == 'red'].players[]) == length(teams[?name == 'blue'].players[])\n```\n\nPass the rule type, the expression, and the rule set, along with other settings, to the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingRules] endpoint.\n\n```json\nPOST \/v1\/gameCenterMatchmakingRules\n{\n    \"data\": {\n        \"type\": \"gameCenterMatchmakingRules\",\n        \"attributes\": {\n            \"type\": \"TEAM\",\n            \"description\": \"Teams must have same number of players\",\n            \"referenceName\": \"SameSizeTeams\",\n            \"expression\": \"length(teams[?name == 'red'].players[]) == length(teams[?name == 'blue'].players[])\"\n        },\n        \"relationships\": {\n            \"ruleSet\": {\n                \"data\": {\n                    \"type\": \"gameCenterMatchmakingRuleSets\",\n                    \"id\": \"6195839b-4ef7-4798-b91d-d59802111607\"\n                }\n            }\n        }\n    }\n}\n```\n\nIn team rule expressions, the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/player] object has a `requestName` field that is an identifier for the associated match request. For more information on the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/team] and [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/player] objects you use in team rules, see [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/expressions] in App Store Connect API.\n\n### Create match requests that assign players to teams\n\nIn your code, create a [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest] object that initiates a team game. Set the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/queueName] property to the reference name of the queue that contains your team rules.\n\n```swift\n\/\/ Create a match request.\nlet request = GKMatchRequest()\n\n\/\/ Set the matchmaking rules queue name.\nrequest.queueName = \"com.example.mygame.TeamBasedQueue\"\n```\n\nIf you add a rule to balance the teams by skill level, add the local player’s skill to the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchRequest\/properties] property:\n\n```swift\n\/\/ Set properties to the game-specific keys you use in the rules.\nlet skill = localPlayerData.skill\nrequest.properties = [ \"skill\": skill]\n```\n\nGame Center finds all compatible players and assigns them to teams.\n\n### Get team assignments when players accept invitations\n\nWhen all the players accept their invitations, GameKit invokes the `GKMatchmakerViewControllerDelegate` [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatchmakerViewControllerDelegate\/matchmakerViewController(_:didFind:)] method in the app instances for all players in the game, including the player who sent the invitations.\n\n```swift\nfunc matchmakerViewController(_ viewController: GKMatchmakerViewController,\n                                  didFind match: GKMatch) {\n    \/\/ Dismiss the view controller.\n    viewController.dismiss(animated: true, completion: nil)\n\n    \/\/ Set the match delegate.\n    match.delegate = myGame\n          \n    \/\/ Start the game with the players in the match.\n}\n```\n\nBefore your implementation of this delegate method starts the game, you can get all the team assignments from the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatch] object. Use the [doc:\/\/com.apple.gamekit\/documentation\/GameKit\/GKMatch\/players] property to get the players that accepted the invitation, including the player that initiated the match. Then use the `GKMatch.``playersProperties` to get the game-specific properties for each player, such as the `skill` property, including the team assignment. If you add team rules to your rule set, use the `gc` and `team` keys to get the name of the player’s team that you previously configured using the [doc:\/\/com.apple.documentation\/documentation\/AppStoreConnectAPI\/POST-v1-gameCenterMatchmakingTeams] endpoint.\n\n```swift\n\/\/ Get the local player's team assignment.\nproperties = match.properties\nteam = properties[\"gc\"][\"team\"]\n```\n\n## Rules\n\n- **Letting players join matches using party codes**: Add a rule that lets players invite players and join matches using a shared party code.\n- **Finding players with similar skill levels**: Add a rule to find players in a range of skill levels to balance competitive gameplay.\n- **Creating matchmaking rules for backward compatibility**: Add matchmaking rules that support previous classic matchmaking versions of your game.\n\n",
  "sections" : [
    {
      "content" : "",
      "items" : [
        {
          "description" : "Add a rule that lets players invite players and join matches using a shared party code.",
          "name" : "Letting players join matches using party codes",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/letting-players-join-matches-using-party-codes"
        },
        {
          "description" : "Add a rule to find players in a range of skill levels to balance competitive gameplay.",
          "name" : "Finding players with similar skill levels",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/finding-players-with-similar-skill-levels"
        },
        {
          "description" : "Add matchmaking rules that support previous classic matchmaking versions of your game.",
          "name" : "Creating matchmaking rules for backward compatibility",
          "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/creating-matchmaking-rules-for-backward-compatibility"
        }
      ],
      "title" : "Rules"
    }
  ],
  "source" : "appleJSON",
  "title" : "Assigning players to teams using rules",
  "url" : "https:\/\/developer.apple.com\/documentation\/GameKit\/assigning-players-to-teams-using-rules"
}